/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var tmp=["inputField","displayArea","button"];for(var i in tmp){if(typeof params[tmp[i]]=="string"){var id="#"+params[tmp[i]].escapejQuerySelector();if(params.context){params[tmp[i]]=AJS.$(params.context).find(id).get(0)}else{params[tmp[i]]=AJS.$(id).get(0)}}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
JIRA.AutoComplete=function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=AJS.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=JIRA.SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){var isIe8=jQuery.browser.msie&&jQuery.browser.version==8;function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){if(isIe8){delay(jQuery.proxy(callback,this),0.2)}else{callback.call(this)}}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}();AJS.namespace("jira.widget.autocomplete",null,JIRA.AutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
JIRA.RESTAutoComplete=function(){var that=begetObject(JIRA.AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}();AJS.namespace("jira.widget.autocomplete.REST",null,JIRA.RESTAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
JIRA.IssueAutoComplete=function(options){var that=begetObject(JIRA.RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/issues/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=AJS.$("<ul/>").appendTo(this.responseContainer);AJS.$(response.sections).each(function(){var section=this;var subSection=AJS.$("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(AJS.$("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(AJS.$("<li/>").append(subSection).mouseover(function(){AJS.$(this).addClass("active")}).mouseout(function(){AJS.$(this).removeClass("active")}));if(section.msg){var msg=AJS.$("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(AJS.$("<li/>").append(msg).mouseover(function(){AJS.$(this).addClass("active")}).mouseout(function(){AJS.$(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){AJS.$(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=AJS.$("<li/>").append(AJS.$("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(AJS.$("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(AJS.$("<tr/>").append(AJS.$("<td/>").append(AJS.$("<img/>").attr("src",imgUrl))).append(AJS.$("<td/>").append(AJS.$("<div/>").addClass("yak").html(this.keyHtml))).append(AJS.$("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};JIRA.IssueAutoComplete.init=function(){AJS.$("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=AJS.$("#"+params.fieldId);if($formElement){AJS.$.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){JIRA.IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};AJS.namespace("jira.widget.autocomplete.Issues",null,JIRA.IssueAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
JIRA.UserAutoComplete=function(options){var that=begetObject(JIRA.RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!AJS.isSelenium()&&!AJS.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);AJS.$(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};JIRA.UserAutoComplete.init=function(parent){AJS.$("fieldset.user-picker-params",parent).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),field=(params.fieldId||params.fieldName),$container=AJS.$("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(AJS.$.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){JIRA.UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};AJS.namespace("jira.widget.autocomplete.Users",null,JIRA.UserAutoComplete);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:JIRA.REST_BASE_URL+"/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();
/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<span class="remove-recipient item-delete"/>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
JIRA.IssuePicker=AJS.MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){AJS.$(response.sections).each(function(i,section){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){AJS.$(section.issues).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;JIRA.IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=AJS.$.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return AJS.$("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});AJS.namespace("jira.issuepicker",null,JIRA.IssuePicker);AJS.namespace("AJS.IssuePicker",null,JIRA.IssuePicker);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
JIRA.LabelPicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(AJS.$.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(AJS.$.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new AJS.GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){AJS.$.each(data.suggestions,function(){optgroup.addItem(new AJS.ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=AJS.$.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}});AJS.namespace("AJS.LabelPicker",null,JIRA.LabelPicker);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){function initIssuePicker(el){AJS.$(el||document.body).find(".aui-field-issuepicker").each(function(){new JIRA.IssuePicker({element:AJS.$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initIssuePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
(function(){function createPicker($fieldset,context){var opts=JIRA.parseOptionsFromFieldset($fieldset),$select=AJS.$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new JIRA.LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}function locateFieldset(parent){var $parent=AJS.$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}var FIELDSET_SELECTOR="fieldset.labelpicker-params";function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";AJS.$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){createPicker($fieldset,context)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.backgroundImages=this.removeBackgroundImages(options.issueTypeSelect);this.$refIssueTypeSelect=jQuery(options.issueTypeSelect).clone(true,true);this.$issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=this.getProjectIssueTypeSchemesFromDom();this.issueTypesSchemeDefaults=this.getIssueTypeSchemeIssueDefaults();if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));if(this.$project.is("select")){this.$project.change(function(){var val=instance.$project.val();instance.lastIssueType=instance.$issueTypeSelect.find(":selected:first").val();instance.$refIssueTypeSelect.val("");instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));instance.$issueTypeSelect.trigger("reset")})}}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},removeBackgroundImages:function(issueTypeSelect){var map={};jQuery(issueTypeSelect).find("option[style]").each(function(){map[jQuery(this).attr("id")]=jQuery(this).css("background-image");jQuery(this).attr("style","");jQuery(this).removeAttr("style")});return map},addBackgroundImages:function(){var that=this;this.$issueTypeSelect.find("option").each(function(){jQuery(this).css("background-image",that.backgroundImages[jQuery(this).attr("id")])})},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType,instance=this,$toSelect,$placeholder=jQuery("<span class='hidden' />"),$optgroups=this.$refIssueTypeSelect.find("optgroup");$placeholder.insertAfter(this.$issueTypeSelect);this.$issueTypeSelect.detach().empty();if($optgroups.length){$optgroups.each(function(){var $optgroup=jQuery(this);if($optgroup.is("[data-scheme-id='"+issueTypeSchemeId+"']")){instance.$issueTypeSelect.append($optgroup.clone(true).children());return false}})}else{this.$issueTypeSelect.append(this.$refIssueTypeSelect.children())}selectedIssueType=this.$issueTypeSelect.find("option[data-selected]").val()||"";if(instance.lastIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+instance.lastIssueType+"']")}else{if(selectedIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+selectedIssueType+"']")}}if($toSelect&&$toSelect.length!==0){$toSelect.attr("selected","selected");this.$issueTypeSelect.val($toSelect.val())}else{this.setDefaultIssueType(issueTypeSchemeId)}this.$issueTypeSelect.insertAfter($placeholder);this.addBackgroundImages();this.$issueTypeSelect.attr("data-project",this.$project.val());$placeholder.remove()},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId);if(defaultIssueType!==""){this.$issueTypeSelect.find("option[value='"+defaultIssueType+"']").attr("selected","selected")}else{this.$issueTypeSelect.find("option").each(function(i,option){if(this.value&&this.value!==""){jQuery(option).attr("selected","selected");return false}})}},getProjectIssueTypeSchemesFromDom:function(){var projectIssueTypes={};this.$projectIssueTypesSchemes.find("input").each(function(i,input){var $input=jQuery(input),project=$input.attr("title"),issueTypes=$input.val();projectIssueTypes[project]=issueTypes});return projectIssueTypes},getIssueTypeSchemeIssueDefaults:function(){var issueTypesSchemeDefaults={};this.$issueTypeSchemeIssueDefaults.find("input").each(function(i,input){var $input=jQuery(input),issueTypeScheme=$input.attr("title"),defaultIssueType=$input.val();issueTypesSchemeDefaults[issueTypeScheme]=defaultIssueType});return issueTypesSchemeDefaults}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body"),$project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=$ctx.find(".issuetype-field"),$projectIssueTypes=$ctx.find(".project-issue-types"),$defaultProjectIssueTypes=$ctx.find(".default-project-issue-type");$project.each(function(i){new JIRA.ProjectIssueTypeSelect({project:jQuery(this),issueTypeSelect:$issueTypeSelect.eq(i),projectIssueTypesSchemes:$projectIssueTypes.eq(i),issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes.eq(i)})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createissueTypePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){function createProjectPicker(context){context.find(".project-field").each(function(){new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createInlineAttach(context)}})})();
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(C,A,B){jQuery(this).trigger(C,A);
if(B&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(E,D){jQuery(AJS).trigger(D+"."+C,A)
})
}return this
};
Class.prototype.bind=function(A,B){jQuery(this).bind(A,B);
return this
};
JIRA.makePropertyFunc=function(A){if(jQuery.isFunction(A)){return A
}else{return function(){return A
}
}};
JIRA.Dialog.getAttrFromActiveTrigger=function(B){var C=JIRA.Dialog.current,A=C.$activeTrigger;
if(A){return A.attr(B)
}};
JIRA.Dialog.getIssueActionTitle=function(B){var A=JIRA.Dialog.getActionIssueKey();
if(!A){return B
}return B+" : "+A
};
JIRA.Dialog.getActionIssueKey=function(){var A=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");
if(!A&&JIRA.Issue){A=JIRA.Issue.getIssueKey()
}if(!A&&JIRA.IssueNavigator){A=JIRA.IssueNavigator.getSelectedIssueKey()
}if(!A&&JIRA.Issues){A=JIRA.Issues.Api.getSelectedIssueKey()
}return A
};
JIRA.activateTabWithChild=function(E){var C,B,A,D=E.closest(".tabs-pane");
if(D.length){B=D.closest(".aui-tabs");
C=D.attr("id");
A=B.find("a[href='#"+C+"']");
A.click()
}};
JIRA.applyErrorsToForm=function(C,D){var B,A=[];
jQuery.each(D,function(F,I){var H,E,G=C.find(":input[name='"+F+"']").last();
if(G.length===1){if(!B){B=G
}E=jQuery("<div class='error' />").attr("data-field",F).text(I);
H=G.closest(".field-group, .group");
H.find(".error").remove();
H.append(E)
}else{if(G.length===0){A.push(I)
}}});
if(A.length>0){JIRA.applyErrorMessageToForm(C,JIRA.Templates.Issue.undealtErrors({errors:A}))
}JIRA.activateTabWithChild(C.find(".error:first"));
if(B){B.focus()
}};
JIRA.extractScripts=function(B){var A=jQuery(B);
return{html:A.not("script"),scripts:A.filter("script")}
};
JIRA.applyMessageToForm=function(A,C,B,E){var D=C.find(".aui-message-context");
if(!D.length){D=jQuery("<div class='aui-message-context' />");
if(JIRA.useLegacyDecorator()){D.prependTo(C.find(".content-body"))
}else{D.prependTo(C.find(".form-body"))
}}D.empty();
AJS.messages[A](D,{shadowed:false,closeable:E,body:B})
};
JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")
};
JIRA.applyErrorMessageToForm=function(B,A){return JIRA.applyMessageToForm("error",B,A,false)
};
JIRA.applySuccessMessageToForm=function(B,A){return JIRA.applyMessageToForm("success",B,A,true)
};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(A){this.userFieldsResource=A.userFieldsResource;
this.fieldsResource=A.fieldsResource;
this.retainedFields=[];
this._hasRetainFeature=false;
this._hasVisibilityFeature=true
},getFieldsResource:function(){return this.fieldsResource
},getAtlToken:function(){return this.atlToken
},getActiveFieldIds:function(){return this.getUserFields()
},addFieldToRetainValue:function(A){if(this._hasRetainFeature){this.removeFieldToRetainValue(A);
this.retainedFields.push(A)
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},clearRetainedFields:function(){this.retainedFields=[]
},removeFieldToRetainValue:function(B){if(this._hasRetainFeature){var A=jQuery.inArray(B,this.retainedFields);
if(A!=-1){this.retainedFields.splice(A,1)
}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},hasRetainedValue:function(A){if(this._hasRetainFeature){return jQuery.inArray(A.id,this.retainedFields)!==-1
}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},refresh:function(C){var A=this,B=jQuery.Deferred(),D;
if(C){D=C+"&retainValues=true"
}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:D,success:function(E){A.atlToken=E.atl_token;
A.fields=E.fields;
A.sortedTabs=E.sortedTabs;
A.userPreferences=E.userPreferences
},complete:function(F,G,E){if(E.successful){B.resolveWith(A,arguments)
}else{A.triggerEvent("serverError",[E]);
B.rejectWith(A,[E])
}}});
return B.promise()
},setFields:function(A){this.fields=A
},getConfigurableFields:function(){return this.getFields()
},getFields:function(){var A=this,B=jQuery.Deferred();
if(!this.fields){this.refresh().done(function(){B.resolve(A.fields)
})
}else{B.resolve(A.fields)
}return B.promise()
},_mungeTabs:function(B){var A=0,C=[];
jQuery.each(B,function(D,E){A++;
if(E.tab){if(!C[E.tab.position]){C[E.tab.position]=AJS.copyObject(E.tab)
}if(E.tab.position===0){C[E.tab.position].isFirst=true
}if(!C[E.tab.position].fields){C[E.tab.position].fields=[]
}C[E.tab.position].fields.push(AJS.copyObject(E))
}});
return C
},getTabs:function(){var A=this,B=jQuery.Deferred();
this.getFields().done(function(C){var D=A._mungeTabs(C);
B.resolve(D)
});
return B.promise()
},getSortedTabs:function(){var A=jQuery.Deferred();
if(!this.sortedTabs){this.refresh().done(function(){A.resolve(this.sortedTabs)
})
}else{A.resolve(this.sortedTabs)
}return A.promise()
},getUserFields:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.fields)
})
}else{B.resolve(A.userPreferences.fields)
}return B.promise()
},setUserFields:function(A){var B={};
B.fields=A;
return this.updateUserPrefs(B)
},hasRetainFeature:function(){return !!this._hasRetainFeature
},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature
},getUseConfigurableForm:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.useQuickForm)
}).fail(function(){B.reject()
})
}else{B.resolve(A.userPreferences.useQuickForm)
}return B.promise()
},setUseConfigurableForm:function(A){var B={};
B.useQuickForm=A;
return this.updateUserPrefs(B)
},updateUserPrefs:function(C){var B=jQuery.Deferred(),A=this;
if(AJS.Meta.get("remote-user")===""){B.done();
return B.promise()
}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");
B.reject();
return B.promise()
}if(!C.fields){C.fields=this.userPreferences.fields
}if(typeof C.showWelcomeScreen==="undefined"){C.showWelcomeScreen=this.userPreferences.showWelcomeScreen
}if(typeof C.useQuickForm==="undefined"){C.useQuickForm=this.userPreferences.useQuickForm
}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(C),dataType:"json",contentType:"application/json",complete:function(E,F,D){if(D.successful){A.userPreferences=C
}else{A.triggerEvent("serverError",[D])
}}})
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error"><span class="aui-icon icon-error"></span>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(A){this.descriptor=A;
this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())
},focus:function(){this.$element.find(":input:first").focus()
},highlight:function(){var A=this;
this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){A.$element.animate({backgroundColor:"#fff"},function(){A.$element.css("backgroundColor","")
})
})
},getLabel:function(){return this.descriptor.label
},getId:function(){return this.descriptor.id
},activate:function(B){var A;
this.active=true;
this.$element.addClass("qf-field-active").show();
this.$element.find("textarea").trigger("refreshInputHeight");
if(!B){A=this.render();
this.$element.append(A.scripts);
this.focus();
JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);
this.$element.scrollIntoView();
this.triggerEvent("activated")
}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature
},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature
},isActive:function(){return this.active
},disable:function(A){this.render();
this.active=false;
this.$element.removeClass("qf-field-active").hide();
if(!A){this.triggerEvent("disabled")
}},render:function(){var B=JIRA.Templates.QuickForm.field(this.descriptor),A=JIRA.extractScripts(B);
this.$element.html(A.html).addClass("qf-field").data("model",this);
return{element:this.$element,scripts:A.scripts}
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]
},switchToAll:function(A){this.isConfigurable=false;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToAll")
}},setForm:function(A){this.form=A
},switchToCustom:function(A){this.isConfigurable=true;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToCustom")
}},hideCallback:function(){},bindInlineDialog:function(){var B=this,A=this.getInlineDialogTrigger();
function C(F,D,E){B.render().done(function(G){if(F.find(".qf-picker").length===0){F.html(G);
F.click(function(K){K.stopPropagation()
})
}var J=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),I=jQuery(window).height(),H=I-J-110;
F.find(".qf-picker-content").css("maxHeight",H);
E()
})
}if(this.inlineDialog){this.inlineDialog.remove()
}this.inlineDialog=AJS.InlineDialog(A,this.INLINE_DIALOG_ID,C,{width:400,upfrontCallback:function(){A.parent().addClass("active")
},hideCallback:function(){A.parent().removeClass("active")
},nobind:true});
A.click(function(D){if(jQuery("#inline-dialog-"+B.INLINE_DIALOG_ID).is(":visible")){B.inlineDialog.hide()
}else{B.inlineDialog.show()
}});
return this.inlineDialog
},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")
},renderButtons:function(B){var A=this,C=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);
jQuery.each(B,function(E,F){var G,D;
if(A.isConfigurable){A.form.getFieldById(F.id).done(function(I){if(I&&I.hasVisibilityFeature()){var J=jQuery("<li />").appendTo(C);
var H=new JIRA.Forms.FieldPicker.ConfigurableButton({field:I});
H.render().appendTo(J);
A.buttons.push(H)
}})
}else{D=new JIRA.Forms.FieldPicker.UnconfigurableButton(F);
G=jQuery("<li />").appendTo(C);
D.render().appendTo(G)
}});
if(C.children().length===0){C.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")
}},renderContents:function(){var A=this,B=jQuery.Deferred();
this.form.model.getSortedTabs().done(function(C){if(C.length===1){A.renderButtons(C[0].fields)
}else{jQuery.each(C,function(D,E){if(E.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(A.$content).find("span").text(E.label);
A.renderButtons(E.fields)
}})
}B.resolveWith(A,[A.$element])
});
return B.promise()
},show:function(){this.inlineDialog.show()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));
this.$content=this.$element.find(".qf-picker-content");
this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));
this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));
return this.renderContents()
},_events:{switchToCustom:{click:function(A){this.switchToCustom();
A.preventDefault()
}},switchToAll:{click:function(A){this.switchToAll();
A.preventDefault()
}}}});
JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(A){this.descriptor=A
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));
return this.$element
}});
JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(B){var A=this;
this.field=B.field;
this.field.bind("disabled",function(){A.$element.removeClass("qf-active")
}).bind("activated",function(){A.$element.addClass("qf-active")
})
},toggle:function(){if(this.field.isActive()){this.field.disable()
}else{this.field.activate()
}},getId:function(){return this.field.getId()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));
this._assignEvents("button",this.$element);
return this.$element
},_events:{button:{click:function(A){this.toggle();
A.preventDefault()
}}}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var A=this;
A.getForm().addClass("submitting");
return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){A.disable()
},data:this.serialize(),complete:function(G,H,C){var E=C.data;
A.getForm().find(".aui-message-context").remove();
A.enable();
A.getForm().find(".error").remove();
if(C.successful){A.performAnalytics();
if(E&&E.fields){A.invalidateFieldsCache();
A.model.setFields(E.fields)
}if(typeof E==="string"){var F=AJS.$(AJS.extractBodyFromResponse(E));
var D=F.find("#atl_token").val();
if(D){A.model.atlToken=D;
A.getForm().find('input[name="atl_token"]').val(D)
}var B=new JIRA.FormDialog({offsetTarget:"body",content:F});
B._handleServerSuccess=function(){if(B.prev){B.prev._removeStackState();
B.prev._resetWindowTitle();
B._removeStackState()
}B.hide();
A.triggerEvent("sessionComplete",[],true);
A.handleSubmitSuccess()
};
B._handleServerError=function(I){B.hide();
A.handleSubmitError(I)
};
B.show()
}else{A.handleSubmitSuccess(C.data)
}}else{A.handleSubmitError(G)
}A.getForm().removeClass("submitting")
}})
},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");
this.getForm().find(":submit").attr("disabled","disabled")
},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");
this.getForm().find(":submit").removeAttr("disabled")
},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")
},serialize:function(C){var A=this,B=this.getForm().serialize();
if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){B=B+"&multipleMode=true"
}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();
jQuery.each(this.getActiveFieldIds(),function(E,D){A.model.addFieldToRetainValue(D,C)
});
jQuery.each(this.model.getFieldsWithRetainedValues(),function(D,E){B=B+"&fieldsToRetain="+E
})
}return B
},invalidateFieldsCache:function(){delete this.fields
},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()
},handleSubmitSuccess:function(){this.triggerEvent("submitted");
AJS.reloadViaWindowLocation()
},performAnalytics:function(){var A=function(D,E){var C="***** Analytics log ["+D+"]";
if(E){C+="["+JSON.stringify(E)+"]"
}AJS.log(C);
if(AJS.EventQueue){AJS.EventQueue.push({name:D,properties:E||{}})
}};
var B=function(E){var C={};
var F=_.filter(E,function(G){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],G.name)
});
var D=_.filter(F,function(G){return G.value!=""
});
_.each(D,function(H){var G=H.name;
if(!_.has(C,G)){C[G]=[]
}C[G].push(H.value)
});
return C
};
this.previousAnalytics=(function(K,O){var F=B(K);
var M=_.keys(F);
var G=_.keys(O.data);
var J=_.difference(M,G);
var N=_.difference(G,M);
var L=_.intersection(G,M);
var D=_.filter(L,function(P){return _.isEqual(O.data[P],F[P])
});
var C=_.difference(L,D);
var I=O.count+1;
var H=(JIRA.Dialog.current.options.id==="edit-issue-dialog");
var E={"atlassian.numCreates":I,"edit.form":H};
_.each(J,function(P){E[P]="added"
});
_.each(N,function(P){E[P]="removed"
});
_.each(D,function(P){E[P]="same"
});
_.each(C,function(P){E[P]="changed"
});
A("quick.create.fields",E);
return{data:F,count:I}
})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})
},handleSubmitError:function(D){var A=this;
var E;
try{E=JSON.parse(D.responseText)
}catch(C){}if(E){if(E.errorMessages&&E.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),E.errorMessages[0])
}if(E&&E.errors&&D.status===400){if(this.getFieldById){jQuery.each(E.errors,function(F){if(/^timetracking/.test(F)){A.getFieldById("timetracking").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{if(/^worklog/.test(F)){A.getFieldById("worklog").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{A.getFieldById(F).done(function(G){G.activate(true)
})
}}})
}JIRA.applyErrorsToForm(this.getForm(),E.errors);
this.triggerEvent("validationError",[this,E.errors],true)
}var B=A.$element.find(".error");
if(B.length){B[0].scrollIntoView(false)
}}},getAction:function(){return this.action
},getFormContent:function(){return this.$element.find("div.content")
},getForm:function(){return this.$element.find("form")
},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")
},_getActiveAttachments:function(){var A=this.$element.find("input[name=filetoconvert]");
var B=[];
A.each(function(){if(this.checked){B.push(this.id)
}});
return B
},_setActiveAttachments:function(B){var A=this.$element.find("input[name=filetoconvert]");
A.each(function(){var D=jQuery(this);
var C=_.contains(B,D.attr("id"));
D.attr("checked",C)
})
},render:function(C){var B=jQuery.Deferred(),A=this;
var D=A._getActiveAttachments();
if(C){this.invalidateFieldsCache();
this.model.refresh(C).done(function(){A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
})
}else{A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
}B.always(function(){A._setActiveAttachments(D)
});
return B.promise()
}});
JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getConfigurableFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
},getActiveFieldIds:function(){var B=[],A=this.$element.find(".qf-field.qf-field-active:not(.qf-required)");
jQuery.each(A,function(D,E){var C=jQuery(E);
var F=C.data("model").getId();
B.push(F);
if(F==="attachment"){C.find(":checked").each(function(){B.push(this.id)
})
}});
return B
},_getActiveAttachments:function(){return _.filter(this.getActiveFieldIds(),function(A){return A&&A.indexOf("filetoconvert")===0
})
},createField:function(C){C.hasVisibilityFeature=this.model.hasVisibilityFeature(C);
if(this.model.hasRetainFeature(C)){C.hasRetainFeature=true;
C.retainValue=this.model.hasRetainedValue(C)
}var A=this,B=new JIRA.Forms.ConfigurableField(C);
if(C.hasVisibilityFeature){B.bind("activated",function(){A.model.setUserFields(A.getActiveFieldIds());
B.highlight();
A.triggerEvent("QuickForm.fieldAdded",[B])
}).bind("disabled",function(){A.model.setUserFields(A.getActiveFieldIds());
A.triggerEvent("QuickForm.fieldRemoved",[B])
})
}return B
},getFieldById:function(C){var A=this,B=jQuery.Deferred();
this.getFields().done(function(D){jQuery.each(D,function(E,F){if(F.getId()===C){B.resolveWith(A,[F])
}});
B.rejectWith(A,[])
});
return B.promise()
},hasNoVisibleFields:function(){var A=jQuery.Deferred();
A.resolve(this.getActiveFieldIds().length===0);
return A.promise()
},renderFormContents:function(){var C=jQuery.Deferred(),B=jQuery(),A=this;
A.getFields().done(function(D){A.model.getActiveFieldIds().done(function(E){jQuery.each(D,function(){var F=this.render();
B=B.add(F.scripts);
A.getFormContent().append(F.element)
});
jQuery.each(E,function(G,F){jQuery.each(D,function(){if(this.getId()===F){this.activate(true)
}})
});
jQuery.each(D,function(){if(!this.isActive()){this.disable(true)
}});
A.hasNoVisibleFields().done(function(G){if(G===true){for(var F=0;
F<3;
F++){if(D[F]){D[F].activate(true)
}}}C.resolveWith(this,[A.$element,B])
})
})
});
return C.promise()
}});
JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},getActiveFieldIds:function(){var A=[];
this.model.getFields().done(function(B){jQuery.each(B,function(C,D){A.push(D.id)
})
});
return A
},getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
}});
JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(A){var B,C;
if(A.hasData&&A.status!==401){try{C=JSON.parse(A.data);
if(C.errorMessages&&C.errorMessages.length>0){B=JIRA.Templates.QuickForm.errorMessage({message:C.errorMessages[0]})
}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}catch(D){B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}return B
},render:function(B){var A=this.getErrorMessageFromSmartAjax(B);
return this._render(A)
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(A){this.$element=jQuery("<div />").addClass("qf-container");
this.options=JIRA.makePropertyFunc(A);
this.fieldPicker=new JIRA.Forms.FieldPicker();
this.successData=[]
},decorateRenderers:function(){var A=this;
if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){A.unconfigurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.bind("switchedToCustom",function(){A.configurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.decorated=true
}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(C,B){A.currentView=A.configurableForm;
A.fieldPicker.switchToCustom(true);
A.fieldPicker.setForm(A.configurableForm);
A.fieldPicker.bindInlineDialog();
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(true);
A.triggerEvent("configurableFormRendered")
});
this.configurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("configurableFormSubmitted")
});
this.configurableForm.decorated=true
}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(C,B){A.fieldPicker.switchToAll(true);
A.fieldPicker.setForm(A.unconfigurableForm);
A.fieldPicker.bindInlineDialog();
A.currentView=A.unconfigurableForm;
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(false);
A.triggerEvent("unconfigurableFormRendered")
});
this.unconfigurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("unconfigurableFormSubmitted")
});
this.unconfigurableForm.decorated=true
}},applyGlobalDecorator:function(C){function B(){if(A.currentView.setInitialFocus){A.currentView.setInitialFocus()
}}var A=this;
C.detach();
this.$element.html(C);
this.triggerEvent("contentRefreshed",[this.$element]);
if(jQuery.browser.msie){window.setTimeout(B,0)
}else{B()
}},asDialog:function(B){var A=this,C;
this.dialog=C=new JIRA.FormDialog({id:B.id,trigger:B.trigger,windowTitle:B.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(D){A.render().done(function(){D(A.$element)
});
A.triggerEvent("dialogShown")
},submitHandler:function(E,D){E.preventDefault();
A.currentView.submit().then(D,D)
},stacked:true});
if(B.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(D){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){D.preventDefault()
}})
}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])
};
this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){C.hide()
});
this.configurableForm.bind("sessionComplete",function(){C.hide()
})
}).bind("contentRefreshed",function(){C.notifyOfNewContent()
});
C.bind("Dialog.hide",function(){if(A.successData.length){A.triggerEvent("sessionComplete",[A.successData],true);
A.successData=[]
}});
A.$element.ajaxStart(function(){C.showFooterLoadingIndicator()
}).ajaxStop(function(){C.hideFooterLoadingIndicator()
});
C.getQuickForm=function(){return A
};
C.dirtyFormWarning();
return C
},lazyInit:function(){var A=this,B=this.options.call(this);
this.model=B.model;
this.errorHandler=B.errorHandler;
this.globalEventNamespaces=B.globalEventNamespaces;
this.configurableForm=B.configurableForm;
this.unconfigurableForm=B.unconfigurableForm;
this.sessionComplete=B.sessionComplete;
this.model.clearRetainedFields();
this.configurableForm.invalidateFieldsCache();
this.model.bind("serverError",function(D,C){A.$element.html(A.errorHandler.render(C));
A.triggerEvent("contentRefreshed",[this.$element])
});
this.triggerEvent("initialized");
this.decorateRenderers()
},render:function(){var A=this,B=jQuery.Deferred();
this.lazyInit();
A.model.getUseConfigurableForm().done(function(C){if(C===true){A.configurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element]);
A.$element.append(D)
})
}else{A.unconfigurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element,D]);
A.$element.append(D)
})
}}).fail(function(){B.resolveWith(A,[A.$element])
});
return B.promise()
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/edit.js' */
JIRA.Forms.EditIssueModel=JIRA.Forms.Model.extend({getUnconfigurableTabs:function(){var A=this,B=jQuery.Deferred();
A.getTabs().done(function(D){var C=D.slice(0);
C[0].fields=C[0].fields.slice(0);
jQuery.each(C[0].fields,function(E,F){if(F.id==="comment"){C[0].fields.splice(E,1);
return false
}});
B.resolve(C)
});
return B.promise()
},getCommentField:function(){var A=jQuery.Deferred();
this.getFields().done(function(B){jQuery.each(B,function(C,D){if(D.id==="comment"){A.resolve(D)
}});
A.reject()
});
return A.promise()
}});
JIRA.Forms.EditIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.editIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableEditIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getUnconfigurableTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A]);
this.triggerEvent("sessionComplete")
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){var D={fieldsHtml:C,title:A.title,issueId:A.issueId,atlToken:A.model.getAtlToken(),useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()};
this.model.getCommentField().then(function(G){var F,E;
D.commentField=G;
F=JIRA.Templates.Issue.editIssueForm(D);
E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
},function(){var F=JIRA.Templates.Issue.editIssueForm(D),E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableEditIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A]);
this.triggerEvent("sessionComplete")
},hasNoVisibleFields:function(){var A=jQuery.Deferred(),B=this.getActiveFieldIds();
this.model.getUserFields().done(function(C){if(C.length===1&&C[0]==="comment"){A.resolve(false)
}else{if(B.length===0||(B.length===1&&B[0]==="comment")){A.resolve(true)
}else{A.resolve(false)
}}});
return A.promise()
},_render:function(){var B=jQuery.Deferred(),A=this,C=JIRA.Templates.Issue.editIssueForm({issueId:this.issueId,title:this.title,atlToken:A.model.getAtlToken(),isConfigurable:true,useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()});
this.$element.html(C);
A.renderFormContents().done(function(E,D){A.getFieldById("comment").done(function(F){A.getFormContent().append(F.$element)
});
B.resolveWith(A,[A.$element,D])
});
return B.promise()
}});
JIRA.Forms.Model.createQuickEditIssueModel=function(A){return new JIRA.Forms.EditIssueModel({fieldsResource:contextPath+"/secure/QuickEditIssue!default.jspa?issueId="+A+"&decorator=none",userFieldsResource:contextPath+"/rest/quickedit/1.0/userpreferences/edit"})
};
JIRA.Dialog.shouldShowIssueKeyInTitle=function(){return JIRA.Issues||JIRA.IssueNavigator.isNavigator()||JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey")
};
JIRA.Forms.createEditIssueForm=function(){function A(C){var D=JIRA.Dialog.getAttrFromActiveTrigger("data-issueId");
if(jQuery.isFunction(C.issueId)){return C.issueId(C)
}else{if(C.issueId){return C.issueId
}else{if(D){return D
}else{return JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
}}}}function B(){var C="Edit Issue";
if(JIRA.Dialog.shouldShowIssueKeyInTitle()){return JIRA.Dialog.getIssueActionTitle(C)
}else{return C
}}return function(C){C=C||{};
return new JIRA.Forms.Container(function(){var H=A(C),G=B(),D=JIRA.Forms.Model.createQuickEditIssueModel(H),F=new JIRA.Forms.ConfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]}),E=new JIRA.Forms.UnconfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]});
return{globalEventNamespaces:["QuickEdit"],model:D,errorHandler:new JIRA.Forms.EditIssueError(),configurableForm:F,unconfigurableForm:E}
})
}
}();
jQuery(function(){JIRA.Forms.createEditIssueForm().asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Edit Issue")
},trigger:".issueaction-edit-issue",id:"edit-issue-dialog"});
jQuery(document).bind("dialogContentReady",function(){AJS.tabs.setup()
})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList66 = opt_data.tabs;
    var tabListLen66 = tabList66.length;
    for (var tabIndex66 = 0; tabIndex66 < tabListLen66; tabIndex66++) {
      var tabData66 = tabList66[tabIndex66];
      output.append((tabData66) ? '<li class="menu-item ' + ((tabData66.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData66.position) + '" ><strong>' + soy.$$escapeHtml(tabData66.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList80 = opt_data.tabs;
    var tabListLen80 = tabList80.length;
    for (var tabIndex80 = 0; tabIndex80 < tabListLen80; tabIndex80++) {
      var tabData80 = tabList80[tabIndex80];
      if (tabData80) {
        output.append('<div class="tabs-pane ', (tabData80.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData80.position), '">');
        var fieldList90 = tabData80.fields;
        var fieldListLen90 = fieldList90.length;
        for (var fieldIndex90 = 0; fieldIndex90 < fieldListLen90; fieldIndex90++) {
          var fieldData90 = fieldList90[fieldIndex90];
          output.append((fieldData90.editHtml) ? fieldData90.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList100 = opt_data.fields;
    var fieldListLen100 = fieldList100.length;
    for (var fieldIndex100 = 0; fieldIndex100 < fieldListLen100; fieldIndex100++) {
      var fieldData100 = fieldList100[fieldIndex100];
      output.append((fieldData100.editHtml) ? fieldData100.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList124 = opt_data.issueSetupFields;
    var fieldListLen124 = fieldList124.length;
    for (var fieldIndex124 = 0; fieldIndex124 < fieldListLen124; fieldIndex124++) {
      var fieldData124 = fieldList124[fieldIndex124];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData124.id), ' qf-required">', fieldData124.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList187 = opt_data.errors;
  var errorListLen187 = errorList187.length;
  for (var errorIndex187 = 0; errorIndex187 < errorListLen187; errorIndex187++) {
    var errorData187 = errorList187[errorIndex187];
    output.append('<li>', soy.$$escapeHtml(errorData187), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'templates/share-dialog.soy' */
// This file was automatically generated from share-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.Share == 'undefined') { JIRA.Templates.Dialogs.Share = {}; }


JIRA.Templates.Dialogs.Share.contentPopup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form share-content-popup ', (opt_data.shareData.issue) ? ' viewissue ' : (opt_data.shareData.filter) ? ' issuenav ' : '', '">');
  JIRA.Templates.Dialogs.Share.shareLink(opt_data, output);
  output.append('<fieldset class="padding">');
  if (opt_data.showForm) {
    JIRA.Templates.Dialogs.Share.shareForm(opt_data, output);
  } else {
    JIRA.Templates.Dialogs.Share.disabledMailMessage(null, output);
  }
  output.append('</fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="sharenames-multi-select">', soy.$$escapeHtml("User name or email"), '</label><div class="autocomplete-user-target"><select id="sharenames" name="sharenames" class="share-user-picker hidden" multiple="multiple"></select></div><ol class="recipients"></ol><div><label for="note">', soy.$$escapeHtml("Note"), '</label></div><textarea class="textarea long-field" id="note" placeholder="', soy.$$escapeHtml("Add an optional note"), '"/><div class="button-panel"><div class="status"><div class="icon"></div><div class="progress-messages"></div></div><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button submit" type="submit" value="', soy.$$escapeHtml("Share"), '" disabled/> <a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="close-dialog" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.disabledMailMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. Please contact your JIRA administrator to enable sharing.") + '</p>', extraClasses: 'disabled-mail-message'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.shareData.permlink) ? '<div class="issuenav-permalink padding"><label>' + ((opt_data.shareData.issue) ? soy.$$escapeHtml("Link to Issue") : (opt_data.shareData.filter) ? soy.$$escapeHtml("Link to Filter") : '') + '</label><input class="permalink text long-field" value="' + soy.$$escapeHtml(opt_data.shareData.permlink) + '" readonly></div>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-user-multi-select.js' */
(function($){function createShareUserPicker(ctx){$(".share-user-picker",ctx).each(function(){var control=new JIRA.MultiUserListPicker({layerId:$(this).attr("id")+"-layer",element:$(this),freeEmailInput:true});$(document).trigger("ready.multi-select.share-user",control)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createShareUserPicker(context)}})}(AJS.$));
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-dialog.js' */
(function($){var currentDialog;function _initShareDialog(dialogId,context){var shareDialog,$contents,currentShareLink;function hideDialog(reset){if(reset){$(document).one("hideLayer",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$(document).unbind(".share-dialog");$contents.empty();$contents=undefined;currentShareLink=undefined}})}shareDialog.hide();return false}function getUsernameValue(){return AJS.$(this).attr("data-username")}function getEmailValue(){return AJS.$(this).attr("data-email")}function sendShare(data,options){$("button,input,textarea",this).attr("disabled","disabled");var icon=$contents.find(".button-panel .icon");icon.addClass("throbber loading");var messages=$contents.find(".progress-messages");messages.text("Sending");var url=AJS.contextPath()+"/rest/share/1.0";if(options.issue){url+="/issue/"+options.issueKey}else{if(options.filter){if(options.filterId){url+="/filter/"+options.filterId}else{data.jql=options.jql;url+="/search"}}}JIRA.trace("jira.plugins.share.send",_.defaults({url:url},data));JIRA.SmartAjax.makeRequest({type:"POST",contentType:"application/json",dataType:"json",url:url,data:JSON.stringify(data),success:function(){icon.removeClass("throbber loading");icon.addClass("icon-tick");messages.text("Sent");setTimeout(function(){hideDialog(true)},1000)},error:function(){icon.removeClass("throbber loading");icon.addClass("icon-cross");messages.text("Error while sending")}})}function submit(shareData){var recipients=$contents.find(".recipients");var users=recipients.find("li[data-username]").map(getUsernameValue).toArray();var emails=recipients.find("li[data-email]").map(getEmailValue).toArray();if(!(users.length||emails.length)){return false}var message=$contents.find("#note").val();var data={usernames:users,emails:emails,message:message};sendShare(data,shareData);return false}function enableSubmit(enabled){$contents.find(".submit").prop("disabled",!enabled)}function enableAccessKeys(shareDialogForm){AJS.$(shareDialogForm).handleAccessKeys({selective:false})}function getShareData(trigger){var $trigger=jQuery(trigger),shareTarget,permlinkFull;if($trigger.hasClass("viewissue-share")){shareTarget="issue";permlinkFull=AJS.Meta.get("viewissue-permlink")}else{if($trigger.hasClass("issuenav-share")){shareTarget="filter";permlinkFull=AJS.Meta.get("issuenav-permlink")}}var shareData={issueKey:JIRA.Meta.getIssueKey(),filterId:AJS.Meta.get("filter-id"),jql:AJS.Meta.get("filter-jql"),permlink:permlinkFull};shareData[shareTarget]=true;return shareData}function generatePopup(contents,trigger,doShowPopup){var shareData=getShareData(trigger);if($contents&&currentShareLink===shareData.permlink){$contents=contents;doShowPopup();return }currentShareLink=shareData.permlink;$contents=contents;$contents.html(JIRA.Templates.Dialogs.Share.contentPopup({shareData:shareData,modifierKey:AJS.Navigator.modifierKey(),showForm:AJS.Meta.get("outgoing-mail-enabled")}));if(AJS.$.browser.msie){$contents.find("form").ieImitationPlaceholder()}enableSubmit(false);$contents.find("#sharenames").bind("change unselect",function(){var val=$(this).val();enableSubmit(val&&val.length)});$contents.find(".close-dialog").click(function(){hideDialog(true)});$contents.find("form").submit(function(){submit(shareData);return false});$contents.find(".issuenav-permalink .text").click(function(e){e.target.select();return false});$(document).bind("keyup.share-dialog",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){return hideDialog(false)}return true});$(document).bind("showLayer.share-dialog",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$contents.find("#sharenames-textarea").focus()}});enableAccessKeys(AJS.$("form",$contents));doShowPopup();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[$contents,JIRA.CONTENT_ADDED_REASON.shareDialogOpened])}AJS.toInit(function($){var allowDialogHide=true;JIRA.bind(AJS.InlineLayer.EVENTS.beforeShow,function(e,layer,id){if(id==="sharenames-layer"){allowDialogHide=false}});JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(e,layer,reason,id){if(id==="sharenames-layer"){setTimeout(function(){allowDialogHide=true},0)}});var offsetX=(dialogId.indexOf("issuenav")!==-1)?-110:-170;var dialogOptions={preHideCallback:function(){return allowDialogHide},hideCallback:function(){$(".dashboard-actions .explanation").hide()},offsetY:17,offsetX:offsetX,hideDelay:3600000,useLiveEvents:true,initCallback:function(){$(context).scrollIntoViewForAuto({complete:function(){var scrollers=$(this).add(window);_.delay(function(){scrollers.one("scroll",function(){AJS.$(document.activeElement).blur();hideDialog(false)})})}})}};shareDialog=AJS.InlineDialog($(context),dialogId,generatePopup,dialogOptions);shareDialog[0].popup._validateClickToClose=function(event){return shareDialog.has(event.target).length===0};$(context).live("click",function(){if(shareDialog.find(".contents:visible").length){shareDialog.find("a.close-dialog").click()}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE&&AJS.InlineDialog.current!==shareDialog&&shareDialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}shareDialog.hide()}})})}_initShareDialog("share-entity-popup-viewissue","#jira-share-trigger.viewissue-share");_initShareDialog("share-entity-popup-issuenav","#jira-share-trigger.issuenav-share")})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};
/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/Namespaces.js' */
if(typeof GH==="undefined"){window.GH={}}if(typeof GH.view=="undefined"){GH.view={}}if(typeof GH.view.model=="undefined"){GH.view.model={}}if(typeof GH.Global=="undefined"){GH.Global={}}if(typeof GH.Dialog=="undefined"){GH.Dialog={}}if(typeof GH.Dialogs=="undefined"){GH.Dialogs={}}if(typeof GH.State=="undefined"){GH.State={}}if(typeof GH.XBoard=="undefined"){GH.XBoard={}}if(typeof GH.RapidBoard=="undefined"){GH.RapidBoard={}}if(typeof GH.HelpPaths=="undefined"){GH.HelpPaths={}}if(typeof GH.JQLAutoComplete=="undefined"){GH.JQLAutoComplete={}}if(typeof GH.RapidBoard.Util=="undefined"){GH.RapidBoard.Util={}}if(typeof GH.NumberFormat=="undefined"){GH.NumberFormat={}}if(typeof GH.UrlFormat=="undefined"){GH.UrlFormat={}}AJS.format=function(i){var b=/'(?!')/g,h=/^\d+$/,e=/^(\d+),number$/,c=/^(\d+),choice,(.+)/,g=/^\s*(-?\d+)([#<])(.*)/;var f=function(s,q){var p="",n,j;if(n=s.match(h)){p=q.length>++s?q[s]:""}else{if(n=s.match(e)){j=GH.NumberFormat&&GH.NumberFormat.format||_.identity;p=q.length>++n[1]?j(q[n[1]]):""}else{if(n=s.match(c)){var t=(q.length>++n[1]?q[n[1]]:null);if(t!==null){var u=n[2].split("|");var o=null;for(var m=0;m<u.length;m++){var l=u[m].match(g);if(!l){console.log("Bad formatting of message: "+s);break}var r=parseInt(l[1],10);if(t<r){if(o){p=o;break}else{p=l[3];break}}if(t==r&&l[2]=="#"){p=l[3];break}else{}if(m==u.length-1){p=l[3]}o=l[3]}var k=[p].concat(Array.prototype.slice.call(q,1));p=AJS.format.apply(AJS,k)}}}}return p};var d=function(o){var m=false,j=-1,n=0;for(var l=0;l<o.length;l++){var p=o.charAt(l);if(p=="'"){m=!m}if(m){continue}if(p==="{"){if(n===0){j=l}n++}else{if(p==="}"){if(n>0){n--;if(n===0){var k=[];k.push(o.substring(0,l+1));k.push(o.substring(0,j));k.push(o.substring(j+1,l));return k}}}}}return null};var a=function(m){var k=arguments,l="",j=d(m);while(j){m=m.substring(j[0].length);l+=j[1].replace(b,"");l+=f(j[2],k);j=d(m)}l+=m.replace(b,"");return l};return a.apply(AJS,arguments)};
/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});AJS.$(".ghx-feedback").css({visibility:"hidden"});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}AJS.$(".ghx-feedback").css({visibility:""})};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});
/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/rapid/Ajax.js' */
GH.namespace("GH.Ajax");GH.Ajax={};GH.Ajax.CONTEXT_PATH=AJS.contextPath();GH.Ajax.REST_URL_BASE="/rest/greenhopper/1.0";GH.Ajax.xhrRegistery={};GH.Ajax.stallTimeout=300;GH.Ajax.get=function(a,c){AJS.$.extend(a,{type:"GET",headers:{"X-Atlassian-GreenHopper-Gadget":!_.isUndefined(GH.gadget)}});var b=GH.Ajax._executeGet(a,c);return b.pipe(function(d,f,e){return AJS.$.Deferred().resolveWith(this,[d.success,f,e])})};GH.Ajax.post=function(a){a=GH.Ajax._getSettings(a,true);AJS.$.extend(a,{type:"POST",contentType:"application/json"});return GH.Ajax._executeStore(a)};GH.Ajax.put=function(a){a=GH.Ajax._getSettings(a,true);a.type="PUT";return GH.Ajax._executeStore(a)};GH.Ajax.del=function(a){a=GH.Ajax._getSettings(a,true);a.type="DELETE";return GH.Ajax._executeStore(a)};GH.Ajax._getSettings=function(a,b){if(!a.bareUrl&&a.url){a.bareUrl=GH.Ajax.buildRestUrl(a.url)}if(a.bareUrl){a.url=a.bareUrl}if(!a.dataType){a.dataType="json"}if(a.data&&b){a.data=JSON.stringify(a.data)}a.contentType="application/json";return a};GH.Ajax._getXhrData=function(b){var a={timestamp:0};if(b){if(GH.Ajax.xhrRegistery[b]){a=GH.Ajax.xhrRegistery[b]}else{a=GH.Ajax.xhrRegistery[b]=a}}return a};GH.Ajax._executeGet=function(c,g){c=GH.Ajax._getSettings(c);var b=GH.Ajax._getXhrData(g);if(b.xhr){GH.log("aborting request for "+g,GH.Logger.Contexts.ajax);b.xhr.abort();delete b.xhr;delete b.xhrAbort;delete b.timeoutId}var f=b.timestamp;b.timestamp=new Date().getTime();if(b.timestamp-f<GH.Ajax.stallTimeout){GH.log("stalling request for "+g+", time since last request: "+(b.timestamp-f),GH.Logger.Contexts.ajax);var a=AJS.$.Deferred();var e;var d=function(){e=GH.Ajax._executeGet(c,g);e.then(a.resolve,a.reject)};b.timeoutId=window.setTimeout(d,GH.Ajax.stallTimeout);b.xhr=a.promise();b.xhr.abort=function(){if(e){e.abort.apply(e,arguments)}else{clearTimeout(b.timeoutId)}}}else{GH.log("executing request for "+g,GH.Logger.Contexts.ajax);b.xhr=GH.Ajax.makeRequest(c)}b.xhrAbort=b.xhr.abort;b.xhr.abort=function(){var i=b.xhr;var h=b.xhrAbort;if(i&&h){return h.apply(i,arguments)}};b.xhr.done(function(){if(b.xhr){delete b.xhr}}).fail(function(){if(b.xhr){delete b.xhr}});return b.xhr};GH.Ajax._executeStore=function(b){b=b||{};if(b.data&&typeof(b.data)==="string"){if(/\?\?/.test(b.data)){var a="\\u003F\\u003F";b.data=b.data.replace(/\?\?/g,a)}}b.dataType="json";return GH.Ajax.makeRequest(b)};GH.Ajax.makeRequest=function(d){var a=AJS.$.Deferred();d=_.extend(d,{success:function(){a.resolveWith(this,arguments)},error:function(){a.rejectWith(this,arguments)}});var c=a.promise(JIRA.SmartAjax.makeRequest(d));var e=c.abort;c.abort=function(f){c.abortMarker=f!="timeout";return e.apply(c,arguments)};var b=c.pipe(GH.Ajax._generateDoneInterceptor(),GH.Ajax._generateFailInterceptor(d.errorsNoAutoEscape));if(!d.deferErrorHandling){b.fail(GH.Ajax._generateErrorHandler(d.onGlobalError,d.errorContextMap,d.contextualErrorRenderer,d.globalErrorDismissable))}return b};GH.Ajax._generateDoneInterceptor=function(){return function(a,c,b){a=a||{};a=GH.Ajax._createExtendedResult(a);if(!GH.Ajax.matchesCurrentUser(b)){return GH.Ajax._handleCurrentUserChanged(b)}if(!a.isSuccess()){return AJS.$.Deferred().rejectWith(this,[a,b,c,null])}return AJS.$.Deferred().resolveWith(this,[a,c,b])}};GH.Ajax._generateFailInterceptor=function(a){return function(d,h,g){if(d.abortMarker){return AJS.$.Deferred()}if(!GH.Ajax.matchesCurrentUser(d)){return GH.Ajax._handleCurrentUserChanged(d)}var c={},b=null;if(d.responseText){try{c=JSON.parse(d.responseText)}catch(f){}}if(c.errors||c.errorMessages){b=GH.Ajax._convertJiraErrors(c,a)}else{if(c.message){b=GH.Ajax._convertFrameworkErrors(c)}}if(!b){b=GH.Ajax._convertGenericErrors(d,g)}return AJS.$.Deferred().rejectWith(this,[b,d,h,g])}};GH.Ajax.handleContextualErrors=function(b,a,c){a=a||{};if(!b.hasContextualErrors()){return false}AJS.$(b.getContextualErrors()).each(function(e,f){var d=a[f.contextId];if(!d){AJS.$(f.errors).each(function(h,i){b.addGlobalError(i)})}else{if(AJS.$.isFunction(d)){d(f,b)}else{d=AJS.$(d);d.siblings(".ghx-error").remove();var g;if(c){g=c(f)}else{g=GH.tpl.rapid.notification.renderContextualErrors({errors:f.errors})}d.after(g)}}});return true};GH.Ajax.handleGlobalErrors=function(c,b,a){if(!c.hasGlobalErrors()){return false}GH.Notification.showErrors({errors:c.getGlobalErrors()},a);if(b&&(b instanceof Function)){b(c)}return true};GH.Ajax.buildRestUrl=function(a){if(a.indexOf("/")!==0){a="/"+a}return GH.Ajax.buildBareRestUrl(GH.Ajax.REST_URL_BASE+a)};GH.Ajax.buildBareRestUrl=function(a){if(a.indexOf("/")!==0){a="/"+a}return GH.Ajax.CONTEXT_PATH+a};GH.Ajax._createExtendedResult=function(a){if(!a){return GH.Ajax._extendResult({success:true})}else{return GH.Ajax._extendResult({success:a})}};GH.Ajax._extendResult=function(a){return AJS.$.extend(a,{getGlobalErrors:function(){return a.error?a.error.errors:null},getContextualErrors:function(){return a.error?a.error.contextualErrors:null},hasGlobalErrors:function(){return a.error&&a.error.errors&&a.error.errors.length>0},hasContextualErrors:function(){return a.error&&a.error.contextualErrors},addGlobalError:function(b){if(!a.error){a.error={}}if(!a.error.errors){a.error.errors=[]}a.error.errors[a.error.errors.length]=b},getSuccessObject:function(){return a.success},isSuccess:function(){return !a.error}})};GH.Ajax._generateErrorHandler=function(d,b,c,a){return function(e){GH.Ajax.handleContextualErrors(e,b,c);GH.Ajax.handleGlobalErrors(e,d,a)}};GH.Ajax._convertJiraErrors=function(a,e){var c=a.errorMessages?a.errorMessages:[];c=_.map(c,function(f){return{message:f,noAutoescape:e}});var b=a.errors?a.errors:{};b=_.map(b,function(g,f){return{contextId:f,errors:[{message:g,noAutoescape:e}]}});var d={error:{errors:c,contextualErrors:b}};return GH.Ajax._extendResult(d)};GH.Ajax._convertFrameworkErrors=function(a){var b={error:{errors:[{message:a.message}],contextualErrors:[]}};return GH.Ajax._extendResult(b)};GH.Ajax._convertGenericErrors=function(b,c){var a=GH.Ajax._extendResult({});if(b.responseText){GH.log("Got an error response with text that we don't know how to parse: "+b.responseText)}if(b.status===0&&c==="abort"){a.addGlobalError({message:"Request timed out"})}else{if(c){a.addGlobalError({message:c})}else{GH.log("Got an Ajax request error response with empty 'errorThrown' value. Silently logging")}}return a};GH.Ajax._hasUsernameResponseHeader=function(a){return !!a.getResponseHeader("X-AUSERNAME")};GH.Ajax._getUserForResponse=function(a){return a.getResponseHeader("X-AUSERNAME")?decodeURIComponent(a.getResponseHeader("X-AUSERNAME")):"anonymous"};GH.Ajax.getUserFromAJS=function(){var a=AJS.Meta.get("remote-user");return a?a:"anonymous"};GH.Ajax.matchesCurrentUser=function(a){return !a.getResponseHeader||!a.getAllResponseHeaders||!GH.Ajax._hasUsernameResponseHeader(a)||GH.Ajax.getUserFromAJS()===GH.Ajax._getUserForResponse(a)||(a.status===204&&!a.getAllResponseHeaders()&&AJS.$.browser.msie)};GH.Ajax._handleCurrentUserChanged=function(c){var b=GH.Ajax.getUserFromAJS();var a=GH.Ajax._getUserForResponse(c);if(b!=="anonymous"&&a==="anonymous"){GH.log("User changed. original: "+b+" new: "+a+". Redirecting to the login page");location.href=GH.Navigation.getLoginUrl()}else{GH.log("User changed. original: "+b+" new: "+a+". Reloading the page");location.reload()}return AJS.$.Deferred()};
/* module-key = 'com.pyxis.greenhopper.jira:greenhopper-epics-issue-web-panel-resources', location = 'includes/js/viewissue/QuickCreateIssueInEpic.js' */
GH.QuickCreateIssueInEpic={};GH.QuickCreateIssueInEpic.epicKey=null;GH.QuickCreateIssueInEpic.epicName=null;AJS.$(function(){GH.QuickCreateIssueInEpic.init();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(c,a,b){if(b===JIRA.CONTENT_ADDED_REASON.pageLoad){GH.QuickCreateIssueInEpic.init()}});AJS.$(document).undelegate("#gh-create-issue-in-epic-lnk","click");AJS.$(document).delegate("#gh-create-issue-in-epic-lnk","click",function(b){var a=GH.QuickCreateIssueInEpic.createQuickCreateIssueForEpicDialog();a.show();b.preventDefault()})});GH.QuickCreateIssueInEpic.init=function(){var a=AJS.$("#ghx-epic-key").text();var d=AJS.$("#ghx-epic-name").text();var c=AJS.$("#ghx-hide-table").text()=="true";GH.QuickCreateIssueInEpic.epicKey=a;GH.QuickCreateIssueInEpic.epicName=d;JIRA.unbind("QuickCreateIssueInEpic.sessionComplete");JIRA.bind("QuickCreateIssueInEpic.sessionComplete",function(g,f){AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);GH.QuickCreateIssueInEpic.handleIssuesCreated(f)});if(c){var b=AJS.$("#ghx-issues-in-epic-table");b.addClass("hidden")}};GH.QuickCreateIssueInEpic.createQuickCreateIssueForEpicDialog=function(){var b=new JIRA.Forms.Container(function(){var d={title:AJS.format("Create issue in epic : {0}",GH.QuickCreateIssueInEpic.epicKey),id:"create-issue-in-epic-form",globalEventNamespaces:["QuickCreateIssueInEpic"]};var c=new JIRA.Forms.CreateIssueModel({projectId:d.pid,issueType:d.issueType}),f=new JIRA.Forms.ConfigurableCreateIssueForm({model:c,title:d.title,globalEventNamespaces:d.globalEventNamespaces}),e=new JIRA.Forms.UnconfigurableCreateIssueForm({model:c,title:d.title,globalEventNamespaces:d.globalEventNamespaces});return{globalEventNamespaces:d.globalEventNamespaces,model:c,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:f,unconfigurableForm:e}});b.bind("contentRefreshed",function(){AJS.$(document).unbind("QuickCreateIssueInEpic.validationError");AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);AJS.$(document).bind(JIRA.EpicPicker.READY_EVENT,function(d,c){c.setSelection(new AJS.ItemDescriptor({value:"key:"+GH.QuickCreateIssueInEpic.epicKey,label:GH.QuickCreateIssueInEpic.epicName}));setTimeout(function(){c.disable()},0);AJS.$(document).bind("QuickCreateIssueInEpic.validationError",function(f){c.disable()})})});var a=b.asDialog({windowTitle:AJS.format("Create issue in epic : {0}",GH.QuickCreateIssueInEpic.epicKey),id:"create-issue-dialog"});a.bind("Dialog.hide",function(){AJS.$(document).unbind(JIRA.EpicPicker.READY_EVENT);AJS.$(document).unbind("QuickCreateIssueInEpic.validationError")});return a};GH.QuickCreateIssueInEpic.handleIssuesCreated=function(b){var a=_.pluck(b,"issueKey");GH.QuickCreateIssueInEpic.addIssuesToEpic(b).done(function(){GH.QuickCreateIssueInEpic.refreshIssuesInEpicTable(a)})};GH.QuickCreateIssueInEpic.addIssuesToEpic=function(b){var a=_.pluck(b,"issueKey");var c={ignoreEpics:true,issueKeys:a};return GH.Ajax.put({url:"/epics/"+GH.QuickCreateIssueInEpic.epicKey+"/add",data:c})};GH.QuickCreateIssueInEpic.refreshIssuesInEpicTable=function(a){var b=AJS.$("#greenhopper-epics-issue-web-panel");b.addClass("updating");AJS.$.ajax({url:contextPath+"/secure/ViewIssuesInEpic.jspa?epicKey="+GH.QuickCreateIssueInEpic.epicKey+"&decorator=none"}).done(function(d){b.find(".mod-content").html(d);JIRA.Dropdowns.bindIssueActionsDds(b);AJS.$.each(a,function(g,f){b.find(".issuerow[data-issuekey='"+f+"']").fadeInBackground()});var c=AJS.$("#ghx-issues-in-epic-table");var e=AJS.$("#ghx-hide-table").text()=="true";if(e){c.addClass("hidden")}else{AJS.$("#ghx-issues-in-epic-empty-message").remove();c.removeClass("hidden")}b.removeClass("updating")})};
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/backbone/backbone.js' */
(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="1.0.0";var _=root._;if(!_&&(typeof require!=="undefined")){_=require("underscore")}Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback){return this}this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback){return this}var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context])){return this}if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if((callback&&callback!==ev.callback&&callback!==ev.callback._callback)||(context&&context!==ev.context)){retain.push(ev)}}}if(!retain.length){delete this._events[name]}}}return this},trigger:function(name){if(!this._events){return this}var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args)){return this}var events=this._events[name];var allEvents=this._events.all;if(events){triggerEvents(events,args)}if(allEvents){triggerEvents(allEvents,arguments)}return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners){return this}var deleteListener=!name&&!callback;if(typeof name==="object"){callback=this}if(obj){(listeners={})[obj._listenerId]=obj}for(var id in listeners){listeners[id].off(name,callback,this);if(deleteListener){delete this._listeners[id]}}return this}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name){return true}if(typeof name==="object"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}return false}if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}return false}return true};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l){(ev=events[i]).callback.call(ev.ctx)}return ;case 1:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1)}return ;case 2:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1,a2)}return ;case 3:while(++i<l){(ev=events[i]).callback.call(ev.ctx,a1,a2,a3)}return ;default:while(++i<l){(ev=events[i]).callback.apply(ev.ctx,args)}}};var listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId("l"));listeners[id]=obj;if(typeof name==="object"){callback=this}obj[implementation](name,callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};options||(options={});this.cid=_.uniqueId("c");this.attributes={};_.extend(this,_.pick(options,modelOptions));if(options.parse){attrs=this.parse(attrs,options)||{}}if(defaults=_.result(this,"defaults")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};var modelOptions=["url","urlRoot","collection"];_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null){return this}if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options)){return false}unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs){this.id=attrs[this.idAttribute]}for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val)){changes.push(attr)}if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length){this._pending=true}for(var i=0,l=changes.length;i<l;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing){return this}if(!silent){while(this._pending){this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes){attrs[key]=void 0}return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null){return !_.isEmpty(this.changed)}return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff){return this.hasChanged()?_.clone(this.changed):false}var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],(val=diff[attr]))){continue}(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes){return null}return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0){options.parse=true}var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options)){return false}if(success){success(model,resp,options)}model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options)){return false}options=_.extend({validate:true},options);if(!this._validate(attrs,options)){return false}if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0){options.parse=true}var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait){serverAttrs=_.extend(attrs||{},serverAttrs)}if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success){success(model,resp,options)}model.trigger("sync",model,resp,options)};wrapError(this,options);method=this.isNew()?"create":(options.patch?"patch":"update");if(method==="patch"){options.attrs=attrs}xhr=this.sync(method,this,options);if(attrs&&options.wait){this.attributes=attributes}return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(options.wait||model.isNew()){destroy()}if(success){success(model,resp,options)}if(!model.isNew()){model.trigger("sync",model,resp,options)}};if(this.isNew()){options.success();return false}wrapError(this,options);var xhr=this.sync("delete",this,options);if(!options.wait){destroy()}return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew()){return base}return base+(base.charAt(base.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate){return true}attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error){return true}this.trigger("invalid",this,error,_.extend(options||{},{validationError:error}));return false}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url){this.url=options.url}if(options.model){this.model=options.model}if(options.comparator!==void 0){this.comparator=options.comparator}this._reset();this.initialize.apply(this,arguments);if(models){this.reset(models,_.extend({silent:true},options))}};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,merge:false,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.defaults(options||{},addOptions))},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model){continue}delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}this._removeReference(model)}return this},set:function(models,options){options=_.defaults(options||{},setOptions);if(options.parse){models=this.parse(models,options)}if(!_.isArray(models)){models=models?[models]:[]}var i,l,model,attrs,existing,sort;var at=options.at;var sortable=this.comparator&&(at==null)&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(models[i],options))){continue}if(existing=this.get(model)){if(options.remove){modelMap[existing.cid]=true}if(options.merge){existing.set(model.attributes,options);if(sortable&&!sort&&existing.hasChanged(sortAttr)){sort=true}}}else{if(options.add){toAdd.push(model);model.on("all",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null){this._byId[model.id]=model}}}}if(options.remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid]){toRemove.push(model)}}if(toRemove.length){this.remove(toRemove,options)}}if(toAdd.length){if(sortable){sort=true}this.length+=toAdd.length;if(at!=null){splice.apply(this.models,[at,0].concat(toAdd))}else{push.apply(this.models,toAdd)}}if(sort){this.sort({silent:true})}if(options.silent){return this}for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger("add",model,this,options)}if(sort){this.trigger("sort",this,options)}return this},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();this.add(models,_.extend({silent:true},options));if(!options.silent){this.trigger("reset",this,options)}return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null){return void 0}return this._byId[obj.id!=null?obj.id:obj.cid||obj]},at:function(index){return this.models[index]},where:function(attrs,first){if(_.isEmpty(attrs)){return first?void 0:[]}return this[first?"find":"filter"](function(model){for(var key in attrs){if(attrs[key]!==model.get(key)){return false}}return true})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent){this.trigger("sort",this,options)}return this},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0){options.parse=true}var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success){success(collection,resp,options)}collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options))){return false}if(!options.wait){this.add(model,options)}var collection=this;var success=options.success;options.success=function(resp){if(options.wait){collection.add(model,options)}if(success){success(model,resp,options)}};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection){attrs.collection=this}return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options)){this.trigger("invalid",this,attrs,options);return false}return model},_removeReference:function(model){if(this===model.collection){delete model.collection}model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this){return }if(event==="destroy"){this.remove(model,options)}if(model&&event==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null){this._byId[model.id]=model}}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el){this.undelegateEvents()}this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false){this.delegateEvents()}return this},delegateEvents:function(events){if(!(events||(events=_.result(this,"events")))){return this}this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method)){method=this[events[key]]}if(!method){continue}var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(options){if(this.options){options=_.extend({},_.result(this,"options"),options)}_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id){attrs.id=_.result(this,"id")}if(this.className){attrs["class"]=_.result(this,"className")}var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,"el"),false)}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON){params.data._method=type}var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend){return beforeSend.apply(this,arguments)}}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}if(params.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes){this.routes=options.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route)){route=this._routeToRegExp(route)}if(_.isFunction(name)){callback=name;name=""}if(!callback){callback=this[name]}var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)});return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes){return }this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");if(!fragment.indexOf(root)){fragment=fragment.substr(root.length)}}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started){throw new Error("Backbone.history has already been started")}History.started=true;this.options=_.extend({},{root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=(isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7));this.root=("/"+this.root+"/").replace(rootStripper,"/");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!oldIE){Backbone.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,"");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment){return false}if(this.iframe){this.navigate(current)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started){return false}if(!options||options===true){options={trigger:options}}fragment=this.getFragment(fragment||"");if(this.fragment===fragment){return }this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else{if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&(fragment!==this.getFragment(this.getHash(this.iframe)))){if(!options.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}}if(options.trigger){this.loadUrl(fragment)}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps){_.extend(child.prototype,protoProps)}child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error){error(model,resp,options)}model.trigger("error",model,resp,options)}}}).call(this);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/marionettejs/backbone.marionette-1.0.3.js' */
/*
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(Backbone,_){var Container=function(initialViews){this._views={};this._indexByModel={};this._indexByCollection={};this._indexByCustom={};this._updateLength();this._addInitialViews(initialViews)};_.extend(Container.prototype,{add:function(view,customIndex){var viewCid=view.cid;this._views[viewCid]=view;if(view.model){this._indexByModel[view.model.cid]=viewCid}if(view.collection){this._indexByCollection[view.collection.cid]=viewCid}if(customIndex){this._indexByCustom[customIndex]=viewCid}this._updateLength()},findByModel:function(model){var viewCid=this._indexByModel[model.cid];return this.findByCid(viewCid)},findByCollection:function(col){var viewCid=this._indexByCollection[col.cid];return this.findByCid(viewCid)},findByCustom:function(index){var viewCid=this._indexByCustom[index];return this.findByCid(viewCid)},findByIndex:function(index){return _.values(this._views)[index]},findByCid:function(cid){return this._views[cid]},remove:function(view){var viewCid=view.cid;if(view.model){delete this._indexByModel[view.model.cid]}if(view.collection){delete this._indexByCollection[view.collection.cid]}var cust;for(var key in this._indexByCustom){if(this._indexByCustom.hasOwnProperty(key)){if(this._indexByCustom[key]===viewCid){cust=key;break}}}if(cust){delete this._indexByCustom[cust]}delete this._views[viewCid];this._updateLength()},call:function(method,args){args=Array.prototype.slice.call(arguments,1);this.apply(method,args)},apply:function(method,args){var view;args=args||[];_.each(this._views,function(view,key){if(_.isFunction(view[method])){view[method].apply(view,args)}})},_updateLength:function(){this.length=_.size(this._views)},_addInitialViews:function(views){if(!views){return }var view,i,length=views.length;for(i=0;i<length;i++){view=views[i];this.add(view)}}});var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];_.each(methods,function(method){Container.prototype[method]=function(){var views=_.values(this._views);var args=[views].concat(_.toArray(arguments));return _[method].apply(_,args)}});return Container})(Backbone,_);Backbone.Wreqr=(function(Backbone,Marionette,_){var Wreqr={};Wreqr.Handlers=(function(Backbone,_){var Handlers=function(options){this.options=options;this._wreqrHandlers={};if(_.isFunction(this.initialize)){this.initialize(options)}};Handlers.extend=Backbone.Model.extend;_.extend(Handlers.prototype,Backbone.Events,{setHandlers:function(handlers){_.each(handlers,function(handler,name){var context=null;if(_.isObject(handler)&&!_.isFunction(handler)){context=handler.context;handler=handler.callback}this.setHandler(name,handler,context)},this)},setHandler:function(name,handler,context){var config={callback:handler,context:context};this._wreqrHandlers[name]=config;this.trigger("handler:add",name,handler,context)},hasHandler:function(name){return !!this._wreqrHandlers[name]},getHandler:function(name){var config=this._wreqrHandlers[name];if(!config){throw new Error("Handler not found for '"+name+"'")}return function(){var args=Array.prototype.slice.apply(arguments);return config.callback.apply(config.context,args)}},removeHandler:function(name){delete this._wreqrHandlers[name]},removeAllHandlers:function(){this._wreqrHandlers={}}});return Handlers})(Backbone,_);Wreqr.CommandStorage=(function(){var CommandStorage=function(options){this.options=options;this._commands={};if(_.isFunction(this.initialize)){this.initialize(options)}};_.extend(CommandStorage.prototype,Backbone.Events,{getCommands:function(commandName){var commands=this._commands[commandName];if(!commands){commands={command:commandName,instances:[]};this._commands[commandName]=commands}return commands},addCommand:function(commandName,args){var command=this.getCommands(commandName);command.instances.push(args)},clearCommands:function(commandName){var command=this.getCommands(commandName);command.instances=[]}});return CommandStorage})();Wreqr.Commands=(function(Wreqr){return Wreqr.Handlers.extend({storageType:Wreqr.CommandStorage,constructor:function(options){this.options=options||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var args=Array.prototype.slice.call(arguments);Wreqr.Handlers.prototype.constructor.apply(this,args)},execute:function(name,args){name=arguments[0];args=Array.prototype.slice.call(arguments,1);if(this.hasHandler(name)){this.getHandler(name).apply(this,args)}else{this.storage.addCommand(name,args)}},_executeCommands:function(name,handler,context){var command=this.storage.getCommands(name);_.each(command.instances,function(args){handler.apply(context,args)});this.storage.clearCommands(name)},_initializeStorage:function(options){var storage;var StorageType=options.storageType||this.storageType;if(_.isFunction(StorageType)){storage=new StorageType()}else{storage=StorageType}this.storage=storage}})})(Wreqr);Wreqr.RequestResponse=(function(Wreqr){return Wreqr.Handlers.extend({request:function(){var name=arguments[0];var args=Array.prototype.slice.call(arguments,1);return this.getHandler(name).apply(this,args)}})})(Wreqr);Wreqr.EventAggregator=(function(Backbone,_){var EA=function(){};EA.extend=Backbone.Model.extend;_.extend(EA.prototype,Backbone.Events);return EA})(Backbone,_);return Wreqr})(Backbone,Backbone.Marionette,_);var Marionette=(function(global,Backbone,_){var Marionette={};Backbone.Marionette=Marionette;Marionette.$=Backbone.$;var protoSlice=Array.prototype.slice;function slice(args){return protoSlice.call(args)}function throwError(message,name){var error=new Error(message);error.name=name||"Error";throw error}Marionette.extend=Backbone.Model.extend;Marionette.getOption=function(target,optionName){if(!target||!optionName){return }var value;if(target.options&&(optionName in target.options)&&(target.options[optionName]!==undefined)){value=target.options[optionName]}else{value=target[optionName]}return value};Marionette.triggerMethod=(function(){var splitter=/(^|:)(\w)/gi;function getEventName(match,prefix,eventName){return eventName.toUpperCase()}var triggerMethod=function(event){var methodName="on"+event.replace(splitter,getEventName);var method=this[methodName];this.trigger.apply(this,arguments);if(_.isFunction(method)){return method.apply(this,_.tail(arguments))}};return triggerMethod})();Marionette.MonitorDOMRefresh=(function(){function handleShow(view){view._isShown=true;triggerDOMRefresh(view)}function handleRender(view){view._isRendered=true;triggerDOMRefresh(view)}function triggerDOMRefresh(view){if(view._isShown&&view._isRendered){if(_.isFunction(view.triggerMethod)){view.triggerMethod("dom:refresh")}}}return function(view){view.listenTo(view,"show",function(){handleShow(view)});view.listenTo(view,"render",function(){handleRender(view)})}})();(function(Marionette){function bindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];if(!method){throwError("Method '"+methodName+"' was configured as an event handler, but does not exist.")}target.listenTo(entity,evt,method,target)})}function bindToFunction(target,entity,evt,method){target.listenTo(entity,evt,method,target)}function unbindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];target.stopListening(entity,evt,method,target)})}function unbindToFunction(target,entity,evt,method){target.stopListening(entity,evt,method,target)}function iterateEvents(target,entity,bindings,functionCallback,stringCallback){if(!entity||!bindings){return }if(_.isFunction(bindings)){bindings=bindings.call(target)}_.each(bindings,function(methods,evt){if(_.isFunction(methods)){functionCallback(target,entity,evt,methods)}else{stringCallback(target,entity,evt,methods)}})}Marionette.bindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,bindToFunction,bindFromStrings)};Marionette.unbindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,unbindToFunction,unbindFromStrings)}})(Marionette);Marionette.Callbacks=function(){this._deferred=Marionette.$.Deferred();this._callbacks=[]};_.extend(Marionette.Callbacks.prototype,{add:function(callback,contextOverride){this._callbacks.push({cb:callback,ctx:contextOverride});this._deferred.done(function(context,options){if(contextOverride){context=contextOverride}callback.call(context,options)})},run:function(options,context){this._deferred.resolve(context,options)},reset:function(){var callbacks=this._callbacks;this._deferred=Marionette.$.Deferred();this._callbacks=[];_.each(callbacks,function(cb){this.add(cb.cb,cb.ctx)},this)}});Marionette.Controller=function(options){this.triggerMethod=Marionette.triggerMethod;this.options=options||{};if(_.isFunction(this.initialize)){this.initialize(this.options)}};Marionette.Controller.extend=Marionette.extend;_.extend(Marionette.Controller.prototype,Backbone.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});Marionette.Region=function(options){this.options=options||{};this.el=Marionette.getOption(this,"el");if(!this.el){var err=new Error("An 'el' must be specified for a region.");err.name="NoElError";throw err}if(this.initialize){var args=Array.prototype.slice.apply(arguments);this.initialize.apply(this,args)}};_.extend(Marionette.Region,{buildRegion:function(regionConfig,defaultRegionType){var regionIsString=(typeof regionConfig==="string");var regionSelectorIsString=(typeof regionConfig.selector==="string");var regionTypeIsUndefined=(typeof regionConfig.regionType==="undefined");var regionIsType=(typeof regionConfig==="function");if(!regionIsType&&!regionIsString&&!regionSelectorIsString){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var selector,RegionType;if(regionIsString){selector=regionConfig}if(regionConfig.selector){selector=regionConfig.selector}if(regionIsType){RegionType=regionConfig}if(!regionIsType&&regionTypeIsUndefined){RegionType=defaultRegionType}if(regionConfig.regionType){RegionType=regionConfig.regionType}var region=new RegionType({el:selector});if(regionConfig.parentEl){region.getEl=function(selector){var parentEl=regionConfig.parentEl;if(_.isFunction(parentEl)){parentEl=parentEl()}return parentEl.find(selector)}}return region}});_.extend(Marionette.Region.prototype,Backbone.Events,{show:function(view){this.ensureEl();var isViewClosed=view.isClosed||_.isUndefined(view.$el);var isDifferentView=view!==this.currentView;if(isDifferentView){this.close()}view.render();if(isDifferentView||isViewClosed){this.open(view)}this.currentView=view;Marionette.triggerMethod.call(this,"show",view);Marionette.triggerMethod.call(view,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(selector){return Marionette.$(selector)},open:function(view){this.$el.empty().append(view.el)},close:function(){var view=this.currentView;if(!view||view.isClosed){return }if(view.close){view.close()}else{if(view.remove){view.remove()}}Marionette.triggerMethod.call(this,"close");delete this.currentView},attachView:function(view){this.currentView=view},reset:function(){this.close();delete this.$el}});Marionette.Region.extend=Marionette.extend;Marionette.RegionManager=(function(Marionette){var RegionManager=Marionette.Controller.extend({constructor:function(options){this._regions={};Marionette.Controller.prototype.constructor.call(this,options)},addRegions:function(regionDefinitions,defaults){var regions={};_.each(regionDefinitions,function(definition,name){if(typeof definition==="string"){definition={selector:definition}}if(definition.selector){definition=_.defaults({},definition,defaults)}var region=this.addRegion(name,definition);regions[name]=region},this);return regions},addRegion:function(name,definition){var region;var isObject=_.isObject(definition);var isString=_.isString(definition);var hasSelector=!!definition.selector;if(isString||(isObject&&hasSelector)){region=Marionette.Region.buildRegion(definition,Marionette.Region)}else{if(_.isFunction(definition)){region=Marionette.Region.buildRegion(definition,Marionette.Region)}else{region=definition}}this._store(name,region);this.triggerMethod("region:add",name,region);return region},get:function(name){return this._regions[name]},removeRegion:function(name){var region=this._regions[name];this._remove(name,region)},removeRegions:function(){_.each(this._regions,function(region,name){this._remove(name,region)},this)},closeRegions:function(){_.each(this._regions,function(region,name){region.close()},this)},close:function(){this.removeRegions();var args=Array.prototype.slice.call(arguments);Marionette.Controller.prototype.close.apply(this,args)},_store:function(name,region){this._regions[name]=region;this._setLength()},_remove:function(name,region){region.close();delete this._regions[name];this._setLength();this.triggerMethod("region:remove",name,region)},_setLength:function(){this.length=_.size(this._regions)}});var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];_.each(methods,function(method){RegionManager.prototype[method]=function(){var regions=_.values(this._regions);var args=[regions].concat(_.toArray(arguments));return _[method].apply(_,args)}});return RegionManager})(Marionette);Marionette.TemplateCache=function(templateId){this.templateId=templateId};_.extend(Marionette.TemplateCache,{templateCaches:{},get:function(templateId){var cachedTemplate=this.templateCaches[templateId];if(!cachedTemplate){cachedTemplate=new Marionette.TemplateCache(templateId);this.templateCaches[templateId]=cachedTemplate}return cachedTemplate.load()},clear:function(){var i;var args=slice(arguments);var length=args.length;if(length>0){for(i=0;i<length;i++){delete this.templateCaches[args[i]]}}else{this.templateCaches={}}}});_.extend(Marionette.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var template=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(template);return this.compiledTemplate},loadTemplate:function(templateId){var template=Marionette.$(templateId).html();if(!template||template.length===0){throwError("Could not find template: '"+templateId+"'","NoTemplateError")}return template},compileTemplate:function(rawTemplate){return _.template(rawTemplate)}});Marionette.Renderer={render:function(template,data){if(!template){var error=new Error("Cannot render the template since it's false, null or undefined.");error.name="TemplateNotFoundError";throw error}var templateFunc;if(typeof template==="function"){templateFunc=template}else{templateFunc=Marionette.TemplateCache.get(template)}return templateFunc(data)}};Marionette.View=Backbone.View.extend({constructor:function(){_.bindAll(this,"render");var args=Array.prototype.slice.apply(arguments);Backbone.View.prototype.constructor.apply(this,args);Marionette.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:Marionette.triggerMethod,getTemplate:function(){return Marionette.getOption(this,"template")},mixinTemplateHelpers:function(target){target=target||{};var templateHelpers=this.templateHelpers;if(_.isFunction(templateHelpers)){templateHelpers=templateHelpers.call(this)}return _.extend(target,templateHelpers)},configureTriggers:function(){if(!this.triggers){return }var triggerEvents={};var triggers=_.result(this,"triggers");_.each(triggers,function(value,key){triggerEvents[key]=function(e){if(e&&e.preventDefault){e.preventDefault()}if(e&&e.stopPropagation){e.stopPropagation()}var args={view:this,model:this.model,collection:this.collection};this.triggerMethod(value,args)}},this);return triggerEvents},delegateEvents:function(events){this._delegateDOMEvents(events);Marionette.bindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.bindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(events){events=events||this.events;if(_.isFunction(events)){events=events.call(this)}var combinedEvents={};var triggers=this.configureTriggers();_.extend(combinedEvents,events,triggers);Backbone.View.prototype.delegateEvents.call(this,combinedEvents)},undelegateEvents:function(){var args=Array.prototype.slice.call(arguments);Backbone.View.prototype.undelegateEvents.apply(this,args);Marionette.unbindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents"));Marionette.unbindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return }var shouldClose=this.triggerMethod("before:close");if(shouldClose===false){return }this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return }if(!this._uiBindings){this._uiBindings=this.ui}var bindings=_.result(this,"_uiBindings");this.ui={};_.each(_.keys(bindings),function(key){var selector=bindings[key];this.ui[key]=this.$(selector)},this)},unbindUIElements:function(){if(!this.ui){return }_.each(this.ui,function($el,name){delete this.ui[name]},this);this.ui=this._uiBindings;delete this._uiBindings}});Marionette.ItemView=Marionette.View.extend({serializeData:function(){var data={};if(this.model){data=this.model.toJSON()}else{if(this.collection){data={items:this.collection.toJSON()}}}return data},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();var html=Marionette.Renderer.render(template,data);this.$el.html(html);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return }this.triggerMethod("item:before:close");Marionette.View.prototype.close.apply(this,slice(arguments));this.triggerMethod("item:closed")}});Marionette.CollectionView=Marionette.View.extend({itemViewEventPrefix:"itemview",constructor:function(options){this._initChildViewStorage();Marionette.View.prototype.constructor.apply(this,slice(arguments));this._initialEvents()},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(item,collection,options){this.closeEmptyView();var ItemView=this.getItemView(item);var index=this.collection.indexOf(item);this.addItemView(item,ItemView,index)},onShowCalled:function(){this.children.each(function(child){Marionette.triggerMethod.call(child,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}},showCollection:function(){var ItemView;this.collection.each(function(item,index){ItemView=this.getItemView(item);this.addItemView(item,ItemView,index)},this)},showEmptyView:function(){var EmptyView=Marionette.getOption(this,"emptyView");if(EmptyView&&!this._showingEmptyView){this._showingEmptyView=true;var model=new Backbone.Model();this.addItemView(model,EmptyView,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView");if(!itemView){throwError("An `itemView` must be specified","NoItemViewError")}return itemView},addItemView:function(item,ItemView,index){var itemViewOptions=Marionette.getOption(this,"itemViewOptions");if(_.isFunction(itemViewOptions)){itemViewOptions=itemViewOptions.call(this,item,index)}var view=this.buildItemView(item,ItemView,itemViewOptions);this.addChildViewEventForwarding(view);this.triggerMethod("before:item:added",view);this.children.add(view);this.renderItemView(view,index);if(this._isShown){Marionette.triggerMethod.call(view,"show")}this.triggerMethod("after:item:added",view)},addChildViewEventForwarding:function(view){var prefix=Marionette.getOption(this,"itemViewEventPrefix");this.listenTo(view,"all",function(){var args=slice(arguments);args[0]=prefix+":"+args[0];args.splice(1,0,view);Marionette.triggerMethod.apply(this,args)},this)},renderItemView:function(view,index){view.render();this.appendHtml(this,view,index)},buildItemView:function(item,ItemViewType,itemViewOptions){var options=_.extend({model:item},itemViewOptions);return new ItemViewType(options)},removeItemView:function(item){var view=this.children.findByModel(item);this.removeChildView(view);this.checkEmpty()},removeChildView:function(view){if(view){this.stopListening(view);if(view.close){view.close()}else{if(view.remove){view.remove()}}this.children.remove(view)}this.triggerMethod("item:removed",view)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendHtml:function(collectionView,itemView,index){collectionView.$el.append(itemView.el)},_initChildViewStorage:function(){this.children=new Backbone.ChildViewContainer()},close:function(){if(this.isClosed){return }this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");Marionette.View.prototype.close.apply(this,slice(arguments))},closeChildren:function(){this.children.each(function(child){this.removeChildView(child)},this);this.checkEmpty()}});Marionette.CompositeView=Marionette.CollectionView.extend({_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}},getItemView:function(item){var itemView=Marionette.getOption(this,"itemView")||this.constructor;if(!itemView){throwError("An `itemView` must be specified","NoItemViewError")}return itemView},serializeData:function(){var data={};if(this.model){data=this.model.toJSON()}return data},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var html=this.renderModel();this.$el.html(html);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){Marionette.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var data={};data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate();return Marionette.Renderer.render(template,data)},appendHtml:function(cv,iv,index){var $container=this.getItemViewContainer(cv);$container.append(iv.el)},getItemViewContainer:function(containerView){if("$itemViewContainer" in containerView){return containerView.$itemViewContainer}var container;if(containerView.itemViewContainer){var selector=_.result(containerView,"itemViewContainer");container=containerView.$(selector);if(container.length<=0){throwError("The specified `itemViewContainer` was not found: "+containerView.itemViewContainer,"ItemViewContainerMissingError")}}else{container=containerView.$el}containerView.$itemViewContainer=container;return container},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});Marionette.Layout=Marionette.ItemView.extend({regionType:Marionette.Region,constructor:function(options){options=options||{};this._firstRender=true;this._initializeRegions(options);Marionette.ItemView.call(this,options)},render:function(){if(this._firstRender){this._firstRender=false}else{if(this.isClosed){this._initializeRegions()}else{this._reInitializeRegions()}}var args=Array.prototype.slice.apply(arguments);var result=Marionette.ItemView.prototype.render.apply(this,args);return result},close:function(){if(this.isClosed){return }this.regionManager.close();var args=Array.prototype.slice.apply(arguments);Marionette.ItemView.prototype.close.apply(this,args)},addRegion:function(name,definition){var regions={};regions[name]=definition;return this.addRegions(regions)[name]},addRegions:function(regions){this.regions=_.extend(this.regions||{},regions);return this._buildRegions(regions)},removeRegion:function(name){return this.regionManager.removeRegion(name)},_buildRegions:function(regions){var that=this;var defaults={parentEl:function(){return that.$el}};return this.regionManager.addRegions(regions,defaults)},_initializeRegions:function(options){var regions;this._initRegionManager();if(_.isFunction(this.regions)){regions=this.regions(options)}else{regions=this.regions||{}}this.addRegions(regions)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(region){region.reset()})},_initRegionManager:function(){this.regionManager=new Marionette.RegionManager();this.listenTo(this.regionManager,"region:add",function(name,region){this[name]=region;this.trigger("region:add",name,region)});this.listenTo(this.regionManager,"region:remove",function(name,region){delete this[name];this.trigger("region:remove",name,region)})}});Marionette.AppRouter=Backbone.Router.extend({constructor:function(options){Backbone.Router.prototype.constructor.apply(this,slice(arguments));this.options=options;if(this.appRoutes){var controller=Marionette.getOption(this,"controller");this.processAppRoutes(controller,this.appRoutes)}},processAppRoutes:function(controller,appRoutes){var routeNames=_.keys(appRoutes).reverse();_.each(routeNames,function(route){var methodName=appRoutes[route];var method=controller[methodName];if(!method){throw new Error("Method '"+methodName+"' was not found on the controller")}this.route(route,methodName,_.bind(method,controller))},this)}});Marionette.Application=function(options){this._initRegionManager();this._initCallbacks=new Marionette.Callbacks();this.vent=new Backbone.Wreqr.EventAggregator();this.commands=new Backbone.Wreqr.Commands();this.reqres=new Backbone.Wreqr.RequestResponse();this.submodules={};_.extend(this,options);this.triggerMethod=Marionette.triggerMethod};_.extend(Marionette.Application.prototype,Backbone.Events,{execute:function(){var args=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,args)},request:function(){var args=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,args)},addInitializer:function(initializer){this._initCallbacks.add(initializer)},start:function(options){this.triggerMethod("initialize:before",options);this._initCallbacks.run(options,this);this.triggerMethod("initialize:after",options);this.triggerMethod("start",options)},addRegions:function(regions){return this._regionManager.addRegions(regions)},removeRegion:function(region){this._regionManager.removeRegion(region)},module:function(moduleNames,moduleDefinition){var args=slice(arguments);args.unshift(this);return Marionette.Module.create.apply(Marionette.Module,args)},_initRegionManager:function(){this._regionManager=new Marionette.RegionManager();this.listenTo(this._regionManager,"region:add",function(name,region){this[name]=region});this.listenTo(this._regionManager,"region:remove",function(name,region){delete this[name]})}});Marionette.Application.extend=Marionette.extend;Marionette.Module=function(moduleName,app){this.moduleName=moduleName;this.submodules={};this._setupInitializersAndFinalizers();this.app=app;this.startWithParent=true;this.triggerMethod=Marionette.triggerMethod};_.extend(Marionette.Module.prototype,Backbone.Events,{addInitializer:function(callback){this._initializerCallbacks.add(callback)},addFinalizer:function(callback){this._finalizerCallbacks.add(callback)},start:function(options){if(this._isInitialized){return }_.each(this.submodules,function(mod){if(mod.startWithParent){mod.start(options)}});this.triggerMethod("before:start",options);this._initializerCallbacks.run(options,this);this._isInitialized=true;this.triggerMethod("start",options)},stop:function(){if(!this._isInitialized){return }this._isInitialized=false;Marionette.triggerMethod.call(this,"before:stop");_.each(this.submodules,function(mod){mod.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();Marionette.triggerMethod.call(this,"stop")},addDefinition:function(moduleDefinition,customArgs){this._runModuleDefinition(moduleDefinition,customArgs)},_runModuleDefinition:function(definition,customArgs){if(!definition){return }var args=_.flatten([this,this.app,Backbone,Marionette,Marionette.$,_,customArgs]);definition.apply(this,args)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new Marionette.Callbacks();this._finalizerCallbacks=new Marionette.Callbacks()}});_.extend(Marionette.Module,{create:function(app,moduleNames,moduleDefinition){var module=app;var customArgs=slice(arguments);customArgs.splice(0,3);moduleNames=moduleNames.split(".");var length=moduleNames.length;var moduleDefinitions=[];moduleDefinitions[length-1]=moduleDefinition;_.each(moduleNames,function(moduleName,i){var parentModule=module;module=this._getModule(parentModule,moduleName,app);this._addModuleDefinition(parentModule,module,moduleDefinitions[i],customArgs)},this);return module},_getModule:function(parentModule,moduleName,app,def,args){var module=parentModule[moduleName];if(!module){module=new Marionette.Module(moduleName,app);parentModule[moduleName]=module;parentModule.submodules[moduleName]=module}return module},_addModuleDefinition:function(parentModule,module,def,args){var fn;var startWithParent;if(_.isFunction(def)){fn=def;startWithParent=true}else{if(_.isObject(def)){fn=def.define;startWithParent=def.startWithParent}else{startWithParent=true}}if(fn){module.addDefinition(fn,args)}module.startWithParent=module.startWithParent&&startWithParent;if(module.startWithParent&&!module.startWithParentIsConfigured){module.startWithParentIsConfigured=true;parentModule.addInitializer(function(options){if(module.startWithParent){module.start(options)}})}}});return Marionette})(this,Backbone,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/namespace.js' */
JIRA.ProjectConfig||(JIRA.ProjectConfig={});JIRA.ProjectConfig.Backbone=Backbone.noConflict();
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/jquery-scrollintoview/jquery.scrollintoview.js' */
/*
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function($){var converter={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var settings={duration:0,direction:"y"};var rootrx=/^(?:html)$/i;var borders=function(domElement,styles){styles=styles||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(domElement,null):domElement.currentStyle);var px=document.defaultView&&document.defaultView.getComputedStyle?true:false;var b={top:(parseFloat(px?styles.borderTopWidth:$.css(domElement,"borderTopWidth"))||0),left:(parseFloat(px?styles.borderLeftWidth:$.css(domElement,"borderLeftWidth"))||0),bottom:(parseFloat(px?styles.borderBottomWidth:$.css(domElement,"borderBottomWidth"))||0),right:(parseFloat(px?styles.borderRightWidth:$.css(domElement,"borderRightWidth"))||0)};return{top:b.top,left:b.left,bottom:b.bottom,right:b.right,vertical:b.top+b.bottom,horizontal:b.left+b.right}};var dimensions=function($element){var win=$(window);var isRoot=rootrx.test($element[0].nodeName);return{border:isRoot?{top:0,left:0,bottom:0,right:0}:borders($element[0]),scroll:{top:(isRoot?win:$element).scrollTop(),left:(isRoot?win:$element).scrollLeft()},scrollbar:{right:isRoot?0:$element.innerWidth()-$element[0].clientWidth,bottom:isRoot?0:$element.innerHeight()-$element[0].clientHeight},rect:(function(){var r=$element[0].getBoundingClientRect();return{top:isRoot?0:r.top,left:isRoot?0:r.left,bottom:isRoot?$element[0].clientHeight:r.bottom,right:isRoot?$element[0].clientWidth:r.right}})()}};$.fn.extend({scrollIntoViewForAuto:function(options){options=$.extend({},settings,options);options.direction=converter[typeof (options.direction)==="string"&&options.direction.toLowerCase()]||converter.both;var dirStr="";if(options.direction.x===true){dirStr="horizontal"}if(options.direction.y===true){dirStr=dirStr?"both":"vertical"}var el=this.eq(0);var scroller=el.closest(":scrollable("+dirStr+")");if(scroller.length>0){scroller=scroller.eq(0);var dim={e:dimensions(el),s:dimensions(scroller)};var rel={top:dim.e.rect.top-(dim.s.rect.top+dim.s.border.top),bottom:dim.s.rect.bottom-dim.s.border.bottom-dim.s.scrollbar.bottom-dim.e.rect.bottom,left:dim.e.rect.left-(dim.s.rect.left+dim.s.border.left),right:dim.s.rect.right-dim.s.border.right-dim.s.scrollbar.right-dim.e.rect.right};var animOptions={};if(options.direction.y===true){if(rel.top<0){animOptions.scrollTop=dim.s.scroll.top+rel.top-30}else{if(rel.top>0&&rel.bottom<0){animOptions.scrollTop=dim.s.scroll.top+Math.min(rel.top,-rel.bottom)+30}}}if(options.direction.x===true){if(rel.left<0){animOptions.scrollLeft=dim.s.scroll.left+rel.left}else{if(rel.left>0&&rel.right<0){animOptions.scrollLeft=dim.s.scroll.left+Math.min(rel.left,-rel.right)}}}if(!$.isEmptyObject(animOptions)){if(rootrx.test(scroller[0].nodeName)){scroller=$("html,body")}scroller.animate(animOptions,options.duration).eq(0).queue(function(next){$.isFunction(options.complete)&&options.complete.call(scroller[0]);next()})}else{$.isFunction(options.complete)&&options.complete.call(scroller[0])}}return this}});var scrollValue={auto:true,scroll:true,visible:false,hidden:false};$.extend($.expr[":"],{scrollable:function(element,index,meta,stack){var direction=converter[typeof (meta[3])==="string"&&meta[3].toLowerCase()]||converter.both;var styles=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(element,null):element.currentStyle);var overflow={x:scrollValue[styles.overflowX.toLowerCase()]||false,y:scrollValue[styles.overflowY.toLowerCase()]||false,isRoot:rootrx.test(element.nodeName)};if(!overflow.x&&!overflow.y&&!overflow.isRoot){return false}var size={height:{scroll:element.scrollHeight,client:element.clientHeight},width:{scroll:element.scrollWidth,client:element.clientWidth},scrollableX:function(){return(overflow.x||overflow.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(overflow.y||overflow.isRoot)&&this.height.scroll>this.height.client}};return direction.y&&size.scrollableY()||direction.x&&size.scrollableX()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/namespace.js' */
AJS.namespace("JIRA.Admin.CustomFields");
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'global/templates/messages.soy' */
// This file was automatically generated from messages.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Messages == 'undefined') { JIRA.Templates.Messages = {}; }


JIRA.Templates.Messages.msg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), '"><p class="title"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type), '"></span>', (opt_data.title) ? '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', '</p>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Messages.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.msg(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/customfields.soy' */
// This file was automatically generated from customfields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }


JIRA.Templates.CustomFields.types = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="customfields-types"></ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.type = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type.previewImageUrl) ? '<img class="field-preview" src="' + soy.$$escapeHtml(opt_data.type.previewImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.type.name) + '" width="120" height="60" />' : '<span class="field-preview-empty"><span class="field-preview-empty-message">' + soy.$$escapeHtml("No field preview") + '</span></span>', (opt_data.type.isManaged) ? '<span class="aui-lozenge aui-lozenge-subtle field-is-managed" title="' + soy.$$escapeHtml(opt_data.type.managedDescription) + '">' + soy.$$escapeHtml("Managed") + '</span>' : '', '<h3 class="field-name">', soy.$$escapeHtml(opt_data.type.name), '</h3>', (opt_data.type.description) ? '<p class="field-description">' + soy.$$escapeHtml(opt_data.type.description) + '</p>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "Your search did not match any custom field types."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeMarketplace = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy35 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.contextPath), '/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&amp;source=custom_fields_create">');
  open__soy35 = open__soy35.toString();
  var close__soy39 = new soy.StringBuilder('</a>');
  close__soy39 = close__soy39.toString();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("Try searching the {0}Atlassian Marketplace{1} for other custom field types.",open__soy35,close__soy39)}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeOtherTab = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("{0}Custom field types{1} have been found in other categories.",'<a href="#" class="customfields-all-category-link">','</a>')}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.quickSearch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="jira-field-search" type="text" title="', soy.$$escapeHtml("Search"), '" placeholder="', soy.$$escapeHtml("Search"), '">');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotification = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-notification"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotificationWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.warningMsg({msg: '<div class="jira-dialog-notification-content"></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'dialog-title\'><div class=\'jira-dialog-title-actions\'></div><div class=\'jira-dialog-title-main\'></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.errorDialogTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsComponent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="text" class="text custom-field-options-input" id="custom-field-options-input" maxlength="255"/><button type="button" class="aui-button custom-field-options-add" id="custom-field-options-add">', soy.$$escapeHtml("Add"), '</button><div id="custom-field-options-list-container" class="custom-field-options"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="aui-icon aui-icon-small aui-iconfont-remove-label custom-field-options-delete" href="#"></a><div class="icon-draghandle custom-field-option-handle"></div><div title="', soy.$$escapeHtml(opt_data.name), '" class="custom-field-option-value">', soy.$$escapeHtml(opt_data.name), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.submitHack = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input tabIndex="-1" type="submit" class="custom-field-trigger" value="submit"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.addCompleteError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml(opt_data.message));
  if (opt_data.failedSteps.length > 0) {
    output.append('<ul>');
    var failList85 = opt_data.failedSteps;
    var failListLen85 = failList85.length;
    for (var failIndex85 = 0; failIndex85 < failListLen85; failIndex85++) {
      var failData85 = failList85[failIndex85];
      output.append('<li>', soy.$$escapeHtml(failData85), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.sharedByCreate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy92 = new soy.StringBuilder('<a>');
  open__soy92 = open__soy92.toString();
  var close__soy94 = new soy.StringBuilder('</a>');
  close__soy94 = close__soy94.toString();
  output.append((opt_data.projects.length > 1) ? '<span>' + AJS.format("This custom field will also be visible in {0}{1} other projects{2}.",open__soy92,opt_data.projects.length,close__soy94) + '</span>' : '<span>' + AJS.format("This custom field will also be visible in {0}1 other project{1}.",open__soy92,close__soy94) + '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.shareByInline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shared-item-content"><h3>', soy.$$escapeHtml("Other projects where the field will be visible"), ':</h3><ul class="shared-project-list">');
  var projectList111 = opt_data.projects;
  var projectListLen111 = projectList111.length;
  for (var projectIndex111 = 0; projectIndex111 < projectListLen111; projectIndex111++) {
    var projectData111 = projectList111[projectIndex111];
    output.append('<li><a class="shared-project-name" href="', soy.$$escapeHtml(contextPath), '/plugins/servlet/project-config/', soy.$$escapeHtml(projectData111.key), '"><img class="shared-project-icon" width="16" height="16" alt="" src="', soy.$$escapeHtml(contextPath), '/secure/projectavatar?size=small&amp;pid=', soy.$$escapeHtml(projectData111.id), '" /> ', soy.$$escapeHtml(projectData111.name), '</a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/FieldWisherStep.soy' */
// This file was automatically generated from FieldWisherStep.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.FieldWisherStep == 'undefined') { JIRA.Templates.CustomFields.FieldWisherStep = {}; }


JIRA.Templates.CustomFields.FieldWisherStep.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui"><div class="field-group"><label for="field-name">', soy.$$escapeHtml("Name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("(required)"), '</span></label><select name="field-name" id="field-name"><option data-placeholder="empty"></option>');
  var fieldList8 = opt_data.fields;
  var fieldListLen8 = fieldList8.length;
  for (var fieldIndex8 = 0; fieldIndex8 < fieldListLen8; fieldIndex8++) {
    var fieldData8 = fieldList8[fieldIndex8];
    output.append('<option value="', soy.$$escapeHtml(fieldData8.id), '">', soy.$$escapeHtml(fieldData8.name), '</option>');
  }
  output.append('</select><div class="description">', soy.$$escapeHtml("Search for an existing field, or name a new one."), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/ErrorDialog.soy' */
// This file was automatically generated from ErrorDialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.ErrorDialog == 'undefined') { JIRA.Templates.CustomFields.ErrorDialog = {}; }


JIRA.Templates.CustomFields.ErrorDialog.header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.ErrorDialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.errorMessage({message: opt_data.text}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/ErrorDialog/ErrorDialog.js' */
(function(namespace,_,$,AJS,Backbone){namespace.ErrorDialog=function(options){var content,dialog,header;options||(options={});_.defaults(options,{heading:"",message:""});content=new Backbone.Marionette.View({el:$(JIRA.Templates.CustomFields.ErrorDialog.content({text:options.message}))});dialog=this.dialog=new namespace.Dialog();this.$el=dialog.$el;header=JIRA.Templates.CustomFields.ErrorDialog.header({text:options.heading});dialog.addHeaderMain(header);dialog.addPanel("",content);dialog.addLink({label:"Cancel",click:_.bind(this.cancel,this)});this.listenTo(dialog,"close",this.cancel)};_.extend(namespace.ErrorDialog.prototype,Backbone.Events,{show:function(){this.dialog.show()},hide:function(){this.dialog&&this.dialog.hide()},cancel:function(){this.trigger("cancel")},destroy:function(){if(this.dialog){this.dialog.destroy();delete this.dialog}},hideLoading:function(){return this},showLoading:function(){return this},isDirty:function(){return false}})})(JIRA.Admin.CustomFields,_,AJS.$,AJS,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/util.js' */
(function(namespace,$,_){function isEmpty(value){return value===undefined||value===null}namespace.lowerCaseLocaleComparator=function(attr){return function(a,b){var a_attr=a.get(attr),b_attr=b.get(attr);if(isEmpty(a_attr)&&isEmpty(b_attr)){return 0}else{if(isEmpty(a_attr)){return -1}else{if(isEmpty(b_attr)){return 1}}}return a_attr.toLocaleLowerCase().localeCompare(b_attr.toLocaleLowerCase())}};namespace.url=function(path,params){if(_.isArray(path)){var realPath="";for(var i=0;i<path.length;i++){realPath=realPath+"/"+encodeURIComponent(""+path[i])}path=realPath}var querystring="";if(params){querystring="?"+$.param(params,true)}return AJS.contextPath()+path+querystring}})(JIRA.Admin.CustomFields,AJS.$,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/FilteredCollection.js' */
(function(namespace,Backbone){namespace.FilteredCollection=Backbone.Collection.extend({initialize:function(){this.filteredModels=[]},filter:function(query){var instance=this,state={};var partition=_.groupBy(this.filteredModels,function(model){return instance.matcher(model,query,state)?"show":"hide"});this.filteredModels=partition.hide||[];_.each(partition.show,function(model){instance.add(model)});_.chain(this.models).filter(function(model){return !instance.matcher(model,query,state)}).each(function(model){instance.remove(model);instance.filteredModels.push(model)})}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Dialog.js' */
(function(namespace,Backbone,Marionette,AJS,_,$){namespace.Dialog=function(options){options||(options={});_.defaults(options,{width:840,height:530});options.keypressListener=_.bind(this.onKeydown,this);this._dialog=new AJS.Dialog(options);this._page=this._dialog.getPage(0);this._currentPanel=null;this._notification=null;this._isShown=false;this.$el=this._dialog.popup.element;this._page.header=JIRA.Templates.CustomFields.dialogHeader();this.$el.prepend(this._page.header);this.$el.addClass("jira-customfields-wizard")};_.extend(namespace.Dialog.prototype,Backbone.Events,{_recalcPageSize:function(){if(this.$notification){var height=null;for(var i=0;i<this._page.panel.length;i++){var panel=this._page.panel[i];if(!panel.isSizeRecalculated){height=height||panel.body.outerHeight()-this.$notification.outerHeight();var body=panel.body;body.css("height",height);panel.isSizeRecalculated=true;if(!this._page.menu.isSizeRecalculated){this._page.menu.css("height",height);this._page.menu.isSizeRecalculated=true}}}}return this},onKeydown:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){this.trigger("close")}},triggerMethod:Marionette.triggerMethod,_lastButtonElement:function(){var button=_.last(this._page.button);return button.item},_setNotification:function(html,view){if(this._notification&&this._isShown){this._notification._triggerHide()}if(!this.$notification){this.$notification=$(JIRA.Templates.CustomFields.dialogNotification());this.$notification.append(html);this.$el.find(".dialog-components").prepend(this.$notification)}else{this.$notification.html(html)}this._recalcPageSize();this._notification=new Notification(view);if(this._isShown){this._notification._triggerShow()}return this},setWarningNotification:function(view){var el=$(JIRA.Templates.CustomFields.dialogNotificationWarning());el.find(".jira-dialog-notification-content").html(view.render().$el);return this._setNotification(el,view)},addHeaderMain:function(html){this.$el.find(".jira-dialog-title-main").append(html);this._page.recalcSize();return this},addOrSetHeaderMainText:function(text){var headerMain=this.$el.find(".jira-dialog-title-main .jira-dialog-title-text");if(headerMain.length>0){headerMain.text(text);return this}else{return this.addHeaderMain($("<h2 class='jira-dialog-title-text'/>").text(text))}},addHeaderAction:function(view){var $actions=this.$el.find(".jira-dialog-title-actions");$actions.append(view.render().$el);this._page.recalcSize();return this},showLoading:function(){if(!this.$loading){var $before=this.$el.find(".dialog-button-panel button").eq(0);this.$loading=$("<span>").addClass("icon dialog-spinner");this.$loading.insertBefore($before)}this.$loading.spin()},hideLoading:function(){if(this.$loading){this.$loading.spin(false)}},addButton:function(options){var buttonClass=options.secondary?" aui-button-secondary":" aui-button-primary";this._dialog.addButton(options.label,options.click,"aui-button"+buttonClass);var element=this._lastButtonElement();element.removeClass("button-panel-button");options.id&&element.attr("id",options.id);if(options.submitAccessKey){this._addSubmitKey(element)}return new namespace.Dialog.Button(element)},addLeftLink:function(options){var element;this._dialog.addLink(options.label,options.click,"secondary",options.url);element=this._lastButtonElement();element=element.removeClass("button-panel-button");if(options.iconClass){$('<span class="icon"/>').addClass(options.iconClass).prependTo(element)}return this},addLink:function(options){this._dialog.addLink(options.label,options.click);var element=this._lastButtonElement();if(options.cancelAccessKey){this._addCancelKey(element)}return this},addPanel:function(name,view){this._dialog.addPanel(name,view.render().el);var dialogPanel=this._page.getCurrentPanel();var panel=new namespace.Dialog.Panel(this,name,view,dialogPanel);dialogPanel.button.click(_.bind(function(){this._onShowPanel(panel)},this));this._onShowPanel(panel);return panel},show:function(){if(!this._isShown){this._dialog.show();this._recalcPageSize();this._isShown=true;this._currentPanel&&this._currentPanel._triggerShow();this._notification&&this._notification._triggerShow()}return this},hide:function(){this.hideLoading();if(this._isShown){this._currentPanel&&this._currentPanel._triggerHide();this._notification&&this._notification._triggerHide();this._dialog&&this._dialog.hide();this._isShown=false}},destroy:function(){this.hide();this._dialog&&this._dialog.remove();delete this._dialog},_addSubmitKey:function(el){var key="s";el.prop("accessKey",key);el.attr("title",AJS.format("Press {1}+{0} to submit this form",key,AJS.Navigator.modifierKey()));return this},_addCancelKey:function(el){var key="`";el.prop("accessKey",key);el.attr("title",AJS.format("Press {1}+{0} to cancel",key,AJS.Navigator.modifierKey()));return this},_onShowPanel:function(panel){if(!this._isShown){this._currentPanel=panel;return }if(this._currentPanel){if(this._currentPanel!==panel){this._currentPanel._triggerHide();this._currentPanel=panel;this._currentPanel._triggerShow()}}else{this._currentPanel=panel;this._currentPanel._triggerShow()}},currentPanel:function(){return this._currentPanel},showErrors:function(errors){if(errors&&errors.length){var newError=$(JIRA.Templates.Messages.errorMessage({message:errors.join(" ")}));if(this.$error){this.$error.replaceWith(newError)}else{var $before=this.$el.find(".dialog-panel-body").filter(":visible");var $form=$before.find("form").filter(":first");if($form.length){$before=$form}$before.prepend(newError)}this.$error=newError}else{if(this.$error){this.$error.remove();delete this.$error}}return this},hideErrors:function(){this.$el.find(".dialog-panel-body .error").hide()}});namespace.Dialog.Panel=function(dialog,name,view,panel){this.dialog=dialog;this.name=name;this.view=view;this.panel=panel};_.extend(namespace.Dialog.Panel.prototype,Backbone.Events,{_triggerHide:function(){return this.triggerMethod("dialog:panel:hide")},_triggerShow:function(){return this.triggerMethod("dialog:panel:show")},triggerMethod:function(event){Marionette.triggerMethod.call(this,event);this.view.triggerMethod(event);return this},show:function(){this.panel.select();return this}});namespace.Dialog.Button=function(element){this.element=element};_.extend(namespace.Dialog.Button.prototype,{disable:function(){this.element.prop("disabled",true);return this},enable:function(){this.element.prop("disabled",false);return this},click:function(){this.element.click.apply(this.element,arguments);return this},setLabel:function(text){this.element.text(text);return this}});var Notification=function(view){this.view=view};_.extend(Notification.prototype,{_triggerHide:function(){return this.triggerMethod("dialog:notification:hide")},_triggerShow:function(){return this.triggerMethod("dialog:notification:show")},triggerMethod:function(event){this.view.triggerMethod(event);return this}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,AJS,_,AJS.$);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Forms.js' */
(function(namespace,Backbone,$,_,Dirty){var Form=namespace.Form=Backbone.View.extend({initialize:function(options){var $el=this.$form=$(aui.form.form(_.defaults(_.pick(options,"id","action"),{action:"",content:"",extraClasses:Dirty.ClassNames.EXEMPT})));this.setElement($el);this.fields={};this.fieldOrder=[];_.each(options.fields,function(field){this.addField(field)},this);this.$form.submit(_.bind(this._submit,this));if($.browser.msie){this.$form.bind("keypress",function(e){if(e.keyCode===$.ui.keyCode.ENTER&&$(e.target).is("input")){e.preventDefault();$(this).submit()}})}},addField:function(field){if(field.content){var content=field.content;if(_.isFunction(content)){content=content.call(this)}this.$form.append(content)}else{var label="";if(field.label){label=aui.form.label({forField:field.id,isRequired:!!field.required,content:field.label})}var fieldGroup=$(aui.form.fieldGroup({content:label}));var newField=new this._getField(field);var name=field.name||field.id;if(name){this.fields[name]=newField}this.fieldOrder.push(newField);this.$form.append(fieldGroup.append(newField.render().$el))}return this},setValueOfFieldWithName:function(name,value){this.fields[name].value(value)},_getField:function(field){if(field.field){return field.field}else{var Type=field.type;if(_.isString(Type)){Type=Form.DEFAULT_TYPES[Type]}var options=_.extend({},field,{form:this});return new Type(options)}},focus:function(){return this._focusFirstField(this.fieldOrder)},blur:function(){_.each(this.fieldOrder,function(field){field.blur()});return this},submit:function(){this.$form.submit();return this},validate:function(){var errors=_.reduce(this.fieldOrder,function(errors,field){if(!field.validate()){errors.push(field)}return errors},[],this);if(errors.length){this._focusFirstField(errors);return false}else{return true}},showErrors:function(fieldErrors,globalErrors){fieldErrors=fieldErrors||{};globalErrors=globalErrors||[];var errors=_.reduce(this.fieldOrder,function(errors,field){if(field.showRelevantErrors(fieldErrors,globalErrors)){errors.push(field)}return errors},[],this);if(errors.length){this._focusFirstField(errors);return true}else{return false}},enable:function(){_.each(this.fieldOrder,function(item){item.enable()});return this},disable:function(){_.each(this.fieldOrder,function(item){item.disable()});return this},isDirty:function(){for(var i=0;i<this.fieldOrder.length;i++){if(this.fieldOrder[i].isDirty()){return true}}return false},toJSON:function(){return _.reduce(this.fieldOrder,function(data,field){field.addValueToData(data);return data},{},this)},_submit:function(e){e.preventDefault();if(!this._interceptSubmit()){if(this.validate()){this.trigger(Form.EVENTS.submit)}}},_interceptSubmit:function(){return _.reduce(this.fieldOrder,function(data,field){return field.handleSubmit()||data},false,this)},_focusFirstField:function(fields){for(var i=0;i<fields.length;i++){if(fields[i].focus()){break}}return this}});Form.Fields={};var FormField=Form.Fields.FormField=Backbone.View.extend({initialize:function(options){},focus:function(){return true},blur:function(){return true},validate:function(){return true},showRelevantErrors:function(fieldErrors,messages){return false},addValueToData:function(data){},setError:function(error){return this},clearError:function(){return this},value:function(value){return this},disable:function(){return this},enable:function(){return this},handleSubmit:function(){return false},isDirty:function(){return false}});Form.Fields.FormField.extend=function(object){if(object.mixin){var initializeCalls=[];object.initialize&&initializeCalls.push(object.initialize);_.each(object.mixin,function(mixin){_.each(mixin,function(value,key){if(key==="initialize"){initializeCalls.push(value)}else{object[key]=value}})});object=_.omit(object,"mixin");if(initializeCalls.length>1){object.initialize=function(){var args=_.toArray(arguments);_.each(initializeCalls,function(func){func.apply(this,args)},this)}}else{if(initializeCalls.length===1){object.initialize=initializeCalls[0]}}}return Backbone.View.extend.call(this,object)};Form.Fields.NamedFieldMixin={initialize:function(options){this.name=options.name||options.id},showRelevantErrors:function(fields){var error=fields[this.name];if(error){this.setError(error);delete fields[this.name];return true}else{this.clearError();return false}},addValueToData:function(data){var val=this.value();if(!_.isUndefined(val)&&!_.isNull(val)&&val!=""){data[this.name]=val}return this}};Form.Fields.ValidatorMixin={initialize:function(options){this.validator=options.validator||Validators.always()},validate:function(){return this.validator.call(this)}};var AbstractTextField=FormField.extend({mixin:[Form.Fields.ValidatorMixin,Form.Fields.NamedFieldMixin],initialize:function(options){this.parent=FormField.prototype;this.parent.initialize.apply(this,arguments)},isDirty:function(){var el=this.$el[0];return el.value!==el.defaultValue},setError:function(text){if(this.$error){this.$error.text(text)}else{this.$error=$(aui.form.fieldError({message:text}));this.$el.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},value:function(value){if(_.isUndefined(value)){return $.trim(this.$el.val())||""}else{this.$el.val(""+value);return this}},focus:function(){if(!this.isDisabled()){this.$el.focus();return true}else{return false}},blur:function(){if(this.$el.is(":focus")){this.$el.blur();return true}else{return false}},disable:function(){this.$el.prop("disabled",true);return this},enable:function(){this.$el.prop("disabled",false);return this},isDisabled:function(){return this.$el.prop("disabled")},_getStyle:function(size){switch(size){case FormField.SIZE.large:return"long-field";default:return""}},_getTemplateOptions:function(options,pick,extra){var templateOptions=_.extend(_.pick(options,pick),extra);var size=this._getStyle(options.size);if(size){templateOptions.extraClasses=[size]}return templateOptions}});var TextField=AbstractTextField.extend({initialize:function(options){this.parent=AbstractTextField.prototype;this.parent.initialize.apply(this,arguments);var templateOptions=this._getTemplateOptions(options,["id","maxLength","value"],{type:"text"});this.setElement($(aui.form.input(templateOptions)))}});var TextArea=AbstractTextField.extend({initialize:function(options){this.parent=AbstractTextField.prototype;this.parent.initialize.apply(this,arguments);var templateOptions=this._getTemplateOptions(options,["id","cols"]);this.setElement($(aui.form.textarea(templateOptions)))}});Form.DEFAULT_TYPES={text:TextField,textarea:TextArea};Form.EVENTS={submit:"submit"};FormField.SIZE={large:"large"};var trueFunc=function(){return true};var Validators=Form.Validators={notEmpty:function(error){return function(){if(!this.value()){this.setError(error);return false}else{this.clearError();return true}}},always:function(){return trueFunc}}}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,JIRA.DirtyForm));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/OptionsView.js' */
(function(namespace,_,$,Backbone,AJS,Form){var Bus=function(){};_.extend(Bus.prototype,Backbone.Events);namespace.OptionsField=Form.Fields.FormField.extend({mixin:[Form.Fields.NamedFieldMixin],initialize:function(){this.bus=new Bus();this.options=new Options.Models.Options();this.view=new Options({collection:this.options,bus:this.bus});this.enabled=true;this.listenTo(this.bus,"removeOption",this._removeOption);this.listenTo(this.bus,"moveOption",this._moveOption)},focus:function(){return this.view.focus()},blur:function(){return this.view.blur()},validate:function(){if(!this.options.length){this.setError("Your custom field must have some options.");return false}else{this.clearError();return true}},setError:function(error){this.view.setError(error);return this},clearError:function(){this.view.clearError();return this},value:function(value){if(_.isUndefined(value)){return this.options.map(function(input){return input.pick("name")})}else{return this}},disable:function(){this.enabled=false;this.view.disable();return this},enable:function(){this.enabled=true;this.view.enable();return this},render:function(){this.setElement(this.view.render().$el);return this},handleSubmit:function(){return this.view.handleSubmit()},isDirty:function(){return this.view.isDirty()},_removeOption:function(option){if(this.enabled){this.options.remove(option);this.focus()}},_moveOption:function(options){if(this.enabled){var option=options.option;this.options.remove(option,{silent:true});this.options.add(option,{silent:true,at:options.newIndex});this.focus()}}});var Options=Backbone.Marionette.ItemView.extend({initialize:function(options){this.bus=options.bus;this.options=options.collection;this.optionsView=new Options.Views.OptionViews({collection:this.options,bus:this.bus})},ui:{input:"#custom-field-options-input",addBtn:"#custom-field-options-add",listContainer:"#custom-field-options-list-container"},template:JIRA.Templates.CustomFields.singleSelectOptionsComponent,onRender:function(){this.ui.listContainer.append(this.optionsView.render().$el);var add=_.bind(this._addOptionFromUi,this);this.ui.addBtn.click(add);this.ui.input.keydown(function(e){if(e.keyCode==$.ui.keyCode.ENTER){e.preventDefault();add()}})},_addOptionFromUi:function(){var errors=[];if(!this.addOption(this.input(),errors)){this.setError(errors[0])}else{this.clearError().clearInput()}this.focus();return this},handleSubmit:function(){return false},getOptions:function(){return this.options.pick("name")},addOption:function(optionName,errors){errors=errors||[];optionName=$.trim(optionName);if(!optionName.length){errors.push("Option must have a name.");return false}else{var id=this._nameToId(optionName);if(this.options.get(id)){errors.push("This value already exists in the list.");return false}else{this.options.add({name:optionName,id:id});return true}}},_getFocus:function(){return this.$(":focus")},focus:function(){if(!this.ui.input.prop("disabled")){this.ui.input.focus();return true}else{return false}},blur:function(){var focusEl=this._getFocus();if(focusEl.length){focusEl.blur();return true}else{return false}},clearInput:function(){this.ui.input.val("");return this},input:function(value){if(_.isUndefined(value)){return this.ui.input.val()}else{this.ui.input.val(value);return this}},setError:function(text){if(this.$error){this.$error.text(text)}else{this.$error=$(aui.form.fieldError({message:text}));this.ui.addBtn.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},_nameToId:function(name){return name.toLowerCase()},enable:function(){this.ui.listContainer.removeClass("disabled");this._setInputState(true)},disable:function(){this.ui.listContainer.addClass("disabled");this._setInputState(false)},_setInputState:function(enabled){this.ui.input.prop("disabled",!enabled);this.ui.addBtn.prop("disabled",!enabled)},isDirty:function(){return this.ui.input.val()||this.options.length}});Options.Models={};Options.Models.Option=Backbone.Model.extend({});Options.Models.Options=Backbone.Collection.extend({model:Options.Models.Option});Options.Views={};Options.Views.OptionView=Backbone.Marionette.ItemView.extend({events:{"click .custom-field-options-delete":"_delete",moveOption:"_moveOption"},tagName:"li",template:JIRA.Templates.CustomFields.singleSelectOptionsItem,initialize:function(options){this.bus=options.bus},_delete:function(e){e.preventDefault();this.bus.trigger("removeOption",this.model)},_moveOption:function(e,newIndex){this.bus.trigger("moveOption",{option:this.model,newIndex:newIndex})}});Options.Views.OptionViews=Backbone.Marionette.CollectionView.extend({itemView:Options.Views.OptionView,tagName:"ul",id:"custom-field-options-list",initialize:function(options){this.bus=options.bus;this.$el.sortable({axis:"y",containment:"#custom-field-options-list-container",tolerance:"pointer",cursor:"move",handle:".custom-field-option-handle",update:this._handleReorder})},itemViewOptions:function(){return{bus:this.bus}},_handleReorder:function(e,ui){ui.item.trigger("moveOption",ui.item.index())}})}(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone,AJS,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/SharedByNotification.js' */
(function(namespace,$,Backbone,AJS){namespace.SharedByView=Backbone.Marionette.ItemView.extend({initialize:function(options){this.projects=options.projects},template:JIRA.Templates.CustomFields.sharedByCreate,serializeData:function(){return{projects:this.projects}},onDialogNotificationHide:function(){if(this.popup){this.popup.hide();this.popup.remove();delete this.popup}},onDialogNotificationShow:function(){var projects=this.projects;this.popup=AJS.InlineDialog(this.$el.find("a"),"customfield-project-list",function(contents,trigger,showPopup){contents.html(JIRA.Templates.CustomFields.shareByInline({projects:projects}));showPopup()},{width:240,onHover:true,hideDelay:500})}})}(JIRA.Admin.CustomFields,AJS.$,JIRA.ProjectConfig.Backbone,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/TypeItemView.js' */
(function(namespace,Backbone){namespace.TypeItemView=Backbone.Marionette.ItemView.extend({className:"item",submit:function(){this.select();this.triggerMethod("submit",this.getKey())},events:{click:"onClick",dblclick:"onDoubleClick"},onClick:function(event){this.triggerMethod("select");event.preventDefault()},onDoubleClick:function(event){this.submit();event.preventDefault()},reveal:function(){var padding=40;this.$el.scrollIntoViewForAuto({direction:"vertical",marginBottom:padding,marginTop:padding})},select:function(){this.$el.toggleClass("selected",true);this.reveal()},deselect:function(){this.$el.toggleClass("selected",false)},tagName:"li",template:function(serialized_model){return JIRA.Templates.CustomFields.type({type:serialized_model})},getKey:function(){return this.model.get("key")}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/EmptyTypeItemView.js' */
(function(namespace,Backbone){namespace.EmptyTypeItemView=Backbone.Marionette.ItemView.extend({tagName:"li",className:"empty",triggers:{"click .customfields-all-category-link":"ongotoall"},setEmptyState:function(state){this.emptyState=state;this.render()},serializeData:function(){return this.emptyState},template:function(serializedData){var html;switch(serializedData){case namespace.EmptyTypeItemView.CHANGE_TAB:html=JIRA.Templates.CustomFields.emptyTypeOtherTab();break;case namespace.EmptyTypeItemView.MARKETPLACE:html=JIRA.Templates.CustomFields.emptyTypeMarketplace({contextPath:AJS.contextPath()});break;default:html=JIRA.Templates.CustomFields.emptyType()}return html}});_.extend(namespace.EmptyTypeItemView,{CHANGE_TAB:"otherTab",MARKETPLACE:"marketplace",EMPTY:"empty"})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/FieldTypeCollectionView.js' */
(function(namespace,$,Backbone,KeyCode){namespace.FieldTypeCollectionView=Backbone.Marionette.CompositeView.extend({itemView:namespace.TypeItemView,emptyView:namespace.EmptyTypeItemView,itemViewContainer:".customfields-types",indexOf:function(item){if(!item){return -1}return this.collection.indexOf(item.model)},attach:function(){if(this.placeholder){this.placeholder.replaceWith(this.$el);this.$el.parent().scrollTop(this.scrollTopBeforeDetach);delete this.placeholder;delete this.scrollTopBeforeDetach}},detach:function(){this.placeholder=$("<div/>").insertBefore(this.$el);this.scrollTopBeforeDetach=this.$el.parent().scrollTop();this.$el.detach()},initialize:function(){this.selectedView=null;_.bindAll.apply(_,[this].concat(_.functions(this)))},onItemviewSelect:function(view){this.select(view)},onItemRemoved:function(){this.selectByIndex(0)},onAfterItemAdded:function(){this.selectByIndex(0)},onItemviewSubmit:function(view,key){this.triggerMethod("submit",key)},onItemviewOngotoall:function(){this.triggerMethod("changeToAll")},isEmpty:function(){return !this.collection.length},_getEmptyView:function(){return this.isEmpty()&&this.children.findByIndex(0)},setHasMatches:function(hasMatches){var emptyView=this._getEmptyView(),state;if(!emptyView){return }if(hasMatches){state=namespace.EmptyTypeItemView.CHANGE_TAB}else{if(JIRA.isSysadmin()){state=namespace.EmptyTypeItemView.MARKETPLACE}else{state=namespace.EmptyTypeItemView.EMPTY}}emptyView.setEmptyState(state)},onKeydown:function(event){switch(event.keyCode){case KeyCode.UP:this.collection.length&&this.moveSelect(-1);break;case KeyCode.DOWN:this.collection.length&&this.moveSelect(1);break;case KeyCode.ENTER:this.collection.length&&this.triggerMethod("submit",this.getSelectedKey());break;default:return }event.preventDefault()},moveSelect:function(offset){var index=this.indexOf(this.selectedView);if(index>=0){index=Math.min(this.children.length-1,Math.max(0,index+offset));this.selectByIndex(index)}},select:function(view){if(this.selectedView){this.selectedView.deselect()}this.selectedView=view;view&&this.selectedView.select();this.triggerMethod("changedSelection",{key:this.getSelectedKey()})},selectByIndex:function(index){var view=this._viewAtIndex(index);this.select(view)},_viewAtIndex:function(index){var model=this.collection.at(index);return model&&this.children.findByModel(model)},template:function(){return JIRA.Templates.CustomFields.types()},onDialogPanelHide:function(){this.detach();$(document).unbind("keydown",this.onKeydown)},onDialogPanelShow:function(){this.attach();$(document).bind("keydown",this.onKeydown)},getSelectedKey:function(){if(this.selectedView){return this.selectedView.getKey()}else{return null}},getSelectedModel:function(){return this.selectedView&&this.selectedView.model},appendHtml:function(cv,iv,index){var $container=this.getItemViewContainer(cv);if(index===0){$container.prepend(iv.el)}else{$container.children().eq(index-1).after(iv.el)}}})})(JIRA.Admin.CustomFields,AJS.$,JIRA.ProjectConfig.Backbone,AJS.$.ui.keyCode);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/QuickSearch.js' */
(function(namespace,Backbone,_){namespace.QuickSearch=Backbone.Marionette.ItemView.extend({className:"search",ui:{input:"input"},initialize:function(options){options=options||{};if(options.delay){this.onInputInput=_.debounce(this.onInputInput,options.delay)}},focus:function(){this.ui.input.focus();return this},onInputInput:function(){this.triggerMethod("change",{value:this.value()})},template:function(){return JIRA.Templates.CustomFields.quickSearch()},value:function(){return this.ui.input.val()},render:function(){Backbone.Marionette.ItemView.prototype.render.apply(this,arguments);this.ui.input.on("input",_.bind(this.onInputInput,this));return this}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Wizard.js' */
(function(namespace,_,Backbone,Marionette,$){namespace.Wizard=function(options){options=options||{};this.sharedStepOptions=options.sharedStepOptions||{};this._setCurrentStepWrapper(null,options.firstStep,null);this.autoClose=options.autoClose;this.dirtyMessage=options.dirtyMessage;this.result=$.Deferred();this.loadingTimer=null};_.extend(namespace.Wizard.prototype,Backbone.Events,{start:function(){this._hasCompleted=false;this._showDelayedLoading(this);this._transitionTo(null,this.currentStepWrapper.step);if(this.dirtyMessage){this._addDirty()}return this.result.promise()},close:function(){this._closeWebsudoDialogIfExists();if(this.currentStepWrapper){if(this.dirtyMessage){this._removeDirty()}this.stopListening();this._applyToEachStep(function(step){this._hideDelayedLoading(step);step.stopStep()});delete this.currentStepWrapper}this._hideDelayedLoading(this)},isDirty:function(){return this._existsSomeStep(function(step){return step.isDirty()})},showLoading:function(){AJS.dim(false);JIRA.Loading.showLoadingIndicator()},hideLoading:function(){JIRA.Loading.hideLoadingIndicator()},_bindToStep:function(step){this.listenTo(step,namespace.Wizard.EVENTS.next,this._onNextStep);this.listenTo(step,namespace.Wizard.EVENTS.previous,this._onPreviousStep);this.listenTo(step,namespace.Wizard.EVENTS.complete,this._onComplete);this.listenTo(step,namespace.Wizard.EVENTS.cancel,this._onCancel)},_onNextStep:function(){var existingNextStepWrapper=this.currentStepWrapper.nextStepWrapper;var previousStepWrapper=this.currentStepWrapper;var proposedNextStep=existingNextStepWrapper&&existingNextStepWrapper.step;var nextStep=this.currentStepWrapper.step.getNextStep(proposedNextStep,this.sharedStepOptions);if(nextStep===proposedNextStep){this.currentStepWrapper=existingNextStepWrapper}else{this._setCurrentStepWrapper(this.currentStepWrapper,nextStep,null)}this.currentStepWrapper.step.setPreviousData(previousStepWrapper.step.getAccumulatedData());this._transitionTo(this.currentStepWrapper.previousStepWrapper.step,this.currentStepWrapper.step)},_onPreviousStep:function(){var previous=this.currentStepWrapper.previousStepWrapper;if(previous){this.currentStepWrapper=previous;this._transitionTo(this.currentStepWrapper.nextStepWrapper.step,this.currentStepWrapper.step)}},_transitionTo:function(fromStep,toStep){var self=this,startPromise=toStep.startStep();this._bindToStepProgress(startPromise,fromStep);startPromise.always(function(){if(self.websudoDialog){self._closeWebsudoDialog()}else{if(fromStep){self._hideDelayedLoading(fromStep);fromStep.pauseStep()}else{self._hideDelayedLoading(self)}}}).always(_.bind(this._makeStepVisible,this,toStep))},_bindToStepProgress:function(promise,currentlyVisibleStep){var self=this;currentlyVisibleStep&&this.stopListening(currentlyVisibleStep);currentlyVisibleStep&&this._showDelayedLoading(currentlyVisibleStep);promise.progress(function(name){if(name===namespace.Wizard.EVENTS.websudoBeforeShow){if(currentlyVisibleStep){self._hideDelayedLoading(currentlyVisibleStep);currentlyVisibleStep.pauseStep()}else{self._hideDelayedLoading(self)}}else{if(name===namespace.Wizard.EVENTS.websudoSuccess){var closeFunction=arguments[1];self.websudoDialog={close:closeFunction}}}})},_makeStepVisible:function(step){step.show();this._bindToStep(step)},_closeWebsudoDialogIfExists:function(){if(this.websudoDialog){this._closeWebsudoDialog()}},_closeWebsudoDialog:function(){this.websudoDialog.close();delete this.websudoDialog},_showDelayedLoading:function(shower){var self=this;this._cancelTimer();this.loadingTimer=window.setTimeout(_.bind(function(){self.loadingTimer=null;shower.showLoading()},this),500)},_hideDelayedLoading:function(hider){this._cancelTimer();hider.hideLoading()},_cancelTimer:function(){if(this.loadingTimer!==null){window.clearTimeout(this.loadingTimer)}this.loadingTimer=null},_addDirty:function(){this._unload=window.onbeforeunload;var instance=this;window.onbeforeunload=function(){if(!instance._hasCompleted&&instance.dirtyMessage&&instance.isDirty()){return instance.dirtyMessage}else{if(_.isFunction(instance._unload)){return instance._unload.apply(this,arguments)}else{return void 0}}}},_removeDirty:function(){window.onbeforeunload=this._unload;delete this._unload},_onComplete:function(){var currentStep=this.currentStepWrapper.step;var completePromise=currentStep.doComplete();this._bindToStepProgress(completePromise,currentStep);completePromise.done(_.bind(this._onCompleteSuccess,this)).fail(_.bind(this._onCompleteFailure,this))},_onCompleteSuccess:function(){this._hasCompleted=true;this.result.resolve(this.currentStepWrapper.step.getAccumulatedData());if(this.autoClose){this.close()}},_onCompleteFailure:function(failReason){var currentStep,errors;if(failReason===namespace.Wizard.FAIL_REASON.recoverableError){currentStep=this.currentStepWrapper.step;errors=arguments[1];if(this.websudoDialog){this._closeWebsudoDialog();currentStep.show()}else{this._hideDelayedLoading(currentStep)}this._bindToStep(currentStep);currentStep.showErrors(errors.fields,errors.general)}else{this.result.reject(failReason,{data:this.currentStepWrapper.step.getAccumulatedData(),dirty:this.isDirty(),notCompletedDescriptions:arguments[1]});this.close()}},_onCancel:function(check){if(check&&!this._hasCompleted&&this.dirtyMessage&&this.isDirty()){if(!window.confirm(this.dirtyMessage)){return }}this.result.reject(namespace.Wizard.FAIL_REASON.cancel);this.close()},_applyToEachStep:function(iterator){this._forEachStep(function(step){iterator.call(this,step)})},_existsSomeStep:function(test){return !!this._forEachStep(function(step){return test.call(this,step)})},_forEachStep:function(func){var returnVal,stepWrapper;for(stepWrapper=this.currentStepWrapper;!!stepWrapper;stepWrapper=stepWrapper.previousStepWrapper){returnVal=func.call(this,stepWrapper.step);if(returnVal){return returnVal}}for(stepWrapper=this.currentStepWrapper.nextStepWrapper;!!stepWrapper;stepWrapper=stepWrapper.nextStepWrapper){returnVal=func.call(this,stepWrapper.step);if(returnVal){return returnVal}}},_setCurrentStepWrapper:function(prev,current,next){this.currentStepWrapper={previousStepWrapper:prev,step:current,nextStepWrapper:next};prev&&(prev.nextStepWrapper=this.currentStepWrapper)}});namespace.Wizard.FAIL_REASON={cancel:"cancel",abort:"abort",recoverableError:"recoverableError",error:"error"}}(JIRA.Admin.CustomFields,_,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,AJS.$));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Events.js' */
(function(namespace){namespace.Wizard.EVENTS={next:"next",previous:"previous",fail:"fail",error:"error",complete:"complete",websudoBeforeShow:"websudo:before:show",websudoSuccess:"websudo:success",cancel:"cancel"}})(JIRA.Admin.CustomFields);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CustomFieldsStepHelper.js' */
(function(namespace,_,$){namespace.CustomFieldsStepHelper={genericFailHandler:function(deferred){var args=_.toArray(arguments);if(args[1]===namespace.IssueCustomFields.STATUS.abort){deferred.rejectWith(deferred,[namespace.Wizard.FAIL_REASON.abort].concat(args.slice(2)))}else{deferred.rejectWith(deferred,[namespace.Wizard.FAIL_REASON.error].concat(args.slice(2)))}},genericProgressHandler:function(deferred,status){if(status===namespace.IssueCustomFields.PROGRESS.SHOW){deferred.notify(namespace.Wizard.EVENTS.websudoBeforeShow)}else{if(status===namespace.IssueCustomFields.PROGRESS.SUCCESS){deferred.notify(namespace.Wizard.EVENTS.websudoSuccess,arguments[2])}}},createField:{execute:function(options){var deferred=$.Deferred(),data=options.data,field=data.field,type=data.type;options.api.addField({name:field.name,description:field.description,searcherKey:type.searcherKey,type:type.key}).pipe(function(fieldResult){field.id=fieldResult.id;deferred.resolve()},function(errors){deferred.reject(namespace.Wizard.FAIL_REASON.recoverableError,errors)},deferred.notify);return deferred.promise()},description:function(){return "Create field."}},addOptions:{execute:function(options){var data=options.data,deferred=$.Deferred(),field=data.field;options.api.setOptions(field.id,field.options).pipe(deferred.resolve,_.bind(namespace.CustomFieldsStepHelper.genericFailHandler,null,deferred),deferred.notify);return deferred.promise()},description:function(){return "Set field options."}},putFieldOnIssue:{execute:function(options){var deferred=$.Deferred();options.api.addFieldToScreen(options.data.field.id).pipe(deferred.resolve,_.bind(namespace.CustomFieldsStepHelper.genericFailHandler,null,deferred),deferred.notify);return deferred.promise()},description:function(){return "Add field to issue."}},refreshIssue:{execute:function(){var deferred=$.Deferred();JIRA.Issues.Api.refreshSelectedIssue().pipe(deferred.resolve,_.bind(namespace.CustomFieldsStepHelper.genericFailHandler,null,deferred),deferred.notify);return deferred.promise()},description:function(){return "Refresh issue."}},executeCompletes:function(completes,executionOptions){var deferred=$.Deferred(),promise=$.Deferred().resolve().promise(),rejectionArgs;_.each(completes,function(complete,index){promise=promise.pipe(function(){return complete.execute(executionOptions)});promise.fail(function(statusText){rejectionArgs=_.toArray(arguments);if(statusText!==namespace.Wizard.FAIL_REASON.recoverableError){var notCompletedDescriptions=_.map(completes.slice(index),function(item){return item.description()});rejectionArgs.push(notCompletedDescriptions)}deferred.reject.apply(deferred,rejectionArgs)})});promise.progress(_.bind(this.genericProgressHandler,this,deferred));promise.done(deferred.resolve);return deferred.promise()}}}(JIRA.Admin.CustomFields,_,AJS.$));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Step.js' */
(function(namespace,_,Backbone){namespace.Wizard.Step=_.extend({},{fireNext:function(){this.trigger(namespace.Wizard.EVENTS.next)},firePrevious:function(){this.trigger(namespace.Wizard.EVENTS.previous)},fireCancel:function(confirm){this.trigger(namespace.Wizard.EVENTS.cancel,confirm||false)},fireComplete:function(){this.trigger(namespace.Wizard.EVENTS.complete)},startStep:function(){},stopStep:function(){},pauseStep:function(){},show:function(){},showLoading:function(){},hideLoading:function(){},doComplete:function(){return $.Deferred().resolve()},showErrors:function(fieldErrors,generalErrors){},isExistingNextStepAppropriate:function(proposedNextStep){},getNextStep:function(proposedNext,sharedStepOptions){},getAccumulatedData:function(){},setPreviousData:function(previousData){},isDirty:function(){}},Backbone.Events)})(JIRA.Admin.CustomFields,_,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/AbstractStep.js' */
(function(namespace,_){namespace.Wizard.AbstractStep=_.extend({},namespace.Wizard.Step,{startStep:function(){if(this.hasStarted){return this.restart()}else{this.hasStarted=true;return this.start()}},getAccumulatedData:function(){return _.extend({},this._previousData,this.getStepData())},setPreviousData:function(previousData){this._previousData=previousData},start:function(){},restart:function(){return this.start()},getStepData:function(){},getPreviousData:function(){return this._previousData}})})(JIRA.Admin.CustomFields,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStep.js' */
(function(namespace,Backbone,$,_){var FieldWisherStep=namespace.FieldWisherStep=function(options){this.api=options.api;this.stepData={}};_.extend(FieldWisherStep.prototype,namespace.Wizard.AbstractStep,{showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},start:function(){var self=this,startingPromise=this._getFields();startingPromise.done(function(fields){var dialog=self.dialog=new FieldWisherStep.Dialog({fields:fields});self.listenTo(dialog,"cancel",function(checkDirty){self.fireCancel(checkDirty)});self.listenTo(dialog,"submit",function(wish){self.stepData.field={};self.stepData.field.id=wish.id;self.stepData.field.name=wish.name;if(wish.id){self.stepData.createField=false;self.stepData.addField=!wish.onAllScreens;self.fireComplete()}else{self.stepData.createField=true;self.stepData.addField=true;self.fireNext()}})});startingPromise.fail(function(kind,message){if(namespace.Wizard.FAIL_REASON.abort===kind){self.fireCancel()}else{var dialog=self.dialog=new namespace.ErrorDialog({heading:FieldWisherStep.Dialog.prototype.text.heading,message:message});self.listenTo(dialog,"cancel",self.fireCancel)}});return startingPromise},restart:function(){return $.Deferred().resolve().promise()},pauseStep:function(){if(this.dialog){this.dialog.resetCanSubmit();this.dialog.resetIsSubmitted();this.dialog.hide()}},stopStep:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},show:function(){this.dialog&&this.dialog.show()},doComplete:function(){var completes,data=this.getAccumulatedData();completes=this._resolveCompletesToExecute(data);return this.executeCompletes(completes,{api:this.api,data:data})},getStepData:function(){return this.stepData},getNextStep:function(proposedNextStep,sharedStepOptions){if(proposedNextStep instanceof namespace.TypeStep){return proposedNextStep}return new namespace.TypeStep({api:sharedStepOptions.api,inIssueContext:sharedStepOptions.inIssueContext})},isDirty:function(){var field=this.stepData.field;var isStepDataDirty=field&&(field.id||field.name);return isStepDataDirty||(this.dialog&&this.dialog.isDirty())},_getFields:function(){var fields=$.Deferred(),instance=this;var getting=this.api.addableFields(true);getting.done(fields.resolve);getting.fail(_.bind(this.genericFailHandler,this,fields));getting.progress(_.bind(this.genericProgressHandler,this,fields));return fields.promise()},_resolveCompletesToExecute:function(data){var completes=[];if(data.addField){completes.push(this.putFieldOnIssue);completes.push(this.refreshIssue)}return completes}},namespace.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepDialog.js' */
(function(namespace,Backbone,$,_,AJS){namespace.FieldWisherStep.Dialog=function(options){_.bindAll(this,"submit");this.text=_.clone(this.text);this.text.nextButton=_.bind(this.text.nextButton,this);this.model=new Backbone.Model({fieldId:undefined,fieldName:undefined,fieldOnAllScreens:undefined,canSubmit:undefined,isSubmitted:undefined,isValid:undefined,fieldsOnAllScreens:undefined});this.dialog=new namespace.Dialog({id:"customfields-field-wisher",height:220,width:520});this.$el=this.dialog.$el;this.panel=new namespace.FieldWisherStep.Panel({initialValue:options.initialValue||"",fields:options.fields});this.dialog.addPanel("",this.panel);this.dialog.addOrSetHeaderMainText(this.text.heading);this.nextButton=this.dialog.addButton({label:this.text.nextButton(),id:"customfields-field-wisher-next",submitAccessKey:true,click:this.submit});this.dialog.addLink({label:this.text.cancel,click:_.bind(this.cancel,this,false),cancelAccessKey:true});this.listenTo(this.model,"change:fieldId change:fieldName",this.calculateIsValid);this.listenTo(this.model,"change:isValid change:isSubmitted",this.calculateCanSubmit);this.listenTo(this.model,"change:fieldId",this.onChangeFieldId);this.listenTo(this.model,"change:canSubmit",this.onChangeCanSubmit);this.listenTo(this.model,"change:isSubmitted",this.onChangeIsSubmitted);this.listenTo(this.panel,"change:field",this.onPanelChangeField);this.listenTo(this.panel,"request:submit",this.onPanelRequestSubmit);this.listenTo(this.dialog,"close",_.bind(this.cancel,this,true));this.calculateIsValid(this.model);this.calculateCanSubmit(this.model);this._initializeFieldsOnScreen(this.model,options.fields)};_.extend(namespace.FieldWisherStep.Dialog.prototype,Backbone.Events,{text:{cancel:"Cancel",create:"Create",add:"Add",edit:"Edit",heading:"Add Field",nextButton:function(){if(!this.model.get("fieldId")){return this.text.create}else{if(this.model.get("fieldOnAllScreens")){return this.text.edit}}return this.text.add}},triggerMethod:Backbone.Marionette.triggerMethod,show:function(){this.dialog.show();return this},hide:function(){this.dialog&&this.dialog.hide();return this},destroy:function(){this.stopListening(this.panel);this.dialog&&this.dialog.destroy();return this},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},resetCanSubmit:function(){this.model.set("canSubmit",true)},resetIsSubmitted:function(){this.model.set("isSubmitted",false)},submit:function(){var result={id:this.model.get("fieldId"),name:this.model.get("fieldName"),onAllScreens:this.model.get("fieldOnAllScreens")};if(!result.id){delete result.id}this.model.set("isSubmitted",true);this.triggerMethod("submit",result)},cancel:function(check){this.triggerMethod("cancel",check||false)},onPanelChangeField:function(field){var id=field.id;this.model.set({fieldId:id,fieldName:field.name,fieldOnAllScreens:!!this.model.get("fieldsOnAllScreens")[id]})},onPanelRequestSubmit:function(){if(this.model.get("canSubmit")){this.submit()}},onChangeFieldId:function(){this.nextButton.setLabel(this.text.nextButton())},onChangeCanSubmit:function(model){if(model.get("canSubmit")){this.nextButton.enable()}else{this.nextButton.disable()}},onChangeIsSubmitted:function(model){if(model.get("isSubmitted")){this.panel.disable()}else{this.panel.enable()}},calculateIsValid:function(model){model.set("isValid",!!model.get("fieldName"))},calculateCanSubmit:function(model){model.set("canSubmit",model.get("isValid")&&!model.get("isSubmitted"))},isDirty:function(){return !!this.model.get("fieldName")||this.panel.isDirty()},_initializeFieldsOnScreen:function(model,fields){var fieldsOnAllScreens={};_.each(fields,function(field){fieldsOnAllScreens[field.id]=field.onAllScreens});model.set("fieldsOnAllScreens",fieldsOnAllScreens)}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepPanel.js' */
(function(namespace,Backbone,$,_,AJS){namespace.FieldWisherStep.Panel=Backbone.Marionette.ItemView.extend({ui:{select:"select"},initialize:function(options){this.template=_.bind(this.template,this);this.model=new Backbone.Model({fieldId:null,fieldName:null,fields:options.fields})},template:function(){return JIRA.Templates.CustomFields.FieldWisherStep.form({fields:this.model.get("fields")})},onRender:function(){this.fieldSelect=new AJS.SingleSelect({element:this.ui.select,itemAttrDisplayed:"label",suggestionsHandler:this.ExistingOrCreateSuggester,errorMessage:""});this.bindUIElements()},events:{"selected select":"onFrotherSelected","unselect select":"onFrotherUnselect","submit form":"onSubmit"},onFrotherSelected:function(event,item){var name;name="fieldText" in item.properties?item.properties.fieldText:item.properties.label;this.model.set({fieldId:item.properties.value,fieldName:name})},onFrotherUnselect:function(){this.model.set({fieldId:null,fieldName:null})},onSubmit:function(event){event.preventDefault();this.trigger("request:submit")},enable:function(){this.fieldSelect&&this.fieldSelect.enable()},disable:function(){this.fieldSelect&&this.fieldSelect.disable()},isDirty:function(){return !!(this.fieldSelect&&(this.fieldSelect.getQueryVal()||this.fieldSelect.getSelectedDescriptor()))},modelEvents:{"change:fieldId":"onChangeField","change:fieldName":"onChangeField"},onChangeField:function(model){var field={id:model.get("fieldId"),name:model.get("fieldName")};if(!field.id){delete field.id}this.trigger("change:field",field)},ExistingOrCreateSuggester:AJS.SelectSuggestHandler.extend({formatSuggestions:function(descriptors,query){var suggestions;suggestions=this.sorted(descriptors);if(query.length>0){suggestions.push(this.creationSuggestion(query))}return suggestions},sorted:function(descriptors){var items;items=AJS.SuggestHelper.extractItems(descriptors).sort(function(a,b){a=a.label().toLowerCase();b=b.label().toLowerCase();return a.localeCompare(b)});return[new AJS.GroupDescriptor({items:items})]},creationSuggestion:function(label){var item;item=new AJS.ItemDescriptor({value:"",label:AJS.format("{0} (Create new field)",label),fieldText:label,title:label,allowDuplicate:false,noExactMatch:true});return new AJS.GroupDescriptor({label:"user inputted option",showLabel:false,replace:true,items:[item]})}})})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,AJS));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStep.js' */
(function(namespace,_,$,AJS,Backbone){var TypeStep=namespace.TypeStep=function(options){this.options=_.extend({initialCategory:"STANDARD",view:TypeStep.Views.TypeChoice},options);this.api=options.api;this.inIssueContext=!!options.inIssueContext;this.categories=null;this.stepData={}};_.extend(TypeStep.prototype,namespace.Wizard.AbstractStep,{showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},start:function(){var self=this,promise=this._getCategories(),view;promise.done(function(categories,sharedBy){var sharedView=sharedBy&&sharedBy.length&&new namespace.SharedByView({projects:sharedBy});view=self.view=new self.options.view(categories,200,sharedView,self.inIssueContext);self.listenTo(view,"submit",function(model){self.stepData.type=self._getUpdateData(model);self.fireNext()});self.listenTo(view,"previous",function(){self.firePrevious()});self.listenTo(view,"cancel",function(check){self.fireCancel(check)})});promise.fail(function(reason,error){if(namespace.Wizard.FAIL_REASON.abort===reason){self.fireCancel()}else{view=self.view=new namespace.ErrorDialog({heading:TypeStep.Views.Text.heading,message:error});self.listenTo(view,"cancel",self.fireCancel)}});return promise},restart:function(){return $.Deferred().resolve().promise()},pauseStep:function(){this.view&&this.view.hide()},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},show:function(){this.view&&this.view.show()},getStepData:function(){return this.stepData},getNextStep:function(proposedNextStep,sharedStepOptions){if(proposedNextStep instanceof namespace.CreateFieldStep){return proposedNextStep}return new namespace.CreateFieldStep({api:sharedStepOptions.api,inIssueContext:sharedStepOptions.inIssueContext})},_getUpdateData:function(model){var data={};if(model){data.key=model.get("key");data.name=model.get("name");data.options=model.get("options");data.cascading=model.get("cascading");var searchers=model.get("searchers");if(searchers&&searchers.length>0){data.searcherKey=searchers[0]}}return data},_getCategories:function(){var deferred=$.Deferred(),instance=this;var getting=this.api.getSharedBy(this.api.getCustomFieldTypes());getting.done(function(data){var categories=[];_.each(data.categories,function(cat){var matchedTypes=_.filter(data.types,function(type){return _.contains(type.categories,cat.id)});var types=new TypeStep.Models.Types(matchedTypes,{parse:true});categories.push({initial:cat.id===instance.options.initialCategory,id:cat.id,name:cat.name,types:types})});deferred.resolveWith(instance,[categories,data.sharedBy])});getting.fail(_.bind(this.genericFailHandler,this,deferred));getting.progress(_.bind(this.genericProgressHandler,this,deferred));return deferred.promise()}},namespace.CustomFieldsStepHelper);TypeStep.Models={};TypeStep.Models.Type=Backbone.Model.extend({initialize:function(){this.get("name")||this.set("name",this.get("key"))},parse:function(data){return _.omit(data,"categories")}});TypeStep.Models.Types=namespace.FilteredCollection.extend({model:TypeStep.Models.Type,comparator:namespace.lowerCaseLocaleComparator("name"),matcher:function(model,query,state){var haystack=model.get("name").toLowerCase(),needles=state.needles;if(!needles){state.needles=needles=_.filter(query.toLowerCase().split(/\s+/),function(needle){return needle})}return _.all(needles,function(needle){return haystack.indexOf(needle)!==-1})}})})(JIRA.Admin.CustomFields,_,AJS.$,AJS,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStepDialog.js' */
(function(namespace,_,$,AJS,Backbone){var urls={marketplace:AJS.contextPath()+"/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&source=custom_fields_create"};var TypeStep=namespace.TypeStep;TypeStep.Views={};var text=TypeStep.Views.Text={heading:"Select a Field Type",panel:"",cancel:"Cancel",previous:"Previous",next:"Next",marketPlace:"Find More Custom Fields"};TypeStep.Views.TypeChoice=function(categories,searchDelay,sharedBy,inIssueContext){this.categories=categories;this.searchDelay=searchDelay||0;this.sharedBy=sharedBy;this.inIssueContext=inIssueContext};_.extend(TypeStep.Views.TypeChoice.prototype,Backbone.Events,{show:function(){if(!this.dialog){var allPanel,analyticsInits=[],collectionViews=[],defaultPanel=null,dialog=new namespace.Dialog({id:"customfields-select-type",focusSelector:".dialog-title input"}),instance=this,nextButton,quickSearch=new namespace.QuickSearch({delay:this.searchDelay});this.listenTo(quickSearch,"change",function(query){_.each(instance.categories,function(category){category.types.filter(query.value)});var anyMatches=_.any(_.pluck(instance.categories,"types"),function(types){return types.length});_.each(collectionViews,function(collectionView){collectionView.setHasMatches(anyMatches)})});dialog.addOrSetHeaderMainText(text.heading);dialog.addHeaderAction(quickSearch);if(this.sharedBy){dialog.setWarningNotification(this.sharedBy)}if(JIRA.isSysadmin()){dialog.addLeftLink({label:text.marketPlace,url:urls.marketplace,iconClass:"jira-icon-marketplace"})}if(this.inIssueContext){dialog.addButton({secondary:true,label:text.previous,click:function(){instance._firePrevious(dialog.currentPanel().view.getSelectedModel())},id:"customfields-select-type-previous"})}nextButton=dialog.addButton({label:text.next,submitAccessKey:true,click:function(){instance._fireSubmit(dialog.currentPanel().view.getSelectedModel())},id:"customfields-select-type-next"});this.listenTo(dialog,"close",_.bind(this._fireCancel,this,true));dialog.addLink({label:text.cancel,click:_.bind(this._fireCancel,this,false),cancelAccessKey:true});_.each(this.categories,function(cat,index){var collectionView=new namespace.FieldTypeCollectionView({collection:cat.types});collectionViews.push(collectionView);instance.listenTo(collectionView,"submit",function(){instance._fireSubmit(collectionView.getSelectedModel())});instance.listenTo(collectionView,"dialog:panel:show",function(){quickSearch.focus();var changedSelectionHandler=function(event){event.key?nextButton.enable():nextButton.disable()};instance.listenTo(collectionView,"changedSelection",changedSelectionHandler);collectionView.once("dialog:panel:hide",function(){instance.stopListening(collectionView,"changedSelection",changedSelectionHandler)},instance);changedSelectionHandler({key:collectionView.getSelectedKey()})});instance.listenTo(collectionView,"changeToAll",function(){allPanel&&allPanel.show()});analyticsInits.push(function(){instance._initAnalytics(cat,collectionView)});var panel=dialog.addPanel(cat.name,collectionView);if(cat.initial){defaultPanel=panel;instance.__currentCategory=cat}if(index===0){allPanel=panel}});defaultPanel&&defaultPanel.show();dialog.show();_.each(analyticsInits,function(init){init()});this.dialog=dialog}else{this.dialog.show()}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},_initAnalytics:function(category,view){var instance=this;this.listenTo(view,"dialog:panel:show",function(){instance.__currentCategory=category;AJS.trigger("analytics",{name:"administration.customfields.addwizard.changecategory",data:{id:category.id,name:category.name}})})},_fireSubmit:function(model){AJS.trigger("analytics",{name:"administration.customfields.addwizard.submittype",data:{key:model.get("key"),category:this.__currentCategory.id}});this.trigger("submit",model)},_firePrevious:function(model){this.trigger("previous",model)},_fireCancel:function(confirm){this.trigger("cancel",confirm)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},isDirty:function(){return true}})})(JIRA.Admin.CustomFields,_,AJS.$,AJS,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStep.js' */
(function(namespace,Backbone,$,_){var CreateFieldStep=namespace.CreateFieldStep=function(options){this.options=_.extend({view:CreateFieldStep.Views.CreateDialog},options);this.api=options.api;this.inIssueContext=!!options.inIssueContext;this.stepData={}};_.extend(CreateFieldStep.prototype,namespace.Wizard.AbstractStep,{start:function(){var previousData=this.getPreviousData();var type=previousData.type;this.fieldTypeName=type.name;var viewOptions=_.extend(_.pick(this.options,["nextLabel","previousLabel"]),{configureOptions:!!type.options&&!type.cascading,typeName:type.name,fieldName:(previousData.field&&previousData.field.name)||""});var view=this.view=new this.options.view(viewOptions);this.listenTo(view,"submit",function(data){this.stepData.field={};this.stepData.field.name=data.name;this.stepData.field.description=data.description;this.stepData.field.options=data.options;this.view.disable();this.fireComplete()});this.listenTo(view,"previous",function(){this.firePrevious()});this.listenTo(view,"cancel",function(check){this.fireCancel(check)});return $.Deferred().resolve().promise()},restart:function(){var previousData=this.getPreviousData();if(this._hasFieldTypeChanged(previousData.type.name)){this.stopStep();return this.start()}else{this.view.updateData({typeName:previousData.type.name,fieldName:(previousData.field&&previousData.field.name)||""});return $.Deferred().resolve().promise()}},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},pauseStep:function(){this.view&&this.view.hide()},show:function(){this.view&&this.view.show()},doComplete:function(){var completes,data=this.getAccumulatedData();completes=this._resolveCompletesToExecute(data);return this.executeCompletes(completes,{api:this.api,data:data})},showErrors:function(fieldErrors,generalErrors){this.view.enable();this.view.showErrors(fieldErrors,generalErrors)},showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},getStepData:function(){return this.stepData},isDirty:function(){var field=this.stepData.field;var isStepDataDirty=field&&(field.name||field.options||field.description);return isStepDataDirty||(this.view&&this.view.isDirty())},_hasFieldTypeChanged:function(currentTypeName){return this.fieldTypeName!=currentTypeName},_resolveCompletesToExecute:function(data){var completes=[];completes.push(this.createField);if(data.field.options){completes.push(this.addOptions)}if(this.inIssueContext){completes.push(this.putFieldOnIssue);completes.push(this.refreshIssue)}return completes}},namespace.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStepDialog.js' */
(function(namespace,Backbone,$,_,AJS,Form){var CreateFieldStep=namespace.CreateFieldStep;var FormField=Form.Fields.FormField;CreateFieldStep.Views={};CreateFieldStep.Views.CreateDialog=function(options){this.options=_.defaults({},options,{previousLabel:"Previous",nextLabel:"Create",cancelLabel:"Cancel",panel:CreateFieldStep.Views.CreatePanel,fieldName:""});this.enabled=true};_.extend(CreateFieldStep.Views.CreateDialog.prototype,Backbone.Events,{initialize:function(options){this.options=options},show:function(){if(!this.dialog){var dialog=this.dialog=new namespace.Dialog({id:"customfields-configure-field",focusSelector:"#custom-field-name"});dialog.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",this.options.typeName));var panelOptions=_.defaults({},_.pick(this.options,"configureOptions"),{fieldName:this.options.fieldName});var panel=this.panel=dialog.addPanel("",new this.options.panel(panelOptions));this.listenTo(panel.view,"submit",_.bind(this._submit,this));this.previousButton=dialog.addButton({secondary:true,label:this.options.previousLabel,id:"customfields-configure-previous",click:_.bind(this._previous,this)});this.nextButton=dialog.addButton({label:this.options.nextLabel,id:"customfields-configure-next",submitAccessKey:true,click:function(){panel.view.triggerSubmit()}});dialog.addLink({label:this.options.cancelLabel,click:_.bind(this._cancel,this,false),cancelAccessKey:true});this.listenTo(dialog,"close",_.bind(this._cancel,this,true))}else{this.dialog.hideErrors()}this.dialog.show();return this},updateData:function(data){this.dialog.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",data.typeName));this.panel.view.updateData(data)},_previous:function(){this.trigger("previous")},_submit:function(){var view=this.panel.view;if(this.enabled){this.trigger("submit",view.getData())}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){this.stopListening(this.panel);if(this.dialog){this.dialog.destroy();delete this.dialog}return this},showErrors:function(fieldErrors,generalErrors){if(!this.panel.view.showErrors(fieldErrors,generalErrors)){this.panel.view.focus()}var allErrors=_.union(generalErrors,_.values(fieldErrors));this.dialog.showErrors(allErrors)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},disable:function(){this.enabled=false;this.panel.view.disable();this.nextButton.disable();this.previousButton.disable()},enable:function(){this.enabled=true;this.panel.view.enable();this.nextButton.enable();this.previousButton.enable()},isDirty:function(){return this.panel.view.isDirty()},_cancel:function(check){this.enabled&&this.trigger("cancel",check)}});CreateFieldStep.Views.CreatePanel=Backbone.Marionette.ItemView.extend({initialize:function(options){options=options||{};this.template=_.bind(this.template,this);this.form=options.form||this._createForm(options);this.listenTo(this.form,Form.EVENTS.submit,this._submit)},template:function(){return this.form.render().$el},_submit:function(){this.triggerMethod("submit")},triggerSubmit:function(){this.form.submit();return this},updateData:function(data){this.form.setValueOfFieldWithName("name",data.fieldName)},getData:function(){return this.form.toJSON()},onDialogPanelShow:function(){this.form.blur().focus()},showErrors:function(fieldErrors,generalErrors){return this.form.showErrors(fieldErrors,generalErrors)},focus:function(){this.form.focus();return this},disable:function(){this.form.disable();return this},enable:function(){this.form.enable();return this},isDirty:function(){return this.form.isDirty()},setValueOfFieldWithName:function(name,value){this.form.setValueOfFieldWithName(name,value)},_createForm:function(options){return new Form(this._createFormParams(options))},_createFormParams:function(options){var fields=[{content:JIRA.Templates.CustomFields.submitHack},{id:"custom-field-name",label:"Name",name:"name",type:"text",maxLength:255,required:true,size:FormField.SIZE.large,validator:Form.Validators.notEmpty("You must specify a name for this custom field."),value:options.fieldName},{id:"custom-field-description",label:"Description",name:"description",type:"textarea",rows:2,size:FormField.SIZE.large}];if(options.configureOptions){fields.push({required:true,label:"Options",field:new namespace.OptionsField({name:"options"}),id:"custom-field-options-input"})}return{fields:fields}}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,AJS,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/io/IssueCustomFields.js' */
(function(namespace,$,_){namespace.IssueCustomFields=function(options){options||(options={});_.extend(this,_.defaults(options,{autoCloseWebsudo:true}))};var standardErrorHandler=function(promise,statusText,smartAjaxResult){if(statusText!=="abort"){promise.reject(namespace.IssueCustomFields.STATUS.error,JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult))}else{promise.reject(namespace.IssueCustomFields.STATUS.abort,null)}};var partial=function(func){return _.bind.apply(_,[func,undefined].concat(_.toArray(arguments).slice(1)))};_.extend(namespace.IssueCustomFields.prototype,{getSharedBy:function(wrap){var fields=this;var def=$.Deferred();wrap.done(function(origData){var instance=this,args;if(_.isUndefined(fields.issue)){origData.sharedBy=[];def.resolveWith(this,arguments)}else{args=_.toArray(arguments);var ajax=fields._ajax({type:"GET",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",fields.issue,"affectedProjects"]),dataType:"json",contentType:"application/json"});ajax.done(function(sharedBy){origData.sharedBy=sharedBy;def.resolveWith(instance,args)});ajax.fail(function(){origData.sharedBy=[];def.resolveWith(instance,args)});ajax.progress(function(){def.notifyWith(instance,arguments)})}});wrap.fail(function(){def.rejectWith(this,arguments)});wrap.progress(function(){def.notifyWith(this,arguments)});return def.promise()},addFieldToScreen:function(field){var adding=$.Deferred();if(_.isUndefined(this.issue)){adding.reject(namespace.IssueCustomFields.STATUS.error,"No issue provided.")}else{var ajax=this._ajax({type:"POST",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",this.issue]),data:field,dataType:"json",contentType:"application/json"});ajax.done(adding.resolve);ajax.progress(adding.notify);ajax.fail(partial(standardErrorHandler,adding))}return adding.promise()},addField:function(field){var instance=this,data=_.pick(field,"name","description","searcherKey","type");var def=this._ajax({type:"POST",url:namespace.url("/rest/api/2/field"),context:this,data:JSON.stringify(data),dataType:"json",contentType:"application/json"});return def.pipe(undefined,function(statusText,smartAjaxResult){return instance._parseErrorCollection(smartAjaxResult,{fieldName:"name"})})},addableFields:function(onAllScreensFlag){var fields=$.Deferred();if(_.isUndefined(this.issue)){fields.reject(namespace.IssueCustomFields.STATUS.error,"No issue provided.")}else{var ajax=this._ajax({type:"GET",url:namespace.url(["rest","globalconfig",1,"issuecustomfields",this.issue,"fields"],{onAllScreensFlag:!!onAllScreensFlag}),contentType:"application/json"});ajax.done(fields.resolve);ajax.progress(fields.notify);ajax.fail(partial(standardErrorHandler,fields))}return fields.promise()},setOptions:function(fieldId,options){var def=this._ajax({type:"POST",url:namespace.url(["rest","globalconfig","1","customfieldoptions",fieldId]),context:this,data:JSON.stringify(options),dataType:"json",contentType:"application/json"});var wrapped=$.Deferred();def.done(wrapped.resolve);def.progress(wrapped.notify);def.fail(partial(standardErrorHandler,wrapped));return wrapped},getCustomFieldTypes:function(){var ajaxing=this._ajax({type:"GET",url:namespace.url("/rest/globalconfig/1/customfieldtypes"),dataType:"json",contentType:"application/json"});var wrapped=$.Deferred();ajaxing.done(wrapped.resolve);ajaxing.progress(wrapped.notify);ajaxing.fail(partial(standardErrorHandler,wrapped));return wrapped},_remapObject:function(object,mapping){var remapped={};_.each(object,function(value,key){var newName=mapping[key]||key;remapped[newName]=value});return remapped},_parseErrorCollection:function(response,mapping){var generalErrors,fieldErrors;if(response.hasData){try{var parsed=JSON.parse(response.data);if(!_.isEmpty(parsed.errorMessages)){generalErrors=parsed.errorMessages}if(!_.isEmpty(parsed.errors)){fieldErrors=parsed.errors;if(mapping){fieldErrors=this._remapObject(fieldErrors,mapping)}}}catch(e){}}if(!generalErrors&&!fieldErrors){generalErrors=[JIRA.SmartAjax.buildSimpleErrorContent(response)]}return{fields:fieldErrors||{},general:generalErrors||[]}},_ajax:function(ajaxOptions){var instance=this;var wrapped=$.Deferred();var ajax=JIRA.SmartAjax.makeWebSudoRequest(ajaxOptions,{beforeShow:function(){wrapped.notify(namespace.IssueCustomFields.PROGRESS.SHOW)},success:function(closeFunction){wrapped.notify(namespace.IssueCustomFields.PROGRESS.SUCCESS,closeFunction);instance.autoCloseWebsudo&&closeFunction()},cancel:function(e){e.preventDefault();wrapped.rejectWith(instance,["abort",undefined])}});ajax.done(function(){wrapped.resolveWith(this,_.toArray(arguments))});ajax.fail(function(xhr,statusText,errorThrown,smartAjaxResult){wrapped.rejectWith(this,[statusText,smartAjaxResult])});return wrapped.promise()}});namespace.IssueCustomFields.STATUS={abort:"abort",error:"error"};namespace.IssueCustomFields.PROGRESS={SHOW:"websudoShow",SUCCESS:"websudoSuccess"}}(JIRA.Admin.CustomFields,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/main.js' */
(function($,namespace,AJS){namespace.addCustomField=function(){var api,sharedStepOptions;api=new namespace.IssueCustomFields({autoCloseWebsudo:false});sharedStepOptions={api:api,inIssueContext:false};return new namespace.Wizard({sharedStepOptions:sharedStepOptions,firstStep:new namespace.TypeStep(sharedStepOptions),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."}).start().done(function(){AJS.trigger("analytics",{name:"administration.customfields.created.from.global"})})};namespace.addCustomFieldToIssue=function(issue){var api,sharedStepOptions,wizard;api=new namespace.IssueCustomFields({autoCloseWebsudo:false,issue:issue});sharedStepOptions={api:api,inIssueContext:true};wizard=new namespace.Wizard({sharedStepOptions:sharedStepOptions,firstStep:new namespace.FieldWisherStep(sharedStepOptions),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."});return wizard.start().fail(namespace.addCustomFieldToIssue._notifyFailure).done(namespace.addCustomFieldToIssue._analytics).done(function(data){wizard.close();namespace.addCustomFieldToIssue.editOrNotify(data.field)})};_.extend(namespace.addCustomFieldToIssue,{editOrNotify:function(field){if(!namespace.addCustomFieldToIssue._editValue(field)){namespace.addCustomFieldToIssue._notifySuccess()}},_editValue:function(field){var edit=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.editFieldOnSelectedIssue;return edit&&edit(field.id)},_notifyFailure:(function(){var stepsMessage=function(message,fails){showMessage(JIRA.Templates.CustomFields.addCompleteError({message:message,failedSteps:fails||[]}))};var showMessage=function(message){JIRA.Messages.showMsg(message,{type:JIRA.Messages.Types.ERROR,closeable:true})};return function(reason,options){var REASONS=namespace.Wizard.FAIL_REASON,data;options=options||{};data=options.data||{};if(reason===REASONS.abort){if(options.dirty){if(data.createField){stepsMessage("The field was created but the following operations were aborted:",options.notCompletedDescriptions)}else{showMessage("Unable to add field to issue.")}}}else{if(reason===REASONS.error){if(data.createField){stepsMessage("The field was created but the following operations failed:",options.notCompletedDescriptions)}else{showMessage("Unable to add field to issue.")}}}}}()),_notifySuccess:function(){JIRA.Messages.showMsg("The field was added successfully, but you do not have edit permissions.",{type:JIRA.Messages.Types.SUCCESS,closeable:true})},_analytics:function(data){if(data.createField){AJS.trigger("analytics",{name:"administration.customfields.created.and.added.to.issue"})}else{if(data.addField){AJS.trigger("analytics",{name:"administration.customfields.existing.added.to.issue"})}else{if(namespace.addCustomFieldToIssue._isFieldVisible(data.field.id)){AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.value"})}else{AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.no.value"})}}}},_isFieldVisible:function(fieldId){var field,fields,getFieldsOnSelectedIssue;getFieldsOnSelectedIssue=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.getFieldsOnSelectedIssue;fields=getFieldsOnSelectedIssue&&getFieldsOnSelectedIssue();field=fields&&fields.get(fieldId);return field&&field.matchesFieldSelector()}});$(document).on("click",".issueaction-fields-add",function(event){event.preventDefault();var issue=JIRA.Issues.Api.getSelectedIssueId();JIRA.Admin.CustomFields.addCustomFieldToIssue(issue)});$(document).on("click","#add_custom_fields",function(event){event.preventDefault();JIRA.Admin.CustomFields.addCustomField().done(function(data){var destination=namespace.url("/secure/admin/AssociateFieldToScreens!default.jspa",{fieldId:data.field.id,returnUrl:"ViewCustomFields.jspa"});AJS.reloadViaWindowLocation(destination)})})})(AJS.$,JIRA.Admin.CustomFields,AJS);
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-standalone-resources', location = 'js/gadgets-standalone.js' */
new gadgets.IfrGadgetService();gadgets.IfrGadgetService.prototype.setTitle=function(title){};
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:hipchat-user-link-support', location = 'user/hipchat-user-link.js' */
AJS.toInit(function(d){var a={removeLink:AJS.Meta.get("context-path")+"/rest/hipchat/integration/latest/oauth2"};var b="com.atlassian.plugins.base-hipchat-integration-plugin";var j=WRM.data instanceof Function?WRM.data:WRM.data.claim;var h=j(b+":hipchat-user-link-support.user-link-context");var e=(function(){var k=window.location;var l=AJS.Meta.get("context-path");var n=k.pathname;if(n.indexOf(AJS.Meta.get(""))){n=n.substr(l.length)}var m=k.search;if(m){m=m.substr(1)}return{path:n,query:m}})();function f(k){window.location.assign(k)}var i=function(){var k=d("<div></div>");k.css({position:"fixed",left:"50%",top:"50%"});d("body").append(k);k.spin("large")};var c=function(l){var k={url:h.beginOauth,type:"POST",contentType:"application/x-www-form-urlencoded",data:{redirect:e.path,redirectQuery:e.query}};d.ajax(k).done(f);l&&l.preventDefault&&l.preventDefault();i()};d(document).on("click",".hipchat-user-link",c);var g=function(l){var k={url:a.removeLink,type:"DELETE",contentType:"application/json"};d.ajax(k).always(function(){window.location.reload()});l&&l.preventDefault&&l.preventDefault();i()};d(document).delegate(".hipchat-user-unlink","click",g);window.HipChat=window.HipChat||{};window.HipChat.UserLink=window.HipChat.UserLink||{};window.HipChat.UserLink.context=h;window.HipChat.UserLink.linkUser=c;window.HipChat.UserLink.unlinkUser=g});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/jquery-amd.js' */
define("jquery",function(){return AJS.$});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/underscore-amd.js' */
define("underscore",function(){return _});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/ajs-amd.js' */
define("ajs",function(){return AJS});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/backbone-amd.js' */
define("backbone",function(){return Backbone});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/jira-query-amd.js' */
define("hipchat/jira/query-component",function(){return JIRA.Components.Query});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:amd', location = 'js/lib/amd/hipchat-scopes-provider-amd.js' */
define("hipchat/scopes-provider",function(){return HipChat.ScopesProvider});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:global', location = 'js/base.js' */
define("hipchat/base",["underscore","backbone","exports"],function(b,d,a){if(typeof HipChat=="undefined"||!HipChat){window.HipChat={}}function c(){a.View=d.View.extend({});a.Model=d.Model.extend({saveWrapper:function(e){this.trigger("waitingToSave");e.apply(this);this.trigger("saved")},addDebounceSave:function(e){this.save=b.wrap(b.debounce(this.save,e),this.saveWrapper)},traceAjaxRequests:function(j){var i=null;var h=i?"request:"+i:"request";var g=i?"sync:"+i:"sync";var e=i?"error:"+i:"error";var f=this;f.on(h,function(){JIRA.trace("ajax.request.started."+j)},this);f.on(g+" "+e,function(){JIRA.trace("ajax.request.completed."+j)},this)}});a.Collection=d.Collection;a.Events=d.Events}c()});
/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:data', location = 'js/data/data.js' */
(function(){if(!window.WRM){window.WRM={}}var a={};function b(d){if(!d){return d}return JSON.parse(d)}function c(e,d){return Object.prototype.hasOwnProperty.call(e,d)}WRM.data=function(d){if(!c(a,d)){if(WRM._unparsedData&&c(WRM._unparsedData,d)){var g=WRM._unparsedData[d];try{a[d]=b(g);WRM._unparsedData[d]=undefined}catch(f){console&&console.log&&console.log("JSON Error parsing data with key "+d+": "+f)}}else{a[d]=null}}return a[d]}}());
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:hipchat-installed-scopes', location = 'install/hipchat-scopes-provider.js' */
(function(){function a(){var e="com.atlassian.plugins.base-hipchat-integration-plugin";var d=WRM.data instanceof Function?WRM.data:WRM.data.claim;var b=d(e+":hipchat-installed-scopes.scopes");function c(f){return b[f]!==undefined}return{hasScope:c}}window.HipChat=window.HipChat||{};window.HipChat.ScopesProvider=a()})();
/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js/external/jquery/plugins/jquery.select2.js' */
(function(A){if(typeof A.fn.each2=="undefined"){A.fn.extend({each2:function(E){var C=A([0]),D=-1,B=this.length;while(++D<B&&(C.context=C[0]=this[D])&&E.call(C[0],D,C)!==false){}return this}})}})(jQuery);(function(b,K){if(window.Select2!==K){return }var i,l,V,C,A,N,M={x:0,y:0},T,U,i={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(m){m=m.which?m.which:m;switch(m){case i.LEFT:case i.RIGHT:case i.UP:case i.DOWN:return true}return false},isControl:function(n){var m=n.which;switch(m){case i.SHIFT:case i.CTRL:case i.ALT:return true}if(n.metaKey){return true}return false},isFunctionKey:function(m){m=m.which?m.which:m;return m>=112&&m<=123}},Z="<div class='select2-measure-scrollbar'></div>";T=b(document);A=(function(){var m=1;return function(){return m++}}());function O(o,p){var n=0,m=p.length;for(;n<m;n=n+1){if(R(o,p[n])){return n}}return -1}function k(){var m=b(Z);m.appendTo("body");var n={width:m.width()-m[0].clientWidth,height:m.height()-m[0].clientHeight};m.remove();return n}function R(n,m){if(n===m){return true}if(n===K||m===K){return false}if(n===null||m===null){return false}if(n.constructor===String){return n+""===m+""}if(m.constructor===String){return m+""===n+""}return false}function G(n,p){var q,o,m;if(n===null||n.length<1){return[]}q=n.split(p);for(o=0,m=q.length;o<m;o=o+1){q[o]=b.trim(q[o])}return q}function F(m){return m.outerWidth(false)-m.width()}function d(n){var m="keyup-change-value";n.on("keydown",function(){if(b.data(n,m)===K){b.data(n,m,n.val())}});n.on("keyup",function(){var o=b.data(n,m);if(o!==K&&n.val()!==o){b.removeData(n,m);n.trigger("keyup-change")}})}T.on("mousemove",function(m){M.x=m.pageX;M.y=m.pageY});function h(m){m.on("mousemove",function(o){var n=M;if(n===K||n.x!==o.pageX||n.y!==o.pageY){b(o.target).trigger("mousemove-filtered",o)}})}function I(p,n,m){m=m||K;var o;return function(){var q=arguments;window.clearTimeout(o);o=window.setTimeout(function(){n.apply(m,q)},p)}}function Q(o){var m=false,n;return function(){if(m===false){n=o();m=true}return n}}function J(m,o){var n=I(m,function(p){o.trigger("scroll-debounced",p)});o.on("scroll",function(p){if(O(p.target,o.get())>=0){n(p)}})}function g(m){if(m[0]===document.activeElement){return }window.setTimeout(function(){var o=m[0],p=m.val().length,n;m.focus();if(m.is(":visible")&&o===document.activeElement){if(o.setSelectionRange){o.setSelectionRange(p,p)}else{if(o.createTextRange){n=o.createTextRange();n.collapse(false);n.select()}}}},0)}function D(m){m=b(m)[0];var p=0;var n=0;if("selectionStart" in m){p=m.selectionStart;n=m.selectionEnd-p}else{if("selection" in document){m.focus();var o=document.selection.createRange();n=document.selection.createRange().text.length;o.moveStart("character",-m.value.length);p=o.text.length-n}}return{offset:p,length:n}}function Y(m){m.preventDefault();m.stopPropagation()}function B(m){m.preventDefault();m.stopImmediatePropagation()}function L(n){if(!N){var m=n[0].currentStyle||window.getComputedStyle(n[0],null);N=b(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:m.fontSize,fontFamily:m.fontFamily,fontStyle:m.fontStyle,fontWeight:m.fontWeight,letterSpacing:m.letterSpacing,textTransform:m.textTransform,whiteSpace:"nowrap"});N.attr("class","select2-sizer");b("body").append(N)}N.text(n.val());return N.width()}function H(n,r,m){var p,q=[],o;p=n.attr("class");if(p){p=""+p;b(p.split(" ")).each2(function(){if(this.indexOf("select2-")===0){q.push(this)}})}p=r.attr("class");if(p){p=""+p;b(p.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){o=m(this);if(o){q.push(this)}}})}n.attr("class",q.join(" "))}function S(r,q,o,m){var p=r.toUpperCase().indexOf(q.toUpperCase()),n=q.length;if(p<0){o.push(m(r));return }o.push(m(r.substring(0,p)));o.push("<span class='select2-match'>");o.push(m(r.substring(p,p+n)));o.push("</span>");o.push(m(r.substring(p+n,r.length)))}function e(m){var n={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(m).replace(/[&<>"'\/\\]/g,function(o){return n[o]})}function c(o){var r,n=0,p=null,s=o.quietMillis||100,q=o.url,m=this;return function(t){window.clearTimeout(r);r=window.setTimeout(function(){n+=1;var w=n,x=o.data,v=q,z=o.transport||b.fn.select2.ajaxDefaults.transport,u={type:o.type||"GET",cache:o.cache||false,jsonpCallback:o.jsonpCallback||K,dataType:o.dataType||"json"},y=b.extend({},b.fn.select2.ajaxDefaults.params,u);x=x?x.call(m,t.term,t.page,t.context):null;v=(typeof v==="function")?v.call(m,t.term,t.page,t.context):v;if(p){p.abort()}if(o.params){if(b.isFunction(o.params)){b.extend(y,o.params.call(m))}else{b.extend(y,o.params)}}b.extend(y,{url:v,dataType:o.dataType,data:x,success:function(AB){if(w<n){return }var AA=o.results(AB,t.page);t.callback(AA)}});p=z.call(m,y)},s)}}function f(n){var q=n,p,o,r=function(s){return""+s.text};if(b.isArray(q)){o=q;q={results:o}}if(b.isFunction(q)===false){o=q;q=function(){return o}}var m=q();if(m.text){r=m.text;if(!b.isFunction(r)){p=m.text;r=function(s){return s[p]}}}return function(v){var u=v.term,s={results:[]},w;if(u===""){v.callback(q());return }w=function(x,z){var y,t;x=x[0];if(x.children){y={};for(t in x){if(x.hasOwnProperty(t)){y[t]=x[t]}}y.children=[];b(x.children).each2(function(AA,AB){w(AB,y.children)});if(y.children.length||v.matcher(u,r(y),x)){z.push(y)}}else{if(v.matcher(u,r(x),x)){z.push(x)}}};b(q().results).each2(function(x,t){w(t,s.results)});v.callback(s)}}function X(n){var m=b.isFunction(n);return function(q){var p=q.term,o={results:[]};b(m?n():n).each(function(){var r=this.text!==K,s=r?this.text:this;if(p===""||q.matcher(p,s)){o.results.push(r?this:{id:this,text:this})}});q.callback(o)}}function W(m,n){if(b.isFunction(m)){return true}if(!m){return false}throw new Error(n+" must be a function or a falsy value")}function a(m){return b.isFunction(m)?m():m}function P(m){var n=0;b.each(m,function(o,p){if(p.children){n+=P(p.children)}else{n++}});return n}function E(u,v,s,m){var n=u,w=false,p,t,q,o,r;if(!m.createSearchChoice||!m.tokenSeparators||m.tokenSeparators.length<1){return K}while(true){t=-1;for(q=0,o=m.tokenSeparators.length;q<o;q++){r=m.tokenSeparators[q];t=u.indexOf(r);if(t>=0){break}}if(t<0){break}p=u.substring(0,t);u=u.substring(t+r.length);if(p.length>0){p=m.createSearchChoice.call(this,p,v);if(p!==K&&p!==null&&m.id(p)!==K&&m.id(p)!==null){w=false;for(q=0,o=v.length;q<o;q++){if(R(m.id(p),m.id(v[q]))){w=true;break}}if(!w){s(p)}}}}if(n!==u){return u}}function j(m,n){var o=function(){};o.prototype=new m;o.prototype.constructor=o;o.prototype.parent=m.prototype;o.prototype=b.extend(o.prototype,n);return o}l=j(Object,{bind:function(n){var m=this;return function(){n.apply(m,arguments)}},init:function(q){var o,n,r=".select2-results",p,m;this.opts=q=this.prepareOpts(q);this.id=q.id;if(q.element.data("select2")!==K&&q.element.data("select2")!==null){q.element.data("select2").destroy()}this.container=this.createContainer();this.containerId="s2id_"+(q.element.attr("id")||"autogen"+A());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=Q(function(){return q.element.closest("body")});H(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(a(q.containerCss));this.container.addClass(a(q.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(a(q.dropdownCssClass));this.dropdown.data("select2",this);this.results=o=this.container.find(r);this.search=n=this.container.find("input.select2-input");this.resultsPage=0;this.context=null;this.initContainer();h(this.results);this.dropdown.on("mousemove-filtered touchstart touchmove touchend",r,this.bind(this.highlightUnderEvent));J(80,this.results);this.dropdown.on("scroll-debounced",r,this.bind(this.loadMoreIfNeeded));b(this.container).on("change",".select2-input",function(s){s.stopPropagation()});b(this.dropdown).on("change",".select2-input",function(s){s.stopPropagation()});if(b.fn.mousewheel){o.mousewheel(function(w,x,u,t){var v=o.scrollTop(),s;if(t>0&&v-t<=0){o.scrollTop(0);Y(w)}else{if(t<0&&o.get(0).scrollHeight-o.scrollTop()+t<=o.height()){o.scrollTop(o.get(0).scrollHeight-o.height());Y(w)}}})}d(n);n.on("keyup-change input paste",this.bind(this.updateResults));n.on("focus",function(){n.addClass("select2-focused")});n.on("blur",function(){n.removeClass("select2-focused")});this.dropdown.on("mouseup",r,this.bind(function(s){if(b(s.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(s);this.selectHighlighted(s)}}));this.dropdown.on("click mouseup mousedown",function(s){s.stopPropagation()});if(b.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(q.maximumInputLength!==null){this.search.attr("maxlength",q.maximumInputLength)}var p=q.element.prop("disabled");if(p===K){p=false}this.enable(!p);var m=q.element.prop("readonly");if(m===K){m=false}this.readonly(m);U=U||k();this.autofocus=q.element.prop("autofocus");q.element.prop("autofocus",false);if(this.autofocus){this.focus()}},destroy:function(){var n=this.opts.element,m=n.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(m!==K){m.container.remove();m.dropdown.remove();n.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||false);if(this.elementTabIndex){n.attr({tabindex:this.elementTabIndex})}else{n.removeAttr("tabindex")}n.show()}},optionToData:function(m){if(m.is("option")){return{id:m.prop("value"),text:m.text(),element:m.get(),css:m.attr("class"),disabled:m.prop("disabled"),locked:R(m.attr("locked"),"locked")||R(m.data("locked"),true)}}else{if(m.is("optgroup")){return{text:m.attr("label"),children:[],element:m.get(),css:m.attr("class")}}}},prepareOpts:function(r){var p,n,m,q,o=this;p=r.element;if(p.get(0).tagName.toLowerCase()==="select"){this.select=n=r.element}if(n){b.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in r){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}r=b.extend({},{populateResults:function(t,v,y){var x,w,s,u,z=this.opts.id;x=function(AG,AA,AF){var AH,AC,AM,AJ,AD,AL,AB,AK,AI,AE;AG=r.sortResults(AG,AA,y);for(AH=0,AC=AG.length;AH<AC;AH=AH+1){AM=AG[AH];AD=(AM.disabled===true);AJ=(!AD)&&(z(AM)!==K);AL=AM.children&&AM.children.length>0;AB=b("<li></li>");AB.addClass("select2-results-dept-"+AF);AB.addClass("select2-result");AB.addClass(AJ?"select2-result-selectable":"select2-result-unselectable");if(AD){AB.addClass("select2-disabled")}if(AL){AB.addClass("select2-result-with-children")}AB.addClass(o.opts.formatResultCssClass(AM));AK=b(document.createElement("div"));AK.addClass("select2-result-label");AE=r.formatResult(AM,AK,y,o.opts.escapeMarkup);if(AE!==K){AK.html(AE)}AB.append(AK);if(AL){AI=b("<ul></ul>");AI.addClass("select2-result-sub");x(AM.children,AI,AF+1);AB.append(AI)}AB.data("select2-data",AM);AA.append(AB)}};x(v,t,0)}},b.fn.select2.defaults,r);if(typeof (r.id)!=="function"){m=r.id;r.id=function(s){return s[m]}}if(b.isArray(r.element.data("select2Tags"))){if("tags" in r){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+r.element.attr("id")}r.tags=r.element.data("select2Tags")}if(n){r.query=this.bind(function(w){var v={results:[],more:false},u=w.term,t,s,x;x=function(y,AA){var z;if(y.is("option")){if(w.matcher(u,y.text(),y)){AA.push(o.optionToData(y))}}else{if(y.is("optgroup")){z=o.optionToData(y);y.children().each2(function(AB,AC){x(AC,z.children)});if(z.children.length>0){AA.push(z)}}}};t=p.children();if(this.getPlaceholder()!==K&&t.length>0){s=this.getPlaceholderOption();if(s){t=t.not(s)}}t.each2(function(y,z){x(z,v.results)});w.callback(v)});r.id=function(s){return s.id};r.formatResultCssClass=function(s){return s.css}}else{if(!("query" in r)){if("ajax" in r){q=r.element.data("ajax-url");if(q&&q.length>0){r.ajax.url=q}r.query=c.call(r.element,r.ajax)}else{if("data" in r){r.query=f(r.data)}else{if("tags" in r){r.query=X(r.tags);if(r.createSearchChoice===K){r.createSearchChoice=function(s){return{id:s,text:s}}}if(r.initSelection===K){r.initSelection=function(s,u){var t=[];b(G(s.val(),r.separator)).each(function(){var x=this,w=this,v=r.tags;if(b.isFunction(v)){v=v()}b(v).each(function(){if(R(this.id,x)){w=this.text;return false}});t.push({id:x,text:w})});u(t)}}}}}}}if(typeof (r.query)!=="function"){throw"query function not defined for Select2 "+r.element.attr("id")}return r},monitorSource:function(){var m=this.opts.element,n;m.on("change.select2",this.bind(function(o){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));n=this.bind(function(){var q,p,o=this;var r=m.prop("disabled");if(r===K){r=false}this.enable(!r);var p=m.prop("readonly");if(p===K){p=false}this.readonly(p);H(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(a(this.opts.containerCssClass));H(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(a(this.opts.dropdownCssClass))});m.on("propertychange.select2 DOMAttrModified.select2",n);if(this.mutationCallback===K){this.mutationCallback=function(o){o.forEach(n)}}if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(this.mutationCallback);this.propertyObserver.observe(m.get(0),{attributes:true,subtree:false})}},triggerSelect:function(n){var m=b.Event("select2-selecting",{val:this.id(n),object:n});this.opts.element.trigger(m);return !m.isDefaultPrevented()},triggerChange:function(m){m=m||{};m=b.extend({},m,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(m);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},isInterfaceEnabled:function(){return this.enabledInterface===true},enableInterface:function(){var m=this._enabled&&!this._readonly,n=!m;if(m===this.enabledInterface){return false}this.container.toggleClass("select2-container-disabled",n);this.close();this.enabledInterface=m;return true},enable:function(m){if(m===K){m=true}if(this._enabled===m){return false}this._enabled=m;this.opts.element.prop("disabled",!m);this.enableInterface();return true},readonly:function(m){if(m===K){m=false}if(this._readonly===m){return false}this._readonly=m;this.opts.element.prop("readonly",m);this.enableInterface();return true},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var o=this.dropdown,q=this.container.offset(),x=this.container.outerHeight(false),y=this.container.outerWidth(false),u=o.outerHeight(false),n=b(window).scrollLeft()+b(window).width(),AB=b(window).scrollTop()+b(window).height(),p=q.top+x,z=q.left,m=p+u<=AB,s=(q.top-u)>=this.body().scrollTop(),v=o.outerWidth(false),AD=z+v<=n,AC=o.hasClass("select2-drop-above"),r,AA,t,w;if(this.opts.dropdownAutoWidth){w=b(".select2-results",o)[0];o.addClass("select2-drop-auto-width");o.css("width","");v=o.outerWidth(false)+(w.scrollHeight===w.clientHeight?0:U.width);v>y?y=v:v=y;AD=z+v<=n}else{this.container.removeClass("select2-drop-auto-width")}if(this.body().css("position")!=="static"){r=this.body().offset();p-=r.top;z-=r.left}if(AC){AA=true;if(!s&&m){AA=false}}else{AA=false;if(!m&&s){AA=true}}if(!AD){z=q.left+y-v}if(AA){p=q.top-u;this.container.addClass("select2-drop-above");o.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");o.removeClass("select2-drop-above")}t=b.extend({top:p,left:z,width:y},a(this.opts.dropdownCss));o.css(t)},shouldOpen:function(){var m;if(this.opened()){return false}if(this._enabled===false||this._readonly===true){return false}m=b.Event("select2-opening");this.opts.element.trigger(m);return !m.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}this.opening();return true},opening:function(){var t=this.containerId,m="scroll."+t,q="resize."+t,p="orientationchange."+t,n,s;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}n=b("#select2-drop-mask");if(n.length==0){n=b(document.createElement("div"));n.attr("id","select2-drop-mask").attr("class","select2-drop-mask");n.hide();n.appendTo(this.body());n.on("mousedown touchstart click",function(v){var w=b("#select2-drop"),u;if(w.length>0){u=w.data("select2");if(u.opts.selectOnBlur){u.selectHighlighted({noFocus:true})}u.close();v.preventDefault();v.stopPropagation()}})}if(this.dropdown.prev()[0]!==n[0]){this.dropdown.before(n)}b("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");s=o();n.css(s).show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var r=this;this.container.parents().add(window).each(function(){b(this).on(q+" "+m+" "+p,function(u){var v=o();b("#select2-drop-mask").css(v);r.positionDropdown()})});function o(){return{width:Math.max(document.documentElement.scrollWidth,b(window).width()),height:Math.max(document.documentElement.scrollHeight,b(window).height())}}},close:function(){if(!this.opened()){return }var p=this.containerId,m="scroll."+p,o="resize."+p,n="orientationchange."+p;this.container.parents().add(window).each(function(){b(this).off(m).off(o).off(n)});this.clearDropdownAlignmentPreference();b("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger(b.Event("select2-close"))},externalSearch:function(m){this.open();this.search.val(m);this.updateResults(false)},clearSearch:function(){},getMaximumSelectionSize:function(){return a(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var p=this.results,o,m,t,s,q,r,n;m=this.highlight();if(m<0){return }if(m==0){p.scrollTop(0);return }o=this.findHighlightableChoices().find(".select2-result-label");t=b(o[m]);s=t.offset().top+t.outerHeight(true);if(m===o.length-1){n=p.find("li.select2-more-results");if(n.length>0){s=n.offset().top+n.outerHeight(true)}}q=p.offset().top+p.outerHeight(true);if(s>q){p.scrollTop(p.scrollTop()+(s-q))}r=t.offset().top-p.offset().top;if(r<0&&t.css("display")!="none"){p.scrollTop(p.scrollTop()+r)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(p){var o=this.findHighlightableChoices(),n=this.highlight();while(n>-1&&n<o.length){n+=p;var m=b(o[n]);if(m.hasClass("select2-result-selectable")&&!m.hasClass("select2-disabled")&&!m.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(n){var p=this.findHighlightableChoices(),m,o;if(arguments.length===0){return O(p.filter(".select2-highlighted")[0],p.get())}if(n>=p.length){n=p.length-1}if(n<0){n=0}this.results.find(".select2-highlighted").removeClass("select2-highlighted");m=b(p[n]);m.addClass("select2-highlighted");this.ensureHighlightVisible();o=m.data("select2-data");if(o){this.opts.element.trigger({type:"select2-highlight",val:this.id(o),choice:o})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(n){var m=b(n.target).closest(".select2-result-selectable");if(m.length>0&&!m.is(".select2-highlighted")){var o=this.findHighlightableChoices();this.highlight(o.index(m))}else{if(m.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var q=this.results,p=q.find("li.select2-more-results"),t,s=-1,r=this.resultsPage+1,m=this,o=this.search.val(),n=this.context;if(p.length===0){return }t=p.offset().top-q.offset().top-q.height();if(t<=this.opts.loadMorePadding){p.addClass("select2-active");this.opts.query({element:this.opts.element,term:o,page:r,context:n,matcher:this.opts.matcher,callback:this.bind(function(u){if(!m.opened()){return }m.opts.populateResults.call(this,q,u.results,{term:o,page:r,context:n});m.postprocessResults(u,false,false);if(u.more===true){p.detach().appendTo(q).text(m.opts.formatLoadMore(r+1));window.setTimeout(function(){m.loadMoreIfNeeded()},10)}else{p.remove()}m.positionDropdown();m.resultsPage=r;m.context=u.context})})}},tokenize:function(){},updateResults:function(u){var x=this.search,s=this.results,m=this.opts,r,w=this,v,q=x.val(),o=b.data(this.container,"select2-last-term");if(u!==true&&o&&R(q,o)){return }b.data(this.container,"select2-last-term",q);if(u!==true&&(this.showSearchInput===false||!this.opened())){return }function t(){x.removeClass("select2-active");w.positionDropdown()}function n(y){s.html(y);t()}var p=this.getMaximumSelectionSize();if(p>=1){r=this.data();if(b.isArray(r)&&r.length>=p&&W(m.formatSelectionTooBig,"formatSelectionTooBig")){n("<li class='select2-selection-limit'>"+m.formatSelectionTooBig(p)+"</li>");return }}if(x.val().length<m.minimumInputLength){if(W(m.formatInputTooShort,"formatInputTooShort")){n("<li class='select2-no-results'>"+m.formatInputTooShort(x.val(),m.minimumInputLength)+"</li>")}else{n("")}if(u&&this.showSearch){this.showSearch(true)}return }if(m.maximumInputLength&&x.val().length>m.maximumInputLength){if(W(m.formatInputTooLong,"formatInputTooLong")){n("<li class='select2-no-results'>"+m.formatInputTooLong(x.val(),m.maximumInputLength)+"</li>")}else{n("")}return }if(m.formatSearching&&this.findHighlightableChoices().length===0){n("<li class='select2-searching'>"+m.formatSearching()+"</li>")}x.addClass("select2-active");v=this.tokenize();if(v!=K&&v!=null){x.val(v)}this.resultsPage=1;m.query({element:m.element,term:x.val(),page:this.resultsPage,context:null,matcher:m.matcher,callback:this.bind(function(z){var y;if(!this.opened()){this.search.removeClass("select2-active");return }this.context=(z.context===K)?null:z.context;if(this.opts.createSearchChoice&&x.val()!==""){y=this.opts.createSearchChoice.call(w,x.val(),z.results);if(y!==K&&y!==null&&w.id(y)!==K&&w.id(y)!==null){if(b(z.results).filter(function(){return R(w.id(this),w.id(y))}).length===0){z.results.unshift(y)}}}if(z.results.length===0&&W(m.formatNoMatches,"formatNoMatches")){n("<li class='select2-no-results'>"+m.formatNoMatches(x.val())+"</li>");return }s.empty();w.opts.populateResults.call(this,s,z.results,{term:x.val(),page:this.resultsPage,context:null});if(z.more===true&&W(m.formatLoadMore,"formatLoadMore")){s.append("<li class='select2-more-results'>"+w.opts.escapeMarkup(m.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){w.loadMoreIfNeeded()},10)}this.postprocessResults(z,u);t();this.opts.element.trigger({type:"select2-loaded",items:z})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){g(this.search)},selectHighlighted:function(n){var m=this.highlight(),o=this.results.find(".select2-highlighted"),p=o.closest(".select2-result").data("select2-data");if(p){this.highlight(m);this.onSelect(p,n)}else{if(n&&n.noFocus){this.close()}}},getPlaceholder:function(){var m;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((m=this.getPlaceholderOption())!==K?m.text():K)},getPlaceholderOption:function(){if(this.select){var m=this.select.children().first();if(this.opts.placeholderOption!==K){return(this.opts.placeholderOption==="first"&&m)||(typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select))}else{if(m.text()===""&&m.val()===""){return m}}}},initContainerWidth:function(){function n(){var r,p,s,q,o;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){r=this.opts.element.attr("style");if(r!==K){p=r.split(";");for(q=0,o=p.length;q<o;q=q+1){s=p[q].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(s!==null&&s.length>=1){return s[1]}}}if(this.opts.width==="resolve"){r=this.opts.element.css("width");if(r.indexOf("%")>0){return r}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(b.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var m=n.call(this);if(m!==null){this.container.css("width",m)}}});V=j(l,{createContainer:function(){var m=b(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return m},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled())}},opening:function(){var o,n,m;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true)}this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.search.focus();o=this.search.get(0);if(o.createTextRange){n=o.createTextRange();n.collapse(false);n.select()}else{if(o.setSelectionRange){m=this.search.val().length;o.setSelectionRange(m,m)}}this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger(b.Event("select2-open"))},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var n,m=this.container,o=this.dropdown;if(this.opts.minimumResultsForSearch<0){this.showSearch(false)}else{this.showSearch(true)}this.selection=n=m.find(".select2-choice");this.focusser=m.find(".select2-focusser");this.focusser.attr("id","s2id_autogen"+A());b("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.focusser.attr("tabindex",this.elementTabIndex);this.search.on("keydown",this.bind(function(p){if(!this.isInterfaceEnabled()){return }if(p.which===i.PAGE_UP||p.which===i.PAGE_DOWN){Y(p);return }switch(p.which){case i.UP:case i.DOWN:this.moveHighlight((p.which===i.UP)?-1:1);Y(p);return ;case i.ENTER:this.selectHighlighted();Y(p);return ;case i.TAB:this.selectHighlighted({noFocus:true});return ;case i.ESC:this.cancel(p);Y(p);return }}));this.search.on("blur",this.bind(function(p){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){this.search.focus()}),0)}}));this.focusser.on("keydown",this.bind(function(p){if(!this.isInterfaceEnabled()){return }if(p.which===i.TAB||i.isControl(p)||i.isFunctionKey(p)||p.which===i.ESC){return }if(this.opts.openOnEnter===false&&p.which===i.ENTER){Y(p);return }if(p.which==i.DOWN||p.which==i.UP||(p.which==i.ENTER&&this.opts.openOnEnter)){if(p.altKey||p.ctrlKey||p.shiftKey||p.metaKey){return }this.open();Y(p);return }if(p.which==i.DELETE||p.which==i.BACKSPACE){if(this.opts.allowClear){this.clear()}Y(p);return }}));d(this.focusser);this.focusser.on("keyup-change input",this.bind(function(p){if(this.opts.minimumResultsForSearch>=0){p.stopPropagation();if(this.opened()){return }this.open()}}));n.on("mousedown","abbr",this.bind(function(p){if(!this.isInterfaceEnabled()){return }this.clear();B(p);this.close();this.selection.focus()}));n.on("mousedown",this.bind(function(p){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(b.Event("select2-focus"))}if(this.opened()){this.close()}else{if(this.isInterfaceEnabled()){this.open()}}Y(p)}));o.on("mousedown",this.bind(function(){this.search.focus()}));n.on("focus",this.bind(function(p){Y(p)}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(b.Event("select2-focus"))}this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger(b.Event("select2-blur"))}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(b.Event("select2-focus"))}this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder()},clear:function(n){var o=this.selection.data("select2-data");if(o){var m=this.getPlaceholderOption();this.opts.element.val(m?m.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(n!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(o),choice:o});this.triggerChange({removed:o})}}},initSelection:function(){var n;if(this.isPlaceholderOptionSelected()){this.updateSelection([]);this.close();this.setPlaceholder()}else{var m=this;this.opts.initSelection.call(null,this.opts.element,function(o){if(o!==K&&o!==null){m.updateSelection(o);m.close();m.setPlaceholder()}})}},isPlaceholderOptionSelected:function(){var m;return((m=this.getPlaceholderOption())!==K&&m.is(":selected"))||(this.opts.element.val()==="")||(this.opts.element.val()===K)||(this.opts.element.val()===null)},prepareOpts:function(){var n=this.parent.prepareOpts.apply(this,arguments),m=this;if(n.element.get(0).tagName.toLowerCase()==="select"){n.initSelection=function(o,q){var p=o.find(":selected");q(m.optionToData(p))}}else{if("data" in n){n.initSelection=n.initSelection||function(p,r){var q=p.val();var o=null;n.query({matcher:function(s,v,t){var u=R(q,n.id(t));if(u){o=t}return u},callback:!b.isFunction(r)?b.noop:function(){r(o)}})}}}return n},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===K){return K}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var m=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&m!==K){if(this.select&&this.getPlaceholderOption()===K){return }this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(m));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear")}},postprocessResults:function(r,n,q){var p=0,m=this,s=true;this.findHighlightableChoices().each2(function(t,u){if(R(m.id(u.data("select2-data")),m.opts.element.val())){p=t;return false}});if(q!==false){if(n===true&&p>=0){this.highlight(p)}else{this.highlight(0)}}if(n===true){var o=this.opts.minimumResultsForSearch;if(o>=0){this.showSearch(P(r.results)>=o)}}},showSearch:function(m){if(this.showSearchInput===m){return }this.showSearchInput=m;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!m);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!m);b(this.dropdown,this.container).toggleClass("select2-with-searchbox",m)},onSelect:function(o,n){if(!this.triggerSelect(o)){return }var m=this.opts.element.val(),p=this.data();this.opts.element.val(this.id(o));this.updateSelection(o);this.opts.element.trigger({type:"select2-selected",val:this.id(o),choice:o});this.close();if(!n||!n.noFocus){this.selection.focus()}if(!R(m,this.id(o))){this.triggerChange({added:o,removed:p})}},updateSelection:function(p){var n=this.selection.find(".select2-chosen"),o,m;this.selection.data("select2-data",p);n.empty();o=this.opts.formatSelection(p,n,this.opts.escapeMarkup);if(o!==K){n.append(o)}m=this.opts.formatSelectionCssClass(p,n);if(m!==K){n.addClass(m)}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==K){this.container.addClass("select2-allowclear")}},val:function(){var q,n=false,o=null,m=this,p=this.data();if(arguments.length===0){return this.opts.element.val()}q=arguments[0];if(arguments.length>1){n=arguments[1]}if(this.select){this.select.val(q).find(":selected").each2(function(r,s){o=m.optionToData(s);return false});this.updateSelection(o);this.setPlaceholder();if(n){this.triggerChange({added:o,removed:p})}}else{if(!q&&q!==0){this.clear(n);return }if(this.opts.initSelection===K){throw new Error("cannot call val() if initSelection() is not defined")}this.opts.element.val(q);this.opts.initSelection(this.opts.element,function(r){m.opts.element.val(!r?"":m.id(r));m.updateSelection(r);m.setPlaceholder();if(n){m.triggerChange({added:r,removed:p})}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(o,m){var n;if(arguments.length===0){n=this.selection.data("select2-data");if(n==K){n=null}return n}else{if(!o||o===""){this.clear(m)}else{n=this.data();this.opts.element.val(!o?"":this.id(o));this.updateSelection(o);if(m){this.triggerChange({added:o,removed:n})}}}}});C=j(l,{createContainer:function(){var m=b(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitilize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return m},prepareOpts:function(){var n=this.parent.prepareOpts.apply(this,arguments),m=this;if(n.element.get(0).tagName.toLowerCase()==="select"){n.initSelection=function(o,q){var p=[];o.find(":selected").each2(function(r,s){p.push(m.optionToData(s))});q(p)}}else{if("data" in n){n.initSelection=n.initSelection||function(o,r){var p=G(o.val(),n.separator);var q=[];n.query({matcher:function(s,v,t){var u=b.grep(p,function(w){return R(w,n.id(t))}).length;if(u){q.push(t)}return u},callback:!b.isFunction(r)?b.noop:function(){var s=[];for(var v=0;v<p.length;v++){var w=p[v];for(var u=0;u<q.length;u++){var t=q[u];if(R(w,n.id(t))){s.push(t);q.splice(u,1);break}}}r(s)}})}}}return n},selectChoice:function(m){var n=this.container.find(".select2-search-choice-focus");if(n.length&&m&&m[0]==n[0]){}else{if(n.length){this.opts.element.trigger("choice-deselected",n)}n.removeClass("select2-search-choice-focus");if(m&&m.length){this.close();m.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",m)}}},initContainer:function(){var m=".select2-choices",n;this.searchContainer=this.container.find(".select2-search-field");this.selection=n=this.container.find(m);var o=this;this.selection.on("mousedown",".select2-search-choice",function(p){o.search[0].focus();o.selectChoice(b(this))});this.search.attr("id","s2id_autogen"+A());b("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id"));this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.opened()){this.open()}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(t){if(!this.isInterfaceEnabled()){return }++this.keydowns;var r=n.find(".select2-search-choice-focus");var s=r.prev(".select2-search-choice:not(.select2-locked)");var q=r.next(".select2-search-choice:not(.select2-locked)");var u=D(this.search);if(r.length&&(t.which==i.LEFT||t.which==i.RIGHT||t.which==i.BACKSPACE||t.which==i.DELETE||t.which==i.ENTER)){var p=r;if(t.which==i.LEFT&&s.length){p=s}else{if(t.which==i.RIGHT){p=q.length?q:null}else{if(t.which===i.BACKSPACE){this.unselect(r.first());this.search.width(10);p=s.length?s:q}else{if(t.which==i.DELETE){this.unselect(r.first());this.search.width(10);p=q.length?q:null}else{if(t.which==i.ENTER){p=null}}}}}this.selectChoice(p);Y(t);if(!p||!p.length){this.open()}return }else{if(((t.which===i.BACKSPACE&&this.keydowns==1)||t.which==i.LEFT)&&(u.offset==0&&!u.length)){this.selectChoice(n.find(".select2-search-choice:not(.select2-locked)").last());Y(t);return }else{this.selectChoice(null)}}if(this.opened()){switch(t.which){case i.UP:case i.DOWN:this.moveHighlight((t.which===i.UP)?-1:1);Y(t);return ;case i.ENTER:this.selectHighlighted();Y(t);return ;case i.TAB:this.selectHighlighted({noFocus:true});this.close();return ;case i.ESC:this.cancel(t);Y(t);return }}if(t.which===i.TAB||i.isControl(t)||i.isFunctionKey(t)||t.which===i.BACKSPACE||t.which===i.ESC){return }if(t.which===i.ENTER){if(this.opts.openOnEnter===false){return }else{if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey){return }}}this.open();if(t.which===i.PAGE_UP||t.which===i.PAGE_DOWN){Y(t)}if(t.which===i.ENTER){Y(t)}}));this.search.on("keyup",this.bind(function(p){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(p){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened()){this.clearSearch()}p.stopImmediatePropagation();this.opts.element.trigger(b.Event("select2-blur"))}));this.container.on("click",m,this.bind(function(p){if(!this.isInterfaceEnabled()){return }if(b(p.target).closest(".select2-search-choice").length>0){return }this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(b.Event("select2-focus"))}this.open();this.focusSearch();p.preventDefault()}));this.container.on("focus",m,this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(b.Event("select2-focus"))}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch()},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled())}},initSelection:function(){var n;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var m=this;this.opts.initSelection.call(null,this.opts.element,function(o){if(o!==K&&o!==null){m.updateSelection(o);m.close();m.clearSearch()}})}},clearSearch:function(){var n=this.getPlaceholder(),m=this.getMaxSearchWidth();if(n!==K&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(n).addClass("select2-default");this.search.width(m>0?m:this.container.css("width"))}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.updateResults(true);this.search.focus();this.opts.element.trigger(b.Event("select2-open"))},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(p){var o=[],n=[],m=this;b(p).each(function(){if(O(m.id(this),o)<0){o.push(m.id(this));n.push(this)}});p=n;this.selection.find(".select2-search-choice").remove();b(p).each(function(){m.addSelectedChoice(this)});m.postprocessResults()},tokenize:function(){var m=this.search.val();m=this.opts.tokenizer.call(this,m,this.data(),this.bind(this.onSelect),this.opts);if(m!=null&&m!=K){this.search.val(m);if(m.length>0){this.open()}}},onSelect:function(n,m){if(!this.triggerSelect(n)){return }this.addSelectedChoice(n);this.opts.element.trigger({type:"selected",val:this.id(n),choice:n});if(this.select||!this.opts.closeOnSelect){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:n});if(!m||!m.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(q){var s=!q.locked,o=b("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),t=b("<li class='select2-search-choice select2-locked'><div></div></li>");var p=s?o:t,m=this.id(q),n=this.getVal(),r,u;r=this.opts.formatSelection(q,p.find("div"),this.opts.escapeMarkup);if(r!=K){p.find("div").replaceWith("<div>"+r+"</div>")}u=this.opts.formatSelectionCssClass(q,p.find("div"));if(u!=K){p.addClass(u)}if(s){p.find(".select2-search-choice-close").on("mousedown",Y).on("click dblclick",this.bind(function(v){if(!this.isInterfaceEnabled()){return }b(v.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(b(v.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();Y(v)})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled()){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}p.data("select2-data",q);p.insertBefore(this.searchContainer);n.push(m);this.setVal(n)},unselect:function(n){var p=this.getVal(),o,m;n=n.closest(".select2-search-choice");if(n.length===0){throw"Invalid argument: "+n+". Must be .select2-search-choice"}o=n.data("select2-data");if(!o){return }m=O(this.id(o),p);if(m>=0){p.splice(m,1);this.setVal(p);if(this.select){this.postprocessResults()}}n.remove();this.opts.element.trigger({type:"removed",val:this.id(o),choice:o});this.triggerChange({removed:o})},postprocessResults:function(q,n,p){var r=this.getVal(),s=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),m=this;s.each2(function(u,t){var v=m.id(t.data("select2-data"));if(O(v,r)>=0){t.addClass("select2-selected");t.find(".select2-result-selectable").addClass("select2-selected")}});o.each2(function(u,t){if(!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0){t.addClass("select2-selected")}});if(this.highlight()==-1&&p!==false){m.highlight(0)}if(!this.opts.createSearchChoice&&!s.filter(".select2-result:not(.select2-selected)").length>0){if(!q||q&&!q.more&&this.results.find(".select2-no-results").length===0){if(W(m.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+m.opts.formatNoMatches(m.search.val())+"</li>")}}}},getMaxSearchWidth:function(){return this.selection.width()-F(this.search)},resizeSearch:function(){var r,p,o,m,n,q=F(this.search);r=L(this.search)+10;p=this.search.offset().left;o=this.selection.width();m=this.selection.offset().left;n=o-(p-m)-q;if(n<r){n=o-q}if(n<40){n=o-q}if(n<=0){n=r}this.search.width(Math.floor(n))},getVal:function(){var m;if(this.select){m=this.select.val();return m===null?[]:m}else{m=this.opts.element.val();return G(m,this.opts.separator)}},setVal:function(n){var m;if(this.select){this.select.val(n)}else{m=[];b(n).each(function(){if(O(this,m)<0){m.push(this)}});this.opts.element.val(m.length===0?"":m.join(this.opts.separator))}},buildChangeDetails:function(m,p){var p=p.slice(0),m=m.slice(0);for(var o=0;o<p.length;o++){for(var n=0;n<m.length;n++){if(R(this.opts.id(p[o]),this.opts.id(m[n]))){p.splice(o,1);o--;m.splice(n,1);n--}}}return{added:p,removed:m}},val:function(q,n){var p,m=this,o;if(arguments.length===0){return this.getVal()}p=this.data();if(!p.length){p=[]}if(!q&&q!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(n){this.triggerChange({added:this.data(),removed:p})}return }this.setVal(q);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(n){this.triggerChange(this.buildChangeDetails(p,this.data()))}}else{if(this.opts.initSelection===K){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(s){var r=b.map(s,m.id);m.setVal(r);m.updateSelection(s);m.clearSearch();if(n){m.triggerChange(this.buildChangeDetails(p,this.data()))}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var n=[],m=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){n.push(m.opts.id(b(this).data("select2-data")))});this.setVal(n);this.triggerChange()},data:function(o,p){var n=this,q,m;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return b(this).data("select2-data")}).get()}else{m=this.data();if(!o){o=[]}q=b.map(o,function(r){return n.opts.id(r)});this.setVal(q);this.updateSelection(o);this.clearSearch();if(p){this.triggerChange(this.buildChangeDetails(m,this.data()))}}}});b.fn.select2=function(){var q=Array.prototype.slice.call(arguments,0),n,p,m,s,u,t=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","readonly","positionDropdown","data","search"],r=["val","opened","isFocused","container","data"],o={search:"externalSearch"};this.each(function(){if(q.length===0||typeof (q[0])==="object"){n=q.length===0?{}:b.extend({},q[0]);n.element=b(this);if(n.element.get(0).tagName.toLowerCase()==="select"){u=n.element.prop("multiple")}else{u=n.multiple||false;if("tags" in n){n.multiple=u=true}}p=u?new C():new V();p.init(n)}else{if(typeof (q[0])==="string"){if(O(q[0],t)<0){throw"Unknown method: "+q[0]}s=K;p=b(this).data("select2");if(p===K){return }m=q[0];if(m==="container"){s=p.container}else{if(m==="dropdown"){s=p.dropdown}else{if(o[m]){m=o[m]}s=p[m].apply(p,q.slice(1))}}if(O(q[0],r)>=0){return false}}else{throw"Invalid arguments to select2 plugin: "+q}}});return(s===K)?this:s};b.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(n,o,q,m){var p=[];S(n.text,q.term,p,m);return p.join("")},formatSelection:function(o,n,m){return o?m(o.text):K},sortResults:function(n,m,o){return n},formatResultCssClass:function(m){return K},formatSelectionCssClass:function(n,m){return K},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(m,o){var p=o-m.length;return"Please enter "+p+" more character"+(p==1?"":"s")},formatInputTooLong:function(o,m){var p=o.length-m;return"Please delete "+p+" character"+(p==1?"":"s")},formatSelectionTooBig:function(m){return"You can only select "+m+" item"+(m==1?"":"s")},formatLoadMore:function(m){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(m){return m.id},matcher:function(m,n){return(""+n).toUpperCase().indexOf((""+m).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:E,escapeMarkup:e,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(m){return m},adaptDropdownCssClass:function(m){return null}};b.fn.select2.ajaxDefaults={transport:b.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:c,local:f,tags:X},util:{debounce:I,markMatch:S,escapeMarkup:e},"class":{"abstract":l,single:V,multi:C}}}(jQuery));
/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js/atlassian/aui-select2.js' */
(function(C){var E=C.fn.select2;var D="aui-select2-container";var B="aui-select2-drop aui-dropdown2 aui-style-default";var A="aui-has-avatar";C.fn.auiSelect2=function(I){var H;if(C.isPlainObject(I)){var F=C.extend({},I);var G=F.hasAvatar?" "+A:"";F.containerCssClass=D+G+(F.containerCssClass?" "+F.containerCssClass:"");F.dropdownCssClass=B+G+(F.dropdownCssClass?" "+F.dropdownCssClass:"");H=Array.prototype.slice.call(arguments,1);H.unshift(F)}else{if(!arguments.length){H=[{containerCssClass:D,dropdownCssClass:B}]}else{H=arguments}}return E.apply(this,H)}})(AJS.$);
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'js/widget/roomselector/roommapping-service.js' */
define("hipchat/feature/roommapping/roommapping-service",["ajs","jquery","underscore"],function(a,d,b){var c=(function(){var o={};var f=[];var l={};function g(){f=b.map(o,function(u){return{id:u.roomId,text:u.roomName,isPrivate:u.isPrivate}});f=b.sortBy(f,function(u){return u.text.toLocaleLowerCase()});b.each(l,function(u){u.apply(null,[f])})}function k(v){var u=d.Deferred();d.ajax({url:a.contextPath()+"/rest/hipchat/integration/1.0/rooms?roomName="+v,type:"POST",dataType:"json",cache:false}).done(function(w){var x={roomId:w.id,roomName:w.name};s(x);u.resolve(x)}).fail(function(w){u.reject(w)});return u}function s(u){o[u.roomId]=u;g()}function t(u){delete o[u.roomId];g()}function p(u){b.each(u,function(v){delete o[v.roomId]});g()}function i(u){l[u]=u}function n(u){delete l[u]}function e(u){return o[u]}function m(){return f}var h={createRoom:k,addRoom:s,removeRoom:t,removeRooms:p,getRoomById:e,getRooms:m,onChange:i,offChange:n};var r=(function(){var u=d.Deferred();d.ajax({url:a.contextPath()+"/rest/hipchat/integration/1.0/rooms",dataType:"json",cache:false}).done(function(v){o=b.object(b.map(v,function(w){return[w.id,{roomId:w.id,roomName:w.name,isPrivate:w["private"]}]}));g(o);u.resolve(h)}).fail(function(){u.reject()});return u.promise()});var q=null;var j=function(){if(q==null){q=r()}return q};j.reset=function(){q=null};return j})();return{roomServicePromise:c}});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'js/widget/roomselector/roomselector-view.js' */
define("hipchat/feature/roommapping/roomselector-view",["jquery","backbone","hipchat/feature/roommapping/roommapping-service","hipchat/scopes-provider"],function(f,i,b,a){var e=b.roomServicePromise();var d="private-room";var c="public-room";function h(l){var m={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(l).replace(/[&<>"'\/\\]/g,function(n){return m[n]})}function g(l,m){return Class.extend({_formatResponse:function(s,p,r){var o=[];if(s.length>0){var q=new AJS.GroupDescriptor({weight:0,label:l?"All rooms":"Public rooms"});_.each(s,function(u){q.addItem(new AJS.ItemDescriptor({value:u.id,label:u.text,html:h(u.text),title:u.text,meta:{roomId:u.id,roomName:u.roomName||u.text,existing:true},styleClass:u.isPrivate?d:c}))});o.push(q)}if(!l){var t=new AJS.GroupDescriptor({weight:1,footerHtml:JIRA.Templates.HipChat.RoomSelector.loginDropdownFooter({hasManageRoomScope:m})});t.addItem(new AJS.ItemDescriptor({label:"filler",html:"filler",highlighted:true}));o.push(t)}else{if(r){var n=new AJS.GroupDescriptor({weight:1,label:"Create room"});n.addItem(new AJS.ItemDescriptor({value:p,label:p,html:h(p)+"<span class='aui-lozenge aui-lozenge-subtle aui-lozenge-complete'>new</span>",title:p,meta:{roomId:p,roomName:p,existing:false},highlighted:true,styleClass:c}));o.push(n)}}return o},execute:function(p){var o=jQuery.Deferred();var n=this;e.done(function(r){var w=r.getRooms();var s=p.toLocaleLowerCase();var u=false;var t=_.filter(w,function(x){var y=x.text.toLocaleLowerCase();if(y==s){u=true}return y.indexOf(s)>=0});var v=m&&(!u&&s.length>0);var q=n._formatResponse(t,p,v);JIRA.trace("ajax.request.completed.RoomSelector");o.resolve(q,p)}).fail(function(){var q=new AJS.GroupDescriptor({weight:1,footerHtml:JIRA.Templates.HipChat.RoomSelector.errorDropdownFooter({})});q.addItem(new AJS.ItemDescriptor({label:"filler",html:"filler",highlighted:true}));o.resolve([q],p)});return o}})}function j(n,l,o){var m=a.hasScope("manage_rooms");return new AJS.SingleSelect({element:n,width:o,suggestionsHandler:g(l,m),submitInputVal:true,matchingStrategy:"(.*)()({0})(.*)"})}var k=i.View.extend({events:{},initialize:function(m){if(!this.$el.length){return}this.roomSelector=j(this.$el,m.loggedIn,m.maxWidth);var l=this;this.roomSelector.model.$element.on("selected",function(o,n){if(n.properties.value!==""){l.roomSelector.$field.addClass(n.properties.styleClass);l.trigger("change")}else{l.roomSelector.$field.removeClass(c).removeClass(d);l.trigger("clear")}});this.roomSelector.model.$element.on("unselect",function(n){l.trigger("clear")})},getSelectedRoom:function(){var m=this.roomSelector.getSelectedDescriptor();var l=JSON.parse(m.properties.meta);return{id:l.roomId,roomName:l.roomName,existing:l.existing}},clearSelectedRoom:function(){this.roomSelector.clear()}});return k});
/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:widget-roomselector', location = 'soy/widget/roomselector/roomselector-client.soy' */
// This file was automatically generated from roomselector-client.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.RoomSelector == 'undefined') { JIRA.Templates.HipChat.RoomSelector = {}; }


JIRA.Templates.HipChat.RoomSelector.loginDropdownFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-login-dropdown-footer"><h6>', soy.$$escapeHtml("Rooms"), '</h6><p>', (opt_data.hasManageRoomScope) ? soy.$$escapeHtml("Login to HipChat, to view private rooms and create new room.") : soy.$$escapeHtml("Login to HipChat, to view private rooms."), '</p><p><a href="#" class="hipchat-user-link">', soy.$$escapeHtml("Log in"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.RoomSelector.errorDropdownFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-login-dropdown-footer error"><h6>', soy.$$escapeHtml("Error"), '</h6><p>', soy.$$escapeHtml("Failed to load the list of rooms from HipChat."), '</p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'soy/issuepanel/issuepanel-client.soy' */
// This file was automatically generated from issuepanel-client.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.HipChat == 'undefined') { JIRA.Templates.HipChat = {}; }
if (typeof JIRA.Templates.HipChat.Project == 'undefined') { JIRA.Templates.HipChat.Project = {}; }
if (typeof JIRA.Templates.HipChat.Project.IssuePanel == 'undefined') { JIRA.Templates.HipChat.Project.IssuePanel = {}; }


JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomsDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var noOfMentionRooms__soy3 = opt_data.mentionedRooms.length;
  output.append((noOfMentionRooms__soy3 > 0) ? '<a id="hipchat-issue-mentions-list" href="' + soy.$$escapeHtml("/jira" + '/secure/HipChatMentionedRooms.jspa?issueKey=' + opt_data.issueKey) + '"' + ((opt_data.userLoggedIntoHipChat) ? 'class="trigger-dialog-large">' : 'class="trigger-dialog">') : '<span>', soy.$$escapeHtml(AJS.format("Issue mentioned in {0} {0,choice,0#rooms|1#room|1\x3crooms}",noOfMentionRooms__soy3)), (noOfMentionRooms__soy3 > 0) ? '</a>' : '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoom = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="hipchat-dedicated-room"><div class="hipchat-dedicated-room-icon ', (opt_data.created) ? 'success' : '', '"><span class="aui-icon aui-icon-small aui-iconfont-approve"> </span><span class="aui-icon public-room"> </span></div><span class="hipchat-dedicated-room-name public-room" data-url="', soy.$$escapeHtml(opt_data.dedicatedRoom.url), '" data-issue-id="', soy.$$escapeHtml(opt_data.dedicatedRoom.issueId), '">', soy.$$escapeHtml(opt_data.dedicatedRoom.name), '</span><div class="hipchat-room-metadata"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.notLoggedInMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-help aui-help-text hipchat-dedicated-room-not-logged-in"><div class="aui-help-content"><p>', "\x3ca class\x3d\x22hipchat-user-link\x22 href\x3d\x22#\x22\x3eLog in to HipChat\x3c/a\x3e to create a dedicated room for this issue.", '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.HipChat.Project.IssuePanel.cantCreateRoomMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-help aui-help-text hipchat-dedicated-room-not-logged-in"><div class="aui-help-content"><p>', AJS.format("HipChat integration \x3ca href\x3d\x22{0}\x22\x3ehas to be reinstalled\x3c/a\x3e in order to create dedicated rooms.","/jira" + '/plugins/servlet/hipchat/configure'), '</p></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.labs.hipchat.hipchat-for-jira-plugin:hipchat-viewissue-panel-resources', location = 'js/feature/issuepanel/issuepanel-init.js' */
(function(d,f,b,k){function h(){var m=d(this);f.trigger("analyticsEvent",{name:"hipchat.dedicatedroom.link.click",data:{issueId:m.data("issue-id")}});window.open(m.data("url"),"_blank")}function i(){var r=d("#hipchat-issue-panel-rooms-container");var m=r.data("hipchat-username")!==undefined;var q=r.data("can-create-room");var n=f.Meta.get("is-admin");var p=d(".hipchat-create-dedicated-room");var o;d(document).on("click",".hipchat-create-dedicated-room",function(u){if(m&&q){var t=d(".button-spinner");var s=d(".hipchat-dedicated-room-section .aui-message-warning");c();s.remove();t.spin();p.attr("disabled","disabled")}else{if(!m||!q){o=f.InlineDialog(d(this),"create-dedicated-room-not-logged-in-dialog",function(x,v,y){var w;if(!q&&n){w=JIRA.Templates.HipChat.Project.IssuePanel.cantCreateRoomMessage({})}else{w=JIRA.Templates.HipChat.Project.IssuePanel.notLoggedInMessage({})}x.html(w);y()},{noBind:true,hideDelay:null});o.show(u,d(this))}}})}function c(q){var n=d.Deferred();var m=f.Meta.get("issue-key");var o=f.contextPath()+"/rest/hipchat/integrations/1.0/dedicatedroom/";var p={type:"POST",url:o,contentType:"application/json",dataType:"json",data:JSON.stringify({issue_key:m,room_id:q}),cache:false};d.ajax(p).done(function(r){var s=JIRA.Templates.HipChat.Project.IssuePanel.dedicatedRoom({dedicatedRoom:r,created:true});d(".hipchat-dedicated-room-content").hide().html(s).fadeIn({complete:function(){setTimeout(function(){d(".hipchat-dedicated-room-icon").removeClass("success")},1500)}});JIRA.trace("hipchat.dedicated.room.created");n.resolve(r)}).fail(function(t){var u=d(".button-spinner");u.spinStop();var r=d(".hipchat-create-dedicated-room");r.removeAttr("disabled");var s=d("#hipchat-dedicated-room-errors");s.empty();s.append(aui.message.warning({titleContent:f.I18n.getText("jira.plugins.hipchat.viewissue.panel.dedicated.room.assign.error"),content:t.responseText}));n.reject(t)});return n}function l(m){d(document).bind("dialogContentReady",{},function(t,r){if(r.options.id==="hipchat-select-dedicated-room-dialog"){var q=b.roomServicePromise();var n=d("#hipchat-issue-panel-rooms-container").data("hipchat-username")!==undefined;var u=new k({el:d("#hipchat-dedicated-room-select"),loggedIn:n,maxWidth:"480px"});var o={roomSelector:u,clearSelectedRoom:function(){this.roomSelector.clearSelectedRoom();this.disableSubmitButton()},enableSubmitButton:function(){var v=this.roomSelector.getSelectedRoom();if(v&&v.id!==""){d("#hipchat-select-dedicated-room-dialog-submit").removeAttr("aria-disabled").removeAttr("disabled")}},disableSubmitButton:function(){d("#hipchat-select-dedicated-room-dialog-submit").attr({"aria-disabled":"true",disabled:""})},roomSelected:function(){return d("#hipchat-select-dedicated-room-dialog-submit").attr("disabled")===undefined},init:function(){this.roomSelector.on("change",this.enableSubmitButton,this);this.roomSelector.on("clear",this.disableSubmitButton,this)}};o.init();function s(){m.showFooterLoadingIndicator();var v=d.Deferred();var x=u.getSelectedRoom();if(!x.existing){var w=b.roomServicePromise();w.done(function(y){v=y.createRoom(x.roomName)}).fail(function(y){v.reject(y)})}else{v.resolve(x)}v.then(function(y){return c(y.id||y.roomId)}).done(function(){d("#hipchat-select-dedicated-room-dialog-close").click();JIRA.trace("hipchat.dedicated.room.selected")}).fail(function(z){var y=d("#hipchat-select-dedicated-room-dialog .errors");y.empty();y.append(aui.message.warning({titleContent:f.I18n.getText("jira.plugins.hipchat.viewissue.panel.dedicated.room.assign.error"),content:z.responseText}))}).always(function(){m.hideFooterLoadingIndicator()})}var p=d("#hipchat-select-dedicated-room-dialog").find("form");p.on("before-submit",function(v){v.preventDefault();if(o.roomSelected()){s()}});q.done(function(v){o.disableSubmitButton()}).fail(function(){o.disableSubmitButton()});d("#hipchat-select-dedicated-room-dialog-submit").on("click",s)}})}function g(){var p=d("#hipchat-issue-panel-rooms-container");var n=p.data("hipchat-configured");var o=p.data("hipchat-username")!==undefined;if(n){var m=f.Meta.get("issue-key");d.ajax({type:"GET",url:f.contextPath()+"/rest/hipchat/integrations/1.0/issue-mentions/"+m+"/rooms",dataType:"json",cache:false}).done(function(q){var r=JIRA.Templates.HipChat.Project.IssuePanel.mentionedRoomsDescription({mentionedRooms:q,issueKey:m,userLoggedIntoHipChat:o});d(".hipchat-mentioned-rooms-section").html(r);JIRA.trace("hipchat.mentioned.rooms.fetched")}).fail(function(r){var q=r.responseText?r.responseText:"No error details available.";d(".hipchat-mentioned-rooms-section").html(aui.message.warning({titleContent:f.I18n.getText("jira.plugins.hipchat.viewissue.panel.mentions.rooms.error"),content:q}))})}}function e(){var m=undefined;d(document).on("click","a.trigger-dialog-small",function(n){n.preventDefault();if(m==undefined){m=new JIRA.FormDialog({id:this.id+"-dialog",ajaxOptions:{url:this.href,data:{decorator:"dialog",inline:"false"}},width:400});l(m)}m.show()})}function a(){d(document).on("click","a.trigger-dialog-large",function(n){n.preventDefault();var m=new JIRA.FormDialog({id:this.id+"-dialog",ajaxOptions:{url:this.href,data:{decorator:"dialog",inline:"false"}},width:800});m.show()})}function j(){e();a();i();g();JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){g()})}d(function(){j()})})(AJS.$,require("ajs"),require("hipchat/feature/roommapping/roommapping-service"),require("hipchat/feature/roommapping/roomselector-view"));
/* module-key = 'jira.webresources:jquery-easing', location = '/includes/jquery/plugins/easing/jquery.easing.1.3.js' */
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return jQuery.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}});
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox-1.3.4.js' */
(function($){var tmp,loading,overlay,wrap,outer,content,close,title,nav_left,nav_right,selectedIndex=0,selectedOpts={},selectedArray=[],currentIndex=0,currentOpts={},currentArray=[],ajaxLoader=null,imgPreloader=new Image(),imgRegExp=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,swfRegExp=/[^\.]\.(swf)\s*$/i,loadingTimer,loadingFrame=1,titleHeight=0,titleStr="",start_pos,final_pos,busy=false,fx=$.extend($("<div/>")[0],{prop:0}),isIE6=$.browser.msie&&$.browser.version<7&&!window.XMLHttpRequest,_abort=function(){loading.hide();imgPreloader.onerror=imgPreloader.onload=null;if(ajaxLoader){ajaxLoader.abort()}tmp.empty()},_error=function(){if(false===selectedOpts.onError(selectedArray,selectedIndex,selectedOpts)){loading.hide();busy=false;return }selectedOpts.titleShow=false;selectedOpts.width="auto";selectedOpts.height="auto";tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');_process_inline()},_start=function(){var obj=selectedArray[selectedIndex],href,type,title,str,emb,ret;_abort();selectedOpts=$.extend({},$.fn.fancybox.defaults,(typeof $(obj).data("fancybox")=="undefined"?selectedOpts:$(obj).data("fancybox")));ret=selectedOpts.onStart(selectedArray,selectedIndex,selectedOpts);if(ret===false){busy=false;return }else{if(typeof ret=="object"){selectedOpts=$.extend(selectedOpts,ret)}}title=selectedOpts.title||(obj.nodeName?$(obj).attr("title"):obj.title)||"";if(obj.nodeName&&!selectedOpts.orig){selectedOpts.orig=$(obj).children("img:first").length?$(obj).children("img:first"):$(obj)}if(title===""&&selectedOpts.orig&&selectedOpts.titleFromAlt){title=selectedOpts.orig.attr("alt")}href=selectedOpts.href||(obj.nodeName?$(obj).attr("href"):obj.href)||null;if((/^(?:javascript)/i).test(href)||href=="#"){href=null}if(selectedOpts.type){type=selectedOpts.type;if(!href){href=selectedOpts.content}}else{if(selectedOpts.content){type="html"}else{if(href){if(href.match(imgRegExp)){type="image"}else{if(href.match(swfRegExp)){type="swf"}else{if($(obj).hasClass("iframe")){type="iframe"}else{if(href.indexOf("#")===0){type="inline"}else{type="ajax"}}}}}}}if(!type){_error();return }if(type=="inline"){obj=href.substr(href.indexOf("#"));type=$(obj).length>0?"inline":"ajax"}selectedOpts.type=type;selectedOpts.href=href;selectedOpts.title=title;if(selectedOpts.autoDimensions){if(selectedOpts.type=="html"||selectedOpts.type=="inline"||selectedOpts.type=="ajax"){selectedOpts.width="auto";selectedOpts.height="auto"}else{selectedOpts.autoDimensions=false}}if(selectedOpts.modal){selectedOpts.overlayShow=true;selectedOpts.hideOnOverlayClick=false;selectedOpts.hideOnContentClick=false;selectedOpts.enableEscapeButton=false;selectedOpts.showCloseButton=false}selectedOpts.padding=parseInt(selectedOpts.padding,10);selectedOpts.margin=parseInt(selectedOpts.margin,10);tmp.css("padding",(selectedOpts.padding+selectedOpts.margin));$(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){$(this).replaceWith(content.children())});switch(type){case"html":tmp.html(selectedOpts.content);_process_inline();break;case"inline":if($(obj).parent().is("#fancybox-content")===true){busy=false;return }$('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup",function(){$(this).replaceWith(content.children())}).bind("fancybox-cancel",function(){$(this).replaceWith(tmp.children())});$(obj).appendTo(tmp);_process_inline();break;case"image":busy=false;$.fancybox.showActivity();imgPreloader=new Image();imgPreloader.onerror=function(){_error()};imgPreloader.onload=function(){busy=true;imgPreloader.onerror=imgPreloader.onload=null;_process_image()};imgPreloader.src=href;break;case"swf":selectedOpts.scrolling="no";str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"><param name="movie" value="'+href+'"></param>';emb="";$.each(selectedOpts.swf,function(name,val){str+='<param name="'+name+'" value="'+val+'"></param>';emb+=" "+name+'="'+val+'"'});str+='<embed src="'+href+'" type="application/x-shockwave-flash" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"'+emb+"></embed></object>";tmp.html(str);_process_inline();break;case"ajax":busy=false;$.fancybox.showActivity();selectedOpts.ajax.win=selectedOpts.ajax.success;ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:href,data:selectedOpts.ajax.data||{},error:function(XMLHttpRequest,textStatus,errorThrown){if(XMLHttpRequest.status>0){_error()}},success:function(data,textStatus,XMLHttpRequest){var o=typeof XMLHttpRequest=="object"?XMLHttpRequest:ajaxLoader;if(o.status==200){if(typeof selectedOpts.ajax.win=="function"){ret=selectedOpts.ajax.win(href,data,textStatus,XMLHttpRequest);if(ret===false){loading.hide();return }else{if(typeof ret=="string"||typeof ret=="object"){data=ret}}}tmp.html(data);_process_inline()}}}));break;case"iframe":_show();break}},_process_inline=function(){var w=selectedOpts.width,h=selectedOpts.height;if(w.toString().indexOf("%")>-1){w=parseInt(($(window).width()-(selectedOpts.margin*2))*parseFloat(w)/100,10)+"px"}else{w=w=="auto"?"auto":w+"px"}if(h.toString().indexOf("%")>-1){h=parseInt(($(window).height()-(selectedOpts.margin*2))*parseFloat(h)/100,10)+"px"}else{h=h=="auto"?"auto":h+"px"}tmp.wrapInner('<div style="width:'+w+";height:"+h+";overflow: "+(selectedOpts.scrolling=="auto"?"auto":(selectedOpts.scrolling=="yes"?"scroll":"hidden"))+';position:relative;"></div>');selectedOpts.width=tmp.width();selectedOpts.height=tmp.height();_show()},_process_image=function(){selectedOpts.width=imgPreloader.width;selectedOpts.height=imgPreloader.height;$("<img />").attr({"id":"fancybox-img","src":imgPreloader.src,"alt":selectedOpts.title}).appendTo(tmp);_show()},_show=function(){var pos,equal;loading.hide();if(wrap.is(":visible")&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){$.event.trigger("fancybox-cancel");busy=false;return }busy=true;$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");if(wrap.is(":visible")&&currentOpts.titlePosition!=="outside"){wrap.css("height",wrap.height())}currentArray=selectedArray;currentIndex=selectedIndex;currentOpts=selectedOpts;if(currentOpts.overlayShow){overlay.css({"background-color":currentOpts.overlayColor,"opacity":currentOpts.overlayOpacity,"cursor":currentOpts.hideOnOverlayClick?"pointer":"auto","height":$(document).height()});if(!overlay.is(":visible")){if(isIE6){$("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({"visibility":"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}overlay.show()}}else{overlay.hide()}final_pos=_get_zoom_to();_process_title();if(wrap.is(":visible")){$(close.add(nav_left).add(nav_right)).hide();pos=wrap.position(),start_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};equal=(start_pos.width==final_pos.width&&start_pos.height==final_pos.height);content.fadeTo(currentOpts.changeFade,0.3,function(){var finish_resizing=function(){content.html(tmp.contents()).fadeTo(currentOpts.changeFade,1,_finish)};$.event.trigger("fancybox-change");content.empty().removeAttr("filter").css({"border-width":currentOpts.padding,"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2});if(equal){finish_resizing()}else{fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.changeSpeed,easing:currentOpts.easingChange,step:_draw,complete:finish_resizing})}});return }wrap.removeAttr("style");content.css("border-width",currentOpts.padding);if(currentOpts.transitionIn=="elastic"){start_pos=_get_zoom_from();content.html(tmp.contents());wrap.show();if(currentOpts.opacity){final_pos.opacity=0}fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.speedIn,easing:currentOpts.easingIn,step:_draw,complete:_finish});return }if(currentOpts.titlePosition=="inside"&&titleHeight>0){title.show()}content.css({"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2}).html(tmp.contents());wrap.css(final_pos).fadeIn(currentOpts.transitionIn=="none"?0:currentOpts.speedIn,_finish)},_format_title=function(title){if(title&&title.length){if(currentOpts.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+currentOpts.titlePosition+'">'+title+"</div>"}return false},_process_title=function(){titleStr=currentOpts.title||"";titleHeight=0;title.empty().removeAttr("style").removeClass();if(currentOpts.titleShow===false){title.hide();return }titleStr=$.isFunction(currentOpts.titleFormat)?currentOpts.titleFormat(titleStr,currentArray,currentIndex,currentOpts):_format_title(titleStr);if(!titleStr||titleStr===""){title.hide();return }title.addClass("fancybox-title-"+currentOpts.titlePosition).html(titleStr).appendTo("body").show();switch(currentOpts.titlePosition){case"inside":title.css({"width":final_pos.width-(currentOpts.padding*2),"marginLeft":currentOpts.padding,"marginRight":currentOpts.padding});titleHeight=title.outerHeight(true);title.appendTo(outer);final_pos.height+=titleHeight;break;case"over":title.css({"marginLeft":currentOpts.padding,"width":final_pos.width-(currentOpts.padding*2),"bottom":currentOpts.padding}).appendTo(outer);break;case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1).appendTo(wrap);break;default:title.css({"width":final_pos.width-(currentOpts.padding*2),"paddingLeft":currentOpts.padding,"paddingRight":currentOpts.padding}).appendTo(wrap);break}title.hide()},_set_navigation=function(){if(currentOpts.enableEscapeButton||currentOpts.enableKeyboardNav){$(document).bind("keydown.fb",function(e){if(e.keyCode==27&&currentOpts.enableEscapeButton){e.preventDefault();$.fancybox.close()}else{if((e.keyCode==37||e.keyCode==39)&&currentOpts.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"){e.preventDefault();$.fancybox[e.keyCode==37?"prev":"next"]()}}})}if(!currentOpts.showNavArrows){nav_left.hide();nav_right.hide();return }if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!==0){nav_left.show()}if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!=(currentArray.length-1)){nav_right.show()}},_finish=function(){if(!$.support.opacity){content.get(0).style.removeAttribute("filter");wrap.get(0).style.removeAttribute("filter")}if(selectedOpts.autoDimensions){content.css("height","auto")}wrap.css("height","auto");if(titleStr&&titleStr.length){title.show()}if(currentOpts.showCloseButton){close.show()}_set_navigation();if(currentOpts.hideOnContentClick){content.bind("click",$.fancybox.close)}if(currentOpts.hideOnOverlayClick){overlay.bind("click",$.fancybox.close)}$(window).bind("resize.fb",$.fancybox.resize);if(currentOpts.centerOnScroll){$(window).bind("scroll.fb",$.fancybox.center)}if(currentOpts.type=="iframe"){$('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+($.browser.msie?'allowtransparency="true""':"")+' scrolling="'+selectedOpts.scrolling+'" src="'+currentOpts.href+'"></iframe>').appendTo(content)}wrap.show();busy=false;$.fancybox.center();currentOpts.onComplete(currentArray,currentIndex,currentOpts);_preload_images()},_preload_images=function(){var href,objNext;if((currentArray.length-1)>currentIndex){href=currentArray[currentIndex+1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}if(currentIndex>0){href=currentArray[currentIndex-1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}},_draw=function(pos){var dim={width:parseInt(start_pos.width+(final_pos.width-start_pos.width)*pos,10),height:parseInt(start_pos.height+(final_pos.height-start_pos.height)*pos,10),top:parseInt(start_pos.top+(final_pos.top-start_pos.top)*pos,10),left:parseInt(start_pos.left+(final_pos.left-start_pos.left)*pos,10)};if(typeof final_pos.opacity!=="undefined"){dim.opacity=pos<0.5?0.5:pos}wrap.css(dim);content.css({"width":dim.width-currentOpts.padding*2,"height":dim.height-(titleHeight*pos)-currentOpts.padding*2})},_get_viewport=function(){return[$(window).width()-(currentOpts.margin*2),$(window).height()-(currentOpts.margin*2),$(document).scrollLeft()+currentOpts.margin,$(document).scrollTop()+currentOpts.margin]},_get_zoom_to=function(){var view=_get_viewport(),to={},resize=currentOpts.autoScale,double_padding=currentOpts.padding*2,ratio;if(currentOpts.width.toString().indexOf("%")>-1){to.width=parseInt((view[0]*parseFloat(currentOpts.width))/100,10)}else{to.width=currentOpts.width+double_padding}if(currentOpts.height.toString().indexOf("%")>-1){to.height=parseInt((view[1]*parseFloat(currentOpts.height))/100,10)}else{to.height=currentOpts.height+double_padding}if(resize&&(to.width>view[0]||to.height>view[1])){if(selectedOpts.type=="image"||selectedOpts.type=="swf"){ratio=(currentOpts.width)/(currentOpts.height);if((to.width)>view[0]){to.width=view[0];to.height=parseInt(((to.width-double_padding)/ratio)+double_padding,10)}if((to.height)>view[1]){to.height=view[1];to.width=parseInt(((to.height-double_padding)*ratio)+double_padding,10)}}else{to.width=Math.min(to.width,view[0]);to.height=Math.min(to.height,view[1])}}to.top=parseInt(Math.max(view[3]-20,view[3]+((view[1]-to.height-40)*0.5)),10);to.left=parseInt(Math.max(view[2]-20,view[2]+((view[0]-to.width-40)*0.5)),10);return to},_get_obj_pos=function(obj){var pos=obj.offset();pos.top+=parseInt(obj.css("paddingTop"),10)||0;pos.left+=parseInt(obj.css("paddingLeft"),10)||0;pos.top+=parseInt(obj.css("border-top-width"),10)||0;pos.left+=parseInt(obj.css("border-left-width"),10)||0;pos.width=obj.width();pos.height=obj.height();return pos},_get_zoom_from=function(){var orig=selectedOpts.orig?$(selectedOpts.orig):false,from={},pos,view;if(orig&&orig.length){pos=_get_obj_pos(orig);from={width:pos.width+(currentOpts.padding*2),height:pos.height+(currentOpts.padding*2),top:pos.top-currentOpts.padding-20,left:pos.left-currentOpts.padding-20}}else{view=_get_viewport();from={width:currentOpts.padding*2,height:currentOpts.padding*2,top:parseInt(view[3]+view[1]*0.5,10),left:parseInt(view[2]+view[0]*0.5,10)}}return from},_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return }$("div",loading).css("top",(loadingFrame*-40)+"px");loadingFrame=(loadingFrame+1)%12};$.fn.fancybox=function(options){if(!$(this).length){return this}$(this).data("fancybox",$.extend({},options,($.metadata?$(this).metadata():{}))).unbind("click.fb").bind("click.fb",function(e){e.preventDefault();if(busy){return }busy=true;$(this).blur();selectedArray=[];selectedIndex=0;var rel=$(this).attr("rel")||"";if(!rel||rel==""||rel==="nofollow"){selectedArray.push(this)}else{selectedArray=$("a[rel="+rel+"], area[rel="+rel+"]");selectedIndex=selectedArray.index(this)}_start();return });return this};$.fancybox=function(obj){var opts;if(busy){return }busy=true;opts=typeof arguments[1]!=="undefined"?arguments[1]:{};selectedArray=[];selectedIndex=parseInt(opts.index,10)||0;if($.isArray(obj)){for(var i=0,j=obj.length;i<j;i++){if(typeof obj[i]=="object"){$(obj[i]).data("fancybox",$.extend({},opts,obj[i]))}else{obj[i]=$({}).data("fancybox",$.extend({content:obj[i]},opts))}}selectedArray=jQuery.merge(selectedArray,obj)}else{if(typeof obj=="object"){$(obj).data("fancybox",$.extend({},opts,obj))}else{obj=$({}).data("fancybox",$.extend({content:obj},opts))}selectedArray.push(obj)}if(selectedIndex>selectedArray.length||selectedIndex<0){selectedIndex=0}_start()};$.fancybox.showActivity=function(){clearInterval(loadingTimer);loading.show();loadingTimer=setInterval(_animate_loading,66)};$.fancybox.hideActivity=function(){loading.hide()};$.fancybox.next=function(){return $.fancybox.pos(currentIndex+1)};$.fancybox.prev=function(){return $.fancybox.pos(currentIndex-1)};$.fancybox.pos=function(pos){if(busy){return }pos=parseInt(pos);selectedArray=currentArray;if(pos>-1&&pos<currentArray.length){selectedIndex=pos;_start()}else{if(currentOpts.cyclic&&currentArray.length>1){selectedIndex=pos>=currentArray.length?0:currentArray.length-1;_start()}}return };$.fancybox.cancel=function(){if(busy){return }busy=true;$.event.trigger("fancybox-cancel");_abort();selectedOpts.onCancel(selectedArray,selectedIndex,selectedOpts);busy=false};$.fancybox.close=function(){if(busy||wrap.is(":hidden")){return }busy=true;if(currentOpts&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){busy=false;return }_abort();$(close.add(nav_left).add(nav_right)).hide();$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");content.find("iframe").attr("src",isIE6&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(currentOpts.titlePosition!=="inside"){title.empty()}wrap.stop();function _cleanup(){overlay.fadeOut("fast");title.empty().hide();wrap.hide();$.event.trigger("fancybox-cleanup");content.empty();currentOpts.onClosed(currentArray,currentIndex,currentOpts);currentArray=selectedOpts=[];currentIndex=selectedIndex=0;currentOpts=selectedOpts={};busy=false}if(currentOpts.transitionOut=="elastic"){start_pos=_get_zoom_from();var pos=wrap.position();final_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};if(currentOpts.opacity){final_pos.opacity=1}title.empty().hide();fx.prop=1;$(fx).animate({prop:0},{duration:currentOpts.speedOut,easing:currentOpts.easingOut,step:_draw,complete:_cleanup})}else{wrap.fadeOut(currentOpts.transitionOut=="none"?0:currentOpts.speedOut,_cleanup)}};$.fancybox.resize=function(){if(overlay.is(":visible")){overlay.css("height",$(document).height())}$.fancybox.center(true)};$.fancybox.center=function(){var view,align;if(busy){return }align=arguments[0]===true?1:0;view=_get_viewport();if(!align&&(wrap.width()>view[0]||wrap.height()>view[1])){return }wrap.stop().animate({"top":parseInt(Math.max(view[3]-20,view[3]+((view[1]-content.height()-40)*0.5)-currentOpts.padding)),"left":parseInt(Math.max(view[2]-20,view[2]+((view[0]-content.width()-40)*0.5)-currentOpts.padding))},typeof arguments[0]=="number"?arguments[0]:200)};$.fancybox.init=function(){if($("#fancybox-wrap").length){return }$("body").append(tmp=$('<div id="fancybox-tmp"></div>'),loading=$('<div id="fancybox-loading"><div></div></div>'),overlay=$('<div id="fancybox-overlay"></div>'),wrap=$('<div id="fancybox-wrap"></div>'));outer=$('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);outer.append(content=$('<div id="fancybox-content"></div>'),close=$('<a id="fancybox-close"></a>'),title=$('<div id="fancybox-title"></div>'),nav_left=$('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),nav_right=$('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));close.click($.fancybox.close);loading.click($.fancybox.cancel);nav_left.click(function(e){e.preventDefault();$.fancybox.prev()});nav_right.click(function(e){e.preventDefault();$.fancybox.next()});if($.fn.mousewheel){wrap.bind("mousewheel.fb",function(e,delta){if(busy){e.preventDefault()}else{if($(e.target).get(0).clientHeight==0||$(e.target).get(0).scrollHeight===$(e.target).get(0).clientHeight){e.preventDefault();$.fancybox[delta>0?"prev":"next"]()}}})}if(!$.support.opacity){wrap.addClass("fancybox-ie")}if(isIE6){loading.addClass("fancybox-ie6");wrap.addClass("fancybox-ie6");$('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)}};$.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};$(document).ready(function(){$.fancybox.init()})})(jQuery);
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox.jira.js' */
AJS.$.fn.fancybox.defaults.titleFormat=function(title){if(title&&title.length){title=AJS.escapeHtml(title);if(this.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+this.titlePosition+'">'+title+"</div>"}};
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.js' */
(function(undefined){var moment,VERSION="2.1.0",round=Math.round,i,languages={},hasModule=(typeof module!=="undefined"&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{1,4}/,parseTokenSixDigits=/[+\-]?\d{1,6}/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/i,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,isoRegex=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoTimes=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={"Milliseconds":1,"Seconds":1000,"Minutes":60000,"Hours":3600000,"Days":86400000,"Months":2592000000,"Years":31536000000},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return ~~(this.milliseconds()/100)},SS:function(){return leftZeroFill(~~(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(~~(a/60),2)+":"+leftZeroFill(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(~~(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Language(){}function Moment(config){extend(this,config)}function Duration(duration){var years=duration.years||duration.year||duration.y||0,months=duration.months||duration.month||duration.M||0,weeks=duration.weeks||duration.week||duration.w||0,days=duration.days||duration.day||duration.d||0,hours=duration.hours||duration.hour||duration.h||0,minutes=duration.minutes||duration.minute||duration.m||0,seconds=duration.seconds||duration.second||duration.s||0,milliseconds=duration.milliseconds||duration.millisecond||duration.ms||0;this._input=duration;this._milliseconds=milliseconds+seconds*1000+minutes*60000+hours*3600000;this._days=days+weeks*7;this._months=months+years*12;this._data={};this._bubble()}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}return a}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength){var output=number+"";while(output.length<targetLength){output="0"+output}return output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,ignoreUpdateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months,minutes,hours,currentDate;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days||months){minutes=mom.minute();hours=mom.hour()}if(days){mom.date(mom.date()+days*isAdding)}if(months){mom.month(mom.month()+months*isAdding)}if(milliseconds&&!ignoreUpdateOffset){moment.updateOffset(mom)}if(days||months){mom.minute(minutes);mom.hour(hours)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function compareArrays(array1,array2){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(~~array1[i]!==~~array2[i]){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){return units?unitAliases[units]||units.toLowerCase().replace(/(.)s$/,"$1"):units}Language.prototype={set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[]}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment([2000,i]);regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return((input+"").toLowerCase()[0]==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return typeof output==="function"?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==="function")?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}};function loadLang(key,values){values.abbr=key;if(!languages[key]){languages[key]=new Language()}languages[key].set(values);return languages[key]}function getLangDefinition(key){if(!key){return moment.fn._lang}if(!languages[key]&&hasModule){try{require("./lang/"+key)}catch(e){return moment.fn._lang}}return languages[key]}function removeFormattingTokens(input){if(input.match(/\[.*\]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i] instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){var i=5;function replaceLongDateFormatTokens(input){return m.lang().longDateFormat(input)||input}while(i--&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens)}if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function getParseRegexForToken(token,config){switch(token){case"DDDD":return parseTokenThreeDigits;case"YYYY":return parseTokenFourDigits;case"YYYYY":return parseTokenSixDigits;case"S":case"SS":case"SSS":case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return parseTokenOneOrTwoDigits;default:return new RegExp(token.replace("\\",""))}}function timezoneMinutesFromString(string){var tzchunk=(parseTokenTimezone.exec(string)||[])[0],parts=(tzchunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+~~parts[2];return parts[0]==="+"?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"M":case"MM":datePartArray[1]=(input==null)?0:~~input-1;break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input);if(a!=null){datePartArray[1]=a}else{config._isValid=false}break;case"D":case"DD":case"DDD":case"DDDD":if(input!=null){datePartArray[2]=~~input}break;case"YY":datePartArray[0]=~~input+(~~input>68?1900:2000);break;case"YYYY":case"YYYYY":datePartArray[0]=~~input;break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[3]=~~input;break;case"m":case"mm":datePartArray[4]=~~input;break;case"s":case"ss":datePartArray[5]=~~input;break;case"S":case"SS":case"SSS":datePartArray[6]=~~(("0."+input)*1000);break;case"X":config._d=new Date(parseFloat(input)*1000);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break}if(input==null){config._isValid=false}}function dateFromArray(config){var i,date,input=[];if(config._d){return }for(i=0;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i]}input[3]+=~~((config._tzm||0)/60);input[4]+=~~((config._tzm||0)%60);date=new Date(0);if(config._useUTC){date.setUTCFullYear(input[0],input[1],input[2]);date.setUTCHours(input[3],input[4],input[5],input[6])}else{date.setFullYear(input[0],input[1],input[2]);date.setHours(input[3],input[4],input[5],input[6])}config._d=date}function makeDateFromStringAndFormat(config){var tokens=config._f.match(formattingTokens),string=config._i,i,parsedInput;config._a=[];for(i=0;i<tokens.length;i++){parsedInput=(getParseRegexForToken(tokens[i],config).exec(string)||[])[0];if(parsedInput){string=string.slice(string.indexOf(parsedInput)+parsedInput.length)}if(formatTokenFunctions[tokens[i]]){addTimeToArrayFromToken(tokens[i],parsedInput,config)}}if(string){config._il=string}if(config._isPm&&config._a[3]<12){config._a[3]+=12}if(config._isPm===false&&config._a[3]===12){config._a[3]=0}dateFromArray(config)}function makeDateFromStringAndArray(config){var tempConfig,tempMoment,bestMoment,scoreToBeat=99,i,currentScore;for(i=0;i<config._f.length;i++){tempConfig=extend({},config);tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);tempMoment=new Moment(tempConfig);currentScore=compareArrays(tempConfig._a,tempMoment.toArray());if(tempMoment._il){currentScore+=tempMoment._il.length}if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempMoment}}extend(config,bestMoment)}function makeDateFromString(config){var i,string=config._i,match=isoRegex.exec(string);if(match){config._f="YYYY-MM-DD"+(match[2]||" ");for(i=0;i<4;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(parseTokenTimezone.exec(string)){config._f+=" Z"}makeDateFromStringAndFormat(config)}else{config._d=new Date(string)}}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);if(input===undefined){config._d=new Date()}else{if(matched){config._d=new Date(+matched[1])}else{if(typeof input==="string"){makeDateFromString(config)}else{if(isArray(input)){config._a=input.slice(0);dateFromArray(config)}else{config._d=input instanceof Date?new Date(+input):new Date(input)}}}}}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&["s",seconds]||minutes===1&&["m"]||minutes<45&&["mm",minutes]||hours===1&&["h"]||hours<22&&["hh",hours]||days===1&&["d"]||days<=25&&["dd",days]||days<=45&&["M"]||days<345&&["MM",round(days/30)]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add("d",daysToDayOfWeek);return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function makeMoment(config){var input=config._i,format=config._f;if(input===null||input===""){return null}if(typeof input==="string"){config._i=input=getLangDefinition().preparse(input)}if(moment.isMoment(input)){config=extend({},input);config._d=new Date(+input._d)}else{if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}}return new Moment(config)}moment=function(input,format,lang){return makeMoment({_i:input,_f:format,_l:lang,_isUTC:false})};moment.utc=function(input,format,lang){return makeMoment({_useUTC:true,_isUTC:true,_l:lang,_i:input,_f:format})};moment.unix=function(input){return moment(input*1000)};moment.duration=function(input,key){var isDuration=moment.isDuration(input),isNumber=(typeof input==="number"),duration=(isDuration?input._input:(isNumber?{}:input)),matched=aspNetTimeSpanJsonRegex.exec(input),sign,ret;if(isNumber){if(key){duration[key]=input}else{duration.milliseconds=input}}else{if(matched){sign=(matched[1]==="-")?-1:1;duration={y:0,d:~~matched[2]*sign,h:~~matched[3]*sign,m:~~matched[4]*sign,s:~~matched[5]*sign,ms:~~matched[6]*sign}}}ret=new Duration(duration);if(isDuration&&input.hasOwnProperty("_lang")){ret._lang=input._lang}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.updateOffset=function(){};moment.lang=function(key,values){if(!key){return moment.fn._lang._abbr}if(values){loadLang(key,values)}else{if(!languages[key]){getLangDefinition(key)}}moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key)};moment.langData=function(key){if(key&&key._lang&&key._lang._abbr){key=key._lang._abbr}return getLangDefinition(key)};moment.isMoment=function(obj){return obj instanceof Moment};moment.isDuration=function(obj){return obj instanceof Duration};moment.fn=Moment.prototype={clone:function(){return moment(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return formatMoment(moment(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){if(this._isValid==null){if(this._a){this._isValid=!compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())}else{this._isValid=!isNaN(this._d.getTime())}}return !!this._isValid},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,1);return this},subtract:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,-1);return this},diff:function(input,units,asFloat){var that=this._isUTC?moment(input).zone(this._offset||0):moment(input).local(),zoneDiff=(this.zone()-that.zone())*60000,diff,output;units=normalizeUnits(units);if(units==="year"||units==="month"){diff=(this.daysInMonth()+that.daysInMonth())*43200000;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf("month"))-(that-moment(that).startOf("month")))/diff;output-=((this.zone()-moment(this).startOf("month").zone())-(that.zone()-moment(that).startOf("month").zone()))*60000/diff;if(units==="year"){output=output/12}}else{diff=(this-that);output=units==="second"?diff/1000:units==="minute"?diff/60000:units==="hour"?diff/3600000:units==="day"?(diff-zoneDiff)/86400000:units==="week"?(diff-zoneDiff)/604800000:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var diff=this.diff(moment().startOf("day"),"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){var year=this.year();return(year%4===0&&year%100!==0)||year%400===0},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){if(typeof input==="string"){input=this.lang().weekdaysParse(input);if(typeof input!=="number"){return this}}return this.add({d:input-day})}else{return day}},month:function(input){var utc=this._isUTC?"UTC":"",dayOfMonth,daysInMonth;if(input!=null){if(typeof input==="string"){input=this.lang().monthsParse(input);if(typeof input!=="number"){return this}}dayOfMonth=this.date();this.date(1);this._d["set"+utc+"Month"](input);this.date(Math.min(dayOfMonth,this.daysInMonth()));moment.updateOffset(this);return this}else{return this._d["get"+utc+"Month"]()}},startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}return this},endOf:function(units){return this.startOf(units).add(units,1).subtract("ms",1)},isAfter:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)===+moment(input).startOf(units)},min:function(other){other=moment.apply(null,arguments);return other<this?this:other},max:function(other){other=moment.apply(null,arguments);return other>this?this:other},zone:function(input){var offset=this._offset||0;if(input!=null){if(typeof input==="string"){input=timezoneMinutesFromString(input)}if(Math.abs(input)<16){input=input*60}this._offset=input;this._isUTC=true;if(offset!==input){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,true)}}else{return this._isUTC?offset:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return moment.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/86400000)+1;return input==null?dayOfYear:this.add("d",(input-dayOfYear))},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return input==null?year:this.add("y",(input-year))},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add("y",(input-year))},week:function(input){var week=this.lang().week(this);return input==null?week:this.add("d",(input-week)*7)},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add("d",(input-week)*7)},weekday:function(input){var weekday=(this._d.getDay()+7-this.lang()._week.dow)%7;return input==null?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},lang:function(key){if(key===undefined){return this._lang}else{this._lang=getLangDefinition(key);return this}}};function makeGetterAndSetter(name,key){moment.fn[name]=moment.fn[name+"s"]=function(input){var utc=this._isUTC?"UTC":"";if(input!=null){this._d["set"+utc+key](input);moment.updateOffset(this);return this}else{return this._d["get"+utc+key]()}}}for(i=0;i<proxyGettersAndSetters.length;i++){makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase().replace(/s$/,""),proxyGettersAndSetters[i])}makeGetterAndSetter("year","FullYear");moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.toJSON=moment.fn.toISOString;moment.duration.fn=Duration.prototype={_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);data.days=days%30;months+=absRound(days/30);data.months=months%12;years=absRound(months/12);data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+~~(this._months/12)*31536000000},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=this.lang().pastFuture(difference,output)}return this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){units=normalizeUnits(units);return this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang};function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return +this/factor}}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}makeDurationAsGetter("Weeks",604800000);moment.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};moment.lang("en",{ordinal:function(number){var b=number%10,output=(~~(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th";return number+output}});if(hasModule){module.exports=moment}if(typeof ender==="undefined"){this["moment"]=moment}if(typeof define==="function"&&define.amd){define("moment",[],function(){return moment})}}).call(this);
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.jira.i18n.js' */
(function(moment){var relativize=AJS.Meta.getBoolean("date-relativize"),meridiem=['AM','PM'],map={d:"D",y:"Y",a:"A",E:"d",u:"d",Z:"ZZ",z:"[GMT]ZZ",XX:"ZZ",XXX:"Z"};JIRA.translateSimpleDateFormat=function(pattern){var inQuote=false,skip=false,tmpBuffer="",actuallyTranslate=function(tmpBuffer){return map[tmpBuffer]||_.reduce(tmpBuffer,function(memo,value){return memo+(map[value]||value)},"")},reduction=_.reduce(pattern,function(memo,value,index,list){if(skip){skip=false}else{if(value==="'"){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}if(list[index+1]==="'"){memo+=value;skip=true}else{memo+=!inQuote?"[":"]";inQuote=!inQuote}}else{if(inQuote){memo+=value}else{if(!/[a-zA-Z]/.test(value)){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}memo+=value}else{if(!tmpBuffer||tmpBuffer[tmpBuffer.length-1]===value){tmpBuffer+=value}else{memo+=actuallyTranslate(tmpBuffer);tmpBuffer=value}}}}}return memo},"");if(tmpBuffer){reduction+=actuallyTranslate(tmpBuffer)}return reduction};moment.lang("jira",{months:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdays:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],weekdaysMin:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],longDateFormat:{LT:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-time")),L:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-day")),LL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-dmy")),LLL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-complete"))},meridiem:function(hours){return meridiem[+(hours>11)]},calendar:{sameDay:relativize?AJS.format("{0}Today{1} {2}","[","]","LT"):"LLL",nextDay:relativize?AJS.format("{0}Tomorrow{1} {2}","[","]","LT"):"LLL",nextWeek:"LLL",lastDay:relativize?AJS.format("{0}Yesterday{1} {2}","[","]","LT"):"LLL",lastWeek:"LLL",sameElse:"LLL"},relativeTime:{future:AJS.format("in {0}","%s"),past:AJS.format("{0} ago","%s"),s:"a few seconds",m:"a minute",mm:AJS.format("{0} minutes","%d"),h:"an hour",hh:AJS.format("{0} hours","%d"),d:"a day",dd:AJS.format("{0} days","%d"),M:"a month",MM:AJS.format("{0} months","%d"),y:"a year",yy:AJS.format("{0} years","%d")}})}(moment));
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/livestamp.js' */
(function($,moment){var timeout,updateInterval=6000,relativize=AJS.Meta.getBoolean("date-relativize"),defaultRelativizeThreshold=1000*60*60,livestamps=[],prep=function($el,timestamp){$el.data("livestampdata",timestamp);livestamps.push($el)},run=function(){update();clearTimeout(timeout);timeout=setTimeout(run,updateInterval)},update=function(){var now=moment(),sod=moment().startOf("day");livestamps=$.grep(livestamps,function($el){var timestamp=$el.data("livestampdata"),relativizeThreshold=$el.data("relativizeThreshold")||defaultRelativizeThreshold,from,to;if(!moment.isMoment(timestamp)||!$el.closest("html").length){$el.removeData("livestampdata")}else{from=$el.text();if(relativize&&Math.abs(now.diff(timestamp))<=relativizeThreshold){if(timestamp.isBefore(now)||$el.hasClass("allow-future")){to=timestamp.fromNow()}else{to=now.fromNow()}}else{to=timestamp.calendar();if(sod.diff(timestamp,"weeks")){$el.removeData("livestampdata")}}if(from!==to){$el.text(to)}}return !!$el.data("livestampdata")})},add=function($el){$el.each(function(){var $this=$(this),timestamp=$this.attr("datetime");if(timestamp){var timestampMoment=isNaN(timestamp)?moment(timestamp).zone(timestamp):moment(parseInt(timestamp,10));prep($this,timestampMoment)}});run();return $el};$.fn.livestamp=function(){return add(this)}}(jQuery,moment));
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/issuecomponents.soy' */
// This file was automatically generated from issuecomponents.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.watchersWithBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div class="autocomplete-user-target"><select id="watchers" name="watchers" data-description="', soy.$$escapeHtml("Start Typing for Users"), '" class="watchers-user-picker hidden" multiple="multiple">');
  var watcherList8 = opt_data.watchers;
  var watcherListLen8 = watcherList8.length;
  for (var watcherIndex8 = 0; watcherIndex8 < watcherListLen8; watcherIndex8++) {
    var watcherData8 = watcherList8[watcherIndex8];
    output.append('<option style="background-image:url(\'', soy.$$escapeHtml(watcherData8.avatarUrls['16x16']), '\')" selected="selected" value="', soy.$$escapeHtml(watcherData8.name), '">', soy.$$escapeHtml(watcherData8.displayName), '</option>');
  }
  output.append('</select></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersNoBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div><input type="text" class="text" id="watchers-nosearch" /><div class="description">', soy.$$escapeHtml("Type username and press enter."), '</div></div><div class="recipients"><ol class="watchers">');
  var watcherList24 = opt_data.watchers;
  var watcherListLen24 = watcherList24.length;
  for (var watcherIndex24 = 0; watcherIndex24 < watcherListLen24; watcherIndex24++) {
    var watcherData24 = watcherList24[watcherIndex24];
    JIRA.Templates.Fields.recipientUsername({username: watcherData24.name, icon: watcherData24.avatarUrls['16x16'], displayName: watcherData24.displayName, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersReadOnly = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><div class="recipients"><ol class="watchers">');
  var watcherList34 = opt_data.watchers;
  var watcherListLen34 = watcherList34.length;
  for (var watcherIndex34 = 0; watcherIndex34 < watcherListLen34; watcherIndex34++) {
    var watcherData34 = watcherList34[watcherIndex34];
    JIRA.Templates.Fields.recipientUsername({username: watcherData34.name, icon: watcherData34.avatarUrls['16x16'], displayName: watcherData34.displayName, readOnly: true, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml(opt_data.msg), '</p><ul>');
  var messageList47 = opt_data.errors;
  var messageListLen47 = messageList47.length;
  for (var messageIndex47 = 0; messageIndex47 < messageListLen47; messageIndex47++) {
    var messageData47 = messageList47[messageIndex47];
    output.append('<li>', soy.$$escapeHtml(messageData47), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:viewissue', location = '/includes/jquery/plugins/shorten/shorten.js' */
AJS.Shortener=AJS.Control.extend({_getDefaultOptions:function(){return{items:"a, span",numRows:1,shortenText:"hide",shortenOnInit:true,persist:true,expandButtonTooltip:"Click to view {0} more",collapseButtonTooltip:"Hide"}},init:function(options){if(typeof options==="string"){options={element:options}}options=options||{};this.options=AJS.$.extend(this._getDefaultOptions(),options);this._timerId=0;this.expanded=false;this.$container=AJS.$(this.options.element);this._assignEvents("body",document.body);this._ready()},_isValid:function(){return !this.initialized&&this.$container.is(":visible")&&this.$container.children().length>0},_ready:function(){if(this._isValid()){this.$items=this.$container.children(this.options.items);this.$expandButton=this._render("expandButton");this.$collapseButton=this._render("collapseButton");this._assignEvents("expand-button",".shortener-expand");this._assignEvents("collapse-button",".shortener-collapse");if(!jQuery.browser.msie||jQuery.browser.version>="9"){this._assignEvents("resize-region",window)}if(this._isCollapsedOnInit()){this.collapse()}else{this.expand()}this.initialized=true}},_renders:{"expandButton":function(){return AJS.$("<a href='#' class='ellipsis shortener-expand' title='"+this.options.expandButtonTooltip+"'></a><br>")},"collapseButton":function(){return AJS.$("<a title='Hide' class='icon icon-hide shortener-collapse' href='#'><span>"+this.options.collapseButtonTooltip+"</span></a>")}},_events:{"expand-button":{"click":function(event){if(event.currentTarget===this.$expandButton[0]){event.preventDefault();this.expand();this._saveState("expanded")}}},"collapse-button":{"click":function(event){if(event.currentTarget===this.$collapseButton[0]){event.preventDefault();this.collapse();this._saveState("collapsed");this.$container.scrollIntoView()}}},"resize-region":{"resize":function(){clearTimeout(this._timerId);if(!this.expanded){var instance=this;this._timerId=setTimeout(function(){instance.collapse()},400)}}},"body":{tabSelect:function(){this._ready()}}},_saveState:function(value){try{localStorage.setItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"),value)}catch(QUOTA_EXCEEDED_ERR){}},_loadState:function(){return localStorage.getItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"))},_isCollapsedOnInit:function(){var shortenOnInit=this._loadState();if(shortenOnInit!==null){return shortenOnInit!=="expanded"}return this.options.shortenOnInit},_removeButtons:function(){this.$expandButton.remove();this.$collapseButton.remove()},_getOverflowIndex:function(){if(this.$items.length>1){var currentRow=1;var prevItemPageX=-1;for(var i=0;i<this.$items.length;i++){var itemPageX=this.$items.eq(i).offset().left;if(itemPageX<=prevItemPageX){currentRow++;if(currentRow>this.options.numRows){return i}}prevItemPageX=itemPageX}}return -1},expand:function(){this._removeButtons();if(this._getOverflowIndex()>0){this.$collapseButton=this._render("collapseButton");this.$container.append(this.$collapseButton);this.$container.css("height","auto");if(jQuery.browser.msie&&jQuery.browser.version<"9"){AJS.$("body").toggleClass("reflow")}}this.expanded=true},collapse:function(){this._removeButtons();var i=this._getOverflowIndex();if(i>0){this.$container.css({"position":"absolute","visibility":"hidden","width":this.$container[0].clientWidth+"px"});var $expandButtonContent=this.$expandButton.first();do{var remainingItemCount=(this.$items.length-i);$expandButtonContent.text("("+remainingItemCount+")");this.$expandButton.insertBefore(this.$items[i]);i--;var oi=this.$items.eq(i).offset();var ob=this.$expandButton.offset();if(oi.left<ob.left&&ob.top<oi.top+10){break}}while(i>0);var height=(i<this.$items.length-1)?(this.$items.eq(i+1).offset().top-this.$container.offset().top)+"px":"auto";this.$container.css({"height":height,"position":"static","visibility":"visible","width":"auto"});$expandButtonContent.attr("title",AJS.format(this.options.expandButtonTooltip,remainingItemCount));if(jQuery.browser.msie&&jQuery.browser.version<"9"){AJS.$("body").toggleClass("reflow")}}else{this.$container.css("height","auto")}this.expanded=false}});jQuery.fn.shorten=function(options){var res=[];options=options||{};this.each(function(){options.element=this;res.push(new AJS.Shortener(options))});return res};
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initShorten.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){AJS.$(".shorten",$ctx).shorten()});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initToggleBlock.js' */
AJS.$(function(){new JIRA.ToggleBlock({blockSelector:".toggle-wrap",triggerSelector:".mod-header .toggle-title",storageCollectionName:"block-states",});if(JIRA.Events.ISSUE_REFRESHED){JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS)}})}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSlideshow.js' */
(function($){var defaultOpts={type:"image",centerOnScroll:true,onStart:AJS.disableKeyboardShortcuts,onClosed:AJS.enableKeyboardShortcuts};function initGallery($ctx){var transition=$.browser.msie&&$.browser.version<=8?"fade":"elastic";var galleryOpts=$.extend({},defaultOpts,{transitionIn:transition,transitionOut:transition});$ctx.find(".gallery, [id$='_thumb']").each(function(){$(this).fancybox(galleryOpts)});$ctx.find("#attachment_thumbnails .attachment-title").click(function(e){if(e.which===1){e.preventDefault();$(this).closest(".attachment-content").find(".gallery").click()}})}function initWorkflow($ctx){$ctx.find("a.issueaction-viewworkflow:not(.new-workflow-designer)").each(function(){$(this).fancybox(defaultOpts)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx,reason){initGallery($ctx);initWorkflow($ctx)});$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="attachmentmodule"){initGallery($new)}else{if(panel==="details-module"){initWorkflow($new)}}})}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initComment.js' */
(function($){var commentForm=JIRA.Issue.CommentForm={setCaretAtEndOfCommentField:function(){var $field=this.getField(),field=$field[0],length;if($field.length){length=$field.val().length;$field.scrollTop($field.attr("scrollHeight"));if(field.setSelectionRange&&length>0){field.setSelectionRange(length,length)}}},disable:function(){this.getForm().find("textarea").attr("readonly","readonly");this.getForm().find(":submit").attr("disabled","disabled")},isDirty:function(){var field=this.getField();if(field.length){return field[0].value!==field[0].defaultValue}return false},handleBrowseAway:function(){var isDirty=commentForm.isDirty(),isVisible=commentForm.getForm()&&commentForm.getForm().is(":visible");if(isDirty&&isVisible){return "You have entered a comment on this issue. If you navigate away from this page without first saving, the comment will be lost."}},setSubmitState:function(){if(jQuery.trim(this.getField().val()).length>0){this.getForm().find(":submit").removeAttr("disabled")}else{this.getForm().find(":submit").attr("disabled","disabled")}},enable:function(){this.getForm().find("textarea").removeAttr("readonly");this.getForm().find(":submit").removeAttr("disabled")},getCommentVisibility:function(){var visibility=$("#commentLevel :selected").val();if(visibility){var split_v=visibility.split(":");return{"type":split_v[0],"value":$("#commentLevel :selected").text()}}return null},ajaxSubmit:function(callback){var $loading=jQuery('<span class="icon throbber loading"></span>');var issueId=JIRA.Issue.getIssueId();var issueKey=JIRA.Issue.getIssueKey();var restURL=contextPath+"/rest/api/2/issue/"+issueKey+"/comment";var newComment={"body":this.getField()[0].value};var visibility=this.getCommentVisibility();if(visibility){newComment["visibility"]=visibility}$.ajax({url:restURL,type:"POST",contentType:"application/json",data:JSON.stringify(newComment),success:function(data){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"]);JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[issueId,{complete:function(){var newCommentId="comment-"+data.id;jQuery("#"+newCommentId).scrollIntoView({marginBottom:200,marginTop:200});var $focusedTabs=$("#issue_actions_container > .issue-data-block.focused");$focusedTabs.removeClass("focused");var $newfocusedTab=$("#"+newCommentId);$newfocusedTab.addClass("focused");$loading.remove();footerComment.hide(true);commentForm.enable()}}])},error:function(xhr){function buildErrorDialog(errorMessage){var errorContent="<h2>"+"Error"+"</h2>"+'<div class="ajaxerror">'+'<div class="aui-message error">'+'<span class="aui-icon icon-warning"/>'+errorMessage+"</div>"+"</div>";return $(errorContent)}var response=$.parseJSON(xhr.responseText);var content;if(response&&response.errors&&response.errors.comment){content=buildErrorDialog(response.errors.comment)}else{content=JIRA.SmartAjax.buildDialogErrorContent(xhr)}new JIRA.FormDialog({content:content}).show();$loading.remove();commentForm.enable()}});$loading.appendTo(this.getForm().find(":submit").parent())},getForm:function(){var $form=$("form#issue-comment-add");if($form.length===1){this.$form=$form}return this.$form||$()},getField:function(){return this.getForm().find("#comment")},getSubmitButton:function(){return this.getForm().find("#issue-comment-add-submit")},hide:function(cancel){if(cancel){this.cancel()}this.getForm().detach();if(JIRA.Events.UNLOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"])}},show:function(){this.focus();if(JIRA.Events.LOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.LOCK_PANEL_REFRESHING,["addcommentmodule"])}},focus:function(){this.focusField();this.setCaretAtEndOfCommentField()},focusField:function(){this.getField().focus().trigger("keyup");this.getSubmitButton().scrollIntoView({marginBottom:200})},showNoCommentMsg:function(e){if(this.getField().val()===""){$("#emptyCommentErrMsg").show();return true}},cancel:function(){var instance=this;setTimeout(function(){instance.getField().val("")},100);$("#comment-preview_link.selected").click()}};var footerComment={getModule:function(){return $("#addcomment")},isActive:function(){return this.getModule().hasClass("active")},hide:function(cancel){if(this.isActive()){this.getModule().removeClass("active");commentForm.hide(cancel)}},ajaxSubmit:function(){commentForm.ajaxSubmit(function(){footerComment.hide()})},show:function(){if(!this.isActive()){this.getModule().addClass("active");this.appendForm();commentForm.show()}else{commentForm.focusField()}},appendForm:function(){this.getModule().find(".mod-content").append(commentForm.getForm())}};var oldBeforeUnload=window.onbeforeunload;$(document).delegate("body:not(.ka) #issue-comment-add","submit",function(e){window.onbeforeunload=oldBeforeUnload}).delegate(".ka #addcomment #issue-comment-add","submit",function(e){footerComment.ajaxSubmit();e.preventDefault()}).delegate(".issue-header #comment-issue","click",function(e){footerComment.show();e.preventDefault()}).delegate("#footer-comment-button","click",function(e){footerComment.show();e.preventDefault()}).delegate("#addcomment .cancel","click",function(e){e.preventDefault();footerComment.hide(true)}).delegate("#issue-comment-add","submit",function(){window.setTimeout(function(){commentForm.disable()},0)}).delegate("#issue-comment-add #comment","input",function(){commentForm.setSubmitState()}).delegate("#issue-comment-add input[type='submit']","click",function(e){if(commentForm.showNoCommentMsg()){e.preventDefault()}}).bind("showWikiInput",function(){var $commentField=commentForm.getField();if($commentField.is(":visible:enabled")){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated");if($commentField.length>0){$commentField.focus()}commentForm.setCaretAtEndOfCommentField()}}).bind("showWikiPreview",function(){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated")});window.onbeforeunload=function(){return oldBeforeUnload.apply(this,arguments)||commentForm.handleBrowseAway.apply(this,arguments)};$(function(){new AJS.SecurityLevelSelect($("#commentLevel"))});JIRA.Issue.getDirtyCommentWarning=commentForm.handleBrowseAway;JIRA.Issue.invokeCommentTrigger=function(){var addIssueComment=AJS.$(".add-issue-comment");if(addIssueComment.length===0){return }var toolbarTrigger=addIssueComment.filter(".toolbar-trigger");if(toolbarTrigger.length>0){toolbarTrigger.click()}else{addIssueComment.click()}}})(AJS.$);AJS.$(function(){if(parseUri(window.location.href).anchor==="add-comment"){AJS.$("#footer-comment-button").click()}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initCustomFieldTabs.js' */
(function($,scope){var activateTab=function(tabName){var tabTrigger;if(typeof tabName!=="string"&&tabName.length>0){return }if(tabName[0]!=="#"){tabName="#"+tabName}console.log("activating tab",tabName);tabTrigger=$("a[href='"+tabName+"']",scope);if(tabTrigger.length){AJS.tabs.change(tabTrigger)}};var revealer=function(e){var $containingTab=$(e.target).closest(".tabs-pane");if($containingTab.length>0){activateTab($containingTab.attr("id"))}};$(function(){if(JIRA.Events.NEW_CONTENT_ADDED){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context){var $customFieldModule=$context.find(scope);$customFieldModule.unbind("reveal");$customFieldModule.bind("reveal",revealer);AJS.tabs.setup()})}if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="details-module"){var $activeTab=$existing.find(scope).find(".active-tab");if($activeTab.length===1){activateTab($activeTab.find("a").attr("href"))}}})}$(scope).bind("reveal",revealer)})})(AJS.$,"#customfieldmodule");
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSubtaskTimeLogging.js' */
(function($){$(document).delegate("#tt_include_subtasks input","click",function(e){if(AJS.$(this).is(":checked")){AJS.$("#tt_info_single").hide();AJS.$("#tt_info_aggregate").show()}else{AJS.$("#tt_info_aggregate").hide();AJS.$("#tt_info_single").show()}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initWatchers.js' */
AJS.$(function(){var WatcherModel=Backbone.Model.extend({url:function(){return[AJS.contextPath(),"rest/api/2/issue",AJS.Meta.get("issue-key"),"watchers"].join("/")},initialize:function(){this.set("canBrowseUsers",AJS.Meta.get("can-search-users"));this.set("isReadOnly",!AJS.Meta.get("can-edit-watchers"))},_parseResponse:function(responseText){try{return JSON.parse(responseText)}catch(e){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var msg="<p>"+"Communications Breakdown"+"</p>"+"<p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(msg,{closeable:true})},getUser:function(username){return AJS.$.ajax({url:AJS.contextPath()+"/rest/api/2/user?username="+encodeURIComponent(username),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)})},handleErrorResponse:function(xhr,msg){var errorCollection=this._parseResponse(xhr.responseText);if(errorCollection.errorMessages){var html=JIRA.Templates.Issue.error({msg:msg,errors:errorCollection.errorMessages});JIRA.Messages.showErrorMsg(html,{closeable:true})}this.trigger("errorOccurred")},addWatcher:function(username){return AJS.$.ajax({type:"post",url:this.url(),global:false,data:JSON.stringify(username),contentType:"application/json",error:_.bind(function(xhr){this.handleErrorResponse(xhr,"There was an error adding watcher")},this)})},removeWatcher:function(username){return AJS.$.ajax({type:"delete",global:false,url:this.url()+"?username="+encodeURIComponent(username),error:_.bind(function(xhr){this.handleErrorResponse(xhr,"There was an error removing watcher")},this)})}});var AbstractWatchersView=Backbone.View.extend({renderNoWatchers:function(){if(this.$(".recipients li").length===0){var $empty=AJS.$("<div class='aui-message info watchers-empty' />").html("<span class='aui-icon icon-info' /> "+"There are no watchers.");this.$("fieldset").append($empty)}else{this.$(".watchers-empty").remove()}},render:function(){var deferred=jQuery.Deferred();this.model.fetch().done(_.bind(function(){this._render();this.renderNoWatchers();deferred.resolve(this.$el);window.setTimeout(_.bind(function(){this.focus()},this),0)},this));return deferred.promise()},watch:function(){AJS.$("#watching-toggle").text("Stop watching this issue")},unwatch:function(){AJS.$("#watching-toggle").text("Start watching this issue")},focus:AJS.$.noop,_incrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount+1);this.renderNoWatchers()},_decrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount-1);this.renderNoWatchers()}});var WatchersView=AbstractWatchersView.extend({events:{selected:"addWatcherToModel",unselect:"removeWatcherFromModel"},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersWithBrowse(this.model.toJSON()));var picker=new JIRA.MultiUserListPicker({element:this.$el.find(".watchers-user-picker"),width:220})},focus:function(){this.$el.find("#watchers-textarea").focus()},addWatcherToModel:function(e,descriptor){e.preventDefault();this.model.addWatcher(descriptor.value()).done(_.bind(function(){this._incrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.watch()}},this))},removeWatcherFromModel:function(e,descriptor){this.model.removeWatcher(descriptor.value()).done(_.bind(function(){this._decrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.unwatch();JIRA.trace("jira.issue.watcher.deleted")}},this))}});var WatchersNoBrowseView=AbstractWatchersView.extend({events:{"click .remove-recipient":"removeWatcher","submit":"addWatcher"},addWatcher:function(e){e.preventDefault();this.removeInlineError();var $field=AJS.$("#watchers-nosearch");var username=AJS.$.trim(AJS.$("#watchers-nosearch").val());$field.attr("disabled","disabled");if(this.hasUsername(username)){$field.removeAttr("disabled");this.showInlineError(AJS.format("User {0} is already watching this issue",username));$field.val("")}else{this.model.getUser(username).done(_.bind(function(data){var html=JIRA.Templates.Fields.recipientUsername({icon:data.avatarUrls["16x16"],username:data.name,displayName:data.displayName});if(username===AJS.Meta.get("remote-user")){this.watch()}$field.val("");this.$(".watchers").append(html);this.model.addWatcher(data.name);this._incrementWatcherCount()},this)).fail(_.bind(function(xhr){if(xhr.status===404){this.showInlineError("User does not exist")}},this)).always(function(){$field.removeAttr("disabled").focus()})}},hasUsername:function(username){var result=false;this.$(".watchers li").each(function(){if(AJS.$(this).attr("data-username")===username){result=true;return false}});return result},removeInlineError:function(){this.$(".error").remove()},showInlineError:function(msg){AJS.$("<div />").addClass("error").text(msg).insertAfter(this.$(".description"))},focus:function(){AJS.$("#watchers-nosearch").focus()},removeWatcher:function(e){e.preventDefault();var $item=AJS.$(e.target).closest("li");var username=$item.attr("data-username");if(username){$item.remove();this.model.removeWatcher(username);this._decrementWatcherCount();if(username===AJS.Meta.get("remote-user")){this.unwatch()}}JIRA.trace("jira.issue.watcher.deleted")},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersNoBrowse(this.model.toJSON()))}});var WatchersReadOnly=AbstractWatchersView.extend({_render:function(){this.$el.html(JIRA.Templates.Issue.watchersReadOnly(this.model.toJSON()))}});function getView(model){if(model.get("isReadOnly")){return WatchersReadOnly}else{if(model.get("canBrowseUsers")){return WatchersView}else{return WatchersNoBrowseView}}}var dialog=AJS.InlineDialog("#view-watcher-list","watchers",function(contents,trigger,doShowPopup){var loadingIcon=AJS.$("#watching-toggle").next(".icon");var model=new WatcherModel();loadingIcon.addClass("loading");var view=getView(model);new view({model:model}).render().done(function(viewHtml){contents.html(viewHtml);contents.find(".cancel").click(function(e){dialog.hide();e.preventDefault()});loadingIcon.removeClass("loading");doShowPopup()});model.on("errorOccurred",function(){dialog.hide()})},{width:240,useLiveEvents:true,items:"#view-watcher-list",preHideCallback:function(){return !AJS.InlineLayer.current}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog.hide()}});AJS.$(document).click(function(e){var currentDialog=AJS.InlineDialog.current;if(currentDialog&&currentDialog.id==="watchers"){if(!jQuery(e.target).closest("#inline-dialog-watchers, #watchers-suggestions").length){currentDialog.hide()}}});AJS.$(document).bind("showLayer",function(e,type,hash){if(type&&type==="inlineDialog"&&hash&&hash.id&&hash.id==="watchers"){AJS.$("body").unbind("click.watchers.inline-dialog-check")}})});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/ViewIssueTabs.js' */
JIRA.ViewIssueTabs=(function(){var useHistoryApi=AJS.Meta.get("viewissue-use-history-api")!==false;var AJAX_LOAD_CLASS="ajax-activity-content";var AJAX_LINK_SELECTOR=AJS.format("a.{0}",AJAX_LOAD_CLASS);var issueTabLoadedListeners=[];var $tabWrapper,$tabContents;var xhrInProgress;function dispatchIssueTabLoadedEvent(container){container=container||document;AJS.$.each(issueTabLoadedListeners,function(i,fn){fn(container)})}function bindToTabDivs(container){var $newTabWrapper=AJS.$(container).find(".issuePanelWrapper");var $newTabContents=AJS.$(container).find("#issue_actions_container");$tabContents=$newTabContents.length?$newTabContents:$tabContents;$tabWrapper=$newTabWrapper.length?$newTabWrapper:$tabWrapper}function dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey){var errorPopup=new JIRA.FormDialog({id:"issue-tab-error-dialog",widthClass:"small",content:JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,false)});setActiveTab(activeTabKey);$tabContents.show();errorPopup.show()}function setActiveTab(activeTabKey){AJS.$("#issue-tabs li").each(function(){var $li=AJS.$(this);var tabKey=$li.data("key");var labelHtml=AJS.format("<strong>{0}</strong>",$li.data("label"));if(tabKey==activeTabKey){$li.addClass("active");$li.html(labelHtml)}else{$li.removeClass("active");var id=$li.data("id");var href=$li.data("href");$li.html(AJS.format('<a id="{0}" href="{1}" class="{2}">{3}</a>',id,href,AJAX_LOAD_CLASS,labelHtml))}});enableAjaxOnLinks(AJS.$("#issue-tabs"))}function putTabInLoadingState(activeTabKey){setActiveTab(activeTabKey)}function enableAjaxOnLinks(context){var activeTabKey=AJS.$(context).find("li.active").data("key");AJS.$(context).find(AJAX_LINK_SELECTOR).click(function(event){if(event.metaKey){return }event.preventDefault();if(xhrInProgress){xhrInProgress.abort()}var $a=AJS.$(this);var containerID="#activitymodule div.mod-content";var loadingTabKey=$a.parent().data("key");if(loadingTabKey){putTabInLoadingState(loadingTabKey)}var xhr=JIRA.SmartAjax.makeRequest({jqueryAjaxFn:useHistoryApi?AJS.$.pjax:AJS.$.ajax,headers:{"X-PJAX":true},container:containerID,url:$a.attr("href"),timeout:null,complete:function(xhr,status,smartAjaxResult){if(status!="abort"){xhrInProgress=null;if(!smartAjaxResult.successful){if(smartAjaxResult.status<300||smartAjaxResult.status>=400){dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey)}return }var container=AJS.$(containerID);var newElements=AJS.$(smartAjaxResult.data);if(!useHistoryApi){smartUpdate(container,newElements)}dispatchIssueTabLoadedEvent(container);JIRA.trace("jira.issue.tab.loaded")}}});jQuery(xhr).throbber({target:$tabWrapper});xhrInProgress=xhr})}function smartUpdate(container,newElements){var newTabs=newElements.filter(".tabwrap");var oldTabs=container.find(".tabwrap");var newContents=newElements.find("#issue_actions_container").contents();var oldContents=$tabContents.contents();if(newTabs.length&&oldTabs.length&&newContents.length&&oldContents.length){oldTabs.replaceWith(newTabs);var currentContentHeight=$tabContents.height();$tabContents.append(newContents);var newContentHeight=$tabContents.height()-currentContentHeight;var visibleHeightDifference=AJS.$(window).scrollTop()+AJS.$(window).height()-($tabContents.offset().top+newContentHeight);if(visibleHeightDifference>0){$tabContents.css("height",newContentHeight+visibleHeightDifference);oldContents.remove();var preDelay=150;setTimeout(function(){var pixelsPerSecond=500;var animSpeed=visibleHeightDifference/pixelsPerSecond*1000;$tabContents.animate({height:newContentHeight},animSpeed,"easeOutQuart",function(){$tabContents.css("height","auto")})},preDelay)}else{$tabContents.empty().append(newContents)}newElements.filter("script").each(function(){AJS.$.globalEval(this.text||this.textContent||this.innerHTML||"")})}else{container.empty().append(newElements)}}function appendHashCodeToLinks(context){AJS.$(context).find(AJAX_LINK_SELECTOR).each(function(){var $a=AJS.$(this);$a.attr("href",$a.attr("href")+"#issue-tabs")})}function processActivityModuleLinks(context){if(!useHistoryApi||AJS.$.support.pjax){enableAjaxOnLinks(context)}else{appendHashCodeToLinks(context)}}function setupMouseoverBehaviour(context){if(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)===7){jQuery("a.twixi",context).bind("focus",function(e){e.preventDefault()})}else{jQuery(context).bind("moveToFinished",function(event,target){jQuery("a.twixi:visible",target).focus()})}}function initLivestamp(context){context.find("time.livestamp").livestamp()}function onTabReady(listener){if(jQuery.inArray(listener,issueTabLoadedListeners)<0){issueTabLoadedListeners.push(listener)}}onTabReady(bindToTabDivs);onTabReady(processActivityModuleLinks);onTabReady(setupMouseoverBehaviour);onTabReady(JIRA.userhover);onTabReady(initLivestamp);return{onTabReady:onTabReady,domReady:dispatchIssueTabLoadedEvent}})();AJS.$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="activitymodule"){var $focusedTab=$existing.find("#issue_actions_container > .issue-data-block.focused");if($focusedTab.length===1){$new.find("#"+$focusedTab.attr("id")).addClass("focused")}}})}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(event,$el){JIRA.ViewIssueTabs.domReady($el)});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVoters.js' */
AJS.$(function(){var toggleVotingAndWatching=function(trigger,className,resultContainer,issueOpTrigger,i18n){var classNameOn=className+"-on",classNameOff=className+"-off",restPath="/voters",spinner=trigger.next(".icon"),data,method="POST";if(trigger.hasClass(classNameOn)){method="DELETE"}if(className.indexOf("watch")!==-1){restPath="/watchers"}trigger.removeClass(classNameOn).removeClass(classNameOff);if(method==="POST"){data={dummy:true}}AJS.$(JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/api/1.0/issues/"+trigger.attr("rel")+restPath,type:method,dataType:"json",data:data,contentType:"application/json",complete:function(xhr,textStatus,smartAjaxResult){var optIn=method==="POST";if(smartAjaxResult.successful){if(optIn){trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}else{trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}resultContainer.text(smartAjaxResult.data.count);resultContainer[optIn?"addClass":"removeClass"](classNameOn);resultContainer[optIn?"removeClass":"addClass"](classNameOff)}else{if(!smartAjaxResult.aborted){alert(JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult,{alert:true}))}if(optIn){trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}else{trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}}}})).throbber({target:spinner})};AJS.$(document).delegate(".toggle-vote-issue","click",function(e){e.preventDefault();AJS.$("#vote-toggle").click()});AJS.$(document).delegate("#toggle-watch-issue","click",function(e){e.preventDefault();AJS.$("#watching-toggle").click()});var addI18nErrorCodes=function(i18n){AJS.$("input[type=hidden][id|=error]").each(function(index,elem){var i18n_id=elem.id.replace("error-","");i18n[i18n_id]=elem.value})};AJS.$(document).delegate("#vote-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Remove vote for this issue",titleOff:"Vote for this issue",textOn:"Remove Vote",textOff:"Add Vote",actionTextOff:"Vote",actionTextOn:"Voted"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"vote-state",AJS.$("#vote-data"),AJS.$("#toggle-vote-issue"),i18n)});AJS.$(document).delegate("#watching-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Stop watching this issue",titleOff:"Start watching this issue",textOn:"Stop Watching",textOff:"Watch Issue",actionTextOff:"Watch",actionTextOn:"Watching"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"watch-state",AJS.$("#watcher-data"),AJS.$("#toggle-watch-issue"),i18n)})});
/* module-key = 'jira.webresources:mark-and-quote-module', location = '/includes/jira/issue/markAndQuote.js' */
define("jira/issue/mark-and-quote",["jquery"],function($){var MarkAndQuote={};function onClick(event){MarkAndQuote.triggerQuoteButton({x:event.pageX,y:event.pageY})}MarkAndQuote.isEnabled=function isEnabled(){if(MarkAndQuote.enabled==null){$.ajax({url:contextPath+"/rest/api/2/mypreferences?key=mark-and-quote",type:"GET",contentType:"application/json",dataType:"json",async:false,success:function retrieveState(data,status){MarkAndQuote.enabled=data},error:function logError(xhr,status){MarkAndQuote.enabled=xhr.statusText=="Not Found"}})}return MarkAndQuote.enabled};MarkAndQuote.setEnabled=function setEnabled(whether){if(MarkAndQuote.enabled!=whether){MarkAndQuote.enabled=whether;$.ajax({url:contextPath+"/rest/api/2/mypreferences?key=mark-and-quote",type:"PUT",contentType:"application/json",dataType:"json",data:whether?"true":"false"})}};MarkAndQuote.getSelectedText=function getSelectedText(){function enclosedWithinSameParent(startElem,endElem){startElem=(startElem instanceof $)?startElem:$(startElem);endElem=(endElem instanceof $)?endElem:$(endElem);var validParentElementsSelector=".action-body, #description-val";var closestToStartElement=startElem.closest(validParentElementsSelector);var closestToEndElement=endElem.closest(validParentElementsSelector);return closestToEndElement.size()&&closestToStartElement.size()&&closestToEndElement[0]==closestToStartElement[0]}var text="";var selection;var withinAQuotableElement=false;if(window.getSelection){selection=window.getSelection()}else{if(document.getSelection){selection=document.getSelection()}}if(selection&&selection.rangeCount>0&&!selection.isCollapsed){if(selection.anchorNode){withinAQuotableElement=enclosedWithinSameParent(selection.anchorNode,selection.focusNode)}else{if(selection.baseNode){withinAQuotableElement=enclosedWithinSameParent(selection.baseNode,selection.extentNode)}}}if(selection&&withinAQuotableElement){text=selection.toString()}return $.trim(text)};MarkAndQuote.triggerQuoteButton=function triggerQuoteButton(coords){var selectedText=MarkAndQuote.getSelectedText();if(selectedText){MarkAndQuote.selectedText=selectedText;MarkAndQuote.show(coords);setTimeout(function(){$("body").one("click",MarkAndQuote.hide)},200)}};MarkAndQuote.canComment=function canComment(){var hasCommentRights=($("#comment-issue").length==1);var isWikiMarkupOn=JIRA.Issue.CommentForm.getForm().find("#comment-preview_link").length==1;return hasCommentRights&&isWikiMarkupOn};MarkAndQuote.createButton=function createButton(within){MarkAndQuote.popup=$(JIRA.Templates.Issue.MarkAndQuote.popup({popupClass:"mark-and-quote-popup",buttonClass:"mark-and-quote-button",buttonText:" "+"Quote",disableLinkClass:"mark-and-quote-turn-off",disableLinkText:"Disable this"}));MarkAndQuote.popup[0].popup={persistent:true};within.append(MarkAndQuote.popup);MarkAndQuote.popup.find(".mark-and-quote-button").on("click",MarkAndQuote.buttonClick);MarkAndQuote.popup.find(".mark-and-quote-turn-off").on("click",function disableMarkAndQuote(e){e.preventDefault();MarkAndQuote.setEnabled(false);MarkAndQuote.displayDisabledState(JIRA.Issue.CommentForm.getForm().find(".field-group.comment-input"));MarkAndQuote.triggerAnalyticsEvent("disabled")})};MarkAndQuote.displayDisabledState=function displayDisabledState(within){var disabledInfoClass="mark-and-quote-disabled-info";var disabledInfoClassSelector="."+disabledInfoClass;if(within.find(disabledInfoClassSelector).length==1){return }if(within&&!MarkAndQuote.isEnabled()&&MarkAndQuote.canComment()){var element=$(JIRA.Templates.Issue.MarkAndQuote.disabledInfo({className:disabledInfoClass,infoText:"Mark quoting is disabled",linkClass:"mark-and-quote-reenable",linkText:"Enable"}));element.find(".mark-and-quote-reenable").on("click",function(e){e.preventDefault();within.find(disabledInfoClassSelector).remove();MarkAndQuote.setEnabled(true);MarkAndQuote.triggerAnalyticsEvent("enabled")});within.append(element)}};MarkAndQuote.handleContentAdded=function handleContentAdded(context,reason){context.each(function hookOnClicks(){var ctx=$(this);ctx.find("#issue_actions_container").on("mouseup dblclick",".activity-comment.expanded",onClick);ctx.find("#description-val").on("mouseup dblclick",onClick)});context.each(function displayDisabledState(){JIRA.Issue.CommentForm.getForm().find(".field-group.comment-input").each(function(){MarkAndQuote.displayDisabledState($(this))})});if(reason=="pageLoad"){AJS.whenIType("q").execute(MarkAndQuote.buttonClick);if(MarkAndQuote.popup==null){MarkAndQuote.createButton($("body"))}}};MarkAndQuote.show=function showButton(coords){if(MarkAndQuote.canComment()&&MarkAndQuote.isEnabled()){MarkAndQuote.popup.removeClass("hidden").css({top:coords.y+15,left:coords.x-35});MarkAndQuote.triggerAnalyticsEvent("displayed")}};MarkAndQuote.hide=function hideButton(){if(MarkAndQuote.popup){MarkAndQuote.popup.addClass("hidden")}$("body").off("click",MarkAndQuote.hide)};MarkAndQuote.openComment=function openComment(){$("#comment-issue").trigger("click")};MarkAndQuote.buttonClick=function buttonClick(){if(MarkAndQuote.selectedText&&MarkAndQuote.canComment()){MarkAndQuote.triggerAnalyticsEvent("used");MarkAndQuote.openComment();var commentField=$("#comment");if(commentField.length==0){setTimeout(MarkAndQuote.buttonClick,0)}else{var newValue=commentField.val()+"{quote}"+MarkAndQuote.selectedText+"{quote}\n";commentField.val(newValue)}}MarkAndQuote.selectedText=null};MarkAndQuote.triggerAnalyticsEvent=function analytics(eventName){AJS.trigger("analyticsEvent",{name:"jira.markAndQuote",data:{type:eventName}})};MarkAndQuote.popup=null;MarkAndQuote.selectedText=null;MarkAndQuote.enabled=null;return MarkAndQuote});AJS.namespace("JIRA.Issue.Quote",null,require("jira/issue/mark-and-quote"));
/* module-key = 'jira.webresources:mark-and-quote-module', location = '/includes/templates/jira/issue/markAndQuote.soy' */
// This file was automatically generated from markAndQuote.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }
if (typeof JIRA.Templates.Issue.MarkAndQuote == 'undefined') { JIRA.Templates.Issue.MarkAndQuote = {}; }


JIRA.Templates.Issue.MarkAndQuote.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="inline-dialog-mark-and-quote" class="aui-inline-dialog hidden ', soy.$$escapeHtml(opt_data.popupClass), '"><div class="contents"><div>');
  aui.buttons.button({text: opt_data.buttonText, tagName: 'a', extraClasses: opt_data.buttonClass, iconType: 'aui', iconClass: 'aui-icon-small mark-and-quote-icon icon-comment'}, output);
  output.append('</div><div><a href="#" class="', soy.$$escapeHtml(opt_data.disableLinkClass), '">', soy.$$escapeHtml(opt_data.disableLinkText), '</a></div></div><div id="arrow-mark-and-quote" class="arrow aui-css-arrow"/></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.MarkAndQuote.disabledInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="', soy.$$escapeHtml(opt_data.className), '">', soy.$$escapeHtml(opt_data.infoText), '   <a href="#" class="', soy.$$escapeHtml(opt_data.linkClass), '">', soy.$$escapeHtml(opt_data.linkText), '</a></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:mark-and-quote-resources', location = '/includes/jira/issue/initMarkAndQuote.js' */
if((!AJS.$("html").hasClass("msie")||AJS.$("html").hasClass("msie-gt-8"))&&AJS.DarkFeatures.isEnabled("com.atlassian.jira.mark-and-quote")){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){JIRA.Issue.Quote.handleContentAdded(context,reason)})};
/* module-key = 'jira.webresources:attach-screenshot-resources', location = '/includes/jira/issue/attachScreenshot.js' */
AJS.namespace("JIRA.Issue.AttachScreenshot");(function initializeAttachScreenshot(){AJS.EventQueue=AJS.EventQueue||[];AJS.$(document).on("click","#attach-screenshot",function(){AJS.EventQueue.push({name:"attach.screenshot.display",properties:{}})})})();
/* module-key = 'com.atlassian.jira.plugins.jira-bitbucket-connector-plugin:requiredResourceForAjaxCommitsTab', location = 'javascripts/dvcs-tabs.js' */
if(typeof(com)=="undefined"){com={}}if(typeof(com.atlassian)=="undefined"){com.atlassian={}}if(typeof(com.atlassian.jira)=="undefined"){com.atlassian.jira={}}if(typeof(com.atlassian.jira.dvcs)=="undefined"){com.atlassian.jira.dvcs={}}com.atlassian.jira.dvcs.showChangesetByFork=function(d,b,c,a){AJS.$("#"+d+" .CommitPanel").each(function(f,e){AJS.$(e).hide()});AJS.$("#"+d+"-"+b).show();com.atlassian.jira.dvcs.registerForksTooltip(d,c,a)};com.atlassian.jira.dvcs.registerForksTooltip=function(c,b,a){com.atlassian.jira.dvcs.registerInlineDialogTooltip(AJS.$("#fork-drop-down-"+c),"This changeset is present in multiple repositories (forks). Currently showing <a href='"+a+"' target='_blank'>"+b+"</a>.")};com.atlassian.jira.dvcs.registerInlineDialogTooltip=function(b,a){AJS.InlineDialog(AJS.$(b),"tooltip_"+AJS.$(b).attr("id"),function(d,c,e){d.css({padding:"10px"}).html(a);e();return false},{onHover:true,hideDelay:200,showDelay:1000,arrowOffsetX:-8,offsetX:-80,addActiveClass:false})};AJS.$(document).on("click","#dvcs-commits-tabpanel.ajax-activity-content",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"issue"}})});AJS.$(document).on("click",".dvcs-link",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.linkclick",data:{type:AJS.$(this).attr("data-link-type")}})});AJS.$(document).on("click",'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-bitbucket-connector-plugin-dvcs-commits-greenhopper-tab"]',function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"agile"}})});
/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:draggableattachment', location = 'viewissue/initDraggableAttachment.js' */
(function($) {
    $.event.props.push("dataTransfer");

    $('[draggable=true]').live("dragstart", function(evt) {
        var $this = AJS.$(this);
        var dataTransfer = evt.dataTransfer;
        dataTransfer.effectAllowed = 'copy';
        dataTransfer.dropEffect = 'copy';
        dataTransfer.setData("DownloadURL", $this.data('downloadurl'));
        if (!$this.find('img').length) {
            dataTransfer.setDragImage($this.closest('li').find('img:visible')[0], 8, 8);
        }
    });
})(AJS.$);
/* module-key = 'com.atlassian.auiplugin:aui-experimental-expander', location = 'js/atlassian/aui-experimental-expander.js' */
(function(C){var D=C(document),B=function(F){var E={};E.$trigger=C(F.currentTarget);E.$content=D.find("#"+E.$trigger.attr("aria-controls"));E.triggerIsParent=E.$content.parent().filter(E.$trigger).length!=0;E.$shortContent=E.triggerIsParent?E.$trigger.find(".aui-expander-short-content"):null;E.height=E.$content.css("min-height");E.isCollapsible=E.$trigger.data("collapsible")!=false;E.replaceText=E.$trigger.attr("data-replace-text");E.replaceSelector=E.$trigger.data("replace-selector");return E},A=function(F){if(F.replaceText){var E=F.replaceSelector?F.$trigger.find(F.replaceSelector):F.$trigger;F.$trigger.attr("data-replace-text",E.text());E.text(F.replaceText)}};EXPANDER_EVENTS={"aui-expander-invoke":function(H){var E=C(H.currentTarget);var G=D.find("#"+E.attr("aria-controls"));var F=E.data("collapsible")!=false;if(G.attr("aria-expanded")=="true"&&F){E.trigger("aui-expander-collapse")}else{E.trigger("aui-expander-expand")}},"aui-expander-expand":function(F){var E=B(F);E.$content.attr("aria-expanded","true");if(E.height!="0px"){E.$content.css("height","auto")}else{E.$content.attr("aria-hidden","false")}A(E);if(E.triggerIsParent){E.$shortContent.hide()}E.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(I){var G=B(I),F,H=parseInt(G.$content.css("line-height"),10),E=G.$content.children().first().height();if(G.height!="0px"){G.$content.css("height",0)}else{G.$content.attr("aria-hidden","true")}A(G);G.$content.attr("aria-expanded","false");if(G.triggerIsParent){G.$shortContent.show()}G.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(E){$target=C(E.currentTarget);$target.trigger("aui-expander-invoke",E.currentTarget)}};D.on(EXPANDER_EVENTS,".aui-expander-trigger")})(jQuery);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\">authenticate\u003c\/a> with \u003ca href=\"{1}\">{2}\u003c\/a>.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\">Authenticate\u003c\/a> to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\">{1}\u003c\/a>\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\">OAuth access tokens\u003c\/a>.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DateUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.Date");JIRA.DevStatus.Date={addTooltip:function(c){var b=c.find("time.livestamp");b.livestamp();b.each(function(){var e=a(this);var d=e.attr("datetime");e.attr("title",moment(isNaN(d)?d:+d).format(JIRA.DevStatus.Date.format))})},format:"LLL"}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/Listeners.js' */
Backbone.define("JIRA.DevStatus.Util.Listeners",Class.extend({init:function(){this._listening=[]},startListening:function(a,c,e,b){var d={start:function(){a.on(c,e,b);return this},stop:function(){a.off(c,e,b);return this}};this._listening.push(d.start())},stopListening:function(){_.each(this._listening,function(a){a.stop()});this._listening=[]}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusURLUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.URL");JIRA.DevStatus.URL={getDetailDialogParam:function(){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);return c&&c.queryKey&&c.queryKey.devStatusDetailDialog},getUrlWithDetailDialogParam:function(d){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);c.queryKey.devStatusDetailDialog=encodeURIComponent(d);return this._createUrlFromParsedUri(c)},getCreateReviewDetailUrl:function(b){return this.getUrlWithDetailDialogParam("create-review-"+b)},isCreateReviewDetailDialogLink:function(b){return b&&b.lastIndexOf&&b.lastIndexOf("create-review-",0)===0},getCreateReviewDetailDialogApplicationType:function(b){return b.substring("create-review-".length)},_removeKickAssIHashFromUrl:function(b){return b.replace("i#","")},_createUrlFromParsedUri:function(c){var d=[];AJS.$.each(c.queryKey,function(e,f){if(_.isObject(f)){AJS.$.each(f,function(g,h){d.push(e+"="+h)})}else{d.push(e+"="+f)}});var b="";if(c.protocol){b+=c.protocol+"://"}if(c.authority){b+=c.authority}if(c.path){b+=c.path}if(d.length>0){b+="?"+d.join("&")}if(c.anchor){b+="#"+c.anchor}return b}}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/common/devstatus-common.soy' */
// This file was automatically generated from devstatus-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Common == 'undefined') { JIRA.Templates.DevStatus.Common = {}; }


JIRA.Templates.DevStatus.Common.learnMoreLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(' <a href="https://www.atlassian.com/software-development" class="learn-more-link" target="_blank">', soy.$$escapeHtml("Learn more"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-cta-dialog.soy' */
// This file was automatically generated from devstatus-cta-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Dialog == 'undefined') { JIRA.Templates.DevStatus.Dialog = {}; }


JIRA.Templates.DevStatus.Dialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading">', (opt_data.prompt) ? '<h2>' + soy.$$escapeHtml(opt_data.prompt) + '</h2>' : '', '</div><div class="jira-dialog-content"><ul class="targets">');
  var remoteAppList10 = opt_data.remoteApps;
  var remoteAppListLen10 = remoteAppList10.length;
  for (var remoteAppIndex10 = 0; remoteAppIndex10 < remoteAppListLen10; remoteAppIndex10++) {
    var remoteAppData10 = remoteAppList10[remoteAppIndex10];
    output.append('<li>');
    JIRA.Templates.DevStatus.Dialog.remoteApp(remoteAppData10, output);
    output.append('</li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><button class="aui-button aui-button-link cancel" id="aui-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Dialog.remoteApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="target ', (opt_data.primary) ? 'primary' : '', '" data-application-type="', soy.$$escapeHtml(opt_data.applicationType), '" href="', soy.$$escapeHtml(opt_data.url), '">', (opt_data.iconUrl) ? '<img class="application-icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '">' : '<span class="application-icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>', '<div class="title" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</div><div class="base-url" title="', soy.$$escapeHtml(opt_data.baseUrl), '">', soy.$$escapeHtml(opt_data.baseUrl), '</div></a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-panel.soy' */
// This file was automatically generated from devstatus-panel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }


JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrors({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm, panelClasses: 'no-title'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemAsWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrors({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm, panelClasses: 'warning', iconClasses: 'icon-warning'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionAndConfigErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', (opt_data.panelClasses) ? soy.$$escapeHtml(opt_data.panelClasses) : '', '"><span class="aui-icon ', (opt_data.iconClasses) ? soy.$$escapeHtml(opt_data.iconClasses) : '', '"></span>');
  if ((! opt_data.errorInstances || opt_data.errorInstances.length == 0) && (! opt_data.notConfiguredInstances || opt_data.notConfiguredInstances.length == 0)) {
    output.append('<p class="connection-error">', "JIRA is having difficulty contacting the applications that supply development status information.", ' ');
    JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
    output.append('</p>');
  } else {
    if (opt_data.errorInstances.length > 0) {
      output.append('<p class="connection-error">');
      JIRA.Templates.DevStatus.connectionProblemMultipleInstances({instances: opt_data.errorInstances}, output);
      output.append(' ');
      JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
      output.append('</p>');
    }
    if (opt_data.notConfiguredInstances && opt_data.notConfiguredInstances.length > 0) {
      output.append('<p class="config-errors">');
      JIRA.Templates.DevStatus.configProblem(opt_data, output);
      output.append('</p>');
    }
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.contactAdmin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "/jira" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="connection-error">');
  if (! opt_data.instances || opt_data.instances.length == 0) {
    output.append("JIRA is having difficulty contacting the applications that supply development status information.");
  } else {
    JIRA.Templates.DevStatus.connectionProblemMultipleInstances(opt_data, output);
  }
  output.append(' ', AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "/jira" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.configProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var servers__soy65 = opt_data.notConfiguredInstances;
  output.append('<span class="description">');
  var server0__soy67 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy65[0]}, server0__soy67);
  server0__soy67 = server0__soy67.toString();
  if (servers__soy65.length == 1) {
    output.append(AJS.format("Couldn\x27\x27t read data from {0}.",server0__soy67));
  } else {
    var server1__soy75 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy65[1]}, server1__soy75);
    server1__soy75 = server1__soy75.toString();
    if (servers__soy65.length == 2) {
      output.append(AJS.format("Couldn\x27\x27t read data from {0} and {1}.",server0__soy67,server1__soy75));
    } else {
      var server2__soy83 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy65[2]}, server2__soy83);
      server2__soy83 = server2__soy83.toString();
      output.append((servers__soy65.length == 3) ? AJS.format("Couldn\x27\x27t read data from {0}, {1}, and {2}.",server0__soy67,server1__soy75,server2__soy83) : AJS.format("Couldn\x27\x27t read data from {0}, {1}, {2}, and {3} other {3,choice,1#application|1\x3capplications}.",server0__soy67,server1__soy75,server2__soy83,servers__soy65.length - 3));
    }
  }
  output.append('</span> <span class="hints">');
  var aOpenLearnMore__soy94 = new soy.StringBuilder('<a href="https://confluence.atlassian.com/x/OQNwGg" target="_blank">');
  aOpenLearnMore__soy94 = aOpenLearnMore__soy94.toString();
  var aOpenApplinks__soy96 = new soy.StringBuilder('<a href="', soy.$$escapeHtml("/jira"), '/plugins/servlet/applinks/listApplicationLinks">');
  aOpenApplinks__soy96 = aOpenApplinks__soy96.toString();
  var aClose__soy100 = new soy.StringBuilder('</a>');
  aClose__soy100 = aClose__soy100.toString();
  output.append(AJS.format("Learn {0}about this issue{1} or go to {2}application links{3} to fix it.",aOpenLearnMore__soy94,aClose__soy100,aOpenApplinks__soy96,aClose__soy100), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemMultipleInstances = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instance0__soy106 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[0]}, instance0__soy106);
  instance0__soy106 = instance0__soy106.toString();
  if (opt_data.instances.length == 1) {
    output.append(AJS.format("JIRA is having difficulty contacting {0}.",instance0__soy106));
  } else {
    var instance1__soy114 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[1]}, instance1__soy114);
    instance1__soy114 = instance1__soy114.toString();
    if (opt_data.instances.length == 2) {
      output.append(AJS.format("JIRA is having difficulty contacting {0} and {1}.",instance0__soy106,instance1__soy114));
    } else {
      var instance2__soy122 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[2]}, instance2__soy122);
      instance2__soy122 = instance2__soy122.toString();
      output.append(AJS.format("JIRA is having difficulty contacting {0}, {1}, {3,choice,0#and {2}|1#{2}, and another application|1\x3c{2}, and {3} more applications}.",instance0__soy106,instance1__soy114,instance2__soy122,opt_data.instances.length - 3));
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemSingleInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="instance" data-name="', soy.$$escapeHtml(opt_data.instance.name), '"><a href="', soy.$$escapeHtml(opt_data.instance.baseUrl), '" title="', soy.$$escapeHtml(opt_data.instance.name), '">', soy.$$escapeHtml(opt_data.instance.name), '</a></span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.labsOnOff = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((! opt_data.isOptedInByAdmin && ! opt_data.isOptedIn) ? '<div class="on-off-panel aui-message closeable"><h2 class="title">' + soy.$$escapeHtml("JIRA Labs") + '</h2><p>' + soy.$$escapeHtml("The new way to see your related commits and pull requests as they occur.") + '</p><span class="aui-icon icon-close labs-close" role="button" tabindex="0" title="' + soy.$$escapeHtml("Close the JIRA Labs panel") + '"></span><div class="aui-group"><div class="aui-item"><button class="toggle-labs aui-button" title="' + soy.$$escapeHtml("Enable JIRA Labs for development panel") + '">' + soy.$$escapeHtml("Enable Labs") + '</button></div></div>' : '<div class="on-off-panel opted-in"><span class="feedback-link"><a href="#" title="' + soy.$$escapeHtml("Give Atlassian feedback about the JIRA development panel") + '">' + soy.$$escapeHtml("Feedback") + '</a></span>' + ((! opt_data.isOptedInByAdmin) ? ' | <span class="disable-labs"><a class="toggle-labs" href="#" title="' + soy.$$escapeHtml("Disable JIRA Labs for the development panel") + '">' + soy.$$escapeHtml("Disable Labs") + '</span></span>' : '') + '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.tryLabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span href="#" class="try-labs" title="', soy.$$escapeHtml("Show the JIRA Labs panel"), '">', soy.$$escapeHtml("Try Labs"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.lastUpdated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastUpdated) {
    output.append('<dd class="sub-text', (opt_data.extraClass) ? ' ' + soy.$$escapeHtml(opt_data.extraClass) : '', '">');
    JIRA.Templates.DevStatus.transitionContainer({content: '<div>' + soy.$$escapeHtml(opt_data.text) + ' <time class="livestamp date user-tz allow-future" datetime="' + soy.$$escapeHtml(opt_data.lastUpdated) + '" data-relativize-threshold="' + soy.$$escapeHtml(opt_data.livestampRelativizeThreshold) + '">$' + soy.$$escapeHtml(opt_data.lastUpdated) + '</time></div>'}, output);
    output.append('</dd>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.transitionContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="rolling-container sliding-container"><div class="rolling-content">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog.soy' */
// This file was automatically generated from devstatus-detail-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.frame = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading devstatus-dialog-heading ', (opt_data.tabs.length > 1) ? 'borderless' : '', '"><h2>', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="jira-dialog-content devstatus-dialog-content">');
  JIRA.Templates.DevStatus.DetailDialog.applicationTabs(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.applicationTabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu ', (opt_data.tabs.length == 1) ? 'hidden' : '', '" >');
  var tabList18 = opt_data.tabs;
  var tabListLen18 = tabList18.length;
  for (var tabIndex18 = 0; tabIndex18 < tabListLen18; tabIndex18++) {
    var tabData18 = tabList18[tabIndex18];
    output.append('<li id="tab-menu-', soy.$$escapeHtml(tabData18.type), '" data-application-type=', soy.$$escapeHtml(tabData18.type), ' class="menu-item ', (! opt_data.initialTab && tabIndex18 == 0 || tabData18.type == opt_data.initialTab) ? ' active-tab' : '', '"><a  href="#tab-content-', soy.$$escapeHtml(tabData18.type), '"><strong>', soy.$$escapeHtml(tabData18.name), '</strong><span class="aui-badge devstatus-tab-count">', soy.$$escapeHtml(tabData18.count), '</span></a></li>');
  }
  output.append('</ul><div class="form-body">');
  var tabList36 = opt_data.tabs;
  var tabListLen36 = tabList36.length;
  for (var tabIndex36 = 0; tabIndex36 < tabListLen36; tabIndex36++) {
    var tabData36 = tabList36[tabIndex36];
    output.append('<div class="tabs-pane ', (tabIndex36 == 0) ? 'active-pane' : '', '" id="tab-content-', soy.$$escapeHtml(tabData36.type), '"><div class="status-loading"></div><div class="detail-content-container"></div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.repositoryHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="repository-header', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '"><div class="aui-group aui-group-split repository-header-group"><div class="aui-item project-space">');
  JIRA.Templates.DevStatus.DetailDialog.projectInfo(opt_data, output);
  output.append('</div>', (opt_data.extraContent) ? '<div class="aui-item action-space">' + opt_data.extraContent + '</div>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-avatar" ', (opt_data.repository.avatarDescription) ? 'title="' + soy.$$escapeHtml(opt_data.repository.avatarDescription) + '"' : '', '><span class="aui-avatar aui-avatar-small aui-avatar-project ', (opt_data.repository.avatar) ? 'fusion-avatar-project' : 'default-avatar-project', '">', (opt_data.repository.avatar) ? '<span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(opt_data.repository.avatar) + '" /></span>' : '<span class="aui-avatar-inner aui-icon aui-icon-small aui-iconfont-devtools-repository"></span>', '</span></div><div class="project-info"><a class="repository-link" href="', soy.$$escapeHtml(opt_data.repository.url), '"', (opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '', '>', soy.$$escapeHtml(opt_data.repository.name), '</a></div><div class="extra-project-info">', (opt_data.showParent && opt_data.repository.parent && opt_data.repository.parent.name && opt_data.repository.parent.url) ? '<a class="fork-off" href="' + soy.$$escapeHtml(opt_data.repository.parent.url) + '"><span class="fork-name" title="' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '">' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '</span></a>' : '', (opt_data.extraProjectInfo) ? opt_data.extraProjectInfo : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.oauthStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-info" /> ', soy.$$escapeHtml(opt_data.message), ' ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.authenticationScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="authentication-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2><p>', soy.$$escapeHtml(AJS.format("Please login to approve {0,choice,1#this application|1\x3cthese applications}:",opt_data.unauthInstances.length)), ' <span class="instances"></span></p>');
  if (opt_data.otherInstances.length > 0) {
    JIRA.Templates.DevStatus.connectionProblemAsWarning({instances: opt_data.otherInstances, showContactAdminForm: opt_data.showContactAdminForm}, output);
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="connection-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2>');
  JIRA.Templates.DevStatus.connectionProblem(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="no-permission-to-view-all"><div class="lock-image"></div><span>', soy.$$escapeHtml(opt_data.message), '</span>', (opt_data.secondaryMessage) ? ' <span>' + soy.$$escapeHtml(opt_data.secondaryMessage) + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.timestamp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.timestamp) ? '<time class="livestamp date user-tz" datetime="' + soy.$$escapeHtml(opt_data.timestamp) + '" data-relativize-threshold="' + soy.$$escapeHtml(opt_data.livestampRelativizeThreshold) + '">' + soy.$$escapeHtml(opt_data.timestamp) + '</time>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.vcsUser = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span><div class="vcs-user"><span class="extra-content-in-title ', (opt_data.approved) ? 'fade' : '', '" title="', soy.$$escapeHtml(opt_data.name), '"><img class="author-avatar" src="', soy.$$escapeHtml(opt_data.avatar), '"/></span>', (opt_data.approved) ? '<span class="approved">✓</span>' : '', '</div></span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/build/devstatus-detail-dialog-build.soy' */
// This file was automatically generated from devstatus-detail-dialog-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.build = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.projects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.projectContent({project: projectData3, projectIndex: projectIndex3, withArtifactColumn: opt_data.hasArtifacts, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-builds-container">');
  JIRA.Templates.DevStatus.DetailDialog.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table builds-table', (opt_data.withArtifactColumn) ? ' builds-table-with-artifact-column' : '', '"><table class="aui"><thead><tr><th class="plan">', soy.$$escapeHtml("Plan"), '</th><th class="build cell-type-collapsed">', soy.$$escapeHtml("Latest build"), '</th><th class="result cell-type-collapsed">', soy.$$escapeHtml("Result"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Completed"), '</th>', (opt_data.withArtifactColumn) ? '<th class="actions cell-type-collapsed"></th>' : '', '</tr></thead><tbody>');
  var planList31 = opt_data.project.plans;
  var planListLen31 = planList31.length;
  for (var planIndex31 = 0; planIndex31 < planListLen31; planIndex31++) {
    var planData31 = planList31[planIndex31];
    var planHasArtifacts__soy32 = planData31.build.artifacts && planData31.build.artifacts.length;
    var uniqueIdSuffix__soy33 = opt_data.projectIndex + '-' + planIndex31;
    output.append('<tr class="plan-row', (planHasArtifacts__soy32) ? ' merge' : '', '"><td class="plan">');
    JIRA.Templates.DevStatus.DetailDialog.planName({plan: planData31}, output);
    output.append('</td><td class="build">');
    JIRA.Templates.DevStatus.DetailDialog.buildIcon({build: planData31.build}, output);
    output.append(' <a class="build-link" href="', soy.$$escapeHtml(planData31.build.url), '">', soy.$$escapeHtml(AJS.format("#{0}",planData31.build.buildNumber)), '</a></td><td class="result">');
    JIRA.Templates.DevStatus.DetailDialog.buildResult({build: planData31.build}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: planData31.build.finishedDate, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
    output.append('</td>');
    if (opt_data.withArtifactColumn) {
      output.append('<td class="actions">');
      if (planHasArtifacts__soy32) {
        aui.expander.trigger({id: 'detail-dialog-build-show-artifacts-trigger-' + uniqueIdSuffix__soy33, contentId: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy33, tag: 'a', content: "Show artifacts", replaceText: "Hide artifacts"}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
    if (planHasArtifacts__soy32) {
      output.append('<tr class="artifacts"><td colspan="5">');
      var param73 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.artifactsTable({build: planData31.build}, param73);
      aui.expander.content({id: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy33, content: param73.toString()}, output);
      output.append('</td></tr>');
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="builds-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.planName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><span class="plan-name">', (opt_data.plan.isBranch) ? '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a> &rsaquo; <span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</span><a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</a>' : '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a>', '</span>', (opt_data.plan.disabled) ? '<span class="aui-lozenge aui-lozenge-subtle disabled" title="' + soy.$$escapeHtml("This plan is disabled") + '">' + soy.$$escapeHtml("Disabled") + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.build.buildState == 'SUCCESS' || opt_data.build.buildState == 'FAILED') {
    if (opt_data.build.testSummary) {
      var duration__soy133 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.buildDuration(opt_data, duration__soy133);
      duration__soy133 = duration__soy133.toString();
      output.append('<span>', (opt_data.build.testSummary.failedTestCount > 0) ? (opt_data.build.testSummary.successfulTestCount) ? soy.$$escapeHtml(AJS.format("{0} of {1} tests failed in {2}",opt_data.build.testSummary.failedTestCount,opt_data.build.testSummary.totalTestCount,duration__soy133)) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} failed in {1}",opt_data.build.testSummary.failedTestCount,duration__soy133)) : (opt_data.build.testSummary.successfulTestCount > 0) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} passed in {1}",opt_data.build.testSummary.successfulTestCount,duration__soy133)) : (opt_data.build.buildState == 'SUCCESS') ? soy.$$escapeHtml(AJS.format("Passed in {0}",duration__soy133)) : soy.$$escapeHtml(AJS.format("Failed in {0}",duration__soy133)), '</span>');
    }
  } else {
    output.append(soy.$$escapeHtml("Build incomplete"));
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildDuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.build) ? (opt_data.build.durationInSeconds < 1) ? soy.$$escapeHtml("under 1 second") : (opt_data.build.durationInSeconds < 90) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#second|1\x3cseconds}",opt_data.build.durationInSeconds)) : (opt_data.build.durationInSeconds < 5400) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#minute|1\x3cminutes}",Math.floor(opt_data.build.durationInSeconds / 60))) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#hour|1\x3chours}",Math.floor(opt_data.build.durationInSeconds / 60 / 60))) : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy169 = new soy.StringBuilder((opt_data.build.buildState == 'SUCCESS') ? 'aui-iconfont-approve' : (opt_data.build.buildState == 'FAILED') ? 'aui-iconfont-error' : 'aui-iconfont-devtools-task-cancelled');
  iconClass__soy169 = iconClass__soy169.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy169), '">', soy.$$escapeHtml(opt_data.build.buildState), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var column1Height__soy183 = Math.ceil(opt_data.build.artifacts.length / 3);
  var column2Height__soy184 = Math.ceil((opt_data.build.artifacts.length - 1) / 3);
  var column3Height__soy185 = Math.ceil((opt_data.build.artifacts.length - 2) / 3);
  output.append('<div class="build-artifacts-table"><table class="aui"><tbody>');
  var artifactIndexLimit187 = column1Height__soy183;
  for (var artifactIndex187 = 0; artifactIndex187 < artifactIndexLimit187; artifactIndex187++) {
    output.append('<tr><td>');
    JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex187]}, output);
    output.append('</td><td>');
    if (artifactIndex187 < column2Height__soy184) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex187 + column1Height__soy183]}, output);
    }
    output.append('</td><td>');
    if (artifactIndex187 < column3Height__soy185) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex187 + column1Height__soy183 + column2Height__soy184]}, output);
    }
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.artifact && opt_data.artifact.name) ? (opt_data.artifact.url) ? '<a class="artifact-link" href="' + soy.$$escapeHtml(opt_data.artifact.url) + '">' + soy.$$escapeHtml(opt_data.artifact.name) + '</a>' : soy.$$escapeHtml(opt_data.artifact.name) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/deployment/devstatus-detail-dialog-deployment.soy' */
// This file was automatically generated from devstatus-detail-dialog-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Deployment == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Deployment = {}; }


JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.deploymentProjects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent({project: projectData3, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-deployments-container">');
  JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table deployments-table"><table class="aui"><thead><tr><th class="environment">', soy.$$escapeHtml("Environment"), '</th><th class="status cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="release cell-type-collapsed">', soy.$$escapeHtml("Latest release"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Last deployed"), '</th></tr></thead><tbody>');
  var environmentList21 = opt_data.project.environments;
  var environmentListLen21 = environmentList21.length;
  for (var environmentIndex21 = 0; environmentIndex21 < environmentListLen21; environmentIndex21++) {
    var environmentData21 = environmentList21[environmentIndex21];
    output.append('<tr class="environment-row"><td class="environment">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName({environment: environmentData21}, output);
    output.append('</td><td class="status cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge({environment: environmentData21}, output);
    output.append('</td><td class="release">');
    if (environmentData21.deployedVersion) {
      JIRA.Templates.DevStatus.DetailDialog.Deployment.release({release: environmentData21.deployedVersion}, output);
    }
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: environmentData21.lastDeployed, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="deployments-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', (opt_data.project.description) ? soy.$$escapeHtml(opt_data.project.description) : soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2><div class="ellipsis"><strong class="commit-info">', soy.$$escapeHtml(AJS.format("Commits were in release {0}",opt_data.project.latestVersions[0].name)), '</strong></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="environment-link" href="', soy.$$escapeHtml(opt_data.environment.url), '" title="', (opt_data.environment.description) ? soy.$$escapeHtml(opt_data.environment.description) : soy.$$escapeHtml(opt_data.environment.name), '">', soy.$$escapeHtml(opt_data.environment.name), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment.status == 'DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-success">' + soy.$$escapeHtml("Deployed") + '</span>' : (opt_data.environment.status == 'FAILED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-error">' + soy.$$escapeHtml("Failed") + '</span>' : (opt_data.environment.status == 'NOT_DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle">' + soy.$$escapeHtml("Not deployed") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.release = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.release.url) ? '<a class="release-link" href="' + soy.$$escapeHtml(opt_data.release.url) + '" title="' + soy.$$escapeHtml(opt_data.release.name) + '">' + soy.$$escapeHtml(opt_data.release.name) + '</a>' : soy.$$escapeHtml(opt_data.release.name));
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-commit.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.commit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.canCreateReview) ? '<div class="aui-group aui-group-split"><div class="aui-item"></div><div class="aui-item"><div class="create-review-instance"><a href="#">' + soy.$$escapeHtml("Create review for all commits") + '</a></div></div></div>' : '');
  var repoList8 = opt_data.repositories;
  var repoListLen8 = repoList8.length;
  for (var repoIndex8 = 0; repoIndex8 < repoListLen8; repoIndex8++) {
    var repoData8 = repoList8[repoIndex8];
    JIRA.Templates.DevStatus.DetailDialog.commitContent(soy.$$augmentData(opt_data, {repository: repoData8, repositoryIndex: repoIndex8}), output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commitContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-commits-container', (opt_data.repository.showReviews) ? ' has-reviews' : '', (opt_data.repository.showBranches) ? ' has-branches' : '', (opt_data.repository.showFiles) ? ' has-files' : '', ' ', (opt_data.repository.showCreateReview) ? 'has-actions' : '', '" data-repository-index="', soy.$$escapeHtml(opt_data.repositoryIndex), '" >');
  JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {showParent: true, extraProjectInfo: (opt_data.repository.showInstance && opt_data.repository.instance) ? '<div class="repository-instance" title="' + soy.$$escapeHtml(opt_data.repository.instance.name) + '">(' + soy.$$escapeHtml(opt_data.repository.instance.name) + ')</div>' : '', extraContent: (opt_data.repository.showFiles) ? '<div class="file-expand"><a href="#">' + soy.$$escapeHtml("Show all files") + '</a></div>' : ''}), output);
  output.append('<div class="devstatus-detail-table commits-table"><table class="aui"><thead><tr><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="changeset cell-type-collapsed">', soy.$$escapeHtml("Commit"), '</th><th class="message">', soy.$$escapeHtml("Message"), '</th>', (opt_data.repository.showBranches) ? '<th class="branches"></th>' : '', (opt_data.repository.showReviews) ? '<th class="reviews">' + soy.$$escapeHtml("Reviews") + '</th>' : '', '<th class="timestamp">', soy.$$escapeHtml("Date"), '</th>', (opt_data.repository.showFiles) ? '<th class="filecount">' + soy.$$escapeHtml("Files") + '</th>' : '', (opt_data.repository.showCreateReview) ? '<th class="commit-actions">' + soy.$$escapeHtml("Actions") + '</th>' : '', '</tr></thead><tbody>');
  var commitList76 = opt_data.repository.commits;
  var commitListLen76 = commitList76.length;
  for (var commitIndex76 = 0; commitIndex76 < commitListLen76; commitIndex76++) {
    var commitData76 = commitList76[commitIndex76];
    output.append('<tr data-changesetid="', soy.$$escapeHtml(commitData76.id), '" class="commitrow', (commitData76.merge) ? ' merge' : '', '" data-commit-index="', soy.$$escapeHtml(commitIndex76), '"><td class="author">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(commitData76.author, output);
    output.append('</td><td class="changeset"><a class="changesetid" href="', soy.$$escapeHtml(commitData76.url), '">', soy.$$escapeHtml(commitData76.displayId), '</a>');
    if (commitData76.merge) {
      JIRA.Templates.DevStatus.DetailDialog.mergeLozenge(null, output);
    }
    output.append('</td><td class="message"><span class="ellipsis" title="', soy.$$escapeHtml(commitData76.message), '">', soy.$$truncate(soy.$$escapeHtml(commitData76.message), 500, true), '</span></td>');
    JIRA.Templates.DevStatus.DetailDialog.branchesColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    JIRA.Templates.DevStatus.DetailDialog.reviewColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    output.append('<td class="timestamp"><time class="livestamp" datetime="', soy.$$escapeHtml(commitData76.authorTimestamp), '" data-relativize-threshold="', soy.$$escapeHtml(opt_data.livestampRelativizeThreshold), '">', soy.$$escapeHtml(commitData76.authorTimestamp), '</time></td>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesColumn({count: commitData76.fileCount}, output);
    }
    if (opt_data.repository.showCreateReview) {
      JIRA.Templates.DevStatus.DetailDialog.actionsColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    }
    output.append('</tr>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesRow(soy.$$augmentData(opt_data, {repository: opt_data.repository, commit: commitData76}), output);
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.mergeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge merge" title="', soy.$$escapeHtml("This commit is a merge"), '">', soy.$$escapeHtml("M"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.repository.showBranches) ? '<td class="branches">' + ((opt_data.commit.branches && opt_data.commit.branches.totalCount > 0) ? '<span class="branches-link aui-lozenge ref-lozenge"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">Branch</span></button>' + ((opt_data.commit.branches.totalCount > 1) ? '<span class="branch-count">' + soy.$$escapeHtml(opt_data.commit.branches.totalCount) + '</span>' : '') + '</span>' : '') + '</td>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="branch-tooltip">');
  var branchList150 = opt_data.branchData.branches;
  var branchListLen150 = branchList150.length;
  for (var branchIndex150 = 0; branchIndex150 < branchListLen150; branchIndex150++) {
    var branchData150 = branchList150[branchIndex150];
    output.append('<div class="branch-name-tooltip">', soy.$$escapeHtml(branchData150.name), '</div>');
  }
  output.append((opt_data.branchData.totalCount > opt_data.branchData.branches.length) ? '<div class="branch-tooltip-summary">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.branchData.totalCount - opt_data.branchData.branches.length)) + '</div>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.repository.showReviews) {
    output.append('<td class="reviews">');
    if (opt_data.commit.reviews && opt_data.commit.reviews.totalCount > 0) {
      output.append('<a class="reviews-link">');
      JIRA.Templates.DevStatus.Review.reviewLozenge({state: opt_data.commit.reviews.reviews[0].state, isSubtle: true}, output);
      output.append('</a>');
    }
    output.append('</td>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.actionsColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="commit-actions">', (opt_data.commit.createReviewUrl) ? '<div class="create-review-commit"><a href="' + soy.$$escapeHtml(opt_data.commit.createReviewUrl) + '">' + soy.$$escapeHtml("Create review") + '</a></div>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="filecount">', (opt_data.count > 0) ? '<a href="#" class="extra-content-in-title" title="' + soy.$$escapeHtml("Click to show files") + '">' + ((opt_data.count < 100) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#file|1\x3cfiles}",opt_data.count)) : soy.$$escapeHtml(AJS.format("{0}+ files",100))) + '</a>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="hidden ', soy.$$escapeHtml(opt_data.commit.fileCount > 0 && opt_data.commit.files ? 'filerow' : ''), '"><td colspan="5">');
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow({files: opt_data.commit.files, max: 5}, output);
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles({files: opt_data.commit.files, fileCount: opt_data.commit.fileCount, instanceName: opt_data.repository.name, moreUrl: opt_data.commit.url}, output);
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table><tbody>');
  var reviewList212 = opt_data.reviewData.reviews;
  var reviewListLen212 = reviewList212.length;
  for (var reviewIndex212 = 0; reviewIndex212 < reviewListLen212; reviewIndex212++) {
    var reviewData212 = reviewList212[reviewIndex212];
    output.append('<tr class="inline-review-row"><td class="inline-review-id"><a href="', soy.$$escapeHtml(reviewData212.url), '">', soy.$$escapeHtml(reviewData212.id), '</a></td><td class="inline-review-state">');
    JIRA.Templates.DevStatus.Review.reviewLozenge({state: reviewData212.state, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append((opt_data.reviewData.totalCount > opt_data.reviewData.reviews.length) ? '<tr><td class="inline-review-summary" colspan="2"><a href="' + soy.$$escapeHtml(opt_data.reviewData.url) + '">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.reviewData.totalCount - opt_data.reviewData.reviews.length)) + '</a></td></tr>' : '', '</tbody></table>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/commit/devstatus-detail-dialog-commit-files.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit-files.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit.Files == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit.Files = {}; }


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var fileList3 = opt_data.files;
  var fileListLen3 = fileList3.length;
  for (var fileIndex3 = 0; fileIndex3 < fileListLen3; fileIndex3++) {
    var fileData3 = fileList3[fileIndex3];
    if (fileIndex3 < opt_data.max) {
      output.append('<div class="file"><div class="change">');
      if (fileData3.linesAdded != null && fileData3.linesRemoved != null) {
        output.append('<div class="lines">', (fileData3.changeType == 'ADDED') ? '<span class="aui-lozenge added">' + soy.$$escapeHtml("Added") + '</span>' : (fileData3.changeType == 'DELETED') ? '<span class="aui-lozenge removed">' + soy.$$escapeHtml("Deleted") + '</span>' : '<span class="aui-lozenge added count">+' + soy.$$escapeHtml(fileData3.linesAdded) + '</span><span class="aui-lozenge removed count">-' + soy.$$escapeHtml(fileData3.linesRemoved) + '</span>', '</div>');
      } else {
        output.append('<div class="changetype">');
        JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge({changeType: fileData3.changeType}, output);
        output.append('</div>');
      }
      output.append('</div><div class="filename ellipsis"><a href="', soy.$$escapeHtml(fileData3.url), '" title="', soy.$$escapeHtml(fileData3.path), '">', soy.$$escapeHtml(fileData3.path), '</a></div></div>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.files.length < opt_data.fileCount) ? '<a href="' + soy.$$escapeHtml(opt_data.moreUrl) + '">' + soy.$$escapeHtml(AJS.format("See more files in {0}",opt_data.instanceName)) + '</a>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var text__soy48 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      text__soy48.append(soy.$$escapeHtml("Added"));
      break;
    case 'COPIED':
      text__soy48.append(soy.$$escapeHtml("Copied"));
      break;
    case 'DELETED':
      text__soy48.append(soy.$$escapeHtml("Deleted"));
      break;
    case 'MOVED':
      text__soy48.append(soy.$$escapeHtml("Moved"));
      break;
    default:
      text__soy48.append(soy.$$escapeHtml("Modified"));
  }
  text__soy48 = text__soy48.toString();
  var class__soy60 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      class__soy60.append('success');
      break;
    case 'COPIED':
      class__soy60.append('current');
      break;
    case 'DELETED':
      class__soy60.append('error');
      break;
    case 'MOVED':
      class__soy60.append('moved');
      break;
    default:
      class__soy60.append('complete');
  }
  class__soy60 = class__soy60.toString();
  output.append('<span class="aui-lozenge aui-lozenge-', soy.$$escapeHtml(class__soy60), ' aui-lozenge-subtle">', soy.$$escapeHtml(text__soy48), '</span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-branch-pullrequest.soy' */
// This file was automatically generated from devstatus-detail-dialog-branch-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.pullRequest = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-pullrequests-container"><div class="devstatus-detail-table pullrequests-table"><table class="aui"><thead><tr><th class="pullrequest-id">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state">', soy.$$escapeHtml("Status"), '</th><th class="author">', soy.$$escapeHtml("Author"), '</th><th class="reviewer">', soy.$$escapeHtml("Reviewer"), '</th><th class="comment cell-type-collapsed"></th><th class="last-updated">', soy.$$escapeHtml("Updated"), '</th></tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var pullRequestList19 = opt_data.pullRequests;
  var pullRequestListLen19 = pullRequestList19.length;
  for (var pullRequestIndex19 = 0; pullRequestIndex19 < pullRequestListLen19; pullRequestIndex19++) {
    var pullRequestData19 = pullRequestList19[pullRequestIndex19];
    output.append('<tr class="pullrequest-row"><td class="pullrequest-id"><a class="pullrequest-link" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.id), '</a></td><td class="title"><a class="pullrequest-link ellipsis" title="', soy.$$escapeHtml(pullRequestData19.name), '" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.name), '</a></td><td class="state">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData19.status, isSubtle: true}, output);
    output.append('</td><td class="author"><img class="author-avatar extra-content-in-title" src="', soy.$$escapeHtml(pullRequestData19.author.avatar), '" title="', soy.$$escapeHtml(pullRequestData19.author.name), '"/></td><td class="reviewer">');
    if (pullRequestData19.reviewers && pullRequestData19.reviewers.length != 0) {
      JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(pullRequestData19, {countThreshold: opt_data.reviewersThreshold}), output);
    }
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: pullRequestData19}, output);
    output.append('</td><td class="last-updated"><time class="livestamp" datetime="', soy.$$escapeHtml(pullRequestData19.lastUpdate), '" data-relativize-threshold="', soy.$$escapeHtml(opt_data.livestampRelativizeThreshold), '">', soy.$$escapeHtml(pullRequestData19.lastUpdate), '</time></td></tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commentCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.pullRequest.commentCount) ? '<div class="comment-container"><a class="comment-link" href="' + soy.$$escapeHtml(opt_data.pullRequest.url) + '" title="' + soy.$$escapeHtml("Comments") + '"><span class="aui-icon aui-icon-small aui-iconfont-comment">Comments</span></a><span class="count">' + soy.$$escapeHtml(opt_data.pullRequest.commentCount) + '</span></div>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewersList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer-container">');
  var showThreshold__soy66 = opt_data.countThreshold + 1;
  var indexLimit67 = Math.min(opt_data.countThreshold, opt_data.reviewers.length);
  for (var index67 = 0; index67 < indexLimit67; index67++) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[index67], output);
  }
  if (opt_data.reviewers.length == showThreshold__soy66) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[opt_data.countThreshold], output);
  } else if (opt_data.reviewers.length > showThreshold__soy66) {
    output.append('<span class="aui-badge extrareviewers-tooltip reviewers-link" data-reviewers="', soy.$$escapeHtml(opt_data.extraReviewers), '">', soy.$$escapeHtml(opt_data.reviewers.length - opt_data.countThreshold), '</span>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-branches-container"><div class="devstatus-detail-table branches-table"><table class="aui"><thead><tr><th class="repository">', soy.$$escapeHtml("Repository"), '</th><th class="branch">', soy.$$escapeHtml("Branch"), '</th>', (opt_data.features.pullRequests) ? '<th class="pullrequest">' + soy.$$escapeHtml("Pull request") + '</th><th class="action">' + soy.$$escapeHtml("Action") + '</th>' : '', (opt_data.features.lastCommitId) ? '<th class="changeset cell-type-collapsed">' + soy.$$escapeHtml("Last commit") + '</th>' : '', (opt_data.features.lastCommitTimestamp) ? '<th class="last-updated cell-type-collapsed">' + soy.$$escapeHtml("Last modified") + '</th>' : '', '</tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.branchEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var branchList107 = opt_data.branches;
  var branchListLen107 = branchList107.length;
  for (var branchIndex107 = 0; branchIndex107 < branchListLen107; branchIndex107++) {
    var branchData107 = branchList107[branchIndex107];
    output.append('<tr class="branch-row"><td class="repository">');
    JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {repository: branchData107.repository, showTooltip: true}), output);
    output.append('</td><td class="branch">');
    JIRA.Templates.DevStatus.DetailDialog.branchLozenge(branchData107, output);
    output.append('</td>');
    if (opt_data.features.pullRequests) {
      output.append('<td class="pullrequest">');
      JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch(branchData107.pullRequestState, output);
      output.append('</td><td class="action">', (branchData107.createPullRequestUrl && branchData107.createPullRequestUrl.length > 0) ? '<a class="create-pullrequest-link" href="' + soy.$$escapeHtml(branchData107.createPullRequestUrl) + '">' + soy.$$escapeHtml("Create pull request") + '</a>' : '', '</td>');
    }
    output.append((opt_data.features.lastCommitId) ? '<td class="changeset cell-type-collapsed">' + ((branchData107.lastCommit && branchData107.lastCommit.displayId && branchData107.lastCommit.url) ? '<a class="changeset-link changesetid" href="' + soy.$$escapeHtml(branchData107.lastCommit.url) + '">' + soy.$$escapeHtml(branchData107.lastCommit.displayId) + '</a>' : '') + '</td>' : '');
    if (opt_data.features.lastCommitTimestamp) {
      output.append('<td class="last-updated cell-type-collapsed">');
      if (branchData107.lastCommit && branchData107.lastCommit.authorTimestamp) {
        JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: branchData107.lastCommit.authorTimestamp, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.total > 0) {
    output.append('<a href="#" class="pullrequest-tooltip pullrequest-link pullrequest-status" data-detail="', soy.$$escapeHtml(opt_data.data), '">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: opt_data.status, isSubtle: true}, output);
    output.append('</a>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="pullrequest-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '" href="', soy.$$escapeHtml(opt_data.url), '" ><span>', soy.$$escapeHtml(opt_data.id), ' ', soy.$$escapeHtml(opt_data.name), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer"><div class="reviewer-container"><table class="aui"><tbody>');
  var reviewerList175 = opt_data.reviewers;
  var reviewerListLen175 = reviewerList175.length;
  for (var reviewerIndex175 = 0; reviewerIndex175 < reviewerListLen175; reviewerIndex175++) {
    var reviewerData175 = reviewerList175[reviewerIndex175];
    output.append('<tr><td class="reviewer-avatar">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewerData175, output);
    output.append('</td><td class="reviewer-name"><span title="', soy.$$escapeHtml(reviewerData175.name), '">', soy.$$escapeHtml(reviewerData175.name), '</span></td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="aui"><tbody>');
  var pullRequestList187 = opt_data.pullRequests;
  var pullRequestListLen187 = pullRequestList187.length;
  for (var pullRequestIndex187 = 0; pullRequestIndex187 < pullRequestListLen187; pullRequestIndex187++) {
    var pullRequestData187 = pullRequestList187[pullRequestIndex187];
    output.append('<tr><td class="pullrequest-name">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle(pullRequestData187, output);
    output.append('</td><td class="lozenge">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData187.status, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.PullRequest.state({state: opt_data.status, isSubtle: opt_data.isSubtle}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="branch-name"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small"></span><a class="branch-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', (! opt_data.url) ? ' null-link' : '', '" ', (opt_data.url) ? 'href="' + soy.$$escapeHtml(opt_data.url) + '"' : '', ' title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-review.soy' */
// This file was automatically generated from devstatus-detail-dialog-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.review = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="devstatus-detail-table detail-reviews-container"><div class="devstatus-detail-table reviews-table"><table class="aui"><thead><tr><th class="review cell-type-collapsed">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="reviewer cell-type-collapsed">', soy.$$escapeHtml("Reviewers"), '</th><th class="comment cell-type-collapsed">', soy.$$escapeHtml(""), '</th><th class="timestamp">', soy.$$escapeHtml("Date"), '</th></tr></thead><tbody>');
  var reviewList18 = opt_data.reviews;
  var reviewListLen18 = reviewList18.length;
  for (var reviewIndex18 = 0; reviewIndex18 < reviewListLen18; reviewIndex18++) {
    var reviewData18 = reviewList18[reviewIndex18];
    output.append('<tr data-id="', soy.$$escapeHtml(reviewData18.id), '"><td class="review"><a href="', soy.$$escapeHtml(reviewData18.url), '" class="review-link">', soy.$$escapeHtml(reviewData18.id), '</a></td><td class="title"><span class="ellipsis" title="', soy.$$escapeHtml(reviewData18.title), '">', soy.$$escapeHtml(reviewData18.title), '</span></td><td class="state">');
    JIRA.Templates.DevStatus.Review.reviewLozenge({state: reviewData18.state, isSubtle: true}, output);
    output.append('</td><td class="author">');
    if (reviewData18.author) {
      JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewData18.author, output);
    }
    output.append('</td><td class="reviewer">');
    JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(reviewData18, {countThreshold: opt_data.reviewersThreshold, extraReviewers: reviewData18.extraReviewers}), output);
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: {'commentCount': reviewData18.commentCount, 'url': reviewData18.url}}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(reviewData18, {lastUpdated: reviewData18.lastModified, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold, showUpdatedText: false}), output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/util/DevStatusNavigation.js' */
if(!JIRA.DevStatus){AJS.namespace("JIRA.DevStatus")}JIRA.DevStatus.Navigate={getUrl:function(){return window.location.href},reload:function(){_.defer(function(){window.location.reload()})},navigate:function(a){_.defer(function(){window.location=a})},redirectToLogin:function(){this.navigate(AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(window.location.href))}};
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusInit.js' */
(function(){JIRA.DevStatus.setDetailDialogParam=function(){AJS.Meta.set("fusion-open-detail-dialog",JIRA.DevStatus.URL.getDetailDialogParam())};JIRA.DevStatus.setDetailDialogParam()})();AJS.$(function(){JIRA.DevStatus.showTooltip=true;var d={devStatusContainer:"#devstatus-container",parentContainer:"[id$='devstatus-panel']",link:"a.devstatus-cta-link",statusPanel:".status-panels",viewIssueHeader:".mod-header",agileHeader:".ghx-header",agileNavMenuLink:'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-development-integration-plugin-greenhopper-devstatus-panel"]'};function e(g){return g.find("body").hasClass("page-type-dashboard")}function b(g){return g.find("body").hasClass("ghx-agile")}function c(g){return g.find("body").hasClass("ka ajax-issue-search-and-view")}function a(h,i,g){JIRA.DevStatus.devStatusModule.initializePanel({container:h,showTooltip:JIRA.DevStatus.showTooltip,headerSelector:i,devStatusPanelVisibilityToggler:g,phaseTwoDisabled:!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.phasetwo.enabled")})}function f(g,i,h,j){_.defer(function(){var k=h?1000:0;var l={duration:k,complete:j};if(i){g.slideDown(l)}else{g.slideUp(l)}})}JIRA.DevStatus.documentReadyInit=function(h){JIRA.DevStatus.devStatusModule=new JIRA.DevStatus.DevStatusModule({parentContainerSelector:d.parentContainer,linkSelector:d.link,panelSelector:d.devStatusContainer,statusPanelSelector:d.statusPanel});if(e(h)||b(h)){h.find("body").on("click",d.agileNavMenuLink,JIRA.DevStatus.Analytics.fireAgileDevStatusLinkClicked);JIRA.DevStatus.showTooltip=false}else{if(c(h)){if(JIRA.Issues.Api.isFullScreenIssueVisible()){var g=AJS.$(d.devStatusContainer);if(g.length>0){a(g,d.viewIssueHeader,f)}}}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(j,i){if(i.not(document).is(d.parentContainer)){a(i.find(d.devStatusContainer),d.viewIssueHeader,f);JIRA.DevStatus.showTooltip=false;return true}return false});JIRA.bind("GH.DetailView.updated",function(j,i){a(AJS.$(d.devStatusContainer),d.agileHeader)})};AJS.$(function(){JIRA.DevStatus.documentReadyInit(AJS.$(document))})});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusModule.js' */
Backbone.define("JIRA.DevStatus.DevStatusModule",Backbone.Model.extend({livestampRelativizeThreshold:1000*60*60*24*7,initialize:function(a){_.defaults(this,a);this._listeners=new JIRA.DevStatus.Util.Listeners();this.createBranchFormDialog=new JIRA.DevStatus.CreateBranchFormDialog(a);this.devSummaryJson=null},initializePanel:function(a){this._listeners.stopListening();this._getContainers(a);this.labsOptIn=JIRA.DevStatus.Labs.LabsOptInModel.createFromDOM(this.parentContainer);a.showTooltip=a.showTooltip&&!(this.labsOptIn.isAllowed()&&!(this.labsOptIn.isOptedIn()||this.labsOptIn.isDismissed()));this._createCreateBranchView(a);this.devSummaryJson=this.devStatusContainer.find(".dev-summary.json-blob").data("json");this._initLabsOptInView();this._initTryLabsView();this._createDevStatusData(a);this._createAnalyticsModel(a);this._createSummaryViews(a);this._setupDataEventHandlers();this.devStatusPanelVisibilityToggler=a.devStatusPanelVisibilityToggler;if(!a.phaseTwoDisabled){this._startDevStatus()}else{this._postRender(false,true)}this.labsOptIn.on("change:optedIn",this._onChangeLabsOptIn,this);if(this.labsOptIn.isAllowed()&&this.labsOptIn.isOptedIn()){this._onChangeLabsOptIn(this.labsOptIn,true)}},_createCreateBranchView:function(a){this.createBranchView=new JIRA.DevStatus.CreateBranchView({el:this.createBranchContainer,showTooltip:a.showTooltip})},_createDevStatusData:function(a){this.devStatusData=new JIRA.DevStatus.DevStatusData({issueId:JIRA.Issue.getIssueId()})},_createSummaryViews:function(a){var c=this;var b=this.devStatusContainer.data();this._summaryModules=this.statusPanelContainer.find(".status-panel").map(function(){var d=AJS.$(this);return new JIRA.DevStatus[d.data("module")]({livestampRelativizeThreshold:c.livestampRelativizeThreshold,dataAttrs:b,el:d,labsOptIn:c.labsOptIn,analyticsModel:c.analyticsModel})});this._errorModule=new JIRA.DevStatus.SummaryErrorModule({el:this.messagePanelContainer,dataAttrs:b});this.modules=_.clone(this._summaryModules);this.modules.push(this._errorModule)},_createAnalyticsModel:function(a){this.analyticsModel=new JIRA.DevStatus.AnalyticsModel({devStatusContainer:this.devStatusContainer,devStatusData:this.devStatusData})},_getContainers:function(a){this.devStatusContainer=a.container;this.parentContainer=a.container.closest(this.parentContainerSelector);this.createBranchContainer=a.container.find(this.linkSelector);this.statusPanelContainer=a.container.find(this.statusPanelSelector);this.headerContainer=this.parentContainer.find(a.headerSelector);this.messagePanelContainer=a.container.find(".message-panel")},_onLoadingStarted:function(){this._startLoadingModuleData()},_onLoadingSuccess:function(b,a,c){this._renderModules(this.devStatusData.get("aggregatedData"));this._postRender(!a,c)},_onLoadingFailure:function(){this._renderModules(undefined);this._postRender(false,true)},_setupDataEventHandlers:function(){this._listeners.startListening(this.devStatusData,"beforeRequest",this._onLoadingStarted,this);this._listeners.startListening(this.devStatusData,"requestSuccess",this._onLoadingSuccess,this);this._listeners.startListening(this.devStatusData,"requestFail",this._onLoadingFailure,this)},_startDevStatus:function(){var a=!this.devSummaryJson||this.devSummaryJson.isStale===true;if(this.devSummaryJson){this.devStatusData.setAggregateData(this.devSummaryJson.cachedValue,true,!a)}if(a){this._startLoadingModuleData();this.devStatusData.retrieveAggregateData()}},_onChangeLabsOptIn:function(a,b){if(b===true){}else{}},_initLabsOptInView:function(){this.labsOptInView=new JIRA.DevStatus.Labs.LabsOptInView({el:this.parentContainer.find(".labs-on-off-container"),labsOptIn:this.labsOptIn}).render()},_initTryLabsView:function(){var a=AJS.$('<div class="try-labs-container"></div>').appendTo(this.headerContainer);new JIRA.DevStatus.Labs.TryLabsView({el:a,labsOptIn:this.labsOptIn}).render()},_postRender:function(g,f){var e=this._isAnySummaryViewVisibleOnPanel();if(e){var d=this.analyticsModel.getIssue();JIRA.DevStatus.SummaryAnalytics.fireSummaryShownEvent(d.isAssignee,d.issueType,d.issueStatus,this.analyticsModel.getSummary());this._openDetailDialogUrlLink()}this._togglePanelEmptyStatus(!this._isAnySummaryViewVisibleOnPanel(true));var a=this.parentContainer;function b(){if(f){a.addClass("js-animation-completed")}}var c=e||(this.createBranchContainer.size()>0);if(this.devStatusPanelVisibilityToggler&&(a.is(":visible")!==c)){this.devStatusPanelVisibilityToggler(this.parentContainer,c,g,b)}else{b()}},_getModuleByType:function(a){return _.find(this.modules,function(b){return b.data&&b.data.getType&&_.isEqual(b.data.getType(),a)})},_openDetailDialogUrlLink:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a){var c;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(a)){c=this._getModuleByType("repository")}else{c=this._getModuleByType(a);if(c){AJS.Meta.set("fusion-open-detail-dialog",undefined)}}if(c){var b=c.view;if(b&&b.isVisible()){AJS.Meta.set("fusion-analytics-new-context-link",true);b.getSummaryLink().click()}}}},_togglePanelEmptyStatus:function(a){if(this.statusPanelContainer){this.statusPanelContainer.toggleClass("empty-status",a)}},_isAnySummaryViewVisibleOnPanel:function(b){var a=b?this._summaryModules:this.modules;return !!_.find(a,function(c){return c.isViewVisible()})},_renderModules:function(a){_.each(this.modules,function(b){b.render(a)})},_startLoadingModuleData:function(){_.each(this.modules,function(a){a.startLoading()})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusData.js' */
Backbone.define("JIRA.DevStatus.DevStatusData",Backbone.Model.extend({properties:["aggregatedData"],namedEvents:["beforeRequest","requestFail","requestSuccess"],initialize:function(a){this.issueId=a.issueId},retrieveAggregateData:function(){var a=AJS.contextPath()+"/rest/dev-status/1.0/issue/summary?issueId="+this.issueId;this.trigger("beforeRequest");return AJS.$.ajax(a).done(_.bind(this.setAggregateData,this)).fail(_.bind(this.setAggregateDataError,this)).promise()},setAggregateData:function(b,a,c){this.set("aggregatedData",b);this.trigger("requestSuccess",this,a===true,!!c)},setAggregateDataError:function(b,a){this.set("aggregatedData",undefined);this.trigger("requestFail",this,b)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/analytics/AnalyticsModel.js' */
Backbone.define("JIRA.DevStatus.AnalyticsModel",Backbone.Model.extend({TO_ANALYTIC_KEY_OVERRIDE:{repository:"commit"},properties:["issue","summary"],initialize:function(a){this.devStatusContainer=a.devStatusContainer;this.devStatusData=a.devStatusData;this._getAllAnalyticData()},getIssue:function(){return this.get("issue")},getSummary:function(){return this.get("summary")},_getAllAnalyticData:function(){this.set("issue",this._getAnalyticIssueData());this._initListenerToData()},_getAnalyticIssueData:function(){return{isAssignee:this.devStatusContainer.data("is-assignee"),isAssignable:this.devStatusContainer.data("is-assignable"),issueStatus:this.devStatusContainer.data("issue-status"),issueType:this.devStatusContainer.data("issue-type")}},_getAnalyticSummaryData:function(c){var a=this;var b={};_.each(c.summary,function(e,d){b[a.TO_ANALYTIC_KEY_OVERRIDE[d]||d]=e.overall.count>0});return b},_initListenerToData:function(){var a=this;this.devStatusData.on("requestSuccess",function(){a.set("summary",a._getAnalyticSummaryData(a.devStatusData.get("aggregatedData")))})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/CreateBranchView.js' */
Backbone.define("JIRA.DevStatus.CreateBranchView",Backbone.View.extend({initialize:function(a){this.tooltipShown=!a.showTooltip;this.linkTextSelector=".devstatus-cta-link-text";this.issueContainer=".issue-container";this._processLinkForNavigableURL();this._initTooltip();_.defer(_.bind(this._openCreateBranchDialog,this))},getCreateBranchLink:function(){return this.$el},_processLinkForNavigableURL:function(){this.getCreateBranchLink().data("cta",this._getCta(this.$el));this.getCreateBranchLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam("create-branch"))},_openCreateBranchDialog:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a==="create-branch"){AJS.Meta.set("fusion-open-detail-dialog",undefined);AJS.Meta.set("fusion-analytics-new-context-link",true);this.getCreateBranchLink().click()}},_initTooltip:function(){if(!this.tooltipShown&&this.$el.length>0){_.defer(_.bind(function(){var a=this.$el.data("cta");if(a){new AJS.HelpTip({id:a+".tooltip",title:"Start development",bodyHtml:JIRA.Templates.DevStatus.Tooltip.createBranch(),anchor:this.$el.find(this.linkTextSelector),isSequence:true,inlineDialogOpts:{container:this.issueContainer}});this.tooltipShown=true;AJS.HelpTip.Manager.showSequences()}},this))}},_getCta:function(c){var b=c.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BasePanelModule.js' */
Backbone.define("JIRA.DevStatus.BasePanelModule",Backbone.Model.extend({initialize:function(a){this.options=_.defaults({},a);this.data=this.createModel()},render:function(a){this.startViews();this.data.updateData(a);this.view.render()},startLoading:function(){this.data.startLoadingData&&this.data.startLoadingData()},startViews:function(){if(!this.view){this.view=this.createView()}},stopViews:function(){if(this.view){this.view.undelegateEvents();this.view.$el.empty();this.view.hide();this.view=null}},isViewVisible:function(){return this.view&&this.view.isVisible()},createView:function(){},createModel:function(){}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryView.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryView",Backbone.View.extend({template:undefined,events:{"simpleClick .summary":"_onSummaryLinkClick"},initialize:function(a){this.options=_.clone(a);this.model.on("change:hasData",this._addOrRemoveHasDataClass,this);this.model.on("change:dataLoading",this._addOrRemoveDataLoadingClass,this);this.transitionView=new JIRA.DevStatus.SummaryTransitionView({model:this.model,el:this.$el})},render:function(){var b=this.isVisible();if(b){var a=AJS.$(this.template(_.extend({issueKey:JIRA.Issue.getIssueKey(),livestampRelativizeThreshold:this.options.livestampRelativizeThreshold},this.model.getOverall())));if(this._shouldAnimateDataTransition()){this.transitionView.renderVisible(a)}else{this.$el.html(a);JIRA.DevStatus.Date.addTooltip(a)}this._renderNavigableSummaryLink();this.show()}else{if(!this._isHidden()){if(this._shouldAnimateDataTransition()){this.transitionView.renderHidden(_.bind(this.hide,this))}else{this.hide()}}}this._addOrRemoveDataLoadingClass();this._addOrRemoveHasDataClass()},getDefaultDetailDialogParameters:function(){return{issueKey:JIRA.Issue.getIssueKey(),issueId:JIRA.Issue.getIssueId(),tabs:this.model.get("byInstanceType"),dataType:this.model.getType(),livestampRelativizeThreshold:this.options.livestampRelativizeThreshold,showContactAdminForm:this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm}},getSummaryLink:function(){return this.$el.find("a.summary")},isVisible:function(){return this.model.getOverall().count>0},_addOrRemoveHasDataClass:function(){var a=this.model.get("hasData");this.$el.toggleClass("js-has-data",a)},_renderNavigableSummaryLink:function(){this.getSummaryLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam(this.model.getType()))},_addOrRemoveDataLoadingClass:function(){var a=this.model.get("dataLoading");this.$el.toggleClass("data-loading",a)},_onSummaryLinkClick:function(a){a.preventDefault();console.log("Summary view not supported: ",this)},_shouldAnimateDataTransition:function(){return !!this.model.getPreviousOverall()},_isHidden:function(){return this.$el.hasClass("hidden")},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryTransitionView.js' */
Backbone.define("JIRA.DevStatus.SummaryTransitionView",Backbone.View.extend({slideTransitionTime:500,initialize:function(){},renderVisible:function(b){var a=!AJS.$.contains(document,this.$el[0]);if(this._hasPreviousData()){if(this._hasDataChanged()){this._prepareContentsForTransition(b,this.$el);this.$el.addClass("roll-transition")}}else{this._preStartSlideTransition();this.$el.addClass("slide-down-transition");a=true}this.$el.html(b);JIRA.DevStatus.Date.addTooltip(b);if(a){_.defer(_.bind(this._initiateTransition,this))}else{this._initiateTransition()}},renderHidden:function(b){var a=this;this.$el.slideUp(this.slideTransitionTime,function(){a.$el.css("display","");b()})},_initiateTransition:function(){if(this.$el.hasClass("slide-down-transition")){this._postStartSlideTransition();this.$el.removeClass("slide-down-transition");this._startSlideDownTransition(this.$el,0)}else{if(this.$el.hasClass("roll-transition")){this.$el.removeClass("roll-transition");this._startRollTransition()}var b=this.$el.find(".sliding-container");if(b.length>0){var a=this;b.each(function(d,c){var e=AJS.$(c);var f=e.data("prevHeight");a._startSlideDownTransition(e,f)})}}},_startSlideDownTransition:function(a,b){var c=a.height();if(b!==c){a.height(b).animate({height:c},this.slideTransitionTime,function(){a.css("height","auto");a.find(".rolling-content").removeClass("transit")})}},_startRollTransition:function(){this.$el.find(".rolling-container").each(_.bind(function(b,a){var f=AJS.$(a);var e=f.find(".rolling-content");var d=e.find(":not(.old-content)");var c=d.height();f.height(c);e.addClass("transit");d.css("margin-top","-"+c+"px").animate({"margin-top":"0"},this.slideTransitionTime,function(){f.css("height","auto");f.find(".old-content").remove();e.removeClass("transit");d.css("margin-top","")})},this))},_prepareContentsForTransition:function(b,d){b=AJS.$("<div></div>").append(b);var c=b.find(".sliding-container");var f=d.find(".sliding-container");c.each(function(h,i){var g=f.get(h);if(g){var j=AJS.$(g);AJS.$(i).data("prevHeight",j.height())}});var e=b.find(".rolling-container");var a=d.find(".rolling-container");e.each(function(i,j){var k=AJS.$(j).find(".rolling-content");var h=a.get(i);if(h){var g=AJS.$(h).find(".rolling-content").children();g.addClass("old-content");k.append(g)}})},_hasPreviousData:function(){var a=this.model.getPreviousOverall();return a&&a.count>0},_hasDataChanged:function(){return !_.isEqual(this.model.getOverall(),this.model.getPreviousOverall())},_preStartSlideTransition:function(){this.$el.css("height","0");this.$el.css("opacity","0")},_postStartSlideTransition:function(){this.$el.css("height","");this.$el.css("opacity","")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModule.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModule",JIRA.DevStatus.BasePanelModule.extend({model:undefined,viewType:undefined,createModel:function(){return new this.model({})},createView:function(){return new this.viewType(_.extend(_.clone(this.options),{model:this.data}))}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModel.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModel",Backbone.Model.extend({typeId:undefined,properties:["byInstanceType","overall","previousOverall","hasData","dataLoading"],startLoadingData:function(){this.set("dataLoading",true)},updateData:function(b){this.set("hasData",b!==undefined);this.set("dataLoading",false);this.set("previousOverall",this.getOverall());if(b&&b.summary&&b.summary[this.typeId]){var a=b.summary[this.typeId];this.set("byInstanceType",a.byInstanceType);this.set("overall",a.overall)}else{this.set("byInstanceType",{});this.set("overall",{count:0})}},getType:function(){return this.typeId},getOverall:function(){return this.get("overall")},getPreviousOverall:function(){return this.get("previousOverall")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInModel.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInModel",Backbone.Model.extend({defaults:{allowed:false,optedIn:false,optedInByAdmin:false,dismissed:false,id:1},isAllowed:function(){return this.get("allowed")},isOptedIn:function(){return this.get("optedIn")},isOptedInByAdmin:function(){return this.get("optedInByAdmin")},setOptedIn:function(a){return this.save({optedIn:a},{wait:true}).done(function(){JIRA.DevStatus.LabsAnalytics.fireLabsEvent(a)})},toggleOptedIn:function(a){var b=this.isOptedIn();return this.setOptedIn(!b)},setDismissed:function(a){return this.save({dismissed:a},{wait:true})},isDismissed:function(){return this.get("dismissed")},url:function(){return AJS.contextPath()+"/rest/dev-status/1.0/labs-opt-in/"}},{createFromDOM:function(b){var a=AJS.$(b).find("#devstatus-container");return new JIRA.DevStatus.Labs.LabsOptInModel(a.data("labs-json"))}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInView.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInView",Backbone.View.extend({events:{"click .toggle-labs":"_onClickToggle","click .labs-close":"_onClickDismiss","click .feedback-link":"_onClickFeedback"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change",this.render,this);this.labsOptIn.on("change:optedIn",this._onChangeOptedIn,this)},render:function(){var a=this.labsOptIn;if(a.isAllowed()&&(a.isOptedInByAdmin()||!a.isDismissed())){this._show()}else{this._hide()}return this},_onClickToggle:function(a){a.preventDefault();this.labsOptIn.toggleOptedIn()},_onClickDismiss:function(a){a.preventDefault();this.labsOptIn.setDismissed(true)},_onClickFeedback:function(a){a.preventDefault();this._showFeedbackDialog()},_onChangeOptedIn:function(b,a){if(a===false){this._showFeedbackDialog({summary:"How can Atlassian improve the development panel?"})}},_showFeedbackDialog:function(a){a=_.defaults({},a,{summary:"What do you think of the development panel?"});var b=JIRA.DevStatus.Labs.LabsOptInView.COLLECTOR_ID;window.ATL_JQ_PAGE_PROPS=window.ATL_JQ_PAGE_PROPS||{};window.ATL_JQ_PAGE_PROPS[b]={fieldValues:{summary:a.summary},triggerFunction:function(c){_.defer(function(){c()})}};AJS.$.getScript(this._collectorUrlFor(b))},_collectorUrlFor:function(a){return"https://jira.atlassian.com/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-b435xk-1988229788/6144/9/1.4.0-m6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId="+a},_show:function(){this.$el.html(JIRA.Templates.DevStatus.labsOnOff({isOptedIn:this.labsOptIn.isOptedIn(),isOptedInByAdmin:this.labsOptIn.isOptedInByAdmin()}));this.$el.removeClass("hidden")},_hide:function(){this.$el.empty();this.$el.addClass("hidden")}},{COLLECTOR_ID:"effe8b72"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/TryLabsView.js' */
Backbone.define("JIRA.DevStatus.Labs.TryLabsView",Backbone.View.extend({events:{"click .try-labs":"_onClickTryLabs"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change:dismissed",this.render,this)},render:function(){if(!this.labsOptIn.isAllowed()||this.labsOptIn.isOptedIn()||!this.labsOptIn.isDismissed()){this.$el.empty()}else{this.$el.html(JIRA.Templates.DevStatus.tryLabs())}return this},_onClickTryLabs:function(a){a.preventDefault();this.labsOptIn.setDismissed(false)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModule.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModule",JIRA.DevStatus.BasePanelModule.extend({createModel:function(){return new JIRA.DevStatus.SummaryErrorModel({})},createView:function(){var a=this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm;return new JIRA.DevStatus.SummaryErrorView({model:this.data,el:this.options.el,showContactAdminForm:a})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModel.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModel",Backbone.Model.extend({properties:["hasErrors","errorInstances","configInstances"],defaults:function(){return{hasErrors:false,errorInstances:[],configInstances:[]}},updateData:function(b){var c=this._extractErrors(b&&b.errors);var a=this._extractErrors(b&&b.configErrors);this.set("hasErrors",!b||!_.isEmpty(c)||!_.isEmpty(a));this.set("errorInstances",c);this.set("configInstances",a)},_extractErrors:function(a){if(!a){return[]}return _.map(_.filter(a,function(b){return b.error}),function(b){return b.instance})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorView.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorView",JIRA.DevStatus.BaseSummaryView.extend({initialize:function(a){this.showContactAdminForm=a.showContactAdminForm},render:function(){if(this.isVisible()){this.$el.html(JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon({instances:this.model.get("errorInstances"),notConfiguredInstances:this.model.get("configInstances"),showContactAdminForm:this.showContactAdminForm}));this.show()}else{this.hide()}return this},isVisible:function(){return this.model.get("hasErrors")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateBranchFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateBranchFormDialog",Backbone.View.extend({initialize:function(a){AJS.namespace("JIRA.DevStatus.CtaDialog");this.parentContainerSelector=a.parentContainerSelector;this.panelSelector=a.panelSelector;this.linkSelector=a.linkSelector;this.dialogId="devstatus-cta-dialog";JIRA.DevStatus.CtaDialogAnalytics.initialize(this.parentContainerSelector,this.linkSelector,this.dialogId);this._initFormDialog()},_initFormDialog:function(){var a=this;var b=JIRA.DevStatus.CtaDialog.dialog=new JIRA.FormDialog({id:this.dialogId,width:560,content:function(c){this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:a._getCta(this.$activeTrigger)});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".target").eq(0).focus();JIRA.DevStatus.CtaDialogAnalytics.fireCreateBranchEvent("dialog.open")})},trigger:this.linkSelector,autoClose:true})},_getCta:function(d){var c=d.data("cta");if(c){return c}else{var b=d.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateReviewFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateReviewFormDialog",Backbone.View.extend({initialize:function(a){this.linkSelector=a.linkSelector;this.applicationType=a.applicationType;this.instances=a.instances;this.dialog.instance=this},renderSuccess:function(){AJS.$(".create-review-instance a").attr("href",JIRA.DevStatus.URL.getCreateReviewDetailUrl(this.applicationType))},_processTargets:function(b){var c=this,a=_.map(b,function(e){var d=_.find(c.instances,function(f){return f.baseUrl===e.baseUrl});if(!d){return null}return _.extend({},e,d)});return _.sortBy(_.filter(a,_.identity),"name")},dialog:new JIRA.FormDialog({id:"devstatus-cta-create-review-dialog",trigger:".create-review-instance a",width:560,content:function(c){var a=this.instance,b=this;this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:"devstatus.cta.createreview",processTargets:function(d){return b.instance._processTargets.call(b.instance,d)},uniqueResultAction:function(d){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true);JIRA.DevStatus.Navigate.navigate(d.url)}});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".primary.target").eq(0).focus();AJS.$(".target").click(function(f){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true)})})},autoClose:true})}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/InstancePickerView.js' */
Backbone.define("JIRA.DevStatus.InstancePickerView",Backbone.View.extend({ARROW_KEY_UP_CODE:38,ARROW_KEY_DOWN_CODE:40,template:JIRA.Templates.DevStatus.Dialog.content,events:{"keydown .jira-dialog-content":"_onTargetKeyboardSelect","focus .target":"_onTargetFocus"},initialize:function(a){this.currentSelected=null;this.link=a.activeTrigger;this.cta=a.cta;this.processTargets=a.processTargets;this.uniqueResultAction=a.uniqueResultAction||function(b){JIRA.DevStatus.Navigate.navigate(b.url)}},render:function(){var b=this._getIssueId(this.link),a=AJS.$.Deferred();this._fetchTargets(this.cta,b).done(_.bind(function(c){if(this.processTargets){c.remoteApps=this.processTargets(c.remoteApps)}var e=this._isUniqueResult(c);if(e){this.uniqueResultAction(e)}else{var d=AJS.$(this.template(c));a.resolve(d)}},this)).fail(function(c){a.resolve(c)});return a.promise()},_fetchTargets:function(b,c){var a=AJS.$.Deferred();AJS.$.ajax({url:contextPath+"/rest/dev-status/1.0/issue/targets?cta="+encodeURIComponent(b)+"&issueId="+encodeURIComponent(c)}).done(function(d){a.resolve(d)}).fail(function(e,d){a.reject(JIRA.SmartAjax.buildDialogErrorContent(e).html())});return a.promise()},_getIssueId:function(a){return(a&&a.data("issueid"))||JIRA.Issue.getIssueId()},_isUniqueResult:function(a){return a.remoteApps.length===1&&a.remoteApps[0]},_toggleEntry:function(d,b,a){var c=d.eq(b);a&&c.focus();c.addClass("selected");this.currentSelected=c},_removeSelected:function(){if(this.currentSelected){this.currentSelected.removeClass("selected");this.currentSelected=null}},_onTargetKeyboardSelect:function(d){if(d.type==="keydown"){var c=0;if(d.keyCode===this.ARROW_KEY_UP_CODE){c=-1}else{if(d.keyCode===this.ARROW_KEY_DOWN_CODE){c=1}}if(c!==0){d.preventDefault();var b=this.$el.find(".target");var a=b.index(this.$el.find(".selected"));if(a!==-1){b.eq((a+c)%b.size()).focus()}}}},_onTargetFocus:function(a){this._removeSelected();this._toggleEntry(AJS.$(a.target),0,false)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogView.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogView",Backbone.View.extend({frameEvents:{"click .menu-item":"_doTabClick"},frameTemplate:JIRA.Templates.DevStatus.DetailDialog.frame,oauthStatusTemplate:JIRA.Templates.DevStatus.DetailDialog.oauthStatus,authenticationTemplate:JIRA.Templates.DevStatus.DetailDialog.authenticationScreen,connectionProblemTemplate:JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen,connectionProblemWarningTemplate:JIRA.Templates.DevStatus.connectionProblemAsWarning,noPermissionToViewAllTemplate:JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll,initialize:function(a){this.options=_.defaults({},a,{width:560,model:new JIRA.DevStatus.BaseDetailDialogModel(a)});this.model=this.options.model;this._initFetchHandlers();this._initFormDialog()},renderSuccess:function(b,a){return this},shouldRefreshOnTabSwitch:function(a){return false},getTitle:function(b,a){console.warn("Unimplemented getTitle() function",this);return a},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more information by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related development information"},getConnectionMessageInCanvas:function(){return "Unable to retrieve development information"},getNoPermissionToViewAllMessageInCanvas:function(){return "Unable to retrieve development information"},getContactAdmistratorsOrLoginMessageInCanvas:function(){if(JIRA.Users.LoggedInUser.isAnonymous()){return "You might be able to view more by authenticating with JIRA."}else{return "Please contact your administrator."}},hasData:function(a){return a.length>0},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},_getPane:function(a){return a?this.$el.find("#tab-content-"+a.replace(/(:|\.|\[|\])/g,"\\$1")):AJS.$()},getContentContainer:function(a){return this._getPane(a||this._getActiveApplicationType()).find(".detail-content-container")},_doTabClick:function(b){b.preventDefault();var a=this._getActiveApplicationType();this.model.switchTab(a,this.shouldRefreshOnTabSwitch(a));this.analytics&&this.analytics.fireDetailTabClicked(a)},_redirectToLoginIf401:function(a){if(a&&a.status===401){JIRA.DevStatus.Navigate.redirectToLogin();return true}return false},_initFetchHandlers:function(){this.model.on("fetchRequested",this._showLoadingIndicator,this);this.model.on("fetchSucceeded",this._handleFetchSucceeded,this);this.model.on("fetchFailed",this._handleFetchFailed,this)},_handleFetchSucceeded:function(c,a){this._hideLoadingIndicator(c);var b=a.detail&&this.hasData(a.detail);if(b){this.renderSuccess(c,a.detail)}this._renderError(c,a.errors,b);this._postRender()},_handleFetchFailed:function(b,a){this._hideLoadingIndicator(b);if(!this._redirectToLoginIf401(a)){this._renderError(b,[],false,true)}},_initAuthenticationCallbacks:function(){this._patchAJSIconsForAppLinks();var a=this;var d=function(g,f){a.model.oauthStatusChanged(f.appType);a.model.fetchAuthenticationStatuses();g.preventDefault()};var c=function(g,f){AJS.$.ajax(AJS.contextPath()+"/rest/auth/1/session").promise().fail(function(e){a._redirectToLoginIf401(e)})};var b=AJS.$(document);b.bind("applinks.auth.approved",d);b.bind("applinks.auth.denied",c);AJS.$(this.dialog).bind("Dialog.beforeHide",function(){b.unbind("applinks.auth.approved",d);b.unbind("applinks.auth.denied",c);a.instanceListPopup&&a.instanceListPopup.remove()});AJS.$('<div class="applinks-auth-confirmation-container hidden"></div>').appendTo(this.$el)},_initFetchAuthenticationHandlers:function(){this.model.on("fetchAuthRequested",this._showLoadingIndicator,this);this.model.on("fetchAuthSucceeded",this._handleAuthSucceeded,this);this.model.on("fetchAuthFailed",this._handleAuthFailed,this)},_handleAuthSucceeded:function(b){var a=this;var d=_.filter(b,function(e){return e.configured&&!e.authenticated&&e.source&&e.source.applicationLinkId});var c=this._getOAuthStatusDiv();if(d.length>0&&!JIRA.Users.LoggedInUser.isAnonymous()){c.html(this.oauthStatusTemplate({message:this.getOAuthMessageInFooter(d)}));this._renderUnauthInstancesInFooter(d);c.show()}else{c.hide()}},_handleAuthFailed:function(a){this._redirectToLoginIf401(a);this._getOAuthStatusDiv().hide()},_renderUnauthInstancesInFooter:function(c){var b=this._getOAuthStatusDiv();var d=_.map(_.pluck(c,"source"),this._createOAuthInstanceDiv);if(d.length>0){b.append(d[0]);if(d.length>1){b.append(", ");b.append(d[1]);if(d.length>2){b.append(" ");var e=AJS.$('<span class="more-instances"><a href="#">'+"... more"+"</a></span>");b.append(e);var a=AJS.$('<ul class="instance-list"></ul>');_.each(d.slice(2),function(f){a.append(AJS.$('<li class="instance-in-popup"></li>').append(f))});AJS.InlineDialog(e,"instance-list-popup",function(g,f,h){g.html(a);h();return false},{width:150,offsetX:-100,onTop:true})}}}},_createOAuthInstanceDiv:function(a){var b=ApplinksUtils.createAuthRequestInline(null,{id:a.applicationLinkId,authUri:AJS.contextPath()+"/plugins/servlet/applinks/oauth/login-dance/authorize?applicationLinkID="+encodeURIComponent(a.applicationLinkId),appUri:a.baseUrl,appName:a.name,appType:a.type});return AJS.$('<span class="instance"></span>').append(b.find("a.applink-authenticate").text(a.name))},_patchAJSIconsForAppLinks:function(){AJS.icons=AJS.icons||{};AJS.icons.addIcon=AJS.icons.addIcon||{};AJS.icons.addIcon.init=AJS.icons.addIcon.init||function(){}},_getOAuthStatusDiv:function(){var a=this.$el.find(".buttons-container .oauth-status");if(a.length){return a}else{return AJS.$('<div class="oauth-status" />').appendTo(this.$el.find(".buttons-container.form-footer"))}},_renderError:function(f,g,d,c){var a=_.groupBy(g,function(h){var i=h.error;if(i==="unauthorized"||i==="incapable"){return i}else{return"others"}});var b=_.pluck(a.unauthorized,"instance");var e=_.pluck(a.others,"instance");if(b.length>0){this.model.fetchAuthenticationStatuses()}if(d){if(e.length>0){this._renderConnectionErrorBeforeData(f,e)}}else{if(b.length>0){this._renderAuthenticationError(f,b,e)}else{if(c||e.length>0){this._renderConnectionError(f,e)}else{this._renderNoPermissionToViewAllWarning(f)}}}},_renderConnectionErrorBeforeData:function(b,a){this.getContentContainer(b).prepend(this.connectionProblemWarningTemplate({instances:a,showContactAdminForm:this.options.showContactAdminForm}))},_renderConnectionError:function(b,a){this.getContentContainer(b).html(this.connectionProblemTemplate({instances:a,title:this.getConnectionMessageInCanvas(),showContactAdminForm:this.options.showContactAdminForm}))},renderNoPermissionToViewAllWarningAtBottom:function(c,d){var a=this.model.get("tabs")[c]||{};var b=this.model.get("contentMap")[c]||{};if(d<a.count){if((b.errors||[]).length===0||JIRA.Users.LoggedInUser.isAnonymous()){this.getContentContainer(c).append(this._getNoPermissionToViewAllHtml())}}},_getNoPermissionToViewAllHtml:function(){return this.noPermissionToViewAllTemplate({message:this.getNoPermissionToViewAllMessageInCanvas(),secondaryMessage:this.getContactAdmistratorsOrLoginMessageInCanvas()})},_renderNoPermissionToViewAllWarning:function(a){this.getContentContainer(a).html(this._getNoPermissionToViewAllHtml())},_renderAuthenticationError:function(f,c,e){var a=this.getContentContainer(f);a.html(this.authenticationTemplate({unauthInstances:c,title:this.getOAuthMessageInCanvas(),otherInstances:e,showContactAdminForm:this.options.showContactAdminForm}));var d=_.map(c,this._createOAuthInstanceDiv);var b=a.find(".instances");_.each(d,function(h,g){if(g!==0){b.append(", ")}b.append(h)})},_initFormDialog:function(){var a=this;this.dialog=new JIRA.FormDialog({id:this.options.id,width:this.options.width,content:function(b){a.setElement(this.$popup);a.delegateEvents(_.extend({},a.frameEvents,a.events));a._renderFrame();a._initAuthenticationCallbacks();a._initFetchAuthenticationHandlers();a.model.fetchAuthenticationStatuses();a.model.switchTab(a._getActiveApplicationType());b()},autoClose:true})},_postRender:function(){this.$el.find(".extra-content-in-title").tooltip();this.dialog._positionInCenter();this.$el.find(".active-pane a:eq(0)").focus()},_getActiveApplicationType:function(){return this.$el.find(".menu-item.active-tab").data("applicationType")},_showLoadingIndicator:function(c){var a=this._getPane(c);a._removeClass("ready");a.addClass("loading");var b=a.find(".status-loading");b.spin("large");b.show()},_hideLoadingIndicator:function(c){var a=this._getPane(c);a.addClass("ready");var b=a.find(".status-loading");if(b){a.removeClass("loading");b.hide();b.spinStop()}},_renderFrame:function(){this.$el.html(this.frameTemplate({title:this.getTitle(this.options.count,this.options.issueKey),tabs:this._convertTabsForSoy(),initialTab:this.options.initialTab}));if(this.options.height){this.$el.find(".form-body").css("min-height",this.options.height)}},_convertTabsForSoy:function(){return _.chain(this.model.get("tabs")).map(function(b,a){return _.extend({type:a},b)}).sortBy(function(a){return a.type}).value()},_createReviewersInlineDialog:function(){this.reviewerInlineDialogView=new JIRA.DevStatus.ReviewerInlineDialogView({el:this.$el.find(".extrareviewers-tooltip"),beforeShowCallback:this._removeInlineDialog});return this.reviewerInlineDialogView},_removeInlineDialog:function(a){if(this[a]){this[a].hide();this[a].remove();this[a]=undefined}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogModel.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogModel",Backbone.Model.extend({TAB_PREFIX:"#tab-menu-",PANE_PREFIX:"#tab-content-",properties:["tabs","contentMap","oauthStatuses","selectedTab","selectedPane"],namedEvents:["fetchRequested","fetchFailed","fetchSucceeded","fetchAuthRequested","fetchAuthFailed","fetchAuthSucceeded"],initialize:function(a){this.issueKey=a.issueKey;this.issueId=a.issueId;this.type=a.dataType;this.set("contentMap",{});this.set("tabs",a.tabs)},switchTab:function(b,a){this.set("selectedTab",this.TAB_PREFIX+b);this.set("selectedPane",this.PANE_PREFIX+b);if(this.get("contentMap")[b]==null||a){this._fetchContents(b)}},_fetchContents:function(a){this.trigger("fetchRequested",a);this._handleFetch(a,AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/issue/detail",data:{issueId:this.issueId,applicationType:a,dataType:this.type}}).promise())},_handleFetch:function(c,b){var a=this;b.done(function(d){a._fireSuccessResult(c,d)}).fail(function(e,d){a._fireFailResult(c,e)})},_fireSuccessResult:function(b,a){this._updateContents(b,a);this.trigger("fetchSucceeded",b,a)},_fireFailResult:function(b,a){this._updateContents(b);this.trigger("fetchFailed",b,a)},_updateContents:function(b,a){this.get("contentMap")[b]=a},fetchAuthenticationStatuses:function(){var b=_.keys(this.get("tabs")||{});if(!_.isEmpty(b)){var a=this;AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/provider/auth-status",data:{applicationType:b}}).promise().done(function(c){if(c&&c.data){a._updateOAuthStatuses(c.data);a.trigger("fetchAuthSucceeded",c.data)}else{a._updateOAuthStatuses();a.trigger("fetchAuthFailed",null,c)}}).fail(function(d,c){a._updateOAuthStatuses();a.trigger("fetchAuthFailed",d)})}},oauthStatusChanged:function(b){if(_.has(this.get("tabs"),b)){var a=this._getCurrentApplicationType();if(a===b){this._fetchContents(a)}else{this.get("contentMap")[b]=null}}},_getCurrentApplicationType:function(){var a=this.get("selectedTab");if(a){return a.slice(this.TAB_PREFIX.length)}return null},_updateOAuthStatuses:function(a){this.set("oauthStatuses",a)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/ReviewerInlineDialogView.js' */
Backbone.define("JIRA.DevStatus.ReviewerInlineDialogView",JIRA.DevStatus.BaseDetailDialogView.extend({extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{mouseenter:"_onHoverExtraReviewersToolTip",click:"_onClickExtraReviewersToolTip"},initialize:function(a){this.beforeShowCallback=a.beforeShowCallback},_onHoverExtraReviewersToolTip:function(c){this.beforeShowCallback("activeExtraReviewersToolTip");c.preventDefault();var a=this;var b=AJS.$(c.target);var d="extrareviewers-tooltip";this.activeExtraReviewersToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.extraReviewersToolTipTemplate({reviewers:g.data("reviewers")}));a.activeExtraReviewersToolTip.$content=h;i()},{cacheContent:false,hideDelay:200,onHover:true,width:false});this.activeExtraReviewersToolTip.show()},_onClickExtraReviewersToolTip:function(a){if(this.activeExtraReviewersToolTip){a.stopPropagation()}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/build/DetailDialogBuildView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBuildView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.build,events:{"click a.project-link":"_onClickProjectLink","click a.plan-link":"_onClickPlanLink","click a.build-link":"_onClickBuildLink"},initialize:function(a){this.analytics=JIRA.DevStatus.BuildsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"build",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.projects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,projects:this.sortProjectsAndPlans(c),hasArtifacts:this.hasArtifacts(c),livestampRelativizeThreshold:this.options.livestampRelativizeThreshold}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getBuildCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#build|1\u003cbuilds}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more builds by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related builds"},getConnectionMessageInCanvas:function(){return "Unable to retrieve build information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related builds."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.projects||[])},[]).length>0},sortProjectsAndPlans:function(a){a=_.sortBy(a,function(b){return _.last(_.sortBy(b.plans,function(c){return c.build.finishedDate})).build.finishedDate}).reverse();_.each(a,function(b){b.plans=_.sortBy(b.plans,function(c){return c.build.finishedDate}).reverse()});return a},hasArtifacts:function(a){return _.any(a,function(b){return _.any(b.plans,function(c){return c.build&&c.build.artifacts&&c.build.artifacts.length})})},getBuildCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.plans,"key")})).length},_onClickProjectLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailProjectClicked()},_onClickPlanLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailPlanClicked()},_onClickBuildLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailBuildClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/deployment/DetailDialogDeploymentView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogDeploymentView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment,events:{"click a.project-link":"_onClickProjectLink","click a.environment-link":"_onClickEnvironmentLink","click a.release-link":"_onClickReleaseLink"},initialize:function(a){this.analytics=JIRA.DevStatus.DeploymentsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"deployment",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.deploymentProjects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,deploymentProjects:this.sortProjects(c),livestampRelativizeThreshold:this.options.livestampRelativizeThreshold}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getEnvironmentCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#deployment|1\u003cdeployments}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more deployments by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related deployments"},getConnectionMessageInCanvas:function(){return "Unable to retrieve deployment information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related deployments."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.deploymentProjects||[])},[]).length>0},sortProjects:function(a){return _.sortBy(a,function(b){return _.last(_.sortBy(b.environments,function(c){return new Date(c.lastDeployed||0).getTime()})).lastDeployed}).reverse()},getEnvironmentCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.environments,"environmentId")})).length},_onClickProjectLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailProjectClicked()},_onClickEnvironmentLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailEnvironmentClicked()},_onClickReleaseLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailReleaseClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogCommitView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogCommitView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.commit,events:{"click a.repository-link":"_onClickRepositoryLink","click a.changesetid":"_onClickChangesetId","click .filecount a":"_onClickFiles","click .file-expand a":"_onClickExpand","click .create-review-commit a":"_onClickCreateReview","click .filename a":"_onClickFile","mouseenter .reviews-link":"_onHoverReviewsToolTip",click:"_onClickReviewsToolTip"},initialize:function(a){this.analytics=JIRA.DevStatus.CommitsAnalytics;this.issueId=a.issueId;var c=AJS.Meta.get("fusion-open-detail-dialog");var b;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(c)){b=JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(c)}JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"commit",width:1000,height:400,initialTab:b},a))},concatResults:function(a){return _.reduce(a,function(b,d){var c=d.repositories||[];_.each(c,function(e){e.showInstance=d._instance&&!d._instance.singleInstance;e.instance=d._instance});return b.concat(c)},[])},_clipEllipsis:function(){function a(b){return b.outerWidth()}this.$el.find(".detail-content-container .file .ellipsis").each(function(b,f){var e=AJS.$(f);var c=a(e);if(c==0){return}var d=e.find("a");if(a(d)>c){var g=d.text();while(a(d)>c){g=g.slice(1);d.text("\u2026"+g)}}})},renderSuccess:function(e,a){var c=this.concatResults(a);var b=this.getContentContainer(e);this.transformedRepositories=this.transformRepositories(c);var d=this.setupCreateReviewDialog(this.transformedRepositories);b.html(this.template({applicationType:e,repositories:this.transformedRepositories,canCreateReview:d,livestampRelativizeThreshold:this.options.livestampRelativizeThreshold}));this.renderNoPermissionToViewAllWarningAtBottom(e,this.getUniqueCommitCount(c));JIRA.DevStatus.Date.addTooltip(b);this.setupBranchesTooltip();this.createReviewDialog&&this.createReviewDialog.renderSuccess();return this},setupCreateReviewDialog:function(a){var c=_.chain(a).filter(function(e){return e.showCreateReview}).pluck("instance").value();var d=false;if(c.length){this.createReviewDialog=new JIRA.DevStatus.CreateReviewFormDialog({analytics:this.analytics,applicationType:this._getActiveApplicationType(),issueId:this.issueId,instances:c});d=true}var b=AJS.Meta.get("fusion-open-detail-dialog");if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(b)&&JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(b)===this._getActiveApplicationType()){AJS.Meta.set("fusion-open-detail-dialog",undefined);if(d){this.createReviewDialog.dialog.show()}}return d},_onHoverReviewsToolTip:function(c){var a=this;this._removeInlineDialog("activeReviewsToolTip");c.preventDefault();var b=AJS.$(c.target);var d="commit-reviews-popup";this.activeReviewsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var g=a._getCommitDetails(AJS.$(f)).reviews;var e=AJS.$(f);JIRA.DevStatus.CommitsAnalytics.fireDetailReviewsShown(a._getActiveApplicationType());h.html(JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog({reviewData:g}));h.find("a").click(function(j){a._onClickReview(j)});i()},{cacheContent:false,hideDelay:200,onHover:true,width:false});this.activeReviewsToolTip.show()},_onClickReviewsToolTip:function(a){if(this.activeReviewsToolTip){a.stopPropagation()}},setupBranchesTooltip:function(){var a=this;AJS.$(".branches-link").tooltip({title:function(){var b=a._getCommitDetails(AJS.$(this)).branches;JIRA.DevStatus.CommitsAnalytics.fireDetailBranchesShown(a._getActiveApplicationType());return JIRA.Templates.DevStatus.DetailDialog.branchesTooltip({branchData:b})},html:true})},getTitle:function(d,b){var a=_.chain(this.model.get("tabs")).map(function(e){return e.count}).reduce(function(e,f){return e+f},0).value();var c=Math.max(a-d,0);return AJS.$.trim(AJS.format("{1}: {0} unique {0,choice,1#commit|1\u003ccommits}{2,choice,0# |0\u003c (and {2} duplicates)}",d,b,c))},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more commits by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related commits"},getConnectionMessageInCanvas:function(){return "Unable to retrieve commit information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related commits."},hasData:function(a){return this.concatResults(a).length>0},transformRepositories:function(b){b=this.sortRepositoriesAndCommits(b);var a=this;var c=[["reviews","showReviews"],["branches","showBranches"],["files","showFiles"],["createReviewUrl","showCreateReview"]];_.each(c,function(d){b=a._setRepositoryFromFromCommitField(b,d[0],d[1])});b=this.prepareReviews(b);return b},_setRepositoryFromFromCommitField:function(b,c,a){_.each(b,function(d){d[a]=_.find(d.commits,function(e){return e[c]!=null})!=null});return b},prepareReviews:function(b){var a=this;_.each(b,function(c){_.each(c.commits,a._orderCommitReviews)});return b},_orderCommitReviews:function(b){if(b.reviews&&b.reviews.reviews){var a=["REVIEW","APPROVAL","SUMMARIZE","REJECTED","CLOSED"];b.reviews.reviews=_.chain(b.reviews.reviews).filter(function(c){return _.contains(a,c.state)}).sortBy(function(c){return _.indexOf(a,c.state)}).value()}},sortRepositoriesAndCommits:function(a){a=_.sortBy(a,function(b){return b.name.toLowerCase()});_.each(a,function(b){b.commits=_.sortBy(b.commits,"authorTimestamp").reverse()});return a},getUniqueCommitCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.filter(_.pluck(b.commits,"id"),function(c){return c})})).length},_getRepoDetails:function(a){return this.transformedRepositories[parseInt(a.parents(".detail-commits-container").data("repository-index"))]},_getCommitDetails:function(a){return this._getRepoDetails(a).commits[parseInt(a.parents("tr").data("commit-index"))]},_onClickRepositoryLink:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickChangesetId:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailCommitClicked(this._getActiveApplicationType())},_onClickExpand:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target));if(a.toggle(a.getRows())){JIRA.DevStatus.CommitsAnalytics.fireDetailFilesExpandedClicked(this._getActiveApplicationType())}this._clipEllipsis()},_onClickFiles:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target)).toggle(AJS.$(b.target).closest(".commitrow").next(".filerow"));this._clipEllipsis();if(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileExpandedClicked(this._getActiveApplicationType())}},_onClickCreateReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(this._getActiveApplicationType(),false)},_onClickReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailReviewClicked(this._getActiveApplicationType())},_onClickFile:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileClicked(this._getActiveApplicationType())},_getFileExpand:function(a){var c=a.closest(".detail-commits-container");function b(d){return d.length>d.filter(".hidden").length}return{getRows:function(){return c.find(".filerow")},toggle:function(e){var d=b(e);e.toggleClass("hidden",d);this._updateExpandLabel();return !d},_updateExpandLabel:function(){c.find(".file-expand a").text(b(this.getRows())?"Hide files":"Show all files")}}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogBranchView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBranchView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.branch,pullRequestToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip,STATE_ORDER:["OPEN","MERGED","DECLINED"],events:{"click a.repository-link":"_onClickRepositoryLink","click a.branch-link":"_onClickBranchLink","click a.pullrequest-link":"_onClickPullRequestLink","click a.create-pullrequest-link":"_onClickCreatePullRequestLink","mouseenter .pullrequest-tooltip":"_onHoverPullRequestsToolTip","click .pullrequest-tooltip":"_onClickPullRequestsToolTip"},initialize:function(a){this.analyticIssueData=a.analyticIssueData||{};this.analytics=JIRA.DevStatus.BranchesAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({},a,{type:"branch",width:1000,height:400,dataType:"pullrequest"}))},renderSuccess:function(g,a){var c=this._sortBranchesByName(this._removeWithNoRepos(this._extractAllBranches(a)));var f=this._extractAllPullRequests(a);this._populatePullRequestStateByBranch(c,f);var d=this._getBranchFeatures(c);var e=this._getBranchCount(c);var b=this.getContentContainer(g);if(e>0){b.html(this.template({applicationType:g,livestampRelativizeThreshold:this.options.livestampRelativizeThreshold,branches:c,features:d,branchCount:e}));JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(g,e);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#branch|1\u003cbranches}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more branches by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related branches"},getConnectionMessageInCanvas:function(){return "Unable to retrieve branch information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related branches."},hasData:function(a){return this._removeWithNoRepos(this._extractAllBranches(a)).length>0},_extractAllBranches:function(a){return _.compact(_.flatten(_.pluck(a,"branches")))},_getBranchFeatures:function(a){return{pullRequests:_.find(a,function(b){return b.createPullRequestUrl||(b.pullRequestState&&b.pullRequestState.total)})!=null,lastCommitId:_.find(a,function(b){return b.lastCommit&&b.lastCommit.displayId})!=null,lastCommitTimestamp:_.find(a,function(b){return b.lastCommit&&b.lastCommit.authorTimestamp})!=null}},_removeWithNoRepos:function(a){return _.filter(a,function(b){return b.repository})},_extractAllPullRequests:function(a){return _.flatten(_.compact(_.pluck(a,"pullRequests")))},_sortBranchesByName:function(a){return _.sortBy(a,function(b){return b.repository.name+b.name})},_onClickRepositoryLink:function(){this.analytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickBranchLink:function(){this.analytics.fireDetailBranchClicked(this._getActiveApplicationType())},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestLozengeClick(this._getActiveApplicationType())},_onClickCreatePullRequestLink:function(){this.analytics.fireDetailCreatePullRequestClicked(this._getActiveApplicationType(),this.analyticIssueData.isAssignee,this.analyticIssueData.isAssignable)},_onHoverPullRequestsToolTip:function(c){this._removeInlineDialog("activePullRequestsToolTip");c.preventDefault();var a=this;var b=AJS.$(c.target);var d="pullrequest-tooltip";this.activePullRequestsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.pullRequestToolTipTemplate({pullRequests:g.data("detail")}));a.activePullRequestsToolTip.$content=h;i()},{onHover:true,hideDelay:200,showDelay:50,offsetX:-200,cacheContent:false,width:400});this.activePullRequestsToolTip.show()},_onClickPullRequestsToolTip:function(a){if(this.activePullRequestsToolTip){a.stopPropagation()}},_getBranchCount:function(a){return a.length},_populatePullRequestStateByBranch:function(b,c){var a=this;_.each(b,function(d){var e=_.filter(c,function(f){return f.source.url===d.url});d.pullRequestState=a._summarisePullRequestState(e)});return b},_sortPullRequestsByStatus:function(a){return _.sortBy(a,function(b){return(b.status==="OPEN"?"2":(b.status==="MERGED"?"1":"0"))+b.lastUpdated}).reverse()},_getFirstStatusWithCount:function(a){return _.find(this.STATE_ORDER,function(b){return a[b]})},_summarisePullRequestState:function(a){var b=_.groupBy(a,function(c){return c.status});return{status:this._getFirstStatusWithCount(b),data:JSON.stringify(this._sortPullRequestsByStatus(a)),total:_.size(a)}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogPullRequestView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogPullRequestView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.pullRequest,extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{"click a.pullrequest-link":"_onClickPullRequestLink"},initialize:function(a){this.analytics=JIRA.DevStatus.PullRequestsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"pullrequest",width:1000,height:400},a))},renderSuccess:function(f,a){var d=this._removeAuthorFromReviewers(this._extractAllPullRequests(a));var e=this._getSortedPullRequestsByDate(d);var c=_.size(e);var b=this.getContentContainer(f);if(c>0){b.html(this.template({pullRequests:e,livestampRelativizeThreshold:this.options.livestampRelativizeThreshold,pullRequestCount:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(f,c);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#pull request|1\u003cpull requests}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more pull requests by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related pull requests"},getConnectionMessageInCanvas:function(){return "Unable to retrieve pull request information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related pull requests."},hasData:function(a){return this._extractAllPullRequests(a).length>0},_extractAllPullRequests:function(a){return _.compact(_.flatten(_.pluck(a,"pullRequests")))},_removeAuthorFromReviewers:function(a){return _.map(a,function(d){if(d.reviewers&&d.author){var c=_.filter(d.reviewers,function(e){return e.name!=d.author.name});if(d.reviewers.length==c.length){return d}var b=_.clone(d);b.reviewers=c;return b}return d})},_sortReviewers:function(b){var a=this.options.reviewersThreshold;_.each(b,function(d,c){if(_.size(d.reviewers)>0){d.reviewers=_.sortBy(_.filter(d.reviewers,function(e){return e.name}),function(e){return e.approved?"0"+e.name:"1"+e.name});if(d.reviewers.length>a+1){d.extraReviewers=JSON.stringify(d.reviewers.slice(a))}}})},_getSortedPullRequestsByDate:function(a){this._sortReviewers(a);return _.sortBy(a,"lastUpdate").reverse()},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestClicked(this._getActiveApplicationType())}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogReviewView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogReviewView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.review,events:{"click a.review-link":"_onClickReviewLink","click a.comment-link":"_onClickReviewLink"},initialize:function(a){this.analytics=JIRA.DevStatus.ReviewsAnalytics;this.finalStates=["REJECTED","CLOSED"];this.nonFinalStates=["REVIEW","APPROVAL","SUMMARIZE"];this.validStates=_.union(this.finalStates,this.nonFinalStates);JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"review",width:1000,height:400},a))},_updateReviewers:function(a){a.reviewers=_.chain(a.reviewers).filter(function(b){if(b&&a.author&&a.author.name&&b.name){return !_.isEqual(b.name,a.author.name)}return true}).sortBy(function(b){return(b.complete?"0":"1")+b.name}).map(function(b){b.approved=b.complete;return b}).value();if(a.moderator&&!_.isEqual(a.moderator,a.author)){a.reviewers=[_.extend(a.moderator,{name:"Moderator:"+" "+a.moderator.name})].concat(a.reviewers)}return a},_updateReview:function(a){return function(b){if(b.state&&b.dueDate&&_.contains(a,b.state)){delete b.dueDate}if(b.dueDate&&moment(b.dueDate).isBefore(moment())){b.overDue=true}return b}},_addExtraReviewersJson:function(a){return function(b){if(b.reviewers){b.extraReviewers=JSON.stringify(b.reviewers.slice(a))}return b}},_reviewCompare:function(b,a){if(b.dueDate&&!a.dueDate){return -1}else{if(!b.dueDate&&a.dueDate){return 1}else{if(b.dueDate&&a.dueDate){return b.dueDate.localeCompare(a.dueDate)}else{if(b.lastModified&&a.lastModified){return a.lastModified.localeCompare(b.lastModified)}}}}return 0},_mergeInstanceData:function(a,b){return a.concat(b.reviews||[])},_prepareReviews:function(b){var a=this;return _.chain(b).reduce(this._mergeInstanceData,[]).filter(function(c){c.state=c.state&&c.state.toUpperCase();return _.contains(a.validStates,c.state)}).map(_.compose(this._addExtraReviewersJson(this.options.reviewersThreshold),this._updateReviewers,this._updateReview(this.finalStates))).sort(this._reviewCompare).value()},renderSuccess:function(d,a){var c=this._prepareReviews(a),b=this.getContentContainer(d);if(c.length>0){b.html(this.template({applicationType:d,reviews:c,livestampRelativizeThreshold:this.options.livestampRelativizeThreshold,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(d,c.length);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#review|1\u003creviews}",b,a)},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related reviews."},getOAuthMessageInCanvas:function(){return "Authenticate to see related reviews"},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more reviews by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getConnectionMessageInCanvas:function(){return "Unable to retrieve review information"},hasData:function(a){return _.flatten(_.pluck(a,"reviews"),true).length>0},_onClickReviewLink:function(){this.analytics.fireDetailReviewClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModel.js' */
Backbone.define("JIRA.DevStatus.CommitModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"repository"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'templates/viewissue/commit/devstatus-panel-commit.soy' */
// This file was automatically generated from devstatus-panel-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Commit == 'undefined') { JIRA.Templates.DevStatus.Commit = {}; }


JIRA.Templates.DevStatus.Commit.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  JIRA.Templates.DevStatus.transitionContainer({content: '<div class="summary-content"><a class="summary" href="#" title="' + soy.$$escapeHtml(AJS.format("Commits related to {0}",opt_data.issueKey)) + '">' + AJS.format("{0}{1}{2} {1,choice,1#commit|1\x3ccommits}",'<span class="count">',opt_data.count,'</span>') + '</a></div>'}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitView.js' */
Backbone.define("JIRA.DevStatus.CommitView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Commit.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogCommitView=new JIRA.DevStatus.DetailDialogCommitView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-commit-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.CommitsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogCommitView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModule.js' */
Backbone.define("JIRA.DevStatus.CommitModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.CommitModel,viewType:JIRA.DevStatus.CommitView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModel.js' */
Backbone.define("JIRA.DevStatus.PullRequestModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"pullrequest"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'templates/viewissue/pullrequest/devstatus-panel-pullrequest.soy' */
// This file was automatically generated from devstatus-panel-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.PullRequest == 'undefined') { JIRA.Templates.DevStatus.PullRequest = {}; }


JIRA.Templates.DevStatus.PullRequest.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Pull requests related to {0}",opt_data.issueKey)), '">', AJS.format("{0}{1}{2} {1,choice,1#pull request|1\x3cpull requests}",'<span class="count">',opt_data.stateCount,'</span>'), '</a> ');
  JIRA.Templates.DevStatus.PullRequest.state(soy.$$augmentData(opt_data, {isSubtle: true}), param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.PullRequest.state = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.state == 'OPEN') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-complete pullrequest-state">' + soy.$$escapeHtml("OPEN") + '</span>' : (opt_data.state == 'MERGED') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-success pullrequest-state">' + soy.$$escapeHtml("MERGED") + '</span>' : (opt_data.state == 'DECLINED') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-error pullrequest-state">' + soy.$$escapeHtml("DECLINED") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestView.js' */
Backbone.define("JIRA.DevStatus.PullRequestView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.PullRequest.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogPullRequestView=new JIRA.DevStatus.DetailDialogPullRequestView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-pullrequest-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2}));JIRA.DevStatus.PullRequestsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogPullRequestView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModule.js' */
Backbone.define("JIRA.DevStatus.PullRequestModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.PullRequestModel,viewType:JIRA.DevStatus.PullRequestView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModel.js' */
Backbone.define("JIRA.DevStatus.ReviewModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"review"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'templates/viewissue/review/devstatus-panel-review.soy' */
// This file was automatically generated from devstatus-panel-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Review == 'undefined') { JIRA.Templates.DevStatus.Review = {}; }


JIRA.Templates.DevStatus.Review.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Reviews related to {0}",opt_data.issueKey)), '">', AJS.format("{0}{1}{2} {1,choice,1#review|1\x3creviews}",'<span class="count">',opt_data.stateCount,'</span>'), '</a> ');
  JIRA.Templates.DevStatus.Review.reviewLozenge({state: opt_data.state, isSubtle: true}, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(opt_data, {showUpdatedText: true}), output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Review.reviewDate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.dueDate) {
    JIRA.Templates.DevStatus.lastUpdated({text: "Due", lastUpdated: opt_data.dueDate, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold, extraClass: opt_data.overDue ? 'overdue' : undefined}, output);
  } else if (opt_data.lastUpdated) {
    JIRA.Templates.DevStatus.lastUpdated({text: opt_data.showUpdatedText ? "Updated" : '', lastUpdated: opt_data.lastUpdated, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Review.reviewLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.state == 'REVIEW') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-current ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Review") + '</span>' : (opt_data.state == 'CLOSED') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-success ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Closed") + '</span>' : (opt_data.state == 'DRAFT') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-complete ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Draft") + '</span>' : (opt_data.state == 'DEAD') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Abandoned") + '</span>' : (opt_data.state == 'REJECTED') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Rejected") + '</span>' : (opt_data.state == 'UNKNOWN') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Unknown") + '</span>' : (opt_data.state == 'APPROVAL') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Approval") + '</span>' : (opt_data.state == 'SUMMARIZE') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Summarize") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewView.js' */
Backbone.define("JIRA.DevStatus.ReviewView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Review.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogReviewView=new JIRA.DevStatus.DetailDialogReviewView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-review-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2}));JIRA.DevStatus.ReviewsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogReviewView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModule.js' */
Backbone.define("JIRA.DevStatus.ReviewModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.ReviewModel,viewType:JIRA.DevStatus.ReviewView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModel.js' */
Backbone.define("JIRA.DevStatus.BranchModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"branch"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'templates/viewissue/branch/devstatus-panel-branch.soy' */
// This file was automatically generated from devstatus-panel-branch.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Branches == 'undefined') { JIRA.Templates.DevStatus.Branches = {}; }


JIRA.Templates.DevStatus.Branches.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  JIRA.Templates.DevStatus.transitionContainer({content: '<div class="summary-content"><a class="summary" href="#" title="' + soy.$$escapeHtml(AJS.format("Branches related to {0}",opt_data.issueKey)) + '">' + AJS.format("{0}{1}{2} {1,choice,1#branch|1\x3cbranches}",'<span class="count">',opt_data.count,'</span>') + '</a></div>'}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchView.js' */
Backbone.define("JIRA.DevStatus.BranchView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Branches.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBranchView=new JIRA.DevStatus.DetailDialogBranchView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-branch-detail-dialog",count:this.model.getOverall().count,analyticIssueData:this.options.analyticsModel.getIssue()}));JIRA.DevStatus.BranchesAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBranchView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModule.js' */
Backbone.define("JIRA.DevStatus.BranchModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BranchModel,viewType:JIRA.DevStatus.BranchView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModel.js' */
Backbone.define("JIRA.DevStatus.BuildModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"build"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'templates/viewissue/build/devstatus-panel-build.soy' */
// This file was automatically generated from devstatus-panel-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Build == 'undefined') { JIRA.Templates.DevStatus.Build = {}; }


JIRA.Templates.DevStatus.Build.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Builds related to {0}",opt_data.issueKey)), '">');
  var countText__soy8 = new soy.StringBuilder((opt_data.successfulBuildCount > 0) ? (opt_data.failedBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.failedBuildCount,'</span>') : (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",'<span class="count">',opt_data.successfulBuildCount,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",'<span class="count">',opt_data.count,'</span>') : (opt_data.failedBuildCount > 0) ? (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.failedBuildCount,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.count,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} incomplete",'<span class="count">',opt_data.count,'</span>'));
  countText__soy8 = countText__soy8.toString();
  param4.append(countText__soy8, '</a> ');
  JIRA.Templates.DevStatus.Build.statusIcon(opt_data, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, livestampRelativizeThreshold: opt_data.livestampRelativizeThreshold}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Build.statusIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy45 = new soy.StringBuilder((opt_data.failedBuildCount > 0) ? 'aui-iconfont-error' : (opt_data.successfulBuildCount > 0) ? 'aui-iconfont-approve' : (opt_data.unknownBuildCount > 0) ? 'aui-iconfont-devtools-task-cancelled' : '');
  iconClass__soy45 = iconClass__soy45.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy45), '">', soy.$$escapeHtml(opt_data.iconText), '</span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildView.js' */
Backbone.define("JIRA.DevStatus.BuildView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Build.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBuildView=new JIRA.DevStatus.DetailDialogBuildView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-build-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.BuildsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBuildView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModule.js' */
Backbone.define("JIRA.DevStatus.BuildModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BuildModel,viewType:JIRA.DevStatus.BuildView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModel.js' */
Backbone.define("JIRA.DevStatus.DeploymentModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"deployment-environment"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'templates/viewissue/deployment/devstatus-panel-deployment.soy' */
// This file was automatically generated from devstatus-panel-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Deployment == 'undefined') { JIRA.Templates.DevStatus.Deployment = {}; }


JIRA.Templates.DevStatus.Deployment.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dd>');
  var param4 = new soy.StringBuilder('<div class="summary-content" title="', soy.$$escapeHtml(AJS.format("Deployments related to {0}",opt_data.issueKey)), '">');
  if (opt_data.topEnvironments.length) {
    var anchorStart__soy10 = '<a class="summary">';
    var anchorEnd__soy11 = '</a>';
    var instanceOne__soy12 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[0]}), instanceOne__soy12);
    instanceOne__soy12 = instanceOne__soy12.toString();
    var instanceTwo__soy15 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[1]}), instanceTwo__soy15);
    instanceTwo__soy15 = instanceTwo__soy15.toString();
    var instanceThree__soy18 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[2]}), instanceThree__soy18);
    instanceThree__soy18 = instanceThree__soy18.toString();
    param4.append((opt_data.successfulCount == 1) ? AJS.format("{0}Deployed{1} to {2}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12) : (opt_data.successfulCount == 2) ? AJS.format("{0}Deployed{1} to {2} and {3}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15) : (opt_data.successfulCount == 3) ? AJS.format("{0}Deployed{1} to {2}, {3} and {4}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15,instanceThree__soy18) : (opt_data.successfulCount > 3) ? AJS.format("{0}Deployed{1} to {2}, {3}, {4} and {5} more",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15,instanceThree__soy18,opt_data.successfulCount - 3) : '');
  } else {
    param4.append(soy.$$escapeHtml("No deployments contain latest commits"));
  }
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dd></dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Deployment.instance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment) ? '<span class="environment" ' + ((opt_data.showProjects) ? 'title="' + soy.$$escapeHtml(AJS.format("Project: {0}",opt_data.environment.project)) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.environment.title) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentView.js' */
Backbone.define("JIRA.DevStatus.DeploymentView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Deployment.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogDeploymentView=new JIRA.DevStatus.DetailDialogDeploymentView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-deployment-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.DeploymentsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogDeploymentView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModule.js' */
Backbone.define("JIRA.DevStatus.DeploymentModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.DeploymentModel,viewType:JIRA.DevStatus.DeploymentView}));
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTip.js' */
(function(E){function A(){return false
}function C(){return true
}var J=0,F=new Date().getTime();
function G(L){L=""+(L||"");
return L.replace(/\./g,"-")
}function I(M,L){if(AJS.EventQueue&&L&&L.attributes.id){var O={};
var N=G(L.attributes.id);
O.name="helptips."+N+"."+M;
O.properties={};
AJS.EventQueue.push(O)
}}function B(){return"c"+F+(J++)
}var D=AJS.HelpTip=function(L){var M;
this.attributes=E.extend({},L);
this.attributes.id||(this.attributes.id=false);
this.attributes.callbacks||(this.attributes.callbacks={});
if(this.attributes.isSequence){if(!this.attributes.weight){this.attributes.weight=Number.MAX_VALUE
}AJS.HelpTip.Manager.sequences.push(this)
}if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;
delete this.attributes.body
}this.cid=B();
M=this.attributes.anchor;
delete this.attributes.anchor;
this.view=(M)?new H(this,M):new K(this);
this.view.$el.addClass("aui-help-tip")
};
E.extend(D.prototype,{show:function(N){N=N||{};
var M=this;
var O=E.Deferred();
if(this.attributes.callbacks.beforeShow){var L=this.attributes.callbacks.beforeShow();
if(L&&_.isFunction(L.done)){L.done(O.resolve)
}else{O.resolve()
}}else{O.resolve()
}O.done(function(){AJS.HelpTip.Manager.show(function(){if(!M.isDismissed()){if(!N.force&&AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:M.id,weight:1000,show:function(){M.view.show()
}})
}else{M.view.show()
}I("shown",M)
}})
})
},dismiss:function(){var L=G(arguments[0]||"programmatically");
this.view.dismiss();
if(L==="close-button"&&this.attributes.isSequence){AJS.HelpTip.Manager.clearSequences()
}if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);
I("dismissed."+L,this)
}},isVisible:function(){return this.view.$el.is(":visible")
},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)
}});
var H=function(M,L){this.initialize(M,L)
};
E.extend(H.prototype,{initialize:function(N,M){var L=this;
this.model=N;
this.beforeHide=A;
this.popup=AJS.InlineDialog(M,N.cid,_.bind(this._createDialog,this),_.extend({container:"#content",noBind:true,preHideCallback:function(){return L.beforeHide()
},calculatePositions:function(O,R,T,Q){var P=AJS.InlineDialog.opts.calculatePositions(O,R,T,Q);
var S=E(this.container);
P.popupCss.top-=S.offset().top;
P.popupCss.left-=S.offset().left;
return P
},addActiveClass:false,initCallback:N.attributes.callbacks.init,hideCallback:N.attributes.callbacks.hide},N.attributes.inlineDialogOpts));
this._popupHide=this.popup.hide;
this.popup.hide=A;
this.$el=E(this.popup[0]);
AJS.$(document).bind("showLayer",function(Q,P,O){if(P==="inlineDialog"&&O.id===N.cid){AJS.InlineDialog.current=null;
AJS.$(document.body).unbind("click."+N.cid+".inline-dialog-check");
O._validateClickToClose=A;
O.hide=A
}})
},show:function(){this.popup.show()
},dismiss:function(){this.beforeHide=C;
this._popupHide()
},_createDialog:function(Q,O,N){var M=this;
var P=AJS.HelpTip.Manager.sequences;
var L=this.model.attributes.position;
Q.html(E(AJS.Templates.HelpTip.tipContent(_.extend({hasSequence:(P.length>1&&(L+1<P.length)),length:P.length,position:L},this.model.attributes))));
Q.unbind("mouseover mouseout");
Q.find(".helptip-link").click(function(){I("learn-more.clicked",M.model)
});
Q.find(".helptip-close").click(function(R){R.preventDefault();
M.model.dismiss("close-button")
});
Q.find(".helptip-next").click(function(S){S.preventDefault();
M.model.dismiss("next-button");
var R=L+1;
P[R]&&(P[R].show({force:true}))
});
N()
}});
var K=function(L){this.initialize(L)
};
E.extend(K.prototype,{initialize:function(){this.$el=E("<div></div>")
},show:function(){},dismiss:function(){}})
})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTipManager.js' */
(function(C){var B=AJS.contextPath()+"/rest/helptips/1.0/tips";
var A={dismissedTipIds:[],sequences:[],loaded:C.Deferred(),url:function(){return B
},sync:function(E,D){E||(E="get");
D||(D=null);
return C.ajax(this.url(),{type:E,context:this,dataType:"json",contentType:"application/json",data:D&&JSON.stringify(D),processData:false}).promise()
},fetch:function(){var D=this.sync();
D.done(function(E){C.merge(this.dismissedTipIds,E);
this.loaded.resolve()
});
return D.promise()
},show:function(D){this.loaded.done(D)
},dismiss:function(D){var E=D.attributes.id;
if(!E){D._dismissed=true
}else{this.dismissedTipIds.push(E);
this.sync("post",{id:E})
}},undismiss:function(D){var E=D.attributes.id;
if(!E){D._dismissed=false
}else{this.dismissedTipIds.splice(C.inArray(E,this.dismissedTipIds),1);
this.sync("delete",{id:E})
}},isDismissed:function(D){var E=D.attributes.id;
return(E)?C.inArray(E,this.dismissedTipIds)>=0:D._dismissed
},clearSequences:function(){this.sequences=[]
},hideSequences:function(){_.each(this.sequences,function(D){D.view.dismiss()
})
},showSequences:function(){if(!this._showStarted){var D=this;
var E=0;
this._showStarted=true;
C.when(this.loaded).done(function(){D.sequences.sort(function(G,F){return G.attributes.weight-F.attributes.weight
});
D.sequences=_.filter(D.sequences,function(G){var F=_.indexOf(D.dismissedTipIds,G.attributes.id)===-1;
if(F){G.attributes.position=E++
}return F
});
if(D.sequences.length>0){D.sequences[0].show({force:true})
}D._showStarted=false
})
}}};
AJS.HelpTip.Manager=A;
A.fetch()
})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'templates/HelpTip.soy' */
// This file was automatically generated from HelpTip.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? '<h2 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h2>' : '', '<p class="helptip-body">', opt_data.bodyHtml, '</p>', (opt_data.url) ? '<p><a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + ((opt_data.linkText) ? soy.$$escapeHtml(opt_data.linkText) : soy.$$escapeHtml("Learn more")) + '</a></p>' : '');
  AJS.Templates.HelpTip.tipFooter(opt_data, output);
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.tipFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="tip-footer">');
  AJS.Templates.HelpTip.nextButton(opt_data, output);
  AJS.Templates.HelpTip.closeButton(opt_data, output);
  AJS.Templates.HelpTip.sequencePaging(opt_data, output);
  output.append('</form>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.nextButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.hasSequence) ? '<button class="aui-button helptip-next" type="button">' + soy.$$escapeHtml("Next") + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.closeButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button ', (opt_data.hasSequence) ? ' aui-button-link ' : '', ' helptip-close" type="button">', soy.$$escapeHtml("Close"), '</button>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.sequencePaging = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.length > 1) ? '<span class="helptip-sequence-paging">' + soy.$$escapeHtml(opt_data.position + 1) + '/' + soy.$$escapeHtml(opt_data.length) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-tooltip-resources', location = 'templates/viewissue/devstatus-cta-tooltips.soy' */
// This file was automatically generated from devstatus-cta-tooltips.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Tooltip == 'undefined') { JIRA.Templates.DevStatus.Tooltip = {}; }


JIRA.Templates.DevStatus.Tooltip.createBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'create-branch', content: '<p>' + soy.$$escapeHtml("Create a branch for this issue in your source repository") + '. <a class="cta-learn-more-link" href="https://www.atlassian.com/git/workflows" target="_blank">' + soy.$$escapeHtml("Learn more about branching strategies") + '.</a></p><p class="branch-illustration"></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.tooltipLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cta-tooltip', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '">', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-analytics-resources', location = 'js/analytics/devstatus-analytics.js' */
(function(d,a){AJS.namespace("JIRA.DevStatus.Analytics");var b=".edit-permission-link";function c(){return AJS.EventQueue&&!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.analytics.disabled")}a.DevStatus.Analytics={fireEvent:function(e,g){if(c()){var f=(typeof g!=="object")?{}:g;AJS.EventQueue.push({name:"devstatus."+e,properties:f})}},fireAgileDevStatusLinkClicked:function(){return a.DevStatus.Analytics.fireEvent("panel.agile.icon.clicked")}};a.DevStatus.LabsAnalytics={fireLabsEvent:function(e){var f=e?"on":"off";return a.DevStatus.Analytics.fireEvent("labs.toggle."+f)}};a.DevStatus.SummaryAnalytics={fireSummaryShownEvent:function(g,f,e,h){var j=g?"assignee":"nonassignee";var i=_.extend({issueType:f,issueStatus:e},h);return a.DevStatus.Analytics.fireEvent("summary.shown."+j,i)},fireSummaryClickedEvent:function(f,e){var h=AJS.Meta.get("fusion-analytics-new-context-link");var g=".clicked";if(h){AJS.Meta.set("fusion-analytics-new-context-link",undefined);g+=".newcontext"}return a.DevStatus.Analytics.fireEvent(f+".summary"+g,e)},fireDetailTabClicked:function(f,e){return a.DevStatus.Analytics.fireEvent(e+".detail."+f+".tab.clicked")}};a.DevStatus.BuildsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("builds",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.project.clicked")},fireDetailPlanClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.plan.clicked")},fireDetailBuildClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.build.clicked")}};a.DevStatus.DeploymentsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("deployments",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.project.clicked")},fireDetailEnvironmentClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.environment.clicked")},fireDetailReleaseClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.release.clicked")}};a.DevStatus.CommitsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("commits",e)},fireDetailRepoClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".repo.clicked")},fireDetailCommitClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".commit.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"commits")},fireDetailFileExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.expanded.clicked")},fireDetailFilesExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".files.expanded.clicked")},fireDetailFileClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.clicked")},fireDetailReviewsShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".reviews.shown")},fireDetailReviewClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".review.clicked")},fireDetailBranchesShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".branches.shown")},fireDetailCreateReviewClicked:function(f,e){return a.DevStatus.Analytics.fireEvent("commits.detail."+f+".review.create"+(e?".all":""))}};a.DevStatus.ReviewsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("reviews",e)},fireDetailReviewClicked:function(){return a.DevStatus.Analytics.fireEvent("reviews.detail.review.clicked")}};a.DevStatus.BranchesAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("branches",e)},_fireDetailClickedEvent:function(f,e){return a.DevStatus.Analytics.fireEvent("branches.detail."+f+"."+e+".clicked")},fireDetailRepoClicked:function(e){this._fireDetailClickedEvent(e,"repo")},fireDetailBranchClicked:function(e){this._fireDetailClickedEvent(e,"branch")},fireDetailPullRequestLozengeClick:function(e){this._fireDetailClickedEvent(e,"pullrequest.lozenge")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"branches")},fireDetailCreatePullRequestClicked:function(g,e,h){var f="pullrequest.create";if(e){f+=".assignee"}else{f+=".nonassignee";if(h){f+=".assignable"}else{f+=".nonassignable"}}this._fireDetailClickedEvent(g,f)}};a.DevStatus.PullRequestsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("pullrequests",e)},fireDetailPullRequestClicked:function(e){return a.DevStatus.Analytics.fireEvent("pullrequests.detail."+e+".pullrequest.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"pullrequests")}};a.DevStatus.LearnMoreAnalytics={fireLearnMoreEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("learnmore."+e,f)}};a.DevStatus.CtaDialogAnalytics={issueDetails:{},fireCreateBranchEvent:function(e,g){g=(typeof g!=="object")?{}:g;var f=d.extend({issueStatus:this.issueDetails.status,issueType:this.issueDetails.type},g);return a.DevStatus.Analytics.fireEvent("createbranch."+e+"."+(this.issueDetails.isAssignee?"assignee":"nonassignee"),f)},_populateIssueDetails:function(e){this.issueDetails={status:""+e.data("issueStatus"),type:""+e.data("issueType"),isAssignee:e.data("isAssignee")}},_initHandler:function(h,g,j,i){if(j&&g.not(document).is(j)){var f=this;g.find(i).on("simpleClick",function(){var e=d(this);f._fireCreateBranchEvent(e)})}},_fireCreateBranchEvent:function(f){this._populateIssueDetails(f);var e="click";var g=AJS.Meta.get("fusion-analytics-new-context-link");if(g){AJS.Meta.set("fusion-analytics-new-context-link",undefined);e+=".newcontext"}this.fireCreateBranchEvent(e)},initialize:function(h,g,f){if(c()){var e=this;a.bind(a.Events.NEW_CONTENT_ADDED,_.bind(function(j,i){this._initHandler(j,i,h,g)},this));a.bind("GH.DetailView.updated",_.bind(function(i){this._initHandler(i,AJS.$(h),h,g)},this));d(g).on("simpleClick",function(){var i=d(this);e._fireCreateBranchEvent(i)});d(document).on("click","#"+f+" .jira-dialog-content .target",function(){var i=d(this);e.fireCreateBranchEvent("dialog.click",{title:i.find(".title").attr("title"),applicationType:i.data("applicationType")})});d(document).on("click","#"+f+" .jira-dialog-content button.cancel",function(){e.fireCreateBranchEvent("dialog.cancel")});d(document).on("click",".cta-tooltip .cta-learn-more-link",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.ctahelptipbranching")})}}};a.DevStatus.AdminAnalytics={fireAdminEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("admin."+e,f)},initialize:function(){if(c()){var e=this,f=d("#project-config-panel-dev-status");f.find(b).on("click",function(){e.fireAdminEvent("editpermissionlink.config."+(d("ul.permissions-list li.devstatus-admin-permission-item").length>0?"withpermissions":"nopermissions"))});f.find(".learn-more-link").on("click",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.adminappvertisementlink")});f.find("#project-config-applinks-connect").on("click",function(){e.fireAdminEvent("connect")});f.find(".devstatus-admin-connect-button-option").on("click",function(){var g=d(this).data("key")||"unknown";e.fireAdminEvent("connect."+g)})}}};a.DevStatus.AdminSummaryAnalytics={initialize:function(){if(c()){d("#project-config-webpanel-devstatus-admin-summary-panel").find(b).on("click",function(){a.DevStatus.AdminAnalytics.fireAdminEvent("editpermissionlink.summary.nopermissions")})}}}})(AJS.$,JIRA);
/* module-key = 'com.atlassian.jira.plugin.system.comment-panel:expandablecomments', location = 'js/plugin/comment/comments-expanding.js' */
AJS.$(function($) {
    $(document).on('simpleClick', '.collapsed-comments', function(e) {
        e.preventDefault();

        var collapsedLink = $(this);
        var collapsedLinkBlock = collapsedLink.closest('.message-container');
        var container = collapsedLink.closest('.issuePanelContainer');
        var module = collapsedLink.closest('.module');
        var numCommentsBefore = collapsedLinkBlock.prevAll('.activity-comment').length;
        var numCollapsed = collapsedLink.find('.show-more-comments').data('collapsed-count');

        showLoading();
        makeRequest();

        function showLoading() {
            collapsedLink.find('.show-more-comments').text("Loading...");
        }

        function makeRequest() {
            var url = collapsedLink.attr('href');
            JIRA.SmartAjax.makeRequest({
                url: url,
                method: 'GET',
                headers: { "X-PJAX": true } // needed for the ViewIssue action to return only the activity panel
            }).done(showCollapsed);
        }

        function showCollapsed(html) {
            var commentsToShow = $(html).find('.activity-comment').slice(numCommentsBefore, numCommentsBefore + numCollapsed);
            collapsedLinkBlock.replaceWith(commentsToShow);
            JIRA.trace("jira.issue.comment.expanded");
            JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED, [module, JIRA.CONTENT_ADDED_REASON.panelRefreshed]);

            // Expand the twixi for the first comment
            container.find('.activity-comment:first').removeClass('collapsed').addClass('expanded');
        }
    });
});

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone-1.0.0.js' */
(function(){var U=this;var b=U.Backbone;var G=[];var d=G.push;var N=G.slice;var T=G.splice;var Z;if(typeof exports!=="undefined"){Z=exports}else{Z=U.Backbone={}}Z.VERSION="1.0.0";var l=U._;if(!l&&(typeof require!=="undefined")){l=require("underscore")}Z.$=U.jQuery||U.Zepto||U.ender||U.$;Z.noConflict=function(){U.Backbone=b;return this};Z.emulateHTTP=false;Z.emulateJSON=false;var j=Z.Events={on:function(m,p,o){if(!X(this,"on",m,[p,o])||!p){return this}this._events||(this._events={});var n=this._events[m]||(this._events[m]=[]);n.push({callback:p,context:o,ctx:o||this});return this},once:function(n,q,o){if(!X(this,"once",n,[q,o])||!q){return this}var m=this;var p=l.once(function(){m.off(n,p);q.apply(this,arguments)});p._callback=q;return this.on(n,p,o)},off:function(m,v,n){var t,u,w,s,r,o,q,p;if(!this._events||!X(this,"off",m,[v,n])){return this}if(!m&&!v&&!n){this._events={};return this}s=m?[m]:l.keys(this._events);for(r=0,o=s.length;r<o;r++){m=s[r];if(w=this._events[m]){this._events[m]=t=[];if(v||n){for(q=0,p=w.length;q<p;q++){u=w[q];if((v&&v!==u.callback&&v!==u.callback._callback)||(n&&n!==u.context)){t.push(u)}}}if(!t.length){delete this._events[m]}}}return this},trigger:function(o){if(!this._events){return this}var n=N.call(arguments,1);if(!X(this,"trigger",o,n)){return this}var p=this._events[o];var m=this._events.all;if(p){B(p,n)}if(m){B(m,arguments)}return this},stopListening:function(p,m,r){var n=this._listeners;if(!n){return this}var o=!m&&!r;if(typeof m==="object"){r=this}if(p){(n={})[p._listenerId]=p}for(var q in n){n[q].off(m,r,this);if(o){delete this._listeners[q]}}return this}};var W=/\s+/;var X=function(t,r,n,q){if(!n){return true}if(typeof n==="object"){for(var p in n){t[r].apply(t,[p,n[p]].concat(q))}return false}if(W.test(n)){var s=n.split(W);for(var o=0,m=s.length;o<m;o++){t[r].apply(t,[s[o]].concat(q))}return false}return true};var B=function(r,p){var s,q=-1,o=r.length,n=p[0],m=p[1],t=p[2];switch(p.length){case 0:while(++q<o){(s=r[q]).callback.call(s.ctx)}return ;case 1:while(++q<o){(s=r[q]).callback.call(s.ctx,n)}return ;case 2:while(++q<o){(s=r[q]).callback.call(s.ctx,n,m)}return ;case 3:while(++q<o){(s=r[q]).callback.call(s.ctx,n,m,t)}return ;default:while(++q<o){(s=r[q]).callback.apply(s.ctx,p)}}};var c={listenTo:"on",listenToOnce:"once"};l.each(c,function(m,n){j[n]=function(q,o,s){var p=this._listeners||(this._listeners={});var r=q._listenerId||(q._listenerId=l.uniqueId("l"));p[r]=q;if(typeof o==="object"){s=this}q[m](o,s,this);return this}});j.bind=j.on;j.unbind=j.off;l.extend(Z,j);var e=Z.Model=function(m,o){var p;var n=m||{};o||(o={});this.cid=l.uniqueId("c");this.attributes={};l.extend(this,l.pick(o,f));if(o.parse){n=this.parse(n,o)||{}}if(p=l.result(this,"defaults")){n=l.defaults({},n,p)}this.set(n,o);this.changed={};this.initialize.apply(this,arguments)};var f=["url","urlRoot","collection"];l.extend(e.prototype,j,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(m){return l.clone(this.attributes)},sync:function(){return Z.sync.apply(this,arguments)},get:function(m){return this.attributes[m]},escape:function(m){return l.escape(this.get(m))},has:function(m){return this.get(m)!=null},set:function(u,m,y){var s,v,w,t,r,x,o,q;if(u==null){return this}if(typeof u==="object"){v=u;y=m}else{(v={})[u]=m}y||(y={});if(!this._validate(v,y)){return false}w=y.unset;r=y.silent;t=[];x=this._changing;this._changing=true;if(!x){this._previousAttributes=l.clone(this.attributes);this.changed={}}q=this.attributes,o=this._previousAttributes;if(this.idAttribute in v){this.id=v[this.idAttribute]}for(s in v){m=v[s];if(!l.isEqual(q[s],m)){t.push(s)}if(!l.isEqual(o[s],m)){this.changed[s]=m}else{delete this.changed[s]}w?delete q[s]:q[s]=m}if(!r){if(t.length){this._pending=true}for(var p=0,n=t.length;p<n;p++){this.trigger("change:"+t[p],this,q[t[p]],y)}}if(x){return this}if(!r){while(this._pending){this._pending=false;this.trigger("change",this,y)}}this._pending=false;this._changing=false;return this},unset:function(m,n){return this.set(m,void 0,l.extend({},n,{unset:true}))},clear:function(n){var m={};for(var o in this.attributes){m[o]=void 0}return this.set(m,l.extend({},n,{unset:true}))},hasChanged:function(m){if(m==null){return !l.isEmpty(this.changed)}return l.has(this.changed,m)},changedAttributes:function(o){if(!o){return this.hasChanged()?l.clone(this.changed):false}var q,p=false;var n=this._changing?this._previousAttributes:this.attributes;for(var m in o){if(l.isEqual(n[m],(q=o[m]))){continue}(p||(p={}))[m]=q}return p},previous:function(m){if(m==null||!this._previousAttributes){return null}return this._previousAttributes[m]},previousAttributes:function(){return l.clone(this._previousAttributes)},fetch:function(n){n=n?l.clone(n):{};if(n.parse===void 0){n.parse=true}var m=this;var o=n.success;n.success=function(p){if(!m.set(m.parse(p,n),n)){return false}if(o){o(m,p,n)}m.trigger("sync",m,p,n)};h(this,n);return this.sync("read",this,n)},save:function(q,n,u){var r,m,t,o=this.attributes;if(q==null||typeof q==="object"){r=q;u=n}else{(r={})[q]=n}if(r&&(!u||!u.wait)&&!this.set(r,u)){return false}u=l.extend({validate:true},u);if(!this._validate(r,u)){return false}if(r&&u.wait){this.attributes=l.extend({},o,r)}if(u.parse===void 0){u.parse=true}var p=this;var s=u.success;u.success=function(w){p.attributes=o;var v=p.parse(w,u);if(u.wait){v=l.extend(r||{},v)}if(l.isObject(v)&&!p.set(v,u)){return false}if(s){s(p,w,u)}p.trigger("sync",p,w,u)};h(this,u);m=this.isNew()?"create":(u.patch?"patch":"update");if(m==="patch"){u.attrs=r}t=this.sync(m,this,u);if(r&&u.wait){this.attributes=o}return t},destroy:function(n){n=n?l.clone(n):{};var m=this;var q=n.success;var o=function(){m.trigger("destroy",m,m.collection,n)};n.success=function(r){if(n.wait||m.isNew()){o()}if(q){q(m,r,n)}if(!m.isNew()){m.trigger("sync",m,r,n)}};if(this.isNew()){n.success();return false}h(this,n);var p=this.sync("delete",this,n);if(!n.wait){o()}return p},url:function(){var m=l.result(this,"urlRoot")||l.result(this.collection,"url")||R();if(this.isNew()){return m}return m+(m.charAt(m.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(n,m){return n},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(m){return this._validate({},l.extend(m||{},{validate:true}))},_validate:function(o,n){if(!n.validate||!this.validate){return true}o=l.extend({},this.attributes,o);var m=this.validationError=this.validate(o,n)||null;if(!m){return true}this.trigger("invalid",this,m,l.extend(n||{},{validationError:m}));return false}});var A=["keys","values","pairs","invert","pick","omit"];l.each(A,function(m){e.prototype[m]=function(){var n=N.call(arguments);n.unshift(this.attributes);return l[m].apply(l,n)}});var C=Z.Collection=function(n,m){m||(m={});if(m.url){this.url=m.url}if(m.model){this.model=m.model}if(m.comparator!==void 0){this.comparator=m.comparator}this._reset();this.initialize.apply(this,arguments);if(n){this.reset(n,l.extend({silent:true},m))}};var O={add:true,remove:true,merge:true};var k={add:true,merge:false,remove:false};l.extend(C.prototype,j,{model:e,initialize:function(){},toJSON:function(m){return this.map(function(n){return n.toJSON(m)})},sync:function(){return Z.sync.apply(this,arguments)},add:function(n,m){return this.set(n,l.defaults(m||{},k))},remove:function(r,p){r=l.isArray(r)?r.slice():[r];p||(p={});var q,m,o,n;for(q=0,m=r.length;q<m;q++){n=this.get(r[q]);if(!n){continue}delete this._byId[n.id];delete this._byId[n.cid];o=this.indexOf(n);this.models.splice(o,1);this.length--;if(!p.silent){p.index=o;n.trigger("remove",n,this,p)}this._removeReference(n)}return this},set:function(n,z){z=l.defaults(z||{},O);if(z.parse){n=this.parse(n,z)}if(!l.isArray(n)){n=n?[n]:[]}var u,q,w,x,o,v;var p=z.at;var t=this.comparator&&(p==null)&&z.sort!==false;var r=l.isString(this.comparator)?this.comparator:null;var y=[],m=[],s={};for(u=0,q=n.length;u<q;u++){if(!(w=this._prepareModel(n[u],z))){continue}if(o=this.get(w)){if(z.remove){s[o.cid]=true}if(z.merge){o.set(w.attributes,z);if(t&&!v&&o.hasChanged(r)){v=true}}}else{if(z.add){y.push(w);w.on("all",this._onModelEvent,this);this._byId[w.cid]=w;if(w.id!=null){this._byId[w.id]=w}}}}if(z.remove){for(u=0,q=this.length;u<q;++u){if(!s[(w=this.models[u]).cid]){m.push(w)}}if(m.length){this.remove(m,z)}}if(y.length){if(t){v=true}this.length+=y.length;if(p!=null){T.apply(this.models,[p,0].concat(y))}else{d.apply(this.models,y)}}if(v){this.sort({silent:true})}if(z.silent){return this}for(u=0,q=y.length;u<q;u++){(w=y[u]).trigger("add",w,this,z)}if(v){this.trigger("sort",this,z)}return this},reset:function(p,n){n||(n={});for(var o=0,m=this.models.length;o<m;o++){this._removeReference(this.models[o])}n.previousModels=this.models;this._reset();this.add(p,l.extend({silent:true},n));if(!n.silent){this.trigger("reset",this,n)}return this},push:function(n,m){n=this._prepareModel(n,m);this.add(n,l.extend({at:this.length},m));return n},pop:function(n){var m=this.at(this.length-1);this.remove(m,n);return m},unshift:function(n,m){n=this._prepareModel(n,m);this.add(n,l.extend({at:0},m));return n},shift:function(n){var m=this.at(0);this.remove(m,n);return m},slice:function(n,m){return this.models.slice(n,m)},get:function(m){if(m==null){return void 0}return this._byId[m.id!=null?m.id:m.cid||m]},at:function(m){return this.models[m]},where:function(m,n){if(l.isEmpty(m)){return n?void 0:[]}return this[n?"find":"filter"](function(o){for(var p in m){if(m[p]!==o.get(p)){return false}}return true})},findWhere:function(m){return this.where(m,true)},sort:function(m){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}m||(m={});if(l.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(l.bind(this.comparator,this))}if(!m.silent){this.trigger("sort",this,m)}return this},sortedIndex:function(m,p,n){p||(p=this.comparator);var o=l.isFunction(p)?p:function(q){return q.get(p)};return l.sortedIndex(this.models,m,o,n)},pluck:function(m){return l.invoke(this.models,"get",m)},fetch:function(m){m=m?l.clone(m):{};if(m.parse===void 0){m.parse=true}var o=m.success;var n=this;m.success=function(p){var q=m.reset?"reset":"set";n[q](p,m);if(o){o(n,p,m)}n.trigger("sync",n,p,m)};h(this,m);return this.sync("read",this,m)},create:function(n,m){m=m?l.clone(m):{};if(!(n=this._prepareModel(n,m))){return false}if(!m.wait){this.add(n,m)}var p=this;var o=m.success;m.success=function(q){if(m.wait){p.add(n,m)}if(o){o(n,q,m)}};n.save(null,m);return n},parse:function(n,m){return n},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(o,n){if(o instanceof e){if(!o.collection){o.collection=this}return o}n||(n={});n.collection=this;var m=new this.model(o,n);if(!m._validate(o,n)){this.trigger("invalid",this,o,n);return false}return m},_removeReference:function(m){if(this===m.collection){delete m.collection}m.off("all",this._onModelEvent,this)},_onModelEvent:function(o,n,p,m){if((o==="add"||o==="remove")&&p!==this){return }if(o==="destroy"){this.remove(n,m)}if(n&&o==="change:"+n.idAttribute){delete this._byId[n.previous(n.idAttribute)];if(n.id!=null){this._byId[n.id]=n}}this.trigger.apply(this,arguments)}});var Y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];l.each(Y,function(m){C.prototype[m]=function(){var n=N.call(arguments);n.unshift(this.models);return l[m].apply(l,n)}});var K=["groupBy","countBy","sortBy"];l.each(K,function(m){C.prototype[m]=function(p,n){var o=l.isFunction(p)?p:function(q){return q.get(p)};return l[m](this.models,o,n)}});var g=Z.View=function(m){this.cid=l.uniqueId("view");this._configure(m||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var V=/^(\S+)\s*(.*)$/;var E=["model","collection","el","id","attributes","className","tagName","events"];l.extend(g.prototype,j,{tagName:"div",$:function(m){return this.$el.find(m)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(m,n){if(this.$el){this.undelegateEvents()}this.$el=m instanceof Z.$?m:Z.$(m);this.el=this.$el[0];if(n!==false){this.delegateEvents()}return this},delegateEvents:function(q){if(!(q||(q=l.result(this,"events")))){return this}this.undelegateEvents();for(var p in q){var r=q[p];if(!l.isFunction(r)){r=this[q[p]]}if(!r){continue}var o=p.match(V);var n=o[1],m=o[2];r=l.bind(r,this);n+=".delegateEvents"+this.cid;if(m===""){this.$el.on(n,r)}else{this.$el.on(n,m,r)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(m){if(this.options){m=l.extend({},l.result(this,"options"),m)}l.extend(this,l.pick(m,E));this.options=m},_ensureElement:function(){if(!this.el){var m=l.extend({},l.result(this,"attributes"));if(this.id){m.id=l.result(this,"id")}if(this.className){m["class"]=l.result(this,"className")}var n=Z.$("<"+l.result(this,"tagName")+">").attr(m);this.setElement(n,false)}else{this.setElement(l.result(this,"el"),false)}}});Z.sync=function(s,n,m){var p=J[s];l.defaults(m||(m={}),{emulateHTTP:Z.emulateHTTP,emulateJSON:Z.emulateJSON});var r={type:p,dataType:"json"};if(!m.url){r.url=l.result(n,"url")||R()}if(m.data==null&&n&&(s==="create"||s==="update"||s==="patch")){r.contentType="application/json";r.data=JSON.stringify(m.attrs||n.toJSON(m))}if(m.emulateJSON){r.contentType="application/x-www-form-urlencoded";r.data=r.data?{model:r.data}:{}}if(m.emulateHTTP&&(p==="PUT"||p==="DELETE"||p==="PATCH")){r.type="POST";if(m.emulateJSON){r.data._method=p}var o=m.beforeSend;m.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",p);if(o){return o.apply(this,arguments)}}}if(r.type!=="GET"&&!m.emulateJSON){r.processData=false}if(r.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var q=m.xhr=Z.ajax(l.extend(r,m));n.trigger("request",n,q,m);return q};var J={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Z.ajax=function(){return Z.$.ajax.apply(Z.$,arguments)};var P=Z.Router=function(m){m||(m={});if(m.routes){this.routes=m.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var Q=/\((.*?)\)/g;var S=/(\(\?)?:\w+/g;var D=/\*\w+/g;var H=/[\-{}\[\]+?.,\\\^$|#\s]/g;l.extend(P.prototype,j,{initialize:function(){},route:function(n,o,p){if(!l.isRegExp(n)){n=this._routeToRegExp(n)}if(l.isFunction(o)){p=o;o=""}if(!p){p=this[o]}var m=this;Z.history.route(n,function(r){var q=m._extractParameters(n,r);p&&p.apply(m,q);m.trigger.apply(m,["route:"+o].concat(q));m.trigger("route",o,q);Z.history.trigger("route",m,o,q)});return this},navigate:function(n,m){Z.history.navigate(n,m);return this},_bindRoutes:function(){if(!this.routes){return }this.routes=l.result(this,"routes");var n,m=l.keys(this.routes);while((n=m.pop())!=null){this.route(n,this.routes[n])}},_routeToRegExp:function(m){m=m.replace(H,"\\$&").replace(Q,"(?:$1)?").replace(S,function(o,n){return n?o:"([^/]+)"}).replace(D,"(.*?)");return new RegExp("^"+m+"$")},_extractParameters:function(m,n){var o=m.exec(n).slice(1);return l.map(o,function(p){return p?decodeURIComponent(p):null})}});var I=Z.History=function(){this.handlers=[];l.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var a=/^[#\/]|\s+$/g;var F=/^\/+|\/+$/g;var i=/msie [\w.]+/;var M=/\/$/;I.started=false;l.extend(I.prototype,j,{interval:50,getHash:function(n){var m=(n||this).location.href.match(/#(.*)$/);return m?m[1]:""},getFragment:function(o,n){if(o==null){if(this._hasPushState||!this._wantsHashChange||n){o=this.location.pathname;var m=this.root.replace(M,"");if(!o.indexOf(m)){o=o.substr(m.length)}}else{o=this.getHash()}}return o.replace(a,"")},start:function(o){if(I.started){throw new Error("Backbone.history has already been started")}I.started=true;this.options=l.extend({},{root:"/"},this.options,o);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment();var m=document.documentMode;var q=(i.exec(navigator.userAgent.toLowerCase())&&(!m||m<=7));this.root=("/"+this.root+"/").replace(F,"/");if(q&&this._wantsHashChange){this.iframe=Z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(n)}if(this._hasPushState){Z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!q){Z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=n;var r=this.location;var p=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!p){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&p&&r.hash){this.fragment=this.getHash().replace(a,"");this.history.replaceState({},document.title,this.root+this.fragment+r.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){Z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(m,n){this.handlers.unshift({route:m,callback:n})},checkUrl:function(n){var m=this.getFragment();if(m===this.fragment&&this.iframe){m=this.getFragment(this.getHash(this.iframe))}if(m===this.fragment){return false}if(this.iframe){this.navigate(m)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(o){var n=this.fragment=this.getFragment(o);var m=l.any(this.handlers,function(p){if(p.route.test(n)){p.callback(n);return true}});return m},navigate:function(o,n){if(!I.started){return false}if(!n||n===true){n={trigger:n}}o=this.getFragment(o||"");if(this.fragment===o){return }this.fragment=o;var m=this.root+o;if(this._hasPushState){this.history[n.replace?"replaceState":"pushState"]({},document.title,m)}else{if(this._wantsHashChange){this._updateHash(this.location,o,n.replace);if(this.iframe&&(o!==this.getFragment(this.getHash(this.iframe)))){if(!n.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,o,n.replace)}}else{return this.location.assign(m)}}if(n.trigger){this.loadUrl(o)}},_updateHash:function(m,o,p){if(p){var n=m.href.replace(/(javascript:|#).*$/,"");m.replace(n+"#"+o)}else{m.hash="#"+o}}});Z.history=new I;var L=function(m,o){var n=this;var q;if(m&&l.has(m,"constructor")){q=m.constructor}else{q=function(){return n.apply(this,arguments)}}l.extend(q,n,o);var p=function(){this.constructor=q};p.prototype=n.prototype;q.prototype=new p;if(m){l.extend(q.prototype,m)}q.__super__=n.prototype;return q};e.extend=C.extend=P.extend=g.extend=I.extend=L;var R=function(){throw new Error('A "url" property or function must be specified')};var h=function(o,n){var m=n.error;n.error=function(p){if(m){m(o,p,n)}o.trigger("error",o,p,n)}}}).call(this);
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone.marionette-1.1.0.js' */
/*
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(D,C){var A=function(E){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();C.each(E,this.add,this)};C.extend(A.prototype,{add:function(E,G){var F=E.cid;this._views[F]=E;if(E.model){this._indexByModel[E.model.cid]=F}if(G){this._indexByCustom[G]=F}this._updateLength()},findByModel:function(E){return this.findByModelCid(E.cid)},findByModelCid:function(E){var F=this._indexByModel[E];return this.findByCid(F)},findByCustom:function(F){var E=this._indexByCustom[F];return this.findByCid(E)},findByIndex:function(E){return C.values(this._views)[E]},findByCid:function(E){return this._views[E]},remove:function(E){var F=E.cid;if(E.model){delete this._indexByModel[E.model.cid]}C.any(this._indexByCustom,function(H,G){if(H===F){delete this._indexByCustom[G];return true}},this);delete this._views[F];this._updateLength()},call:function(E){this.apply(E,C.tail(arguments))},apply:function(F,E){C.each(this._views,function(G){if(C.isFunction(G[F])){G[F].apply(G,E||[])}})},_updateLength:function(){this.length=C.size(this._views)}});var B=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];C.each(B,function(E){A.prototype[E]=function(){var F=C.values(this._views);var G=[F].concat(C.toArray(arguments));return C[E].apply(C,G)}});return A})(Backbone,_);Backbone.Wreqr=(function(D,C,A){var B={};B.Handlers=(function(G,F){var E=function(H){this.options=H;this._wreqrHandlers={};if(F.isFunction(this.initialize)){this.initialize(H)}};E.extend=G.Model.extend;F.extend(E.prototype,G.Events,{setHandlers:function(H){F.each(H,function(K,I){var J=null;if(F.isObject(K)&&!F.isFunction(K)){J=K.context;K=K.callback}this.setHandler(I,K,J)},this)},setHandler:function(I,K,J){var H={callback:K,context:J};this._wreqrHandlers[I]=H;this.trigger("handler:add",I,K,J)},hasHandler:function(H){return !!this._wreqrHandlers[H]},getHandler:function(I){var H=this._wreqrHandlers[I];if(!H){throw new Error("Handler not found for '"+I+"'")}return function(){var J=Array.prototype.slice.apply(arguments);return H.callback.apply(H.context,J)}},removeHandler:function(H){delete this._wreqrHandlers[H]},removeAllHandlers:function(){this._wreqrHandlers={}}});return E})(D,A);B.CommandStorage=(function(){var E=function(F){this.options=F;this._commands={};if(A.isFunction(this.initialize)){this.initialize(F)}};A.extend(E.prototype,D.Events,{getCommands:function(G){var F=this._commands[G];if(!F){F={command:G,instances:[]};this._commands[G]=F}return F},addCommand:function(G,F){var H=this.getCommands(G);H.instances.push(F)},clearCommands:function(F){var G=this.getCommands(F);G.instances=[]}});return E})();B.Commands=(function(E){return E.Handlers.extend({storageType:E.CommandStorage,constructor:function(G){this.options=G||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var F=Array.prototype.slice.call(arguments);E.Handlers.prototype.constructor.apply(this,F)},execute:function(G,F){G=arguments[0];F=Array.prototype.slice.call(arguments,1);if(this.hasHandler(G)){this.getHandler(G).apply(this,F)}else{this.storage.addCommand(G,F)}},_executeCommands:function(F,H,G){var I=this.storage.getCommands(F);A.each(I.instances,function(J){H.apply(G,J)});this.storage.clearCommands(F)},_initializeStorage:function(F){var H;var G=F.storageType||this.storageType;if(A.isFunction(G)){H=new G()}else{H=G}this.storage=H}})})(B);B.RequestResponse=(function(E){return E.Handlers.extend({request:function(){var G=arguments[0];var F=Array.prototype.slice.call(arguments,1);return this.getHandler(G).apply(this,F)}})})(B);B.EventAggregator=(function(G,E){var F=function(){};F.extend=G.Model.extend;E.extend(F.prototype,G.Events);return F})(D,A);return B})(Backbone,Backbone.Marionette,_);var Marionette=(function(B,G,A){var F={};G.Marionette=F;F.$=G.$;var C=Array.prototype.slice;function D(H){return C.call(H)}function E(J,I){var H=new Error(J);H.name=I||"Error";throw H}F.extend=G.Model.extend;F.getOption=function(J,H){if(!J||!H){return }var I;if(J.options&&(H in J.options)&&(J.options[H]!==undefined)){I=J.options[H]}else{I=J[H]}return I};F.triggerMethod=(function(){var I=/(^|:)(\w)/gi;function J(L,M,K){return K.toUpperCase()}var H=function(L){var K="on"+L.replace(I,J);var M=this[K];if(A.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(A.isFunction(M)){return M.apply(this,A.tail(arguments))}};return H})();F.MonitorDOMRefresh=(function(){function J(K){K._isShown=true;H(K)}function I(K){K._isRendered=true;H(K)}function H(K){if(K._isShown&&K._isRendered){if(A.isFunction(K.triggerMethod)){K.triggerMethod("dom:refresh")}}}return function(K){K.listenTo(K,"show",function(){J(K)});K.listenTo(K,"render",function(){I(K)})}})();(function(M){function L(R,P,N,O){var Q=O.split(/\s+/);A.each(Q,function(S){var T=R[S];if(!T){E("Method '"+S+"' was configured as an event handler, but does not exist.")}R.listenTo(P,N,T,R)})}function H(P,O,N,Q){P.listenTo(O,N,Q,P)}function J(R,P,N,O){var Q=O.split(/\s+/);A.each(Q,function(S){var T=R[S];R.stopListening(P,N,T,R)})}function I(P,O,N,Q){P.stopListening(O,N,Q,P)}function K(Q,N,R,P,O){if(!N||!R){return }if(A.isFunction(R)){R=R.call(Q)}A.each(R,function(T,S){if(A.isFunction(T)){P(Q,N,S,T)}else{O(Q,N,S,T)}})}M.bindEntityEvents=function(O,N,P){K(O,N,P,H,L)};M.unbindEntityEvents=function(O,N,P){K(O,N,P,I,J)}})(F);F.Callbacks=function(){this._deferred=F.$.Deferred();this._callbacks=[]};A.extend(F.Callbacks.prototype,{add:function(I,H){this._callbacks.push({cb:I,ctx:H});this._deferred.done(function(K,J){if(H){K=H}I.call(K,J)})},run:function(H,I){this._deferred.resolve(I,H)},reset:function(){var H=this._callbacks;this._deferred=F.$.Deferred();this._callbacks=[];A.each(H,function(I){this.add(I.cb,I.ctx)},this)}});F.Controller=function(H){this.triggerMethod=F.triggerMethod;this.options=H||{};if(A.isFunction(this.initialize)){this.initialize(this.options)}};F.Controller.extend=F.extend;A.extend(F.Controller.prototype,G.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});F.Region=function(I){this.options=I||{};this.el=F.getOption(this,"el");if(!this.el){var J=new Error("An 'el' must be specified for a region.");J.name="NoElError";throw J}if(this.initialize){var H=Array.prototype.slice.apply(arguments);this.initialize.apply(this,H)}};A.extend(F.Region,{buildRegion:function(I,O){var M=(typeof I==="string");var L=(typeof I.selector==="string");var P=(typeof I.regionType==="undefined");var J=(typeof I==="function");if(!J&&!M&&!L){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var H,K;if(M){H=I}if(I.selector){H=I.selector}if(J){K=I}if(!J&&P){K=O}if(I.regionType){K=I.regionType}var N=new K({el:H});if(I.parentEl){N.getEl=function(Q){var R=I.parentEl;if(A.isFunction(R)){R=R()}return R.find(Q)}}return N}});A.extend(F.Region.prototype,G.Events,{show:function(J){this.ensureEl();var H=J.isClosed||A.isUndefined(J.$el);var I=J!==this.currentView;if(I){this.close()}J.render();if(I||H){this.open(J)}this.currentView=J;F.triggerMethod.call(this,"show",J);F.triggerMethod.call(J,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(H){return F.$(H)},open:function(H){this.$el.empty().append(H.el)},close:function(){var H=this.currentView;if(!H||H.isClosed){return }if(H.close){H.close()}else{if(H.remove){H.remove()}}F.triggerMethod.call(this,"close");delete this.currentView},attachView:function(H){this.currentView=H},reset:function(){this.close();delete this.$el}});F.Region.extend=F.extend;F.RegionManager=(function(J){var I=J.Controller.extend({constructor:function(K){this._regions={};J.Controller.prototype.constructor.call(this,K)},addRegions:function(K,L){var M={};A.each(K,function(O,N){if(typeof O==="string"){O={selector:O}}if(O.selector){O=A.defaults({},O,L)}var P=this.addRegion(N,O);M[N]=P},this);return M},addRegion:function(M,N){var P;var L=A.isObject(N);var K=A.isString(N);var O=!!N.selector;if(K||(L&&O)){P=J.Region.buildRegion(N,J.Region)}else{if(A.isFunction(N)){P=J.Region.buildRegion(N,J.Region)}else{P=N}}this._store(M,P);this.triggerMethod("region:add",M,P);return P},get:function(K){return this._regions[K]},removeRegion:function(K){var L=this._regions[K];this._remove(K,L)},removeRegions:function(){A.each(this._regions,function(L,K){this._remove(K,L)},this)},closeRegions:function(){A.each(this._regions,function(L,K){L.close()},this)},close:function(){this.removeRegions();var K=Array.prototype.slice.call(arguments);J.Controller.prototype.close.apply(this,K)},_store:function(K,L){this._regions[K]=L;this._setLength()},_remove:function(K,L){L.close();delete this._regions[K];this._setLength();this.triggerMethod("region:remove",K,L)},_setLength:function(){this.length=A.size(this._regions)}});var H=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];A.each(H,function(K){I.prototype[K]=function(){var M=A.values(this._regions);var L=[M].concat(A.toArray(arguments));return A[K].apply(A,L)}});return I})(F);F.TemplateCache=function(H){this.templateId=H};A.extend(F.TemplateCache,{templateCaches:{},get:function(H){var I=this.templateCaches[H];if(!I){I=new F.TemplateCache(H);this.templateCaches[H]=I}return I.load()},clear:function(){var I;var H=D(arguments);var J=H.length;if(J>0){for(I=0;I<J;I++){delete this.templateCaches[H[I]]}}else{this.templateCaches={}}}});A.extend(F.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var H=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(H);return this.compiledTemplate},loadTemplate:function(H){var I=F.$(H).html();if(!I||I.length===0){E("Could not find template: '"+H+"'","NoTemplateError")}return I},compileTemplate:function(H){return A.template(H)}});F.Renderer={render:function(J,K){if(!J){var H=new Error("Cannot render the template since it's false, null or undefined.");H.name="TemplateNotFoundError";throw H}var I;if(typeof J==="function"){I=J}else{I=F.TemplateCache.get(J)}return I(K)}};F.View=G.View.extend({constructor:function(){A.bindAll(this,"render");var H=Array.prototype.slice.apply(arguments);G.View.prototype.constructor.apply(this,H);F.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:F.triggerMethod,getTemplate:function(){return F.getOption(this,"template")},mixinTemplateHelpers:function(H){H=H||{};var I=F.getOption(this,"templateHelpers");if(A.isFunction(I)){I=I.call(this)}return A.extend(H,I)},configureTriggers:function(){if(!this.triggers){return }var I={};var H=A.result(this,"triggers");A.each(H,function(K,J){I[J]=function(M){if(M&&M.preventDefault){M.preventDefault()}if(M&&M.stopPropagation){M.stopPropagation()}var L={view:this,model:this.model,collection:this.collection};this.triggerMethod(K,L)}},this);return I},delegateEvents:function(H){this._delegateDOMEvents(H);F.bindEntityEvents(this,this.model,F.getOption(this,"modelEvents"));F.bindEntityEvents(this,this.collection,F.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(H){H=H||this.events;if(A.isFunction(H)){H=H.call(this)}var J={};var I=this.configureTriggers();A.extend(J,H,I);G.View.prototype.delegateEvents.call(this,J)},undelegateEvents:function(){var H=Array.prototype.slice.call(arguments);G.View.prototype.undelegateEvents.apply(this,H);F.unbindEntityEvents(this,this.model,F.getOption(this,"modelEvents"));F.unbindEntityEvents(this,this.collection,F.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return }var H=this.triggerMethod("before:close");if(H===false){return }this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return }if(!this._uiBindings){this._uiBindings=this.ui}var H=A.result(this,"_uiBindings");this.ui={};A.each(A.keys(H),function(J){var I=H[J];this.ui[J]=this.$(I)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return }A.each(this.ui,function(I,H){delete this.ui[H]},this);this.ui=this._uiBindings;delete this._uiBindings}});F.ItemView=F.View.extend({constructor:function(){F.View.prototype.constructor.apply(this,D(arguments))},serializeData:function(){var H={};if(this.model){H=this.model.toJSON()}else{if(this.collection){H={items:this.collection.toJSON()}}}return H},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var J=this.serializeData();J=this.mixinTemplateHelpers(J);var I=this.getTemplate();var H=F.Renderer.render(I,J);this.$el.html(H);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return }this.triggerMethod("item:before:close");F.View.prototype.close.apply(this,D(arguments));this.triggerMethod("item:closed")}});F.CollectionView=F.View.extend({itemViewEventPrefix:"itemview",constructor:function(H){this._initChildViewStorage();F.View.prototype.constructor.apply(this,D(arguments));this._initialEvents()},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(K,L,I){this.closeEmptyView();var J=this.getItemView(K);var H=this.collection.indexOf(K);this.addItemView(K,J,H)},onShowCalled:function(){this.children.each(function(H){F.triggerMethod.call(H,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}},showCollection:function(){var H;this.collection.each(function(J,I){H=this.getItemView(J);this.addItemView(J,H,I)},this)},showEmptyView:function(){var I=F.getOption(this,"emptyView");if(I&&!this._showingEmptyView){this._showingEmptyView=true;var H=new G.Model();this.addItemView(H,I,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getItemView:function(I){var H=F.getOption(this,"itemView");if(!H){E("An `itemView` must be specified","NoItemViewError")}return H},addItemView:function(K,J,I){var L=F.getOption(this,"itemViewOptions");if(A.isFunction(L)){L=L.call(this,K,I)}var H=this.buildItemView(K,J,L);this.addChildViewEventForwarding(H);this.triggerMethod("before:item:added",H);this.children.add(H);this.renderItemView(H,I);if(this._isShown){F.triggerMethod.call(H,"show")}this.triggerMethod("after:item:added",H)},addChildViewEventForwarding:function(H){var I=F.getOption(this,"itemViewEventPrefix");this.listenTo(H,"all",function(){var J=D(arguments);J[0]=I+":"+J[0];J.splice(1,0,H);F.triggerMethod.apply(this,J)},this)},renderItemView:function(H,I){H.render();this.appendHtml(this,H,I)},buildItemView:function(J,H,K){var I=A.extend({model:J},K);return new H(I)},removeItemView:function(I){var H=this.children.findByModel(I);this.removeChildView(H);this.checkEmpty()},removeChildView:function(H){if(H){this.stopListening(H);if(H.close){H.close()}else{if(H.remove){H.remove()}}this.children.remove(H)}this.triggerMethod("item:removed",H)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendHtml:function(H,J,I){H.$el.append(J.el)},_initChildViewStorage:function(){this.children=new G.ChildViewContainer()},close:function(){if(this.isClosed){return }this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");F.View.prototype.close.apply(this,D(arguments))},closeChildren:function(){this.children.each(function(H){this.removeChildView(H)},this);this.checkEmpty()}});F.CompositeView=F.CollectionView.extend({constructor:function(){F.CollectionView.prototype.constructor.apply(this,D(arguments))},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}},getItemView:function(I){var H=F.getOption(this,"itemView")||this.constructor;if(!H){E("An `itemView` must be specified","NoItemViewError")}return H},serializeData:function(){var H={};if(this.model){H=this.model.toJSON()}return H},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var H=this.renderModel();this.$el.html(H);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){F.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var I={};I=this.serializeData();I=this.mixinTemplateHelpers(I);var H=this.getTemplate();return F.Renderer.render(H,I)},appendHtml:function(H,J,I){var K=this.getItemViewContainer(H);K.append(J.el)},getItemViewContainer:function(K){if("$itemViewContainer" in K){return K.$itemViewContainer}var I;var J=F.getOption(K,"itemViewContainer");if(J){var H=A.isFunction(J)?J():J;I=K.$(H);if(I.length<=0){E("The specified `itemViewContainer` was not found: "+K.itemViewContainer,"ItemViewContainerMissingError")}}else{I=K.$el}K.$itemViewContainer=I;return I},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});F.Layout=F.ItemView.extend({regionType:F.Region,constructor:function(H){H=H||{};this._firstRender=true;this._initializeRegions(H);F.ItemView.prototype.constructor.call(this,H)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var I=Array.prototype.slice.apply(arguments);var H=F.ItemView.prototype.render.apply(this,I);return H},close:function(){if(this.isClosed){return }this.regionManager.close();var H=Array.prototype.slice.apply(arguments);F.ItemView.prototype.close.apply(this,H)},addRegion:function(H,I){var J={};J[H]=I;return this._buildRegions(J)[H]},addRegions:function(H){this.regions=A.extend({},this.regions,H);return this._buildRegions(H)},removeRegion:function(H){delete this.regions[H];return this.regionManager.removeRegion(H)},_buildRegions:function(J){var H=this;var I={regionType:F.getOption(this,"regionType"),parentEl:function(){return H.$el}};return this.regionManager.addRegions(J,I)},_initializeRegions:function(H){var I;this._initRegionManager();if(A.isFunction(this.regions)){I=this.regions(H)}else{I=this.regions||{}}this.addRegions(I)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(H){H.reset()})},_initRegionManager:function(){this.regionManager=new F.RegionManager();this.listenTo(this.regionManager,"region:add",function(H,I){this[H]=I;this.trigger("region:add",H,I)});this.listenTo(this.regionManager,"region:remove",function(H,I){delete this[H];this.trigger("region:remove",H,I)})}});F.AppRouter=G.Router.extend({constructor:function(I){G.Router.prototype.constructor.apply(this,D(arguments));this.options=I||{};var J=F.getOption(this,"appRoutes");var H=this._getController();this.processAppRoutes(H,J)},appRoute:function(J,I){var H=this._getController();this._addAppRoute(H,J,I)},processAppRoutes:function(H,J){if(!J){return }var I=A.keys(J).reverse();A.each(I,function(K){this._addAppRoute(H,K,J[K])},this)},_getController:function(){return F.getOption(this,"controller")},_addAppRoute:function(H,J,I){var K=H[I];if(!K){throw new Error("Method '"+I+"' was not found on the controller")}this.route(J,I,A.bind(K,H))}});F.Application=function(H){this._initRegionManager();this._initCallbacks=new F.Callbacks();this.vent=new G.Wreqr.EventAggregator();this.commands=new G.Wreqr.Commands();this.reqres=new G.Wreqr.RequestResponse();this.submodules={};A.extend(this,H);this.triggerMethod=F.triggerMethod};A.extend(F.Application.prototype,G.Events,{execute:function(){var H=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,H)},request:function(){var H=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,H)},addInitializer:function(H){this._initCallbacks.add(H)},start:function(H){this.triggerMethod("initialize:before",H);this._initCallbacks.run(H,this);this.triggerMethod("initialize:after",H);this.triggerMethod("start",H)},addRegions:function(H){return this._regionManager.addRegions(H)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(H){this._regionManager.removeRegion(H)},getRegion:function(H){return this._regionManager.get(H)},module:function(H,J){var I=D(arguments);I.unshift(this);return F.Module.create.apply(F.Module,I)},_initRegionManager:function(){this._regionManager=new F.RegionManager();this.listenTo(this._regionManager,"region:add",function(H,I){this[H]=I});this.listenTo(this._regionManager,"region:remove",function(H,I){delete this[H]})}});F.Application.extend=F.extend;F.Module=function(H,I){this.moduleName=H;this.submodules={};this._setupInitializersAndFinalizers();this.app=I;this.startWithParent=true;this.triggerMethod=F.triggerMethod};A.extend(F.Module.prototype,G.Events,{addInitializer:function(H){this._initializerCallbacks.add(H)},addFinalizer:function(H){this._finalizerCallbacks.add(H)},start:function(H){if(this._isInitialized){return }A.each(this.submodules,function(I){if(I.startWithParent){I.start(H)}});this.triggerMethod("before:start",H);this._initializerCallbacks.run(H,this);this._isInitialized=true;this.triggerMethod("start",H)},stop:function(){if(!this._isInitialized){return }this._isInitialized=false;F.triggerMethod.call(this,"before:stop");A.each(this.submodules,function(H){H.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();F.triggerMethod.call(this,"stop")},addDefinition:function(H,I){this._runModuleDefinition(H,I)},_runModuleDefinition:function(I,J){if(!I){return }var H=A.flatten([this,this.app,G,F,F.$,A,J]);I.apply(this,H)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new F.Callbacks();this._finalizerCallbacks=new F.Callbacks()}});A.extend(F.Module,{create:function(N,H,I){var J=N;var L=D(arguments);L.splice(0,3);H=H.split(".");var K=H.length;var M=[];M[K-1]=I;A.each(H,function(O,P){var Q=J;J=this._getModule(Q,O,N);this._addModuleDefinition(Q,J,M[P],L)},this);return J},_getModule:function(L,I,M,K,H){var J=L[I];if(!J){J=new F.Module(I,M);L[I]=J;L.submodules[I]=J}return J},_addModuleDefinition:function(M,I,L,H){var K;var J;if(A.isFunction(L)){K=L;J=true}else{if(A.isObject(L)){K=L.define;J=L.startWithParent}else{J=true}}if(K){I.addDefinition(K,H)}I.startWithParent=I.startWithParent&&J;if(I.startWithParent&&!I.startWithParentIsConfigured){I.startWithParentIsConfigured=true;M.addInitializer(function(N){if(I.startWithParent){I.start(N)}})}}});return F})(this,Backbone,_);
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone.noconflict.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Backbone");JIRA.WorkflowDesigner.Backbone=Backbone.noConflict()}());
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.position.js' */
/*
 * jQuery UI Position 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(G,H){G.ui=G.ui||{};var D=/left|center|right/,E=/top|center|bottom/,A="center",F={},B=G.fn.position,C=G.fn.offset;G.fn.position=function(J){if(!J||!J.of){return B.apply(this,arguments)}J=G.extend({},J);var N=G(J.of),M=N[0],P=(J.collision||"flip").split(" "),O=J.offset?J.offset.split(" "):[0,0],L,I,K;if(M.nodeType===9){L=N.width();I=N.height();K={top:0,left:0}}else{if(M.setTimeout){L=N.width();I=N.height();K={top:N.scrollTop(),left:N.scrollLeft()}}else{if(M.preventDefault){J.at="left top";L=I=0;K={top:J.of.pageY,left:J.of.pageX}}else{L=N.outerWidth();I=N.outerHeight();K=N.offset()}}}G.each(["my","at"],function(){var Q=(J[this]||"").split(" ");if(Q.length===1){Q=D.test(Q[0])?Q.concat([A]):E.test(Q[0])?[A].concat(Q):[A,A]}Q[0]=D.test(Q[0])?Q[0]:A;Q[1]=E.test(Q[1])?Q[1]:A;J[this]=Q});if(P.length===1){P[1]=P[0]}O[0]=parseInt(O[0],10)||0;if(O.length===1){O[1]=O[0]}O[1]=parseInt(O[1],10)||0;if(J.at[0]==="right"){K.left+=L}else{if(J.at[0]===A){K.left+=L/2}}if(J.at[1]==="bottom"){K.top+=I}else{if(J.at[1]===A){K.top+=I/2}}K.left+=O[0];K.top+=O[1];return this.each(function(){var T=G(this),V=T.outerWidth(),S=T.outerHeight(),U=parseInt(G.curCSS(this,"marginLeft",true))||0,R=parseInt(G.curCSS(this,"marginTop",true))||0,X=V+U+(parseInt(G.curCSS(this,"marginRight",true))||0),Y=S+R+(parseInt(G.curCSS(this,"marginBottom",true))||0),W=G.extend({},K),Q;if(J.my[0]==="right"){W.left-=V}else{if(J.my[0]===A){W.left-=V/2}}if(J.my[1]==="bottom"){W.top-=S}else{if(J.my[1]===A){W.top-=S/2}}if(!F.fractions){W.left=Math.round(W.left);W.top=Math.round(W.top)}Q={left:W.left-U,top:W.top-R};G.each(["left","top"],function(a,Z){if(G.ui.position[P[a]]){G.ui.position[P[a]][Z](W,{targetWidth:L,targetHeight:I,elemWidth:V,elemHeight:S,collisionPosition:Q,collisionWidth:X,collisionHeight:Y,offset:O,my:J.my,at:J.at})}});if(G.fn.bgiframe){T.bgiframe()}T.offset(G.extend(W,{using:J.using}))})};G.ui.position={fit:{left:function(I,J){var L=G(window),K=J.collisionPosition.left+J.collisionWidth-L.width()-L.scrollLeft();I.left=K>0?I.left-K:Math.max(I.left-J.collisionPosition.left,I.left)},top:function(I,J){var L=G(window),K=J.collisionPosition.top+J.collisionHeight-L.height()-L.scrollTop();I.top=K>0?I.top-K:Math.max(I.top-J.collisionPosition.top,I.top)}},flip:{left:function(J,L){if(L.at[0]===A){return }var N=G(window),M=L.collisionPosition.left+L.collisionWidth-N.width()-N.scrollLeft(),I=L.my[0]==="left"?-L.elemWidth:L.my[0]==="right"?L.elemWidth:0,K=L.at[0]==="left"?L.targetWidth:-L.targetWidth,O=-2*L.offset[0];J.left+=L.collisionPosition.left<0?I+K+O:M>0?I+K+O:0},top:function(J,L){if(L.at[1]===A){return }var N=G(window),M=L.collisionPosition.top+L.collisionHeight-N.height()-N.scrollTop(),I=L.my[1]==="top"?-L.elemHeight:L.my[1]==="bottom"?L.elemHeight:0,K=L.at[1]==="top"?L.targetHeight:-L.targetHeight,O=-2*L.offset[1];J.top+=L.collisionPosition.top<0?I+K+O:M>0?I+K+O:0}}};if(!G.offset.setOffset){G.offset.setOffset=function(M,J){if(/static/.test(G.curCSS(M,"position"))){M.style.position="relative"}var L=G(M),O=L.offset(),I=parseInt(G.curCSS(M,"top",true),10)||0,N=parseInt(G.curCSS(M,"left",true),10)||0,K={top:(J.top-O.top)+I,left:(J.left-O.left)+N};if("using" in J){J.using.call(M,K)}else{L.css(K)}};G.fn.offset=function(I){var J=this[0];if(!J||!J.ownerDocument){return null}if(I){if(G.isFunction(I)){return this.each(function(K){G(this).offset(I.call(this,K,G(this).offset()))})}return this.each(function(){G.offset.setOffset(this,I)})}return C.call(this)}}if(!G.curCSS){G.curCSS=G.css}(function(){var I=document.getElementsByTagName("body")[0],P=document.createElement("div"),M,O,J,N,L;M=document.createElement(I?"div":"body");J={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(I){G.extend(J,{position:"absolute",left:"-1000px",top:"-1000px"})}for(var K in J){M.style[K]=J[K]}M.appendChild(P);O=I||document.documentElement;O.insertBefore(M,O.firstChild);P.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";N=G(P).offset(function(Q,R){return R}).offset();M.innerHTML="";O.removeChild(M);L=N.top+N.left+(I?2000:0);F.fractions=L>21&&L<22})()}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.droppable.js' */
/*
 * jQuery UI Droppable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(A,B){A.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var D=this.options,C=D.accept;this.isover=0;this.isout=1;this.accept=A.isFunction(C)?C:function(E){return E.is(C)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};A.ui.ddmanager.droppables[D.scope]=A.ui.ddmanager.droppables[D.scope]||[];A.ui.ddmanager.droppables[D.scope].push(this);(D.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var C=A.ui.ddmanager.droppables[this.options.scope];for(var D=0;D<C.length;D++){if(C[D]==this){C.splice(D,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(C,D){if(C=="accept"){this.accept=A.isFunction(D)?D:function(E){return E.is(D)}}A.Widget.prototype._setOption.apply(this,arguments)},_activate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(C&&this._trigger("activate",D,this.ui(C)))},_deactivate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(C&&this._trigger("deactivate",D,this.ui(C)))},_over:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",D,this.ui(C))}},_out:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",D,this.ui(C))}},_drop:function(D,E){var C=E||A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return false}var F=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var G=A.data(this,"droppable");if(G.options.greedy&&!G.options.disabled&&G.options.scope==C.options.scope&&G.accept.call(G.element[0],(C.currentItem||C.element))&&A.ui.intersect(C,A.extend(G,{offset:G.element.offset()}),G.options.tolerance)){F=true;return false}});if(F){return false}if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",D,this.ui(C));return this.element}return false},ui:function(C){return{draggable:(C.currentItem||C.element),helper:C.helper,position:C.position,offset:C.positionAbs}}});A.extend(A.ui.droppable,{version:"1.8.24"});A.ui.intersect=function(P,J,N){if(!J.offset){return false}var E=(P.positionAbs||P.position.absolute).left,D=E+P.helperProportions.width,M=(P.positionAbs||P.position.absolute).top,L=M+P.helperProportions.height;var G=J.offset.left,C=G+J.proportions.width,O=J.offset.top,K=O+J.proportions.height;switch(N){case"fit":return(G<=E&&D<=C&&O<=M&&L<=K);break;case"intersect":return(G<E+(P.helperProportions.width/2)&&D-(P.helperProportions.width/2)<C&&O<M+(P.helperProportions.height/2)&&L-(P.helperProportions.height/2)<K);break;case"pointer":var H=((P.positionAbs||P.position.absolute).left+(P.clickOffset||P.offset.click).left),I=((P.positionAbs||P.position.absolute).top+(P.clickOffset||P.offset.click).top),F=A.ui.isOver(I,H,O,G,J.proportions.height,J.proportions.width);return F;break;case"touch":return((M>=O&&M<=K)||(L>=O&&L<=K)||(M<O&&L>K))&&((E>=G&&E<=C)||(D>=G&&D<=C)||(E<G&&D>C));break;default:return false;break}};A.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(F,H){var C=A.ui.ddmanager.droppables[F.options.scope]||[];var G=H?H.type:null;var I=(F.currentItem||F.element).find(":data(droppable)").andSelf();droppablesLoop:for(var E=0;E<C.length;E++){if(C[E].options.disabled||(F&&!C[E].accept.call(C[E].element[0],(F.currentItem||F.element)))){continue}for(var D=0;D<I.length;D++){if(I[D]==C[E].element[0]){C[E].proportions.height=0;continue droppablesLoop}}C[E].visible=C[E].element.css("display")!="none";if(!C[E].visible){continue}if(G=="mousedown"){C[E]._activate.call(C[E],H)}C[E].offset=C[E].element.offset();C[E].proportions={width:C[E].element[0].offsetWidth,height:C[E].element[0].offsetHeight}}},drop:function(C,D){var E=false;A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(!this.options){return }if(!this.options.disabled&&this.visible&&A.ui.intersect(C,this,this.options.tolerance)){E=this._drop.call(this,D)||E}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(C.currentItem||C.element))){this.isout=1;this.isover=0;this._deactivate.call(this,D)}});return E},dragStart:function(C,D){C.element.parents(":not(body,html)").bind("scroll.droppable",function(){if(!C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}})},drag:function(C,D){if(C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return }var G=A.ui.intersect(C,this,this.options.tolerance);var I=!G&&this.isover==1?"isout":(G&&this.isover==0?"isover":null);if(!I){return }var H;if(this.options.greedy){var F=this.options.scope;var E=this.element.parents(":data(droppable)").filter(function(){return A.data(this,"droppable").options.scope===F});if(E.length){H=A.data(E[0],"droppable");H.greedyChild=(I=="isover"?1:0)}}if(H&&I=="isover"){H.isover=0;H.isout=1;H._out.call(H,D)}this[I]=1;this[I=="isout"?"isover":"isout"]=0;this[I=="isover"?"_over":"_out"].call(this,D);if(H&&I=="isout"){H.isout=0;H.isover=1;H._over.call(H,D)}})},dragStop:function(C,D){C.element.parents(":not(body,html)").unbind("scroll.droppable");if(!C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}}}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.resizable.js' */
/*
 * jQuery UI Resizable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(C,D){C.widget("ui.resizable",C.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var F=this,J=this.options;this.element.addClass("ui-resizable");C.extend(this,{_aspectRatio:!!(J.aspectRatio),aspectRatio:J.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:J.helper||J.ghost||J.animate?J.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(C('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=J.handles||(!C(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var K=this.handles.split(",");this.handles={};for(var G=0;G<K.length;G++){var I=C.trim(K[G]),E="ui-resizable-"+I;var H=C('<div class="ui-resizable-handle '+E+'"></div>');H.css({zIndex:J.zIndex});if("se"==I){H.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[I]=".ui-resizable-"+I;this.element.append(H)}}this._renderAxis=function(P){P=P||this.element;for(var M in this.handles){if(this.handles[M].constructor==String){this.handles[M]=C(this.handles[M],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var N=C(this.handles[M],this.element),O=0;O=/sw|ne|nw|se|n|s/.test(M)?N.outerHeight():N.outerWidth();var L=["padding",/ne|nw|n/.test(M)?"Top":/se|sw|s/.test(M)?"Bottom":/^e$/.test(M)?"Right":"Left"].join("");P.css(L,O);this._proportionallyResize()}if(!C(this.handles[M]).length){continue}}};this._renderAxis(this.element);this._handles=C(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!F.resizing){if(this.className){var L=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}F.axis=L&&L[1]?L[1]:"se"}});if(J.autoHide){this._handles.hide();C(this.element).addClass("ui-resizable-autohide").hover(function(){if(J.disabled){return }C(this).removeClass("ui-resizable-autohide");F._handles.show()},function(){if(J.disabled){return }if(!F.resizing){C(this).addClass("ui-resizable-autohide");F._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var E=function(G){C(G).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){E(this.element);var F=this.element;F.after(this.originalElement.css({position:F.css("position"),width:F.outerWidth(),height:F.outerHeight(),top:F.css("top"),left:F.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);E(this.originalElement);return this},_mouseCapture:function(F){var G=false;for(var E in this.handles){if(C(this.handles[E])[0]==F.target){G=true}}return !this.options.disabled&&G},_mouseStart:function(G){var J=this.options,F=this.element.position(),E=this.element;this.resizing=true;this.documentScroll={top:C(document).scrollTop(),left:C(document).scrollLeft()};if(E.is(".ui-draggable")||(/absolute/).test(E.css("position"))){E.css({position:"absolute",top:F.top,left:F.left})}this._renderProxy();var K=B(this.helper.css("left")),H=B(this.helper.css("top"));if(J.containment){K+=C(J.containment).scrollLeft()||0;H+=C(J.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:K,top:H};this.size=this._helper?{width:E.outerWidth(),height:E.outerHeight()}:{width:E.width(),height:E.height()};this.originalSize=this._helper?{width:E.outerWidth(),height:E.outerHeight()}:{width:E.width(),height:E.height()};this.originalPosition={left:K,top:H};this.sizeDiff={width:E.outerWidth()-E.width(),height:E.outerHeight()-E.height()};this.originalMousePosition={left:G.pageX,top:G.pageY};this.aspectRatio=(typeof J.aspectRatio=="number")?J.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var I=C(".ui-resizable-"+this.axis).css("cursor");C("body").css("cursor",I=="auto"?this.axis+"-resize":I);E.addClass("ui-resizable-resizing");this._propagate("start",G);return true},_mouseDrag:function(E){var H=this.helper,G=this.options,M={},P=this,J=this.originalMousePosition,N=this.axis;var Q=(E.pageX-J.left)||0,O=(E.pageY-J.top)||0;var I=this._change[N];if(!I){return false}var L=I.apply(this,[E,Q,O]),K=C.browser.msie&&C.browser.version<7,F=this.sizeDiff;this._updateVirtualBoundaries(E.shiftKey);if(this._aspectRatio||E.shiftKey){L=this._updateRatio(L,E)}L=this._respectSize(L,E);this._propagate("resize",E);H.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(L);this._trigger("resize",E,this.ui());return false},_mouseStop:function(H){this.resizing=false;var I=this.options,M=this;if(this._helper){var G=this._proportionallyResizeElements,E=G.length&&(/textarea/i).test(G[0].nodeName),F=E&&C.ui.hasScroll(G[0],"left")?0:M.sizeDiff.height,K=E?0:M.sizeDiff.width;var N={width:(M.helper.width()-K),height:(M.helper.height()-F)},J=(parseInt(M.element.css("left"),10)+(M.position.left-M.originalPosition.left))||null,L=(parseInt(M.element.css("top"),10)+(M.position.top-M.originalPosition.top))||null;if(!I.animate){this.element.css(C.extend(N,{top:L,left:J}))}M.helper.height(M.size.height);M.helper.width(M.size.width);if(this._helper&&!I.animate){this._proportionallyResize()}}C("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",H);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(G){var J=this.options,I,H,F,K,E;E={minWidth:A(J.minWidth)?J.minWidth:0,maxWidth:A(J.maxWidth)?J.maxWidth:Infinity,minHeight:A(J.minHeight)?J.minHeight:0,maxHeight:A(J.maxHeight)?J.maxHeight:Infinity};if(this._aspectRatio||G){I=E.minHeight*this.aspectRatio;F=E.minWidth/this.aspectRatio;H=E.maxHeight*this.aspectRatio;K=E.maxWidth/this.aspectRatio;if(I>E.minWidth){E.minWidth=I}if(F>E.minHeight){E.minHeight=F}if(H<E.maxWidth){E.maxWidth=H}if(K<E.maxHeight){E.maxHeight=K}}this._vBoundaries=E},_updateCache:function(E){var F=this.options;this.offset=this.helper.offset();if(A(E.left)){this.position.left=E.left}if(A(E.top)){this.position.top=E.top}if(A(E.height)){this.size.height=E.height}if(A(E.width)){this.size.width=E.width}},_updateRatio:function(H,G){var I=this.options,J=this.position,F=this.size,E=this.axis;if(A(H.height)){H.width=(H.height*this.aspectRatio)}else{if(A(H.width)){H.height=(H.width/this.aspectRatio)}}if(E=="sw"){H.left=J.left+(F.width-H.width);H.top=null}if(E=="nw"){H.top=J.top+(F.height-H.height);H.left=J.left+(F.width-H.width)}return H},_respectSize:function(L,G){var J=this.helper,I=this._vBoundaries,Q=this._aspectRatio||G.shiftKey,P=this.axis,S=A(L.width)&&I.maxWidth&&(I.maxWidth<L.width),M=A(L.height)&&I.maxHeight&&(I.maxHeight<L.height),H=A(L.width)&&I.minWidth&&(I.minWidth>L.width),R=A(L.height)&&I.minHeight&&(I.minHeight>L.height);if(H){L.width=I.minWidth}if(R){L.height=I.minHeight}if(S){L.width=I.maxWidth}if(M){L.height=I.maxHeight}var F=this.originalPosition.left+this.originalSize.width,O=this.position.top+this.size.height;var K=/sw|nw|w/.test(P),E=/nw|ne|n/.test(P);if(H&&K){L.left=F-I.minWidth}if(S&&K){L.left=F-I.maxWidth}if(R&&E){L.top=O-I.minHeight}if(M&&E){L.top=O-I.maxHeight}var N=!L.width&&!L.height;if(N&&!L.left&&L.top){L.top=null}else{if(N&&!L.top&&L.left){L.left=null}}return L},_proportionallyResize:function(){var J=this.options;if(!this._proportionallyResizeElements.length){return }var G=this.helper||this.element;for(var F=0;F<this._proportionallyResizeElements.length;F++){var H=this._proportionallyResizeElements[F];if(!this.borderDif){var E=[H.css("borderTopWidth"),H.css("borderRightWidth"),H.css("borderBottomWidth"),H.css("borderLeftWidth")],I=[H.css("paddingTop"),H.css("paddingRight"),H.css("paddingBottom"),H.css("paddingLeft")];this.borderDif=C.map(E,function(K,M){var L=parseInt(K,10)||0,N=parseInt(I[M],10)||0;return L+N})}if(C.browser.msie&&!(!(C(G).is(":hidden")||C(G).parents(":hidden").length))){continue}H.css({height:(G.height()-this.borderDif[0]-this.borderDif[2])||0,width:(G.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var F=this.element,I=this.options;this.elementOffset=F.offset();if(this._helper){this.helper=this.helper||C('<div style="overflow:hidden;"></div>');var E=C.browser.msie&&C.browser.version<7,G=(E?1:0),H=(E?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+H,height:this.element.outerHeight()+H,position:"absolute",left:this.elementOffset.left-G+"px",top:this.elementOffset.top-G+"px",zIndex:++I.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(G,F,E){return{width:this.originalSize.width+F}},w:function(H,F,E){var J=this.options,G=this.originalSize,I=this.originalPosition;return{left:I.left+F,width:G.width-F}},n:function(H,F,E){var J=this.options,G=this.originalSize,I=this.originalPosition;return{top:I.top+E,height:G.height-E}},s:function(G,F,E){return{height:this.originalSize.height+E}},se:function(G,F,E){return C.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},sw:function(G,F,E){return C.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[G,F,E]))},ne:function(G,F,E){return C.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},nw:function(G,F,E){return C.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[G,F,E]))}},_propagate:function(F,E){C.ui.plugin.call(this,F,[E,this.ui()]);(F!="resize"&&this._trigger(F,E,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});C.extend(C.ui.resizable,{version:"1.8.24"});C.ui.plugin.add("resizable","alsoResize",{start:function(F,G){var E=C(this).data("resizable"),I=E.options;var H=function(J){C(J).each(function(){var K=C(this);K.data("resizable-alsoresize",{width:parseInt(K.width(),10),height:parseInt(K.height(),10),left:parseInt(K.css("left"),10),top:parseInt(K.css("top"),10)})})};if(typeof (I.alsoResize)=="object"&&!I.alsoResize.parentNode){if(I.alsoResize.length){I.alsoResize=I.alsoResize[0];H(I.alsoResize)}else{C.each(I.alsoResize,function(J){H(J)})}}else{H(I.alsoResize)}},resize:function(G,I){var F=C(this).data("resizable"),J=F.options,H=F.originalSize,L=F.originalPosition;var K={height:(F.size.height-H.height)||0,width:(F.size.width-H.width)||0,top:(F.position.top-L.top)||0,left:(F.position.left-L.left)||0},E=function(M,N){C(M).each(function(){var Q=C(this),R=C(this).data("resizable-alsoresize"),P={},O=N&&N.length?N:Q.parents(I.originalElement[0]).length?["width","height"]:["width","height","top","left"];C.each(O,function(S,U){var T=(R[U]||0)+(K[U]||0);if(T&&T>=0){P[U]=T||null}});Q.css(P)})};if(typeof (J.alsoResize)=="object"&&!J.alsoResize.nodeType){C.each(J.alsoResize,function(M,N){E(M,N)})}else{E(J.alsoResize)}},stop:function(E,F){C(this).removeData("resizable-alsoresize")}});C.ui.plugin.add("resizable","animate",{stop:function(I,N){var O=C(this).data("resizable"),J=O.options;var H=O._proportionallyResizeElements,E=H.length&&(/textarea/i).test(H[0].nodeName),F=E&&C.ui.hasScroll(H[0],"left")?0:O.sizeDiff.height,L=E?0:O.sizeDiff.width;var G={width:(O.size.width-L),height:(O.size.height-F)},K=(parseInt(O.element.css("left"),10)+(O.position.left-O.originalPosition.left))||null,M=(parseInt(O.element.css("top"),10)+(O.position.top-O.originalPosition.top))||null;O.element.animate(C.extend(G,M&&K?{top:M,left:K}:{}),{duration:J.animateDuration,easing:J.animateEasing,step:function(){var P={width:parseInt(O.element.css("width"),10),height:parseInt(O.element.css("height"),10),top:parseInt(O.element.css("top"),10),left:parseInt(O.element.css("left"),10)};if(H&&H.length){C(H[0]).css({width:P.width,height:P.height})}O._updateCache(P);O._propagate("resize",I)}})}});C.ui.plugin.add("resizable","containment",{start:function(F,P){var R=C(this).data("resizable"),J=R.options,L=R.element;var G=J.containment,K=(G instanceof C)?G.get(0):(/parent/.test(G))?L.parent().get(0):G;if(!K){return }R.containerElement=C(K);if(/document/.test(G)||G==document){R.containerOffset={left:0,top:0};R.containerPosition={left:0,top:0};R.parentData={element:C(document),left:0,top:0,width:C(document).width(),height:C(document).height()||document.body.parentNode.scrollHeight}}else{var N=C(K),I=[];C(["Top","Right","Left","Bottom"]).each(function(T,S){I[T]=B(N.css("padding"+S))});R.containerOffset=N.offset();R.containerPosition=N.position();R.containerSize={height:(N.innerHeight()-I[3]),width:(N.innerWidth()-I[1])};var O=R.containerOffset,E=R.containerSize.height,M=R.containerSize.width,H=(C.ui.hasScroll(K,"left")?K.scrollWidth:M),Q=(C.ui.hasScroll(K)?K.scrollHeight:E);R.parentData={element:K,left:O.left,top:O.top,width:H,height:Q}}},resize:function(G,P){var S=C(this).data("resizable"),I=S.options,F=S.containerSize,O=S.containerOffset,M=S.size,N=S.position,Q=S._aspectRatio||G.shiftKey,E={top:0,left:0},H=S.containerElement;if(H[0]!=document&&(/static/).test(H.css("position"))){E=O}if(N.left<(S._helper?O.left:0)){S.size.width=S.size.width+(S._helper?(S.position.left-O.left):(S.position.left-E.left));if(Q){S.size.height=S.size.width/S.aspectRatio}S.position.left=I.helper?O.left:0}if(N.top<(S._helper?O.top:0)){S.size.height=S.size.height+(S._helper?(S.position.top-O.top):S.position.top);if(Q){S.size.width=S.size.height*S.aspectRatio}S.position.top=S._helper?O.top:0}S.offset.left=S.parentData.left+S.position.left;S.offset.top=S.parentData.top+S.position.top;var L=Math.abs((S._helper?S.offset.left-E.left:(S.offset.left-E.left))+S.sizeDiff.width),R=Math.abs((S._helper?S.offset.top-E.top:(S.offset.top-O.top))+S.sizeDiff.height);var K=S.containerElement.get(0)==S.element.parent().get(0),J=/relative|absolute/.test(S.containerElement.css("position"));if(K&&J){L-=S.parentData.left}if(L+S.size.width>=S.parentData.width){S.size.width=S.parentData.width-L;if(Q){S.size.height=S.size.width/S.aspectRatio}}if(R+S.size.height>=S.parentData.height){S.size.height=S.parentData.height-R;if(Q){S.size.width=S.size.height*S.aspectRatio}}},stop:function(F,M){var O=C(this).data("resizable"),G=O.options,K=O.position,L=O.containerOffset,E=O.containerPosition,H=O.containerElement;var I=C(O.helper),P=I.offset(),N=I.outerWidth()-O.sizeDiff.width,J=I.outerHeight()-O.sizeDiff.height;if(O._helper&&!G.animate&&(/relative/).test(H.css("position"))){C(this).css({left:P.left-E.left-L.left,width:N,height:J})}if(O._helper&&!G.animate&&(/static/).test(H.css("position"))){C(this).css({left:P.left-E.left-L.left,width:N,height:J})}}});C.ui.plugin.add("resizable","ghost",{start:function(G,H){var E=C(this).data("resizable"),I=E.options,F=E.size;E.ghost=E.originalElement.clone();E.ghost.css({opacity:0.25,display:"block",position:"relative",height:F.height,width:F.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof I.ghost=="string"?I.ghost:"");E.ghost.appendTo(E.helper)},resize:function(F,G){var E=C(this).data("resizable"),H=E.options;if(E.ghost){E.ghost.css({position:"relative",height:E.size.height,width:E.size.width})}},stop:function(F,G){var E=C(this).data("resizable"),H=E.options;if(E.ghost&&E.helper){E.helper.get(0).removeChild(E.ghost.get(0))}}});C.ui.plugin.add("resizable","grid",{resize:function(E,M){var O=C(this).data("resizable"),H=O.options,K=O.size,I=O.originalSize,J=O.originalPosition,N=O.axis,L=H._aspectRatio||E.shiftKey;H.grid=typeof H.grid=="number"?[H.grid,H.grid]:H.grid;var G=Math.round((K.width-I.width)/(H.grid[0]||1))*(H.grid[0]||1),F=Math.round((K.height-I.height)/(H.grid[1]||1))*(H.grid[1]||1);if(/^(se|s|e)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F}else{if(/^(ne)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F;O.position.top=J.top-F}else{if(/^(sw)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F;O.position.left=J.left-G}else{O.size.width=I.width+G;O.size.height=I.height+F;O.position.top=J.top-F;O.position.left=J.left-G}}}}});var B=function(E){return parseInt(E,10)||0};var A=function(E){return !isNaN(parseInt(E,10))}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.selectable.js' */
/*
 * jQuery UI Selectable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.selectable",A.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var C=this;this.element.addClass("ui-selectable");this.dragged=false;var D;this.refresh=function(){D=A(C.options.filter,C.element[0]);D.addClass("ui-selectee");D.each(function(){var E=A(this);var F=E.offset();A.data(this,"selectable-item",{element:this,$element:E,left:F.left,top:F.top,right:F.left+E.outerWidth(),bottom:F.top+E.outerHeight(),startselected:false,selected:E.hasClass("ui-selected"),selecting:E.hasClass("ui-selecting"),unselecting:E.hasClass("ui-unselecting")})})};this.refresh();this.selectees=D.addClass("ui-selectee");this._mouseInit();this.helper=A("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(E){var C=this;this.opos=[E.pageX,E.pageY];if(this.options.disabled){return }var D=this.options;this.selectees=A(D.filter,this.element[0]);this._trigger("start",E);A(D.appendTo).append(this.helper);this.helper.css({left:E.clientX,top:E.clientY,width:0,height:0});if(D.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var F=A.data(this,"selectable-item");F.startselected=true;if(!E.metaKey&&!E.ctrlKey){F.$element.removeClass("ui-selected");F.selected=false;F.$element.addClass("ui-unselecting");F.unselecting=true;C._trigger("unselecting",E,{unselecting:F.element})}});A(E.target).parents().andSelf().each(function(){var G=A.data(this,"selectable-item");if(G){var F=(!E.metaKey&&!E.ctrlKey)||!G.$element.hasClass("ui-selected");G.$element.removeClass(F?"ui-unselecting":"ui-selected").addClass(F?"ui-selecting":"ui-unselecting");G.unselecting=!F;G.selecting=F;G.selected=F;if(F){C._trigger("selecting",E,{selecting:G.element})}else{C._trigger("unselecting",E,{unselecting:G.element})}return false}})},_mouseDrag:function(J){var D=this;this.dragged=true;if(this.options.disabled){return }var F=this.options;var E=this.opos[0],I=this.opos[1],C=J.pageX,H=J.pageY;if(E>C){var G=C;C=E;E=G}if(I>H){var G=H;H=I;I=G}this.helper.css({left:E,top:I,width:C-E,height:H-I});this.selectees.each(function(){var K=A.data(this,"selectable-item");if(!K||K.element==D.element[0]){return }var L=false;if(F.tolerance=="touch"){L=(!(K.left>C||K.right<E||K.top>H||K.bottom<I))}else{if(F.tolerance=="fit"){L=(K.left>E&&K.right<C&&K.top>I&&K.bottom<H)}}if(L){if(K.selected){K.$element.removeClass("ui-selected");K.selected=false}if(K.unselecting){K.$element.removeClass("ui-unselecting");K.unselecting=false}if(!K.selecting){K.$element.addClass("ui-selecting");K.selecting=true;D._trigger("selecting",J,{selecting:K.element})}}else{if(K.selecting){if((J.metaKey||J.ctrlKey)&&K.startselected){K.$element.removeClass("ui-selecting");K.selecting=false;K.$element.addClass("ui-selected");K.selected=true}else{K.$element.removeClass("ui-selecting");K.selecting=false;if(K.startselected){K.$element.addClass("ui-unselecting");K.unselecting=true}D._trigger("unselecting",J,{unselecting:K.element})}}if(K.selected){if(!J.metaKey&&!J.ctrlKey&&!K.startselected){K.$element.removeClass("ui-selected");K.selected=false;K.$element.addClass("ui-unselecting");K.unselecting=true;D._trigger("unselecting",J,{unselecting:K.element})}}}});return false},_mouseStop:function(E){var C=this;this.dragged=false;var D=this.options;A(".ui-unselecting",this.element[0]).each(function(){var F=A.data(this,"selectable-item");F.$element.removeClass("ui-unselecting");F.unselecting=false;F.startselected=false;C._trigger("unselected",E,{unselected:F.element})});A(".ui-selecting",this.element[0]).each(function(){var F=A.data(this,"selectable-item");F.$element.removeClass("ui-selecting").addClass("ui-selected");F.selecting=false;F.selected=true;F.startselected=true;C._trigger("selected",E,{selected:F.element})});this._trigger("stop",E);this.helper.remove();return false}});A.extend(A.ui.selectable,{version:"1.8.24"})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.accordion.js' */
/*
 * jQuery UI Accordion 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var C=this,D=C.options;C.running=0;C.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");C.headers=C.element.find(D.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){if(D.disabled){return }A(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){if(D.disabled){return }A(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){if(D.disabled){return }A(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){if(D.disabled){return }A(this).removeClass("ui-state-focus")});C.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(D.navigation){var E=C.element.find("a").filter(D.navigationFilter).eq(0);if(E.length){var F=E.closest(".ui-accordion-header");if(F.length){C.active=F}else{C.active=E.closest(".ui-accordion-content").prev()}}}C.active=C._findActive(C.active||D.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");C.active.next().addClass("ui-accordion-content-active");C._createIcons();C.resize();C.element.attr("role","tablist");C.headers.attr("role","tab").bind("keydown.accordion",function(G){return C._keydown(G)}).next().attr("role","tabpanel");C.headers.not(C.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!C.active.length){C.headers.eq(0).attr("tabIndex",0)}else{C.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!A.browser.safari){C.headers.find("a").attr("tabIndex",-1)}if(D.event){C.headers.bind(D.event.split(" ").join(".accordion ")+".accordion",function(G){C._clickHandler.call(C,G,this);G.preventDefault()})}},_createIcons:function(){var C=this.options;if(C.icons){A("<span></span>").addClass("ui-icon "+C.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(C.icons.header).toggleClass(C.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var C=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var D=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(C.autoHeight||C.fillHeight){D.css("height","")}return A.Widget.prototype.destroy.call(this)},_setOption:function(C,D){A.Widget.prototype._setOption.apply(this,arguments);if(C=="active"){this.activate(D)}if(C=="icons"){this._destroyIcons();if(D){this._createIcons()}}if(C=="disabled"){this.headers.add(this.headers.next())[D?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")}},_keydown:function(F){if(this.options.disabled||F.altKey||F.ctrlKey){return }var G=A.ui.keyCode,E=this.headers.length,C=this.headers.index(F.target),D=false;switch(F.keyCode){case G.RIGHT:case G.DOWN:D=this.headers[(C+1)%E];break;case G.LEFT:case G.UP:D=this.headers[(C-1+E)%E];break;case G.SPACE:case G.ENTER:this._clickHandler({target:F.target},F.target);F.preventDefault()}if(D){A(F.target).attr("tabIndex",-1);A(D).attr("tabIndex",0);D.focus();return false}return true},resize:function(){var C=this.options,E;if(C.fillSpace){if(A.browser.msie){var D=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}E=this.element.parent().height();if(A.browser.msie){this.element.parent().css("overflow",D)}this.headers.each(function(){E-=A(this).outerHeight(true)});this.headers.next().each(function(){A(this).height(Math.max(0,E-A(this).innerHeight()+A(this).height()))}).css("overflow","auto")}else{if(C.autoHeight){E=0;this.headers.next().each(function(){E=Math.max(E,A(this).height("").height())}).height(E)}}return this},activate:function(C){this.options.active=C;var D=this._findActive(C)[0];this._clickHandler({target:D},D);return this},_findActive:function(C){return C?typeof C==="number"?this.headers.filter(":eq("+C+")"):this.headers.not(this.headers.not(C)):C===false?A([]):this.headers.filter(":eq(0)")},_clickHandler:function(C,G){var L=this.options;if(L.disabled){return }if(!C.target){if(!L.collapsible){return }this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(L.icons.headerSelected).addClass(L.icons.header);this.active.next().addClass("ui-accordion-content-active");var I=this.active.next(),F={options:L,newHeader:A([]),oldHeader:L.active,newContent:A([]),oldContent:I},D=(this.active=A([]));this._toggle(D,I,F);return }var H=A(C.currentTarget||G),J=H[0]===this.active[0];L.active=L.collapsible&&J?false:this.headers.index(H);if(this.running||(!L.collapsible&&J)){return }var E=this.active,D=H.next(),I=this.active.next(),F={options:L,newHeader:J&&L.collapsible?A([]):H,oldHeader:this.active,newContent:J&&L.collapsible?A([]):D,oldContent:I},K=this.headers.index(this.active[0])>this.headers.index(H[0]);this.active=J?A([]):H;this._toggle(D,I,F,J,K);E.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(L.icons.headerSelected).addClass(L.icons.header);if(!J){H.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(L.icons.header).addClass(L.icons.headerSelected);H.next().addClass("ui-accordion-content-active")}return },_toggle:function(C,I,G,J,K){var M=this,N=M.options;M.toShow=C;M.toHide=I;M.data=G;var D=function(){if(!M){return }return M._completed.apply(M,arguments)};M._trigger("changestart",null,M.data);M.running=I.size()===0?C.size():I.size();if(N.animated){var F={};if(N.collapsible&&J){F={toShow:A([]),toHide:I,complete:D,down:K,autoHeight:N.autoHeight||N.fillSpace}}else{F={toShow:C,toHide:I,complete:D,down:K,autoHeight:N.autoHeight||N.fillSpace}}if(!N.proxied){N.proxied=N.animated}if(!N.proxiedDuration){N.proxiedDuration=N.duration}N.animated=A.isFunction(N.proxied)?N.proxied(F):N.proxied;N.duration=A.isFunction(N.proxiedDuration)?N.proxiedDuration(F):N.proxiedDuration;var L=A.ui.accordion.animations,E=N.duration,H=N.animated;if(H&&!L[H]&&!A.easing[H]){H="slide"}if(!L[H]){L[H]=function(O){this.slide(O,{easing:H,duration:E||700})}}L[H](F)}else{if(N.collapsible&&J){C.toggle()}else{I.hide();C.show()}D(true)}I.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();C.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(C){this.running=C?0:--this.running;if(this.running){return }if(this.options.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length){this.toHide.parent()[0].className=this.toHide.parent()[0].className}this._trigger("change",null,this.data)}});A.extend(A.ui.accordion,{version:"1.8.24",animations:{slide:function(K,I){K=A.extend({easing:"swing",duration:300},K,I);if(!K.toHide.size()){K.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},K);return }if(!K.toShow.size()){K.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},K);return }var D=K.toShow.css("overflow"),H=0,E={},G={},F=["height","paddingTop","paddingBottom"],C;var J=K.toShow;C=J[0].style.width;J.width(J.parent().width()-parseFloat(J.css("paddingLeft"))-parseFloat(J.css("paddingRight"))-(parseFloat(J.css("borderLeftWidth"))||0)-(parseFloat(J.css("borderRightWidth"))||0));A.each(F,function(L,N){G[N]="hide";var M=(""+A.css(K.toShow[0],N)).match(/^([\d+-.]+)(.*)$/);E[N]={value:M[1],unit:M[2]||"px"}});K.toShow.css({height:0,overflow:"hidden"}).show();K.toHide.filter(":hidden").each(K.complete).end().filter(":visible").animate(G,{step:function(L,M){if(M.prop=="height"){H=(M.end-M.start===0)?0:(M.now-M.start)/(M.end-M.start)}K.toShow[0].style[M.prop]=(H*E[M.prop].value)+E[M.prop].unit},duration:K.duration,easing:K.easing,complete:function(){if(!K.autoHeight){K.toShow.css("height","")}K.toShow.css({width:C,overflow:D});K.complete()}})},bounceslide:function(C){this.slide(C,{easing:C.down?"easeOutBounce":"swing",duration:C.down?1000:200})}}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.autocomplete.js' */
/*
 * jQuery UI Autocomplete 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
(function(A,B){var C=0;A.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var D=this,F=this.element[0].ownerDocument,E;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(G){if(D.options.disabled||D.element.propAttr("readOnly")){return }E=false;var H=A.ui.keyCode;switch(G.keyCode){case H.PAGE_UP:D._move("previousPage",G);break;case H.PAGE_DOWN:D._move("nextPage",G);break;case H.UP:D._keyEvent("previous",G);break;case H.DOWN:D._keyEvent("next",G);break;case H.ENTER:case H.NUMPAD_ENTER:if(D.menu.active){E=true;G.preventDefault()}case H.TAB:if(!D.menu.active){return }D.menu.select(G);break;case H.ESCAPE:D.element.val(D.term);D.close(G);break;default:clearTimeout(D.searching);D.searching=setTimeout(function(){if(D.term!=D.element.val()){D.selectedItem=null;D.search(null,G)}},D.options.delay);break}}).bind("keypress.autocomplete",function(G){if(E){E=false;G.preventDefault()}}).bind("focus.autocomplete",function(){if(D.options.disabled){return }D.selectedItem=null;D.previous=D.element.val()}).bind("blur.autocomplete",function(G){if(D.options.disabled){return }clearTimeout(D.searching);D.closing=setTimeout(function(){D.close(G);D._change(G)},150)});this._initSource();this.menu=A("<ul></ul>").addClass("ui-autocomplete").appendTo(A(this.options.appendTo||"body",F)[0]).mousedown(function(G){var H=D.menu.element[0];if(!A(G.target).closest(".ui-menu-item").length){setTimeout(function(){A(document).one("mousedown",function(I){if(I.target!==D.element[0]&&I.target!==H&&!A.ui.contains(H,I.target)){D.close()}})},1)}setTimeout(function(){clearTimeout(D.closing)},13)}).menu({focus:function(H,I){var G=I.item.data("item.autocomplete");if(false!==D._trigger("focus",H,{item:G})){if(/^key/.test(H.originalEvent.type)){D.element.val(G.value)}}},selected:function(I,J){var H=J.item.data("item.autocomplete"),G=D.previous;if(D.element[0]!==F.activeElement){D.element.focus();D.previous=G;setTimeout(function(){D.previous=G;D.selectedItem=H},1)}if(false!==D._trigger("select",I,{item:H})){D.element.val(H.value)}D.term=D.element.val();D.close(I);D.selectedItem=H},blur:function(G,H){if(D.menu.element.is(":visible")&&(D.element.val()!==D.term)){D.element.val(D.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(A.fn.bgiframe){this.menu.element.bgiframe()}D.beforeunloadHandler=function(){D.element.removeAttr("autocomplete")};A(window).bind("beforeunload",D.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();A(window).unbind("beforeunload",this.beforeunloadHandler);A.Widget.prototype.destroy.call(this)},_setOption:function(D,E){A.Widget.prototype._setOption.apply(this,arguments);if(D==="source"){this._initSource()}if(D==="appendTo"){this.menu.element.appendTo(A(E||"body",this.element[0].ownerDocument)[0])}if(D==="disabled"&&E&&this.xhr){this.xhr.abort()}},_initSource:function(){var D=this,F,E;if(A.isArray(this.options.source)){F=this.options.source;this.source=function(H,G){G(A.ui.autocomplete.filter(F,H.term))}}else{if(typeof this.options.source==="string"){E=this.options.source;this.source=function(H,G){if(D.xhr){D.xhr.abort()}D.xhr=A.ajax({url:E,data:H,dataType:"json",success:function(J,I){G(J)},error:function(){G([])}})}}else{this.source=this.options.source}}},search:function(E,D){E=E!=null?E:this.element.val();this.term=this.element.val();if(E.length<this.options.minLength){return this.close(D)}clearTimeout(this.closing);if(this._trigger("search",D)===false){return }return this._search(E)},_search:function(D){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:D},this._response())},_response:function(){var E=this,D=++C;return function(F){if(D===C){E.__response(F)}E.pending--;if(!E.pending){E.element.removeClass("ui-autocomplete-loading")}}},__response:function(D){if(!this.options.disabled&&D&&D.length){D=this._normalize(D);this._suggest(D);this._trigger("open")}else{this.close()}},close:function(D){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",D)}},_change:function(D){if(this.previous!==this.element.val()){this._trigger("change",D,{item:this.selectedItem})}},_normalize:function(D){if(D.length&&D[0].label&&D[0].value){return D}return A.map(D,function(E){if(typeof E==="string"){return{label:E,value:E}}return A.extend({label:E.label||E.value,value:E.value||E.label},E)})},_suggest:function(D){var E=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(E,D);this.menu.deactivate();this.menu.refresh();E.show();this._resizeMenu();E.position(A.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new A.Event("mouseover"))}},_resizeMenu:function(){var D=this.menu.element;D.outerWidth(Math.max(D.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(F,E){var D=this;A.each(E,function(G,H){D._renderItem(F,H)})},_renderItem:function(D,E){return A("<li></li>").data("item.autocomplete",E).append(A("<a></a>").text(E.label)).appendTo(D)},_move:function(E,D){if(!this.menu.element.is(":visible")){this.search(null,D);return }if(this.menu.first()&&/^previous/.test(E)||this.menu.last()&&/^next/.test(E)){this.element.val(this.term);this.menu.deactivate();return }this.menu[E](D)},widget:function(){return this.menu.element},_keyEvent:function(E,D){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(E,D);D.preventDefault()}}});A.extend(A.ui.autocomplete,{escapeRegex:function(D){return D.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(F,D){var E=new RegExp(A.ui.autocomplete.escapeRegex(D),"i");return A.grep(F,function(G){return E.test(G.label||G.value||G)})}})}(jQuery));(function(A){A.widget("ui.menu",{_create:function(){var B=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(C){if(!A(C.target).closest(".ui-menu-item a").length){return }C.preventDefault();B.select(C)});this.refresh()},refresh:function(){var C=this;var B=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");B.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(D){C.activate(D,A(this).parent())}).mouseleave(function(){C.deactivate()})},activate:function(E,D){this.deactivate();if(this.hasScroll()){var F=D.offset().top-this.element.offset().top,B=this.element.scrollTop(),C=this.element.height();if(F<0){this.element.scrollTop(B+F)}else{if(F>=C){this.element.scrollTop(B+F-C+D.height())}}}this.active=D.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",E,{item:D})},deactivate:function(){if(!this.active){return }this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(B){this.move("next",".ui-menu-item:first",B)},previous:function(B){this.move("prev",".ui-menu-item:last",B)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(E,D,C){if(!this.active){this.activate(C,this.element.children(D));return }var B=this.active[E+"All"](".ui-menu-item").eq(0);if(B.length){this.activate(C,B)}else{this.activate(C,this.element.children(D))}},nextPage:function(D){if(this.hasScroll()){if(!this.active||this.last()){this.activate(D,this.element.children(".ui-menu-item:first"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children(".ui-menu-item").filter(function(){var F=A(this).offset().top-E-C+A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(".ui-menu-item:last")}this.activate(D,B)}else{this.activate(D,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(D){if(this.hasScroll()){if(!this.active||this.first()){this.activate(D,this.element.children(".ui-menu-item:last"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children(".ui-menu-item").filter(function(){var F=A(this).offset().top-E+C-A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(".ui-menu-item:first")}this.activate(D,B)}else{this.activate(D,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[A.fn.prop?"prop":"attr"]("scrollHeight")},select:function(B){this._trigger("selected",B,{item:this.active})}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.button.js' */
/*
 * jQuery UI Button 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(F,B){var K,E,A,H,I="ui-button ui-widget ui-state-default ui-corner-all",C="ui-state-hover ui-state-active ",G="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",J=function(){var L=F(this).find(":ui-button");setTimeout(function(){L.button("refresh")},1)},D=function(M){var L=M.name,N=M.form,O=F([]);if(L){if(N){O=F(N).find("[name='"+L+"']")}else{O=F("[name='"+L+"']",M.ownerDocument).filter(function(){return !this.form})}}return O};F.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",J);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.propAttr("disabled")}else{this.element.propAttr("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var L=this,N=this.options,O=this.type==="checkbox"||this.type==="radio",P="ui-state-hover"+(!O?" ui-state-active":""),M="ui-state-focus";if(N.label===null){N.label=this.buttonElement.html()}this.buttonElement.addClass(I).attr("role","button").bind("mouseenter.button",function(){if(N.disabled){return }F(this).addClass("ui-state-hover");if(this===K){F(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){if(N.disabled){return }F(this).removeClass(P)}).bind("click.button",function(Q){if(N.disabled){Q.preventDefault();Q.stopImmediatePropagation()}});this.element.bind("focus.button",function(){L.buttonElement.addClass(M)}).bind("blur.button",function(){L.buttonElement.removeClass(M)});if(O){this.element.bind("change.button",function(){if(H){return }L.refresh()});this.buttonElement.bind("mousedown.button",function(Q){if(N.disabled){return }H=false;E=Q.pageX;A=Q.pageY}).bind("mouseup.button",function(Q){if(N.disabled){return }if(E!==Q.pageX||A!==Q.pageY){H=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(N.disabled||H){return false}F(this).toggleClass("ui-state-active");L.buttonElement.attr("aria-pressed",L.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(N.disabled||H){return false}F(this).addClass("ui-state-active");L.buttonElement.attr("aria-pressed","true");var Q=L.element[0];D(Q).not(Q).map(function(){return F(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown.button",function(){if(N.disabled){return false}F(this).addClass("ui-state-active");K=this;F(document).one("mouseup",function(){K=null})}).bind("mouseup.button",function(){if(N.disabled){return false}F(this).removeClass("ui-state-active")}).bind("keydown.button",function(Q){if(N.disabled){return false}if(Q.keyCode==F.ui.keyCode.SPACE||Q.keyCode==F.ui.keyCode.ENTER){F(this).addClass("ui-state-active")}}).bind("keyup.button",function(){F(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(Q){if(Q.keyCode===F.ui.keyCode.SPACE){F(this).click()}})}}}this._setOption("disabled",N.disabled);this._resetButton()},_determineButtonType:function(){if(this.element.is(":checkbox")){this.type="checkbox"}else{if(this.element.is(":radio")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){var L=this.element.parents().filter(":last"),N="label[for='"+this.element.attr("id")+"']";this.buttonElement=L.find(N);if(!this.buttonElement.length){L=L.length?L.siblings():this.element.siblings();this.buttonElement=L.filter(N);if(!this.buttonElement.length){this.buttonElement=L.find(N)}}this.element.addClass("ui-helper-hidden-accessible");var M=this.element.is(":checked");if(M){this.buttonElement.addClass("ui-state-active")}this.buttonElement.attr("aria-pressed",M)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(I+" "+C+" "+G).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}F.Widget.prototype.destroy.call(this)},_setOption:function(L,M){F.Widget.prototype._setOption.apply(this,arguments);if(L==="disabled"){if(M){this.element.propAttr("disabled",true)}else{this.element.propAttr("disabled",false)}return }this._resetButton()},refresh:function(){var L=this.element.is(":disabled");if(L!==this.options.disabled){this._setOption("disabled",L)}if(this.type==="radio"){D(this.element[0]).each(function(){if(F(this).is(":checked")){F(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{F(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return }var P=this.buttonElement.removeClass(G),N=F("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(P.empty()).text(),M=this.options.icons,L=M.primary&&M.secondary,O=[];if(M.primary||M.secondary){if(this.options.text){O.push("ui-button-text-icon"+(L?"s":(M.primary?"-primary":"-secondary")))}if(M.primary){P.prepend("<span class='ui-button-icon-primary ui-icon "+M.primary+"'></span>")}if(M.secondary){P.append("<span class='ui-button-icon-secondary ui-icon "+M.secondary+"'></span>")}if(!this.options.text){O.push(L?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){P.attr("title",N)}}}else{O.push("ui-button-text-only")}P.addClass(O.join(" "))}});F.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(L,M){if(L==="disabled"){this.buttons.button("option",L,M)}F.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var L=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return F(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(L?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(L?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return F(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");F.Widget.prototype.destroy.call(this)}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.datepicker.js' */
/*
 * jQuery UI Datepicker 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.24"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return }this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!=input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return }divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}var onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){var dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){$.datepicker.log(err)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return }var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}var beforeShow=$.datepicker._get(inst,"beforeShow");var beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return }extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft());var viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return }if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&$.effects[showAnim]){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return }var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=inst)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return }this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return }var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof (inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return }var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths");var id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,-stepMonths,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(id)},selectDay:function(){window["DP_jQuery_"+dpuuid].datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' data-handler="selectDay" data-event="click" data-month="'+printDate.getMonth()+'" data-year="'+printDate.getFullYear()+'"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.bind("mouseout",function(event){var elem=$(event.target).closest(selector);if(!elem.length){return }elem.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(event){var elem=$(event.target).closest(selector);if($.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||!elem.length){return }elem.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");elem.addClass("ui-state-hover");if(elem.hasClass("ui-datepicker-prev")){elem.addClass("ui-datepicker-prev-hover")}if(elem.hasClass("ui-datepicker-next")){elem.addClass("ui-datepicker-next-hover")}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.8.24";window["DP_jQuery_"+dpuuid]=$})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.dialog.js' */
/*
 * jQuery UI Dialog 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(D,E){var B="ui-dialog ui-widget ui-widget-content ui-corner-all ",A={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},C={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};D.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(G){var F=D(this).css(G).offset().top;if(F<0){D(this).css("top",G.top-F)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var N=this,O=N.options,L=O.title||"&#160;",G=D.ui.dialog.getTitleId(N.element),M=(N.uiDialog=D("<div></div>")).appendTo(document.body).hide().addClass(B+O.dialogClass).css({zIndex:O.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(P){if(O.closeOnEscape&&!P.isDefaultPrevented()&&P.keyCode&&P.keyCode===D.ui.keyCode.ESCAPE){N.close(P);P.preventDefault()}}).attr({role:"dialog","aria-labelledby":G}).mousedown(function(P){N.moveToTop(false,P)}),I=N.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(M),H=(N.uiDialogTitlebar=D("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(M),K=D('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){K.addClass("ui-state-hover")},function(){K.removeClass("ui-state-hover")}).focus(function(){K.addClass("ui-state-focus")}).blur(function(){K.removeClass("ui-state-focus")}).click(function(P){N.close(P);return false}).appendTo(H),J=(N.uiDialogTitlebarCloseText=D("<span></span>")).addClass("ui-icon ui-icon-closethick").text(O.closeText).appendTo(K),F=D("<span></span>").addClass("ui-dialog-title").attr("id",G).html(L).prependTo(H);if(D.isFunction(O.beforeclose)&&!D.isFunction(O.beforeClose)){O.beforeClose=O.beforeclose}H.find("*").add(H).disableSelection();if(O.draggable&&D.fn.draggable){N._makeDraggable()}if(O.resizable&&D.fn.resizable){N._makeResizable()}N._createButtons(O.buttons);N._isOpen=false;if(D.fn.bgiframe){M.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},destroy:function(){var F=this;if(F.overlay){F.overlay.destroy()}F.uiDialog.hide();F.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");F.uiDialog.remove();if(F.originalTitle){F.element.attr("title",F.originalTitle)}return F},widget:function(){return this.uiDialog},close:function(I){var F=this,H,G;if(false===F._trigger("beforeClose",I)){return }if(F.overlay){F.overlay.destroy()}F.uiDialog.unbind("keypress.ui-dialog");F._isOpen=false;if(F.options.hide){F.uiDialog.hide(F.options.hide,function(){F._trigger("close",I)})}else{F.uiDialog.hide();F._trigger("close",I)}D.ui.dialog.overlay.resize();if(F.options.modal){H=0;D(".ui-dialog").each(function(){if(this!==F.uiDialog[0]){G=D(this).css("z-index");if(!isNaN(G)){H=Math.max(H,G)}}});D.ui.dialog.maxZ=H}return F},isOpen:function(){return this._isOpen},moveToTop:function(J,I){var F=this,H=F.options,G;if((H.modal&&!J)||(!H.stack&&!H.modal)){return F._trigger("focus",I)}if(H.zIndex>D.ui.dialog.maxZ){D.ui.dialog.maxZ=H.zIndex}if(F.overlay){D.ui.dialog.maxZ+=1;F.overlay.$el.css("z-index",D.ui.dialog.overlay.maxZ=D.ui.dialog.maxZ)}G={scrollTop:F.element.scrollTop(),scrollLeft:F.element.scrollLeft()};D.ui.dialog.maxZ+=1;F.uiDialog.css("z-index",D.ui.dialog.maxZ);F.element.attr(G);F._trigger("focus",I);return F},open:function(){if(this._isOpen){return }var G=this,H=G.options,F=G.uiDialog;G.overlay=H.modal?new D.ui.dialog.overlay(G):null;G._size();G._position(H.position);F.show(H.show);G.moveToTop(true);if(H.modal){F.bind("keydown.ui-dialog",function(K){if(K.keyCode!==D.ui.keyCode.TAB){return }var J=D(":tabbable",this),L=J.filter(":first"),I=J.filter(":last");if(K.target===I[0]&&!K.shiftKey){L.focus(1);return false}else{if(K.target===L[0]&&K.shiftKey){I.focus(1);return false}}})}D(G.element.find(":tabbable").get().concat(F.find(".ui-dialog-buttonpane :tabbable").get().concat(F.get()))).eq(0).focus();G._isOpen=true;G._trigger("open");return G},_createButtons:function(I){var H=this,F=false,G=D("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),J=D("<div></div>").addClass("ui-dialog-buttonset").appendTo(G);H.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof I==="object"&&I!==null){D.each(I,function(){return !(F=true)})}if(F){D.each(I,function(K,M){M=D.isFunction(M)?{click:M,text:K}:M;var L=D('<button type="button"></button>').click(function(){M.click.apply(H.element[0],arguments)}).appendTo(J);D.each(M,function(N,O){if(N==="click"){return }if(N in L){L[N](O)}else{L.attr(N,O)}});if(D.fn.button){L.button()}});G.appendTo(H.uiDialog)}},_makeDraggable:function(){var F=this,I=F.options,J=D(document),H;function G(K){return{position:K.position,offset:K.offset}}F.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(K,L){H=I.height==="auto"?"auto":D(this).height();D(this).height(D(this).height()).addClass("ui-dialog-dragging");F._trigger("dragStart",K,G(L))},drag:function(K,L){F._trigger("drag",K,G(L))},stop:function(K,L){I.position=[L.position.left-J.scrollLeft(),L.position.top-J.scrollTop()];D(this).removeClass("ui-dialog-dragging").height(H);F._trigger("dragStop",K,G(L));D.ui.dialog.overlay.resize()}})},_makeResizable:function(K){K=(K===E?this.options.resizable:K);var G=this,J=G.options,F=G.uiDialog.css("position"),I=(typeof K==="string"?K:"n,e,s,w,se,sw,ne,nw");function H(L){return{originalPosition:L.originalPosition,originalSize:L.originalSize,position:L.position,size:L.size}}G.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:G.element,maxWidth:J.maxWidth,maxHeight:J.maxHeight,minWidth:J.minWidth,minHeight:G._minHeight(),handles:I,start:function(L,M){D(this).addClass("ui-dialog-resizing");G._trigger("resizeStart",L,H(M))},resize:function(L,M){G._trigger("resize",L,H(M))},stop:function(L,M){D(this).removeClass("ui-dialog-resizing");J.height=D(this).height();J.width=D(this).width();G._trigger("resizeStop",L,H(M));D.ui.dialog.overlay.resize()}}).css("position",F).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var F=this.options;if(F.height==="auto"){return F.minHeight}else{return Math.min(F.minHeight,F.height)}},_position:function(G){var H=[],I=[0,0],F;if(G){if(typeof G==="string"||(typeof G==="object"&&"0" in G)){H=G.split?G.split(" "):[G[0],G[1]];if(H.length===1){H[1]=H[0]}D.each(["left","top"],function(K,J){if(+H[K]===H[K]){I[K]=H[K];H[K]=J}});G={my:H.join(" "),at:H.join(" "),offset:I.join(" ")}}G=D.extend({},D.ui.dialog.prototype.options.position,G)}else{G=D.ui.dialog.prototype.options.position}F=this.uiDialog.is(":visible");if(!F){this.uiDialog.show()}this.uiDialog.css({top:0,left:0}).position(D.extend({of:window},G));if(!F){this.uiDialog.hide()}},_setOptions:function(I){var G=this,F={},H=false;D.each(I,function(J,K){G._setOption(J,K);if(J in A){H=true}if(J in C){F[J]=K}});if(H){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",F)}},_setOption:function(I,J){var G=this,F=G.uiDialog;switch(I){case"beforeclose":I="beforeClose";break;case"buttons":G._createButtons(J);break;case"closeText":G.uiDialogTitlebarCloseText.text(""+J);break;case"dialogClass":F.removeClass(G.options.dialogClass).addClass(B+J);break;case"disabled":if(J){F.addClass("ui-dialog-disabled")}else{F.removeClass("ui-dialog-disabled")}break;case"draggable":var H=F.is(":data(draggable)");if(H&&!J){F.draggable("destroy")}if(!H&&J){G._makeDraggable()}break;case"position":G._position(J);break;case"resizable":var K=F.is(":data(resizable)");if(K&&!J){F.resizable("destroy")}if(K&&typeof J==="string"){F.resizable("option","handles",J)}if(!K&&J!==false){G._makeResizable(J)}break;case"title":D(".ui-dialog-title",G.uiDialogTitlebar).html(""+(J||"&#160;"));break}D.Widget.prototype._setOption.apply(G,arguments)},_size:function(){var J=this.options,G,I,F=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(J.minWidth>J.width){J.width=J.minWidth}G=this.uiDialog.css({height:"auto",width:J.width}).height();I=Math.max(0,J.minHeight-G);if(J.height==="auto"){if(D.support.minHeight){this.element.css({minHeight:I,height:"auto"})}else{this.uiDialog.show();var H=this.element.css("height","auto").height();if(!F){this.uiDialog.hide()}this.element.height(Math.max(H,I))}}else{this.element.height(Math.max(J.height-G,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});D.extend(D.ui.dialog,{version:"1.8.24",uuid:0,maxZ:0,getTitleId:function(F){var G=F.attr("id");if(!G){this.uuid+=1;G=this.uuid}return"ui-dialog-title-"+G},overlay:function(F){this.$el=D.ui.dialog.overlay.create(F)}});D.extend(D.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:D.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(F){return F+".dialog-overlay"}).join(" "),create:function(G){if(this.instances.length===0){setTimeout(function(){if(D.ui.dialog.overlay.instances.length){D(document).bind(D.ui.dialog.overlay.events,function(H){if(D(H.target).zIndex()<D.ui.dialog.overlay.maxZ){return false}})}},1);D(document).bind("keydown.dialog-overlay",function(H){if(G.options.closeOnEscape&&!H.isDefaultPrevented()&&H.keyCode&&H.keyCode===D.ui.keyCode.ESCAPE){G.close(H);H.preventDefault()}});D(window).bind("resize.dialog-overlay",D.ui.dialog.overlay.resize)}var F=(this.oldInstances.pop()||D("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if(D.fn.bgiframe){F.bgiframe()}this.instances.push(F);return F},destroy:function(F){var G=D.inArray(F,this.instances);if(G!=-1){this.oldInstances.push(this.instances.splice(G,1)[0])}if(this.instances.length===0){D([document,window]).unbind(".dialog-overlay")}F.remove();var H=0;D.each(this.instances,function(){H=Math.max(H,this.css("z-index"))});this.maxZ=H},height:function(){var G,F;if(D.browser.msie&&D.browser.version<7){G=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);F=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(G<F){return D(window).height()+"px"}else{return G+"px"}}else{return D(document).height()+"px"}},width:function(){var F,G;if(D.browser.msie){F=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);G=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(F<G){return D(window).width()+"px"}else{return F+"px"}}else{return D(document).width()+"px"}},resize:function(){var F=D([]);D.each(D.ui.dialog.overlay.instances,function(){F=F.add(this)});F.css({width:0,height:0}).css({width:D.ui.dialog.overlay.width(),height:D.ui.dialog.overlay.height()})}});D.extend(D.ui.dialog.overlay.prototype,{destroy:function(){D.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.progressbar.js' */
/*
 * jQuery UI Progressbar 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=A("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();A.Widget.prototype.destroy.apply(this,arguments)},value:function(C){if(C===B){return this._value()}this._setOption("value",C);return this},_setOption:function(C,D){if(C==="value"){this.options.value=D;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}A.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var C=this.options.value;if(typeof C!=="number"){C=0}return Math.min(this.options.max,Math.max(this.min,C))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var D=this.value();var C=this._percentage();if(this.oldValue!==D){this.oldValue=D;this._trigger("change")}this.valueDiv.toggle(D>this.min).toggleClass("ui-corner-right",D===this.options.max).width(C.toFixed(0)+"%");this.element.attr("aria-valuenow",D)}});A.extend(A.ui.progressbar,{version:"1.8.24"})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.slider.js' */
/*
 * jQuery UI Slider 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(B,C){var A=5;B.widget("ui.slider",B.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var E=this,J=this.options,I=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),H="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",D=(J.values&&J.values.length)||1,G=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(J.disabled?" ui-slider-disabled ui-disabled":""));this.range=B([]);if(J.range){if(J.range===true){if(!J.values){J.values=[this._valueMin(),this._valueMin()]}if(J.values.length&&J.values.length!==2){J.values=[J.values[0],J.values[0]]}}this.range=B("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((J.range==="min"||J.range==="max")?" ui-slider-range-"+J.range:""))}for(var F=I.length;F<D;F+=1){G.push(H)}this.handles=I.add(B(G.join("")).appendTo(E.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(K){K.preventDefault()}).hover(function(){if(!J.disabled){B(this).addClass("ui-state-hover")}},function(){B(this).removeClass("ui-state-hover")}).focus(function(){if(!J.disabled){B(".ui-slider .ui-state-focus").removeClass("ui-state-focus");B(this).addClass("ui-state-focus")}else{B(this).blur()}}).blur(function(){B(this).removeClass("ui-state-focus")});this.handles.each(function(K){B(this).data("index.ui-slider-handle",K)});this.handles.keydown(function(O){var L=B(this).data("index.ui-slider-handle"),P,M,K,N;if(E.options.disabled){return }switch(O.keyCode){case B.ui.keyCode.HOME:case B.ui.keyCode.END:case B.ui.keyCode.PAGE_UP:case B.ui.keyCode.PAGE_DOWN:case B.ui.keyCode.UP:case B.ui.keyCode.RIGHT:case B.ui.keyCode.DOWN:case B.ui.keyCode.LEFT:O.preventDefault();if(!E._keySliding){E._keySliding=true;B(this).addClass("ui-state-active");P=E._start(O,L);if(P===false){return }}break}N=E.options.step;if(E.options.values&&E.options.values.length){M=K=E.values(L)}else{M=K=E.value()}switch(O.keyCode){case B.ui.keyCode.HOME:K=E._valueMin();break;case B.ui.keyCode.END:K=E._valueMax();break;case B.ui.keyCode.PAGE_UP:K=E._trimAlignValue(M+((E._valueMax()-E._valueMin())/A));break;case B.ui.keyCode.PAGE_DOWN:K=E._trimAlignValue(M-((E._valueMax()-E._valueMin())/A));break;case B.ui.keyCode.UP:case B.ui.keyCode.RIGHT:if(M===E._valueMax()){return }K=E._trimAlignValue(M+N);break;case B.ui.keyCode.DOWN:case B.ui.keyCode.LEFT:if(M===E._valueMin()){return }K=E._trimAlignValue(M-N);break}E._slide(O,L,K)}).keyup(function(L){var K=B(this).data("index.ui-slider-handle");if(E._keySliding){E._keySliding=false;E._stop(L,K);E._change(L,K);B(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(F){var G=this.options,J,L,E,H,N,K,M,I,D;if(G.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();J={x:F.pageX,y:F.pageY};L=this._normValueFromMouse(J);E=this._valueMax()-this._valueMin()+1;N=this;this.handles.each(function(O){var P=Math.abs(L-N.values(O));if(E>P){E=P;H=B(this);K=O}});if(G.range===true&&this.values(1)===G.min){K+=1;H=B(this.handles[K])}M=this._start(F,K);if(M===false){return false}this._mouseSliding=true;N._handleIndex=K;H.addClass("ui-state-active").focus();I=H.offset();D=!B(F.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=D?{left:0,top:0}:{left:F.pageX-I.left-(H.width()/2),top:F.pageY-I.top-(H.height()/2)-(parseInt(H.css("borderTopWidth"),10)||0)-(parseInt(H.css("borderBottomWidth"),10)||0)+(parseInt(H.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(F,K,L)}this._animateOff=true;return true},_mouseStart:function(D){return true},_mouseDrag:function(F){var D={x:F.pageX,y:F.pageY},E=this._normValueFromMouse(D);this._slide(F,this._handleIndex,E);return false},_mouseStop:function(D){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(D,this._handleIndex);this._change(D,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(E){var D,H,G,F,I;if(this.orientation==="horizontal"){D=this.elementSize.width;H=E.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{D=this.elementSize.height;H=E.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}G=(H/D);if(G>1){G=1}if(G<0){G=0}if(this.orientation==="vertical"){G=1-G}F=this._valueMax()-this._valueMin();I=this._valueMin()+G*F;return this._trimAlignValue(I)},_start:function(F,E){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}return this._trigger("start",F,D)},_slide:function(H,G,F){var D,E,I;if(this.options.values&&this.options.values.length){D=this.values(G?0:1);if((this.options.values.length===2&&this.options.range===true)&&((G===0&&F>D)||(G===1&&F<D))){F=D}if(F!==this.values(G)){E=this.values();E[G]=F;I=this._trigger("slide",H,{handle:this.handles[G],value:F,values:E});D=this.values(G?0:1);if(I!==false){this.values(G,F,true)}}}else{if(F!==this.value()){I=this._trigger("slide",H,{handle:this.handles[G],value:F});if(I!==false){this.value(F)}}}},_stop:function(F,E){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}this._trigger("stop",F,D)},_change:function(F,E){if(!this._keySliding&&!this._mouseSliding){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}this._trigger("change",F,D)}},value:function(D){if(arguments.length){this.options.value=this._trimAlignValue(D);this._refreshValue();this._change(null,0);return }return this._value()},values:function(E,H){var G,D,F;if(arguments.length>1){this.options.values[E]=this._trimAlignValue(H);this._refreshValue();this._change(null,E);return }if(arguments.length){if(B.isArray(arguments[0])){G=this.options.values;D=arguments[0];for(F=0;F<G.length;F+=1){G[F]=this._trimAlignValue(D[F]);this._change(null,F)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(E)}else{return this.value()}}}else{return this._values()}},_setOption:function(E,F){var D,G=0;if(B.isArray(this.options.values)){G=this.options.values.length}B.Widget.prototype._setOption.apply(this,arguments);switch(E){case"disabled":if(F){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.propAttr("disabled",true);this.element.addClass("ui-disabled")}else{this.handles.propAttr("disabled",false);this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(D=0;D<G;D+=1){this._change(null,D)}this._animateOff=false;break}},_value:function(){var D=this.options.value;D=this._trimAlignValue(D);return D},_values:function(D){var G,F,E;if(arguments.length){G=this.options.values[D];G=this._trimAlignValue(G);return G}else{F=this.options.values.slice();for(E=0;E<F.length;E+=1){F[E]=this._trimAlignValue(F[E])}return F}},_trimAlignValue:function(G){if(G<=this._valueMin()){return this._valueMin()}if(G>=this._valueMax()){return this._valueMax()}var D=(this.options.step>0)?this.options.step:1,F=(G-this._valueMin())%D,E=G-F;if(Math.abs(F)*2>=D){E+=(F>0)?D:(-D)}return parseFloat(E.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var G=this.options.range,F=this.options,M=this,E=(!this._animateOff)?F.animate:false,H,D={},I,K,J,L;if(this.options.values&&this.options.values.length){this.handles.each(function(O,N){H=(M.values(O)-M._valueMin())/(M._valueMax()-M._valueMin())*100;D[M.orientation==="horizontal"?"left":"bottom"]=H+"%";B(this).stop(1,1)[E?"animate":"css"](D,F.animate);if(M.options.range===true){if(M.orientation==="horizontal"){if(O===0){M.range.stop(1,1)[E?"animate":"css"]({left:H+"%"},F.animate)}if(O===1){M.range[E?"animate":"css"]({width:(H-I)+"%"},{queue:false,duration:F.animate})}}else{if(O===0){M.range.stop(1,1)[E?"animate":"css"]({bottom:(H)+"%"},F.animate)}if(O===1){M.range[E?"animate":"css"]({height:(H-I)+"%"},{queue:false,duration:F.animate})}}}I=H})}else{K=this.value();J=this._valueMin();L=this._valueMax();H=(L!==J)?(K-J)/(L-J)*100:0;D[M.orientation==="horizontal"?"left":"bottom"]=H+"%";this.handle.stop(1,1)[E?"animate":"css"](D,F.animate);if(G==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[E?"animate":"css"]({width:H+"%"},F.animate)}if(G==="max"&&this.orientation==="horizontal"){this.range[E?"animate":"css"]({width:(100-H)+"%"},{queue:false,duration:F.animate})}if(G==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[E?"animate":"css"]({height:H+"%"},F.animate)}if(G==="max"&&this.orientation==="vertical"){this.range[E?"animate":"css"]({height:(100-H)+"%"},{queue:false,duration:F.animate})}}}});B.extend(B.ui.slider,{version:"1.8.24"})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.ui.tabs.js' */
/*
 * jQuery UI Tabs 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(D,F){var C=0,B=0;function E(){return ++C}function A(){return ++B}D.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(G,H){if(G=="selected"){if(this.options.collapsible&&H==this.options.selected){return }this.select(H)}else{this.options[G]=H;this._tabify()}},_tabId:function(G){return G.title&&G.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+E()},_sanitizeSelector:function(G){return G.replace(/:/g,"\\:")},_cookie:function(){var G=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+A());return D.cookie.apply(null,[G].concat(D.makeArray(arguments)))},_ui:function(H,G){return{tab:H,panel:G,index:this.anchors.index(H)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var G=D(this);G.html(G.data("label.tabs")).removeData("label.tabs")})},_tabify:function(R){var S=this,I=this.options,H=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=D(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return D("a",this)[0]});this.panels=D([]);this.anchors.each(function(V,T){var U=D(T).attr("href");var W=U.split("#")[0],X;if(W&&(W===location.toString().split("#")[0]||(X=D("base")[0])&&W===X.href)){U=T.hash;T.href=U}if(H.test(U)){S.panels=S.panels.add(S.element.find(S._sanitizeSelector(U)))}else{if(U&&U!=="#"){D.data(T,"href.tabs",U);D.data(T,"load.tabs",U.replace(/#.*$/,""));var Z=S._tabId(T);T.href="#"+Z;var Y=S.element.find("#"+Z);if(!Y.length){Y=D(I.panelTemplate).attr("id",Z).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(S.panels[V-1]||S.list);Y.data("destroy.tabs",true)}S.panels=S.panels.add(Y)}else{I.disabled.push(V)}}});if(R){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(I.selected===F){if(location.hash){this.anchors.each(function(U,T){if(T.hash==location.hash){I.selected=U;return false}})}if(typeof I.selected!=="number"&&I.cookie){I.selected=parseInt(S._cookie(),10)}if(typeof I.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){I.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}I.selected=I.selected||(this.lis.length?0:-1)}else{if(I.selected===null){I.selected=-1}}I.selected=((I.selected>=0&&this.anchors[I.selected])||I.selected<0)?I.selected:0;I.disabled=D.unique(I.disabled.concat(D.map(this.lis.filter(".ui-state-disabled"),function(U,T){return S.lis.index(U)}))).sort();if(D.inArray(I.selected,I.disabled)!=-1){I.disabled.splice(D.inArray(I.selected,I.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(I.selected>=0&&this.anchors.length){S.element.find(S._sanitizeSelector(S.anchors[I.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(I.selected).addClass("ui-tabs-selected ui-state-active");S.element.queue("tabs",function(){S._trigger("show",null,S._ui(S.anchors[I.selected],S.element.find(S._sanitizeSelector(S.anchors[I.selected].hash))[0]))});this.load(I.selected)}D(window).bind("unload",function(){S.lis.add(S.anchors).unbind(".tabs");S.lis=S.anchors=S.panels=null})}else{I.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[I.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(I.cookie){this._cookie(I.selected,I.cookie)}for(var L=0,Q;(Q=this.lis[L]);L++){D(Q)[D.inArray(L,I.disabled)!=-1&&!D(Q).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(I.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(I.event!=="mouseover"){var K=function(U,T){if(T.is(":not(.ui-state-disabled)")){T.addClass("ui-state-"+U)}};var N=function(U,T){T.removeClass("ui-state-"+U)};this.lis.bind("mouseover.tabs",function(){K("hover",D(this))});this.lis.bind("mouseout.tabs",function(){N("hover",D(this))});this.anchors.bind("focus.tabs",function(){K("focus",D(this).closest("li"))});this.anchors.bind("blur.tabs",function(){N("focus",D(this).closest("li"))})}var G,M;if(I.fx){if(D.isArray(I.fx)){G=I.fx[0];M=I.fx[1]}else{G=M=I.fx}}function J(T,U){T.css("display","");if(!D.support.opacity&&U.opacity){T[0].style.removeAttribute("filter")}}var O=M?function(T,U){D(T).closest("li").addClass("ui-tabs-selected ui-state-active");U.hide().removeClass("ui-tabs-hide").animate(M,M.duration||"normal",function(){J(U,M);S._trigger("show",null,S._ui(T,U[0]))})}:function(T,U){D(T).closest("li").addClass("ui-tabs-selected ui-state-active");U.removeClass("ui-tabs-hide");S._trigger("show",null,S._ui(T,U[0]))};var P=G?function(U,T){T.animate(G,G.duration||"normal",function(){S.lis.removeClass("ui-tabs-selected ui-state-active");T.addClass("ui-tabs-hide");J(T,G);S.element.dequeue("tabs")})}:function(U,T,V){S.lis.removeClass("ui-tabs-selected ui-state-active");T.addClass("ui-tabs-hide");S.element.dequeue("tabs")};this.anchors.bind(I.event+".tabs",function(){var U=this,W=D(U).closest("li"),T=S.panels.filter(":not(.ui-tabs-hide)"),V=S.element.find(S._sanitizeSelector(U.hash));if((W.hasClass("ui-tabs-selected")&&!I.collapsible)||W.hasClass("ui-state-disabled")||W.hasClass("ui-state-processing")||S.panels.filter(":animated").length||S._trigger("select",null,S._ui(this,V[0]))===false){this.blur();return false}I.selected=S.anchors.index(this);S.abort();if(I.collapsible){if(W.hasClass("ui-tabs-selected")){I.selected=-1;if(I.cookie){S._cookie(I.selected,I.cookie)}S.element.queue("tabs",function(){P(U,T)}).dequeue("tabs");this.blur();return false}else{if(!T.length){if(I.cookie){S._cookie(I.selected,I.cookie)}S.element.queue("tabs",function(){O(U,V)});S.load(S.anchors.index(this));this.blur();return false}}}if(I.cookie){S._cookie(I.selected,I.cookie)}if(V.length){if(T.length){S.element.queue("tabs",function(){P(U,T)})}S.element.queue("tabs",function(){O(U,V)});S.load(S.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(D.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(G){if(typeof G=="string"){G=this.anchors.index(this.anchors.filter("[href$='"+G+"']"))}return G},destroy:function(){var G=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var H=D.data(this,"href.tabs");if(H){this.href=H}var I=D(this).unbind(".tabs");D.each(["href","load","cache"],function(J,K){I.removeData(K+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(D.data(this,"destroy.tabs")){D(this).remove()}else{D(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}});if(G.cookie){this._cookie(null,G.cookie)}return this},add:function(J,I,H){if(H===F){H=this.anchors.length}var G=this,L=this.options,N=D(L.tabTemplate.replace(/#\{href\}/g,J).replace(/#\{label\}/g,I)),M=!J.indexOf("#")?J.replace("#",""):this._tabId(D("a",N)[0]);N.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var K=G.element.find("#"+M);if(!K.length){K=D(L.panelTemplate).attr("id",M).data("destroy.tabs",true)}K.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(H>=this.lis.length){N.appendTo(this.list);K.appendTo(this.list[0].parentNode)}else{N.insertBefore(this.lis[H]);K.insertBefore(this.panels[H])}L.disabled=D.map(L.disabled,function(P,O){return P>=H?++P:P});this._tabify();if(this.anchors.length==1){L.selected=0;N.addClass("ui-tabs-selected ui-state-active");K.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){G._trigger("show",null,G._ui(G.anchors[0],G.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[H],this.panels[H]));return this},remove:function(G){G=this._getIndex(G);var I=this.options,J=this.lis.eq(G).remove(),H=this.panels.eq(G).remove();if(J.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(G+(G+1<this.anchors.length?1:-1))}I.disabled=D.map(D.grep(I.disabled,function(L,K){return L!=G}),function(L,K){return L>=G?--L:L});this._tabify();this._trigger("remove",null,this._ui(J.find("a")[0],H[0]));return this},enable:function(G){G=this._getIndex(G);var H=this.options;if(D.inArray(G,H.disabled)==-1){return }this.lis.eq(G).removeClass("ui-state-disabled");H.disabled=D.grep(H.disabled,function(J,I){return J!=G});this._trigger("enable",null,this._ui(this.anchors[G],this.panels[G]));return this},disable:function(H){H=this._getIndex(H);var G=this,I=this.options;if(H!=I.selected){this.lis.eq(H).addClass("ui-state-disabled");I.disabled.push(H);I.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[H],this.panels[H]))}return this},select:function(G){G=this._getIndex(G);if(G==-1){if(this.options.collapsible&&this.options.selected!=-1){G=this.options.selected}else{return this}}this.anchors.eq(G).trigger(this.options.event+".tabs");return this},load:function(J){J=this._getIndex(J);var H=this,L=this.options,G=this.anchors.eq(J)[0],I=D.data(G,"load.tabs");this.abort();if(!I||this.element.queue("tabs").length!==0&&D.data(G,"cache.tabs")){this.element.dequeue("tabs");return }this.lis.eq(J).addClass("ui-state-processing");if(L.spinner){var K=D("span",G);K.data("label.tabs",K.html()).html(L.spinner)}this.xhr=D.ajax(D.extend({},L.ajaxOptions,{url:I,success:function(N,M){H.element.find(H._sanitizeSelector(G.hash)).html(N);H._cleanup();if(L.cache){D.data(G,"cache.tabs",true)}H._trigger("load",null,H._ui(H.anchors[J],H.panels[J]));try{L.ajaxOptions.success(N,M)}catch(O){}},error:function(O,M,N){H._cleanup();H._trigger("load",null,H._ui(H.anchors[J],H.panels[J]));try{L.ajaxOptions.error(O,M,J,G)}catch(N){}}}));H.element.dequeue("tabs");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(H,G){this.anchors.eq(H).removeData("cache.tabs").data("load.tabs",G);return this},length:function(){return this.anchors.length}});D.extend(D.ui.tabs,{version:"1.8.24"});D.extend(D.ui.tabs.prototype,{rotation:null,rotate:function(I,K){var G=this,L=this.options;var H=G._rotate||(G._rotate=function(M){clearTimeout(G.rotation);G.rotation=setTimeout(function(){var N=L.selected;G.select(++N<G.anchors.length?N:0)},I);if(M){M.stopPropagation()}});var J=G._unrotate||(G._unrotate=!K?function(M){if(M.clientX){G.rotate(null)}}:function(M){H()});if(I){this.element.bind("tabsshow",H);this.anchors.bind(L.event+".tabs",J);H()}else{clearTimeout(G.rotation);this.element.unbind("tabsshow",H);this.anchors.unbind(L.event+".tabs",J);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.core.js' */
/*
 * jQuery UI Effects 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||(function(H,E){H.effects={};H.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(O,N){H.fx.step[N]=function(P){if(!P.colorInit){P.start=M(P.elem,N);P.end=K(P.end);P.colorInit=true}P.elem.style[N]="rgb("+Math.max(Math.min(parseInt((P.pos*(P.end[0]-P.start[0]))+P.start[0],10),255),0)+","+Math.max(Math.min(parseInt((P.pos*(P.end[1]-P.start[1]))+P.start[1],10),255),0)+","+Math.max(Math.min(parseInt((P.pos*(P.end[2]-P.start[2]))+P.start[2],10),255),0)+")"}});function K(O){var N;if(O&&O.constructor==Array&&O.length==3){return O}if(N=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(O)){return[parseInt(N[1],10),parseInt(N[2],10),parseInt(N[3],10)]}if(N=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(O)){return[parseFloat(N[1])*2.55,parseFloat(N[2])*2.55,parseFloat(N[3])*2.55]}if(N=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(O)){return[parseInt(N[1],16),parseInt(N[2],16),parseInt(N[3],16)]}if(N=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(O)){return[parseInt(N[1]+N[1],16),parseInt(N[2]+N[2],16),parseInt(N[3]+N[3],16)]}if(N=/rgba\(0, 0, 0, 0\)/.exec(O)){return A.transparent}return A[H.trim(O).toLowerCase()]}function M(P,N){var O;do{O=(H.curCSS||H.css)(P,N);if(O!=""&&O!="transparent"||H.nodeName(P,"body")){break}N="backgroundColor"}while(P=P.parentNode);return K(O)}var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var F=["add","remove","toggle"],C={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function G(){var Q=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,R={},O,P;if(Q&&Q.length&&Q[0]&&Q[Q[0]]){var N=Q.length;while(N--){O=Q[N];if(typeof Q[O]=="string"){P=O.replace(/\-(\w)/g,function(S,T){return T.toUpperCase()});R[P]=Q[O]}}}else{for(O in Q){if(typeof Q[O]==="string"){R[O]=Q[O]}}}return R}function B(O){var N,P;for(N in O){P=O[N];if(P==null||H.isFunction(P)||N in C||(/scrollbar/).test(N)||(!(/color/i).test(N)&&isNaN(parseFloat(P)))){delete O[N]}}return O}function I(N,P){var Q={_:0},O;for(O in P){if(N[O]!=P[O]){Q[O]=P[O]}}return Q}H.effects.animateClass=function(N,O,Q,P){if(H.isFunction(Q)){P=Q;Q=null}return this.queue(function(){var U=H(this),R=U.attr("style")||" ",V=B(G.call(this)),T,S=U.attr("class")||"";H.each(F,function(W,X){if(N[X]){U[X+"Class"](N[X])}});T=B(G.call(this));U.attr("class",S);U.animate(I(V,T),{queue:false,duration:O,easing:Q,complete:function(){H.each(F,function(W,X){if(N[X]){U[X+"Class"](N[X])}});if(typeof U.attr("style")=="object"){U.attr("style").cssText="";U.attr("style").cssText=R}else{U.attr("style",R)}if(P){P.apply(this,arguments)}H.dequeue(this)}})})};H.fn.extend({_addClass:H.fn.addClass,addClass:function(O,N,Q,P){return N?H.effects.animateClass.apply(this,[{add:O},N,Q,P]):this._addClass(O)},_removeClass:H.fn.removeClass,removeClass:function(O,N,Q,P){return N?H.effects.animateClass.apply(this,[{remove:O},N,Q,P]):this._removeClass(O)},_toggleClass:H.fn.toggleClass,toggleClass:function(P,O,N,R,Q){if(typeof O=="boolean"||O===E){if(!N){return this._toggleClass(P,O)}else{return H.effects.animateClass.apply(this,[(O?{add:P}:{remove:P}),N,R,Q])}}else{return H.effects.animateClass.apply(this,[{toggle:P},O,N,R])}},switchClass:function(N,P,O,R,Q){return H.effects.animateClass.apply(this,[{add:P,remove:N},O,R,Q])}});H.extend(H.effects,{version:"1.8.24",save:function(O,P){for(var N=0;N<P.length;N++){if(P[N]!==null){O.data("ec.storage."+P[N],O[0].style[P[N]])}}},restore:function(O,P){for(var N=0;N<P.length;N++){if(P[N]!==null){O.css(P[N],O.data("ec.storage."+P[N]))}}},setMode:function(N,O){if(O=="toggle"){O=N.is(":hidden")?"show":"hide"}return O},getBaseline:function(O,P){var Q,N;switch(O[0]){case"top":Q=0;break;case"middle":Q=0.5;break;case"bottom":Q=1;break;default:Q=O[0]/P.height}switch(O[1]){case"left":N=0;break;case"center":N=0.5;break;case"right":N=1;break;default:N=O[1]/P.width}return{x:N,y:Q}},createWrapper:function(N){if(N.parent().is(".ui-effects-wrapper")){return N.parent()}var O={width:N.outerWidth(true),height:N.outerHeight(true),"float":N.css("float")},R=H("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),Q=document.activeElement;try{Q.id}catch(P){Q=document.body}N.wrap(R);if(N[0]===Q||H.contains(N[0],Q)){H(Q).focus()}R=N.parent();if(N.css("position")=="static"){R.css({position:"relative"});N.css({position:"relative"})}else{H.extend(O,{position:N.css("position"),zIndex:N.css("z-index")});H.each(["top","left","bottom","right"],function(S,T){O[T]=N.css(T);if(isNaN(parseInt(O[T],10))){O[T]="auto"}});N.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return R.css(O).show()},removeWrapper:function(N){var O,P=document.activeElement;if(N.parent().is(".ui-effects-wrapper")){O=N.parent().replaceWith(N);if(N[0]===P||H.contains(N[0],P)){H(P).focus()}return O}return N},setTransition:function(O,Q,N,P){P=P||{};H.each(Q,function(S,R){var T=O.cssUnit(R);if(T[0]>0){P[R]=T[0]*N+T[1]}});return P}});function D(O,N,P,Q){if(typeof O=="object"){Q=N;P=null;N=O;O=N.effect}if(H.isFunction(N)){Q=N;P=null;N={}}if(typeof N=="number"||H.fx.speeds[N]){Q=P;P=N;N={}}if(H.isFunction(P)){Q=P;P=null}N=N||{};P=P||N.duration;P=H.fx.off?0:typeof P=="number"?P:P in H.fx.speeds?H.fx.speeds[P]:H.fx.speeds._default;Q=Q||N.complete;return[O,N,P,Q]}function L(N){if(!N||typeof N==="number"||H.fx.speeds[N]){return true}if(typeof N==="string"&&!H.effects[N]){return true}return false}H.fn.extend({effect:function(Q,P,S,U){var O=D.apply(this,arguments),R={options:O[1],duration:O[2],callback:O[3]},T=R.options.mode,N=H.effects[Q];if(H.fx.off||!N){if(T){return this[T](R.duration,R.callback)}else{return this.each(function(){if(R.callback){R.callback.call(this)}})}}return N.call(this,R)},_show:H.fn.show,show:function(O){if(L(O)){return this._show.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="show";return this.effect.apply(this,N)}},_hide:H.fn.hide,hide:function(O){if(L(O)){return this._hide.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="hide";return this.effect.apply(this,N)}},__toggle:H.fn.toggle,toggle:function(O){if(L(O)||typeof O==="boolean"||H.isFunction(O)){return this.__toggle.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="toggle";return this.effect.apply(this,N)}},cssUnit:function(N){var O=this.css(N),P=[];H.each(["em","px","%","pt"],function(Q,R){if(O.indexOf(R)>0){P=[parseFloat(O),R]}});return P}});var J={};H.each(["Quad","Cubic","Quart","Quint","Expo"],function(O,N){J[N]=function(P){return Math.pow(P,O+2)}});H.extend(J,{Sine:function(N){return 1-Math.cos(N*Math.PI/2)},Circ:function(N){return 1-Math.sqrt(1-N*N)},Elastic:function(N){return N===0||N===1?N:-Math.pow(2,8*(N-1))*Math.sin(((N-1)*80-7.5)*Math.PI/15)},Back:function(N){return N*N*(3*N-2)},Bounce:function(P){var N,O=4;while(P<((N=Math.pow(2,--O))-1)/11){}return 1/Math.pow(4,3-O)-7.5625*Math.pow((N*3-2)/22-P,2)}});H.each(J,function(O,N){H.easing["easeIn"+O]=N;H.easing["easeOut"+O]=function(P){return 1-N(1-P)};H.easing["easeInOut"+O]=function(P){return P<0.5?N(P*2)/2:N(P*-2+2)/-2+1}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.blind.js' */
/*
 * jQuery UI Effects Blind 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.blind=function(C){return this.queue(function(){var E=A(this),D=["position","top","bottom","left","right"];var I=A.effects.setMode(E,C.options.mode||"hide");var H=C.options.direction||"vertical";A.effects.save(E,D);E.show();var K=A.effects.createWrapper(E).css({overflow:"hidden"});var F=(H=="vertical")?"height":"width";var J=(H=="vertical")?K.height():K.width();if(I=="show"){K.css(F,0)}var G={};G[F]=I=="show"?J:0;K.animate(G,C.duration,C.options.easing,function(){if(I=="hide"){E.hide()}A.effects.restore(E,D);A.effects.removeWrapper(E);if(C.callback){C.callback.apply(E[0],arguments)}E.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.bounce.js' */
/*
 * jQuery UI Effects Bounce 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.bounce=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var K=A.effects.setMode(F,C.options.mode||"effect");var N=C.options.direction||"up";var D=C.options.distance||20;var E=C.options.times||5;var H=C.duration||250;if(/show|hide/.test(K)){L.push("opacity")}A.effects.save(F,L);F.show();A.effects.createWrapper(F);var G=(N=="up"||N=="down")?"top":"left";var P=(N=="up"||N=="left")?"pos":"neg";var D=C.options.distance||(G=="top"?F.outerHeight(true)/3:F.outerWidth(true)/3);if(K=="show"){F.css("opacity",0).css(G,P=="pos"?-D:D)}if(K=="hide"){D=D/(E*2)}if(K!="hide"){E--}if(K=="show"){var I={opacity:1};I[G]=(P=="pos"?"+=":"-=")+D;F.animate(I,H/2,C.options.easing);D=D/2;E--}for(var J=0;J<E;J++){var O={},M={};O[G]=(P=="pos"?"-=":"+=")+D;M[G]=(P=="pos"?"+=":"-=")+D;F.animate(O,H/2,C.options.easing).animate(M,H/2,C.options.easing);D=(K=="hide")?D*2:D/2}if(K=="hide"){var I={opacity:0};I[G]=(P=="pos"?"-=":"+=")+D;F.animate(I,H/2,C.options.easing,function(){F.hide();A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}})}else{var O={},M={};O[G]=(P=="pos"?"-=":"+=")+D;M[G]=(P=="pos"?"+=":"-=")+D;F.animate(O,H/2,C.options.easing).animate(M,H/2,C.options.easing,function(){A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}})}F.queue("fx",function(){F.dequeue()});F.dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.clip.js' */
/*
 * jQuery UI Effects Clip 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.clip=function(C){return this.queue(function(){var G=A(this),K=["position","top","bottom","left","right","height","width"];var J=A.effects.setMode(G,C.options.mode||"hide");var L=C.options.direction||"vertical";A.effects.save(G,K);G.show();var D=A.effects.createWrapper(G).css({overflow:"hidden"});var F=G[0].tagName=="IMG"?D:G;var H={size:(L=="vertical")?"height":"width",position:(L=="vertical")?"top":"left"};var E=(L=="vertical")?F.height():F.width();if(J=="show"){F.css(H.size,0);F.css(H.position,E/2)}var I={};I[H.size]=J=="show"?E:0;I[H.position]=J=="show"?0:E/2;F.animate(I,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){G.hide()}A.effects.restore(G,K);A.effects.removeWrapper(G);if(C.callback){C.callback.apply(G[0],arguments)}G.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.drop.js' */
/*
 * jQuery UI Effects Drop 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.drop=function(C){return this.queue(function(){var F=A(this),E=["position","top","bottom","left","right","opacity"];var J=A.effects.setMode(F,C.options.mode||"hide");var I=C.options.direction||"left";A.effects.save(F,E);F.show();A.effects.createWrapper(F);var G=(I=="up"||I=="down")?"top":"left";var D=(I=="up"||I=="left")?"pos":"neg";var K=C.options.distance||(G=="top"?F.outerHeight(true)/2:F.outerWidth(true)/2);if(J=="show"){F.css("opacity",0).css(G,D=="pos"?-K:K)}var H={opacity:J=="show"?1:0};H[G]=(J=="show"?(D=="pos"?"+=":"-="):(D=="pos"?"-=":"+="))+K;F.animate(H,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){F.hide()}A.effects.restore(F,E);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}F.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.explode.js' */
/*
 * jQuery UI Effects Explode 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.explode=function(C){return this.queue(function(){var J=C.options.pieces?Math.round(Math.sqrt(C.options.pieces)):3;var F=C.options.pieces?Math.round(Math.sqrt(C.options.pieces)):3;C.options.mode=C.options.mode=="toggle"?(A(this).is(":visible")?"hide":"show"):C.options.mode;var I=A(this).show().css("visibility","hidden");var K=I.offset();K.top-=parseInt(I.css("marginTop"),10)||0;K.left-=parseInt(I.css("marginLeft"),10)||0;var H=I.outerWidth(true);var D=I.outerHeight(true);for(var G=0;G<J;G++){for(var E=0;E<F;E++){I.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-E*(H/F),top:-G*(D/J)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:H/F,height:D/J,left:K.left+E*(H/F)+(C.options.mode=="show"?(E-Math.floor(F/2))*(H/F):0),top:K.top+G*(D/J)+(C.options.mode=="show"?(G-Math.floor(J/2))*(D/J):0),opacity:C.options.mode=="show"?0:1}).animate({left:K.left+E*(H/F)+(C.options.mode=="show"?0:(E-Math.floor(F/2))*(H/F)),top:K.top+G*(D/J)+(C.options.mode=="show"?0:(G-Math.floor(J/2))*(D/J)),opacity:C.options.mode=="show"?1:0},C.duration||500)}}setTimeout(function(){C.options.mode=="show"?I.css({visibility:"visible"}):I.css({visibility:"visible"}).hide();if(C.callback){C.callback.apply(I[0])}I.dequeue();A("div.ui-effects-explode").remove()},C.duration||500)})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.fade.js' */
/*
 * jQuery UI Effects Fade 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.fade=function(C){return this.queue(function(){var D=A(this),E=A.effects.setMode(D,C.options.mode||"hide");D.animate({opacity:E},{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){(C.callback&&C.callback.apply(this,arguments));D.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.fold.js' */
/*
 * jQuery UI Effects Fold 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.fold=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var I=A.effects.setMode(F,C.options.mode||"hide");var P=C.options.size||15;var O=!(!C.options.horizFirst);var H=C.duration?C.duration/2:A.fx.speeds._default/2;A.effects.save(F,L);F.show();var E=A.effects.createWrapper(F).css({overflow:"hidden"});var J=((I=="show")!=O);var G=J?["width","height"]:["height","width"];var D=J?[E.width(),E.height()]:[E.height(),E.width()];var K=/([0-9]+)%/.exec(P);if(K){P=parseInt(K[1],10)/100*D[I=="hide"?0:1]}if(I=="show"){E.css(O?{height:0,width:P}:{height:P,width:0})}var N={},M={};N[G[0]]=I=="show"?D[0]:P;M[G[1]]=I=="show"?D[1]:0;E.animate(N,H,C.options.easing).animate(M,H,C.options.easing,function(){if(I=="hide"){F.hide()}A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(F[0],arguments)}F.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.highlight.js' */
/*
 * jQuery UI Effects Highlight 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.highlight=function(C){return this.queue(function(){var E=A(this),D=["backgroundImage","backgroundColor","opacity"],G=A.effects.setMode(E,C.options.mode||"show"),F={backgroundColor:E.css("backgroundColor")};if(G=="hide"){F.opacity=0}A.effects.save(E,D);E.show().css({backgroundImage:"none",backgroundColor:C.options.color||"#ffff99"}).animate(F,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){(G=="hide"&&E.hide());A.effects.restore(E,D);(G=="show"&&!A.support.opacity&&this.style.removeAttribute("filter"));(C.callback&&C.callback.apply(this,arguments));E.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.pulsate.js' */
/*
 * jQuery UI Effects Pulsate 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.pulsate=function(C){return this.queue(function(){var G=A(this),J=A.effects.setMode(G,C.options.mode||"show"),I=((C.options.times||5)*2)-1,H=C.duration?C.duration/2:A.fx.speeds._default/2,D=G.is(":visible"),E=0;if(!D){G.css("opacity",0).show();E=1}if((J=="hide"&&D)||(J=="show"&&!D)){I--}for(var F=0;F<I;F++){G.animate({opacity:E},H,C.options.easing);E=(E+1)%2}G.animate({opacity:E},H,C.options.easing,function(){if(E==0){G.hide()}(C.callback&&C.callback.apply(this,arguments))});G.queue("fx",function(){G.dequeue()}).dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.scale.js' */
/*
 * jQuery UI Effects Scale 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.puff=function(C){return this.queue(function(){var G=A(this),H=A.effects.setMode(G,C.options.mode||"hide"),F=parseInt(C.options.percent,10)||150,E=F/100,D={height:G.height(),width:G.width()};A.extend(C.options,{fade:true,mode:H,percent:H=="hide"?F:100,from:H=="hide"?D:{height:D.height*E,width:D.width*E}});G.effect("scale",C.options,C.duration,C.callback);G.dequeue()})};A.effects.scale=function(C){return this.queue(function(){var H=A(this);var E=A.extend(true,{},C.options);var K=A.effects.setMode(H,C.options.mode||"effect");var I=parseInt(C.options.percent,10)||(parseInt(C.options.percent,10)==0?0:(K=="hide"?0:100));var J=C.options.direction||"both";var D=C.options.origin;if(K!="effect"){E.origin=D||["middle","center"];E.restore=true}var G={height:H.height(),width:H.width()};H.from=C.options.from||(K=="show"?{height:0,width:0}:G);var F={y:J!="horizontal"?(I/100):1,x:J!="vertical"?(I/100):1};H.to={height:G.height*F.y,width:G.width*F.x};if(C.options.fade){if(K=="show"){H.from.opacity=0;H.to.opacity=1}if(K=="hide"){H.from.opacity=1;H.to.opacity=0}}E.from=H.from;E.to=H.to;E.mode=K;H.effect("size",E,C.duration,C.callback);H.dequeue()})};A.effects.size=function(C){return this.queue(function(){var D=A(this),O=["position","top","bottom","left","right","width","height","overflow","opacity"];var N=["position","top","bottom","left","right","overflow","opacity"];var K=["width","height","overflow"];var Q=["fontSize"];var L=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var G=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var H=A.effects.setMode(D,C.options.mode||"effect");var J=C.options.restore||false;var F=C.options.scale||"both";var P=C.options.origin;var E={height:D.height(),width:D.width()};D.from=C.options.from||E;D.to=C.options.to||E;if(P){var I=A.effects.getBaseline(P,E);D.from.top=(E.height-D.from.height)*I.y;D.from.left=(E.width-D.from.width)*I.x;D.to.top=(E.height-D.to.height)*I.y;D.to.left=(E.width-D.to.width)*I.x}var M={from:{y:D.from.height/E.height,x:D.from.width/E.width},to:{y:D.to.height/E.height,x:D.to.width/E.width}};if(F=="box"||F=="both"){if(M.from.y!=M.to.y){O=O.concat(L);D.from=A.effects.setTransition(D,L,M.from.y,D.from);D.to=A.effects.setTransition(D,L,M.to.y,D.to)}if(M.from.x!=M.to.x){O=O.concat(G);D.from=A.effects.setTransition(D,G,M.from.x,D.from);D.to=A.effects.setTransition(D,G,M.to.x,D.to)}}if(F=="content"||F=="both"){if(M.from.y!=M.to.y){O=O.concat(Q);D.from=A.effects.setTransition(D,Q,M.from.y,D.from);D.to=A.effects.setTransition(D,Q,M.to.y,D.to)}}A.effects.save(D,J?O:N);D.show();A.effects.createWrapper(D);D.css("overflow","hidden").css(D.from);if(F=="content"||F=="both"){L=L.concat(["marginTop","marginBottom"]).concat(Q);G=G.concat(["marginLeft","marginRight"]);K=O.concat(L).concat(G);D.find("*[width]").each(function(){var S=A(this);if(J){A.effects.save(S,K)}var R={height:S.height(),width:S.width()};S.from={height:R.height*M.from.y,width:R.width*M.from.x};S.to={height:R.height*M.to.y,width:R.width*M.to.x};if(M.from.y!=M.to.y){S.from=A.effects.setTransition(S,L,M.from.y,S.from);S.to=A.effects.setTransition(S,L,M.to.y,S.to)}if(M.from.x!=M.to.x){S.from=A.effects.setTransition(S,G,M.from.x,S.from);S.to=A.effects.setTransition(S,G,M.to.x,S.to)}S.css(S.from);S.animate(S.to,C.duration,C.options.easing,function(){if(J){A.effects.restore(S,K)}})})}D.animate(D.to,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(D.to.opacity===0){D.css("opacity",D.from.opacity)}if(H=="hide"){D.hide()}A.effects.restore(D,J?O:N);A.effects.removeWrapper(D);if(C.callback){C.callback.apply(this,arguments)}D.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.shake.js' */
/*
 * jQuery UI Effects Shake 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.shake=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var K=A.effects.setMode(F,C.options.mode||"effect");var N=C.options.direction||"left";var D=C.options.distance||20;var E=C.options.times||3;var H=C.duration||C.options.duration||140;A.effects.save(F,L);F.show();A.effects.createWrapper(F);var G=(N=="up"||N=="down")?"top":"left";var P=(N=="up"||N=="left")?"pos":"neg";var I={},O={},M={};I[G]=(P=="pos"?"-=":"+=")+D;O[G]=(P=="pos"?"+=":"-=")+D*2;M[G]=(P=="pos"?"-=":"+=")+D*2;F.animate(I,H,C.options.easing);for(var J=1;J<E;J++){F.animate(O,H,C.options.easing).animate(M,H,C.options.easing)}F.animate(O,H,C.options.easing).animate(I,H/2,C.options.easing,function(){A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}});F.queue("fx",function(){F.dequeue()});F.dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.slide.js' */
/*
 * jQuery UI Effects Slide 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.slide=function(C){return this.queue(function(){var F=A(this),E=["position","top","bottom","left","right"];var J=A.effects.setMode(F,C.options.mode||"show");var I=C.options.direction||"left";A.effects.save(F,E);F.show();A.effects.createWrapper(F).css({overflow:"hidden"});var G=(I=="up"||I=="down")?"top":"left";var D=(I=="up"||I=="left")?"pos":"neg";var K=C.options.distance||(G=="top"?F.outerHeight(true):F.outerWidth(true));if(J=="show"){F.css(G,D=="pos"?(isNaN(K)?"-"+K:-K):K)}var H={};H[G]=(J=="show"?(D=="pos"?"+=":"-="):(D=="pos"?"-=":"+="))+K;F.animate(H,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){F.hide()}A.effects.restore(F,E);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}F.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery-ui/jquery.effects.transfer.js' */
/*
 * jQuery UI Effects Transfer 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.transfer=function(C){return this.queue(function(){var G=A(this),I=A(C.options.to),F=I.offset(),H={top:F.top,left:F.left,height:I.innerHeight(),width:I.innerWidth()},E=G.offset(),D=A('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(C.options.className).css({top:E.top,left:E.left,height:G.innerHeight(),width:G.innerWidth(),position:"absolute"}).animate(H,C.duration,C.options.easing,function(){D.remove();(C.callback&&C.callback.apply(G[0],arguments));G.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js/external/jquery/jquery.ui.menu.js' */
(function(A){A.widget("ui.menu",{_create:function(){var B=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(C){if(!A(C.target).closest(".ui-menu-item a").length){return }C.preventDefault();B.select(C)});this.refresh()},refresh:function(){var C=this;var B=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");B.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(D){C.activate(D,A(this).parent())}).mouseleave(function(){C.deactivate()})},activate:function(E,D){this.deactivate();if(this.hasScroll()){var F=D.offset().top-this.element.offset().top,B=this.element.attr("scrollTop"),C=this.element.height();if(F<0){this.element.attr("scrollTop",B+F)}else{if(F>C){this.element.attr("scrollTop",B+F-C+D.height())}}}this.active=D.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",E,{item:D})},deactivate:function(){if(!this.active){return }this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(B){this.move("next",".ui-menu-item:first",B)},previous:function(B){this.move("prev",".ui-menu-item:last",B)},first:function(){return this.active&&!this.active.prev().length},last:function(){return this.active&&!this.active.next().length},move:function(E,D,C){if(!this.active){this.activate(C,this.element.children(D));return }var B=this.active[E+"All"](".ui-menu-item").eq(0);if(B.length){this.activate(C,B)}else{this.activate(C,this.element.children(D))}},nextPage:function(D){if(this.hasScroll()){if(!this.active||this.last()){this.activate(D,this.element.children(":first"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children("li").filter(function(){var F=A(this).offset().top-E-C+A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(":last")}this.activate(D,B)}else{this.activate(D,this.element.children(!this.active||this.last()?":first":":last"))}},previousPage:function(C){if(this.hasScroll()){if(!this.active||this.first()){this.activate(C,this.element.children(":last"));return }var D=this.active.offset().top,B=this.element.height();result=this.element.children("li").filter(function(){var E=A(this).offset().top-D+B-A(this).height();return E<10&&E>-10});if(!result.length){result=this.element.children(":first")}this.activate(C,result)}else{this.activate(C,this.element.children(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(B){this._trigger("selected",B,{item:this.active})}})}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d-api', location = 'js/lib/draw2d/draw2d.js' */
var draw2d={geo:{},io:{json:{},png:{},svg:{}},util:{spline:{}},shape:{basic:{},arrow:{},node:{},note:{},diagram:{},analog:{},icon:{},layout:{},pert:{},state:{},widget:{}},policy:{canvas:{},port:{},figure:{}},command:{},decoration:{connection:{}},layout:{connection:{},anchor:{},mesh:{},locator:{}},ui:{},isTouchDevice:((navigator.platform.indexOf("iPhone")!=-1)||(navigator.platform.indexOf("iPod")!=-1)||(navigator.platform.indexOf("iPad")!=-1))};(function(){Raphael.fn.group=function(D,C){var A=document.getElementsByTagName("svg").length>0;if(!A){return{add:function(){}}}var B;this.svg="http://www.w3.org/2000/svg";this.defs=document.getElementsByTagName("defs")[D];this.svgcanv=document.getElementsByTagName("svg")[D];this.group=document.createElementNS(this.svg,"g");for(B=0;B<C.length;B++){this.group.appendChild(C[B].node)}this.svgcanv.appendChild(this.group);this.group.translate=function(F,E){this.setAttribute("transform","translate("+F+","+E+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+")")};this.group.rotate=function(G,E,F){this.setAttribute("transform","translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+") rotate("+G+","+E+","+F+")")};this.group.scale=function(F,E){this.setAttribute("transform","scale("+F+","+E+") translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+")")};this.group.push=function(E){this.appendChild(E.node)};this.group.getAttr=function(L){this.previous=this.getAttribute("transform")?this.getAttribute("transform"):"";var F=[],J,I,H;F=this.previous.split(" ");for(B=0;B<F.length;B++){if(F[B].substring(0,1)=="t"){var K=F[B],E=[];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=[];E=K.split(",");J=E.length===0?{x:0,y:0}:{x:E[0],y:E[1]}}else{if(F[B].substring(0,1)==="r"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");I=E.length===0?{x:0,y:0,z:0}:{x:E[0],y:E[1],z:E[2]}}else{if(F[B].substring(0,1)==="s"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");H=E.length===0?{x:1,y:1}:{x:E[0],y:E[1]}}}}}if(typeof J==="undefined"){J={x:0,y:0}}if(typeof I==="undefined"){I={x:0,y:0,z:0}}if(typeof H==="undefined"){H={x:1,y:1}}if(L=="translate"){var G=J}else{if(L=="rotate"){G=I}else{if(L=="scale"){G=H}}}return G};this.group.copy=function(E){this.copy=E.node.cloneNode(true);this.appendChild(this.copy)};return this.group}})();Math.sign=function(){if(this<0){return -1}return 1};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/shifty-0.6.1.js' */
(function ($) {(function(){var A;(function(D){var E,H="linear",K;if(typeof SHIFTY_DEBUG_NOW==="function"){E=SHIFTY_DEBUG_NOW}else{E=function(){return +new Date()}}function N(R,Q){var S;for(S in R){if(R.hasOwnProperty(S)){Q(R,S)}}}function L(R,Q){N(Q,function(S,T){R[T]=S[T]});return R}function G(R,Q){N(Q,function(S,T){if(typeof R[T]==="undefined"){R[T]=S[T]}});return R}function B(S,T,R){var U,Q;Q=(S-T.timestamp)/T.duration;for(U in R.current){if(R.current.hasOwnProperty(U)&&T.to.hasOwnProperty(U)){R.current[U]=J(T.originalState[U],T.to[U],K[T.easing[U]],Q)}}return R.current}function J(T,S,R,Q){return T+(S-T)*R(Q)}function F(Q,R){return setTimeout(Q,1000/R)}function M(T,Q,U,R){var S;for(S=0;S<Q[T].length;S++){Q[T][S].apply(U,R)}}function I(R,S,Q){N(A.prototype.filter,function(U,T){if(U[T][R]){U[T][R].apply(S,Q)}})}function P(U,T){var R=U.timestamp+U.duration,S=Math.min(E(),R),Q=S>=R;if(T.isTweening){if(!Q){T.loopId=F(function(){P(U,T)},U.owner.fps)}I("beforeTween",U.owner,[T.current,U.originalState,U.to]);B(S,U,T);I("afterTween",U.owner,[T.current,U.originalState,U.to]);if(U.hook.step){M("step",U.hook,U.owner,[T.current])}if(U.step){U.step.call(T.current,T.current)}}if(Q||!T.isTweening){U.owner.stop(true)}}if(typeof SHIFTY_DEBUG_NOW==="function"){D.timeoutHandler=P}function C(S,R){var Q;Q={};if(typeof R==="string"){N(S,function(T,U){Q[U]=R})}else{N(S,function(T,U){if(!Q[U]){Q[U]=R[U]||H}})}return Q}A=function(Q){Q=Q||{};this._hook={};this._tweenParams={owner:this,hook:this._hook,data:{}};this._state={};this._state.current=Q.initialState||{};this.fps=Q.fps||30;this.easing=Q.easing||H;this.duration=Q.duration||500;return this};A.prototype.tween=function(X,W,S,V,U){var Q,T,R;if(this._state.isTweening){return }Q=this;T=this._tweenParams;R=this._state;this._state.loopId=0;this._state.pausedAtTime=null;if(W){T.to=W||{};T.duration=S||this.duration;T.callback=V;T.easing=U||this.easing;R.current=X||{}}else{T.step=X.step;T.callback=X.callback;T.to=X.to||X.target||{};T.duration=X.duration||this.duration;T.easing=X.easing||this.easing;R.current=X.from||{}}T.timestamp=E();G(R.current,T.to);G(T.to,R.current);T.easing=C(R.current,T.easing);I("tweenCreated",T.owner,[R.current,T.originalState,T.to]);T.originalState=L({},R.current);R.isTweening=true;this.resume();if(X.start){X.start()}return this};A.prototype.to=function O(R,Q,T,S){if(arguments.length===1){if("to" in R){R.from=this.get();this.tween(R)}else{this.tween(this.get(),R)}}else{this.tween(this.get(),R,Q,T,S)}return this};A.prototype.get=function(){return this._state.current};A.prototype.set=function(Q){this._state.current=Q||{};return this};A.prototype.stop=function(Q){clearTimeout(this._state.loopId);this._state.isTweening=false;if(Q){L(this._state.current,this._tweenParams.to);I("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]);if(this._tweenParams.callback){this._tweenParams.callback.call(this._state.current,this._state.current)}}return this};A.prototype.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=E();this._state.isPaused=true;return this};A.prototype.resume=function(){var Q;Q=this;if(this._state.isPaused){this._tweenParams.timestamp+=E()-this._state.pausedAtTime}P(Q._tweenParams,Q._state);return this};A.prototype.hookAdd=function(Q,R){if(!this._hook.hasOwnProperty(Q)){this._hook[Q]=[]}this._hook[Q].push(R)};A.prototype.hookRemove=function(R,S){var Q;if(!this._hook.hasOwnProperty(R)){return }if(!S){this._hook[R]=[];return }for(Q=this._hook[R].length;Q>=0;Q++){if(this._hook[R][Q]===S){this._hook[R].splice(Q,1)}}};A.prototype.filter={};A.util={now:E,each:N,tweenProps:B,tweenProp:J,applyFilter:I,simpleCopy:L,weakCopy:G,composeEasingObject:C};K=A.prototype.formula={linear:function(Q){return Q}};if(typeof exports==="object"){module.exports=A}else{if(typeof define==="function"&&define.amd){define(function(){return A})}else{if(typeof D.Tweenable==="undefined"){D.Tweenable=A}}}}(this));(function(){A.util.simpleCopy(A.prototype.formula,{easeInQuad:function(B){return Math.pow(B,2)},easeOutQuad:function(B){return -(Math.pow((B-1),2)-1)},easeInOutQuad:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,2)}return -0.5*((B-=2)*B-2)},easeInCubic:function(B){return Math.pow(B,3)},easeOutCubic:function(B){return(Math.pow((B-1),3)+1)},easeInOutCubic:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,3)}return 0.5*(Math.pow((B-2),3)+2)},easeInQuart:function(B){return Math.pow(B,4)},easeOutQuart:function(B){return -(Math.pow((B-1),4)-1)},easeInOutQuart:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeInQuint:function(B){return Math.pow(B,5)},easeOutQuint:function(B){return(Math.pow((B-1),5)+1)},easeInOutQuint:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,5)}return 0.5*(Math.pow((B-2),5)+2)},easeInSine:function(B){return -Math.cos(B*(Math.PI/2))+1},easeOutSine:function(B){return Math.sin(B*(Math.PI/2))},easeInOutSine:function(B){return(-0.5*(Math.cos(Math.PI*B)-1))},easeInExpo:function(B){return(B==0)?0:Math.pow(2,10*(B-1))},easeOutExpo:function(B){return(B==1)?1:-Math.pow(2,-10*B)+1},easeInOutExpo:function(B){if(B==0){return 0}if(B==1){return 1}if((B/=0.5)<1){return 0.5*Math.pow(2,10*(B-1))}return 0.5*(-Math.pow(2,-10*--B)+2)},easeInCirc:function(B){return -(Math.sqrt(1-(B*B))-1)},easeOutCirc:function(B){return Math.sqrt(1-Math.pow((B-1),2))},easeInOutCirc:function(B){if((B/=0.5)<1){return -0.5*(Math.sqrt(1-B*B)-1)}return 0.5*(Math.sqrt(1-(B-=2)*B)+1)},easeOutBounce:function(B){if((B)<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeInBack:function(C){var B=1.70158;return(C)*C*((B+1)*C-B)},easeOutBack:function(C){var B=1.70158;return(C=C-1)*C*((B+1)*C+B)+1},easeInOutBack:function(C){var B=1.70158;if((C/=0.5)<1){return 0.5*(C*C*(((B*=(1.525))+1)*C-B))}return 0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},elastic:function(B){return -1*Math.pow(4,-8*B)*Math.sin((B*6-1)*(2*Math.PI)/2)+1},swingFromTo:function(C){var B=1.70158;return((C/=0.5)<1)?0.5*(C*C*(((B*=(1.525))+1)*C-B)):0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},swingFrom:function(C){var B=1.70158;return C*C*((B+1)*C-B)},swingTo:function(C){var B=1.70158;return(C-=1)*C*((B+1)*C+B)+1},bounce:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},bouncePast:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return 2-(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return 2-(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return 2-(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeFromTo:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeFrom:function(B){return Math.pow(B,4)},easeTo:function(B){return Math.pow(B,0.25)}})}());(function(){var C=function(){};function E(F){F.shift();if(F.length){F[0]()}else{F.running=false}}function D(G,F){return function(){G();E(F)}}function B(F,K,J,G,I,H){return function(){if(J){F.tween(K,J,G,I,H)}else{K.callback=I;if(K.from){F.tween(K)}else{F.to(K)}}}}A.prototype.queue=function(K,J,F,I,H){var G;if(!this._tweenQueue){this._tweenQueue=[]}I=I||K.callback||C;G=D(I,this._tweenQueue);this._tweenQueue.push(B(this,K,J,F,G,H));return this};A.prototype.queueStart=function(){if(!this._tweenQueue.running&&this._tweenQueue.length>0){this._tweenQueue[0]();this._tweenQueue.running=true}return this};A.prototype.queueShift=function(){this._tweenQueue.shift();return this};A.prototype.queuePop=function(){this._tweenQueue.pop();return this};A.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};A.prototype.queueLength=function(){return this._tweenQueue.length}}());(function(){var B=/^#([0-9]|[a-f]){3}$/i,M=/^#([0-9]|[a-f]){6}$/i,E=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,Q;if(!A){return }function P(R){return parseInt(R,16)}function G(R){R=R.replace(/#/g,"");if(R.length===3){R=R.split("");R=R[0]+R[0]+R[1]+R[1]+R[2]+R[2]}return[P(R.substr(0,2)),P(R.substr(2,2)),P(R.substr(4,2))]}function N(S){var T,R;T=G(S);R="rgb("+T[0]+","+T[1]+","+T[2]+")";return R}function J(R){return(typeof R==="string")&&(B.test(R)||M.test(R)||E.test(R))}function H(R){return(typeof R==="string")&&(B.test(R)||M.test(R))}function I(R){A.util.each(R,function(S,T){if(H(S[T])){S[T]=N(S[T])}})}function D(S){var R;R=[];A.util.each(S,function(T,U){if(J(T[U])){R.push(U)}});return R}function K(R){return R.match(/(\d+)/g)}function F(V,T){var U,S,R;S=T.length;for(U=0;U<S;U++){R=K(V[T[U]]);V["__r__"+T[U]]=+R[0];V["__g__"+T[U]]=+R[1];V["__b__"+T[U]]=+R[2];delete V[T[U]]}}function C(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U[S[T]]="rgb("+parseInt(U["__r__"+S[T]],10)+","+parseInt(U["__g__"+S[T]],10)+","+parseInt(U["__b__"+S[T]],10)+")";delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}function O(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U["__r__"+S[T]]=U[S[T]];U["__g__"+S[T]]=U[S[T]];U["__b__"+S[T]]=U[S[T]]}}function L(U,S){var T,R;R=S.length;for(T=0;T<R;T++){delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}A.prototype.filter.color={tweenCreated:function(S,T,R){I(S);I(T);I(R)},beforeTween:function(S,T,R){Q=D(T);F(S,Q);F(T,Q);F(R,Q);O(this._tweenParams.easing,Q)},afterTween:function(S,T,R){C(S,Q);C(T,Q);C(R,Q);L(this._tweenParams.easing,Q)}}}());(function(){var D=/\D+/g;var G;function B(I){return typeof I==="string"&&I.match(D)}function F(I){return I.replace(/\(/g,"\\(").replace(/\)/g,"\\)")}function H(I){var J;J={};A.util.each(I,function(M,N){var L=M[N];if(B(L)){var K=L.match(D);if(K.length===1){K.unshift("")}J[N]=K}});return J}function C(J,I){A.util.each(I,function(P,L){var M=I[L];var O;var K=F(M[0]);var N=F(M[1]);if(M[0]===""){O=new RegExp(N,"g")}else{O=new RegExp("("+K+"|"+N+")","g")}J[L]=+(J[L].replace(O,""))})}function E(J,I){A.util.each(I,function(M,L){var K=M[L];J[L]=K[0]+J[L]+K[1]})}A.prototype.filter.token={beforeTween:function(J,K,I){G=H(K);C(J,G);C(K,G);C(I,G)},afterTween:function(J,K,I){E(J,G);E(K,G);E(I,G)}}}());(function(){if(!A){return }function B(H,D,G,C,F){var E;E=A.util.composeEasingObject(H,F);return A.util.tweenProps(C,{originalState:H,to:G,timestamp:0,duration:1,easing:E},{current:D})}A.util.interpolate=function(I,H,C,G){var F,E,D;if(I&&I.from){H=I.to;C=I.position;G=I.easing;I=I.from}D=new A();D._tweenParams.easing=G||"linear";F=A.util.simpleCopy({},I);A.util.applyFilter("tweenCreated",D,[F,I,H]);A.util.applyFilter("beforeTween",D,[F,I,H]);E=B(I,F,H,C,D._tweenParams.easing);A.util.applyFilter("afterTween",D,[E,I,H]);return E};A.prototype.interpolate=function(F,C,E){var D;D=A.util.interpolate(this.get(),F,C,E);this.set(D);return D}}());(function(){var B=false;A.util.enableRounding=function(){B=true};A.util.disableRounding=function(){B=false};A.util.isRoundingEnabled=function(){return B};A.prototype.filter.round={afterTween:function(D,E,C){if(B){A.util.each(D,function(F,G){if(!F[G].replace){F[G]=Math.round(F[G])}})}}}}())}());}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/Color.js' */
(function ($) {draw2d.util.Color=Class.extend({init:function(D,C,A){this.hashString=null;if(typeof D==="undefined"||D===null){this.hashString="none"}else{if(D instanceof draw2d.util.Color){this.red=D.red;this.green=D.green;this.blue=D.blue}else{if(typeof C==="undefined"){var B=this.hex2rgb(D);this.red=B[0];this.green=B[1];this.blue=B[2]}else{this.red=D;this.green=C;this.blue=A}}}},getHTMLStyle:function(){return"rgb("+this.red+","+this.green+","+this.blue+")"},getRed:function(){return this.red},getGreen:function(){return this.green},getBlue:function(){return this.blue},getIdealTextColor:function(){var A=105;var B=(this.red*0.299)+(this.green*0.587)+(this.blue*0.114);return(255-B<A)?new draw2d.util.Color(0,0,0):new draw2d.util.Color(255,255,255)},hex2rgb:function(A){A=A.replace("#","");return({0:parseInt(A.substr(0,2),16),1:parseInt(A.substr(2,2),16),2:parseInt(A.substr(4,2),16)})},hex:function(){return(this.int2hex(this.red)+this.int2hex(this.green)+this.int2hex(this.blue))},hash:function(){if(this.hashString===null){this.hashString="#"+this.hex()}return this.hashString},int2hex:function(A){A=Math.round(Math.min(Math.max(0,A),255));return("0123456789ABCDEF".charAt((A-A%16)/16)+"0123456789ABCDEF".charAt(A%16))},darker:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1-B)));var C=parseInt(Math.round(this.getGreen()*(1-B)));var A=parseInt(Math.round(this.getBlue()*(1-B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},lighter:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1+B)));var C=parseInt(Math.round(this.getGreen()*(1+B)));var A=parseInt(Math.round(this.getBlue()*(1+B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},fadeTo:function(B,C){var E=Math.floor(this.red+(C*(B.red-this.red))+0.5);var D=Math.floor(this.green+(C*(B.green-this.green))+0.5);var A=Math.floor(this.blue+(C*(B.blue-this.blue))+0.5);return new draw2d.util.Color(E,D,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/ArrayList.js' */
(function ($) {draw2d.util.ArrayList=Class.extend({init:function(A){this.increment=10;this.size=0;this.data=new Array(this.increment);if(typeof A!=="undefined"){$.each(A,$.proxy(function(B,C){this.add(C)},this))}},reverse:function(){var B=new Array(this.size);for(var A=0;A<this.size;A++){B[A]=this.data[this.size-A-1]}this.data=B;return this},getCapacity:function(){return this.data.length},getSize:function(){return this.size},isEmpty:function(){return this.getSize()===0},getLastElement:function(){if(this.data[this.getSize()-1]!==null){return this.data[this.getSize()-1]}return null},asArray:function(){this.trimToSize();return this.data},getFirstElement:function(){if(this.data[0]!==null&&typeof this.data[0]!=="undefined"){return this.data[0]}return null},get:function(A){return this.data[A]},add:function(A){if(this.getSize()==this.data.length){this.resize()}this.data[this.size++]=A;return this},grep:function(A){this.data=$.grep(this.data,A);this.data=$.grep(this.data,function(B){return(typeof B!=="undefined")});this.size=this.data.length;return this},addAll:function(B){if(!(B instanceof draw2d.util.ArrayList)){throw"Unable to handle unknown object type in ArrayList.addAll"}for(var A=0;A<B.getSize();A++){this.add(B.get(A))}return this},pop:function(){return this.removeElementAt(this.getSize()-1)},push:function(A){this.add(A)},remove:function(B){var A=this.indexOf(B);if(A>=0){return this.removeElementAt(A)}return null},insertElementAt:function(C,A){if(this.size==this.capacity){this.resize()}for(var B=this.getSize();B>A;B--){this.data[B]=this.data[B-1]}this.data[A]=C;this.size++;return this},removeElementAt:function(A){var C=this.data[A];for(var B=A;B<(this.size-1);B++){this.data[B]=this.data[B+1]}this.data[this.size-1]=null;this.size--;return C},removeAll:function(A){$.each(A,$.proxy(function(B,C){this.remove(C)},this));return this},indexOf:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return A}}return -1},contains:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return true}}return false},resize:function(){newData=new Array(this.data.length+this.increment);for(var A=0;A<this.data.length;A++){newData[A]=this.data[A]}this.data=newData;return this},trimToSize:function(){if(this.data.length==this.size){return this}var A=new Array(this.getSize());for(var B=0;B<this.getSize();B++){A[B]=this.data[B]}this.size=A.length;this.data=A;return this},sort:function(F){var D,C;var E;var B;var G;var A;for(D=1;D<this.getSize();D++){B=this.data[D];E=B[F];C=D-1;G=this.data[C];A=G[F];while(C>=0&&A>E){this.data[C+1]=this.data[C];C--;if(C>=0){G=this.data[C];A=G[F]}}this.data[C+1]=B}return this},clone:function(){var A=new draw2d.util.ArrayList();for(var B=0;B<this.size;B++){A.add(this.data[B])}return A},each:function(B){for(var A=0;A<this.size;A++){if(B(A,this.data[A])===false){break}}},overwriteElementAt:function(B,A){this.data[A]=B;return this},getPersistentAttributes:function(){return{data:this.data,increment:this.increment,size:this.getSize()}},setPersistentAttributes:function(A){this.data=A.data;this.increment=A.increment;this.size=A.size}});draw2d.util.ArrayList.EMPTY_LIST=new draw2d.util.ArrayList();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/SVGUtil.js' */
(function ($) {Raphael.fn.polygon=function(F){var D=["M"],A=F.split(" ");for(var C=0;C<A.length;C++){var G=A[C].split(",");for(var B=0;B<G.length;B++){var E=parseFloat(G[B]);if(E){D.push(E)}}if(C==0){D.push("L")}}D.push("Z");return this.path(D)};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/UUID.js' */
(function ($) {draw2d.util.UUID=function(){};draw2d.util.UUID.create=function(){var A=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(A()+A()+"-"+A()+"-"+A()+"-"+A()+"-"+A()+A()+A())};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/Spline.js' */
(function ($) {draw2d.util.spline.Spline=Class.extend({NAME:"draw2d.util.spline.Spline",init:function(){},generate:function(A,B){throw"inherit classes must implement the method 'draw2d.util.spline.Spline.generate()'"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CubicSpline.js' */
(function ($) {draw2d.util.spline.CubicSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.CubicSpline",init:function(){this._super()},generate:function(A,E){var D=new draw2d.util.ArrayList();D.add(A.get(0));D.addAll(A);D.add(A.get(A.getSize()-1));var G=D.getSize();var F=new draw2d.util.ArrayList();F.add(A.get(0));F.add(this.p(1,0,D));for(var C=1;C<G-2;C++){for(var B=1;B<=E;B++){F.add(this.p(C,B/E,D))}}F.add(A.get(A.getSize()-1));return F},p:function(D,I,E){var H=0;var F=0;var B=D-1;for(var C=-2;C<=1;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B===-2){return(((-A+3)*A-3)*A+1)/6}else{if(B===-1){return(((3*A-6)*A)*A+4)/6}else{if(B===0){return(((-3*A+3)*A+3)*A+1)/6}}}return(A*A*A)/6}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CatmullRomSpline.js' */
(function ($) {draw2d.util.spline.CatmullRomSpline=draw2d.util.spline.CubicSpline.extend({NAME:"draw2d.util.spline.CatmullRomSpline",init:function(){this._super()},blend:function(B,A){if(B==-2){return((-A+2)*A-1)*A/2}else{if(B==-1){return(((3*A-5)*A)*A+2)/2}else{if(B==0){return((-3*A+4)*A+1)*A/2}else{return((A-1)*A*A)/2}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/BezierSpline.js' */
(function ($) {draw2d.util.spline.BezierSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.BezierSpline",init:function(){this._super()},generate:function(A,D){var F=A.getSize();var E=new draw2d.util.ArrayList();E.add(this.p(0,0,A));for(var C=0;C<F-3;C+=3){for(var B=1;B<=D;B++){E.add(this.p(C,B/D,A))}}return E},p:function(D,I,E){var H=0;var F=0;var B=D;for(var C=0;C<=3;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B==0){return(1-A)*(1-A)*(1-A)}else{if(B==1){return 3*A*(1-A)*(1-A)}else{if(B==2){return 3*A*A*(1-A)}else{return A*A*A}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/PositionConstants.js' */
(function ($) {draw2d.geo.PositionConstants=function(){};draw2d.geo.PositionConstants.NORTH=1;draw2d.geo.PositionConstants.SOUTH=4;draw2d.geo.PositionConstants.WEST=8;draw2d.geo.PositionConstants.EAST=16;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Point.js' */
(function ($) {draw2d.geo.Point=Class.extend({NAME:"draw2d.geo.Point",init:function(A,B){this.x=A;this.y=B;this.bx=null;this.by=null;this.bw=null;this.bh=null},setBoundary:function(C,B,D,A){if(C instanceof draw2d.geo.Rectangle){this.bx=C.x;this.by=C.y;this.bw=C.w;this.bh=C.h}else{this.bx=C;this.by=B;this.bw=D;this.bh=A}this.adjustBoundary();return this},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw);this.y=Math.min(Math.max(this.by,this.y),this.bh);return this},translate:function(B,A){this.x+=B;this.y+=A;this.adjustBoundary();return this},getX:function(){return this.x},getY:function(){return this.y},setX:function(A){this.x=A;this.adjustBoundary();return this},setY:function(A){this.y=A;this.adjustBoundary();return this},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.adjustBoundary();return this},getPosition:function(C){var B=C.x-this.x;var A=C.y-this.y;if(Math.abs(B)>Math.abs(A)){if(B<0){return draw2d.geo.PositionConstants.WEST}return draw2d.geo.PositionConstants.EAST}if(A<0){return draw2d.geo.PositionConstants.NORTH}return draw2d.geo.PositionConstants.SOUTH},equals:function(A){return this.x===A.x&&this.y===A.y},getDistance:function(A){return Math.sqrt((this.x-A.x)*(this.x-A.x)+(this.y-A.y)*(this.y-A.y))},getTranslated:function(A){return new draw2d.geo.Point(this.x+A.x,this.y+A.y)},getPersistentAttributes:function(){return{x:this.x,y:this.y}},setPersistentAttributes:function(A){this.x=A.x;this.y=A.y},subtract:function(A){return new draw2d.geo.Point(this.x-A.x,this.y-A.y)},dot:function(A){return this.x*A.x+this.y*A.y},cross:function(A){return this.x*A.y-this.y*A.x},lerp:function(B,A){return new draw2d.geo.Point(this.x+(B.x-this.x)*A,this.y+(B.y-this.y)*A)},clone:function(){return new draw2d.geo.Point(this.x,this.y)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Rectangle.js' */
(function ($) {draw2d.geo.Rectangle=draw2d.geo.Point.extend({NAME:"draw2d.geo.Rectangle",init:function(A,D,B,C){this._super(A,D);this.w=B;this.h=C},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw-this.w);this.y=Math.min(Math.max(this.by,this.y),this.bh-this.h);this.w=Math.min(this.w,this.bw);this.h=Math.min(this.h,this.bh)},resize:function(A,B){this.w+=A;this.h+=B;this.adjustBoundary();return this},scale:function(A,B){this.w+=(A);this.h+=(B);this.x-=(A/2);this.y-=(B/2);this.adjustBoundary();return this},setBounds:function(A){this.setPosition(A.x,A.y);this.w=A.w;this.h=A.h;return this},isEmpty:function(){return this.w<=0||this.h<=0},getWidth:function(){return this.w},setWidth:function(A){this.w=A;this.adjustBoundary();return this},getHeight:function(){return this.h},setHeight:function(A){this.h=A;this.adjustBoundary();return this},getLeft:function(){return this.x},getRight:function(){return this.x+this.w},getTop:function(){return this.y},getBottom:function(){return this.y+this.h},getTopLeft:function(){return new draw2d.geo.Point(this.x,this.y)},getTopCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y)},getTopRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y)},getBottomLeft:function(){return new draw2d.geo.Point(this.x,this.y+this.h)},getBottomCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y+this.h)},getCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y+this.h/2)},getBottomRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y+this.h)},getPoints:function(){var A=new draw2d.util.ArrayList();A.add(this.getTopLeft());A.add(this.getTopRight());A.add(this.getBottomRight());A.add(this.getBottomLeft());return A},moveInside:function(B){var A=new draw2d.geo.Rectangle(B.x,B.y,B.w,B.h);A.x=Math.max(A.x,this.x);A.y=Math.max(A.y,this.y);if(A.w<this.w){A.x=Math.min(A.x+A.w,this.x+this.w)-A.w}else{A.x=this.x}if(A.h<this.h){A.y=Math.min(A.y+A.h,this.y+this.h)-A.h}else{A.y=this.y}return A},getDistance:function(H){var F=this.x;var E=this.y;var G=this.w;var A=this.h;var C=H.getX();var B=H.getY();var D=1;var J=1;if(H instanceof draw2d.geo.Rectangle){D=H.getWidth();J=H.getHeight()}var I=9;if(F+G<=C){if((E+A)<=B){I=0}else{if(E>=(B+J)){I=6}else{I=7}}}else{if(F>=C+D){if(E+A<=B){I=2}else{if(E>=B+J){I=4}else{I=3}}}else{if(E+A<=B){I=1}else{if(E>=B+J){I=5}else{return 0}}}}switch(I){case 0:F=(F+G)-C;E=(E+A)-B;return -(F+E);case 1:return -((E+A)-B);case 2:F=(C+D)-F;E=(E+A)-B;return -(F+E);case 3:return -((C+D)-F);case 4:F=(C+D)-F;E=(B+J)-E;return -(F+E);case 5:return -((B+J)-E);case 6:F=(F+G)-C;E=(B+J)-E;return -(F+E);case 7:return -((F+G)-C)}throw"Unknown data type of parameter for distance calculation in draw2d.geo.Rectangle.getDistnace(..)"},determineOctant:function(D){var J=3;var C=this.x+J;var B=this.y+J;var E=this.w-(J*2);var K=this.h-(J*2);var G=D.x;var F=D.y;var H=2;var A=2;if(D instanceof draw2d.geo.Rectangle){H=D.w;A=D.h}var I=0;if(G+H<=C){if((F+A)<=B){I=0}else{if(F>=(B+K)){I=6}else{I=7}}}else{if(G>=C+E){if(F+A<=B){I=2}else{if(F>=B+K){I=4}else{I=3}}}else{if(F+A<=B){I=1}else{if(F>=B+K){I=5}else{I=8}}}}return I},getDirection:function(A){var B=this.getTopLeft();switch(this.determineOctant(A)){case 0:if((B.x-A.x)<(B.y-A.y)){return 0}return 3;case 1:return 0;case 2:B=this.getTopRight();if((A.x-B.x)<(B.y-A.y)){return 0}return 1;case 3:return 1;case 4:B=this.getBottomRight();if((A.x-B.x)<(A.y-B.y)){return 2}return 1;case 5:return 2;case 6:B=this.getBottomLeft();if((B.x-A.x)<(A.y-B.y)){return 2}return 3;case 7:return 3;case 8:if(A.y>this.y){return 2}return 0}return 0},equals:function(A){return this.x==A.x&&this.y==A.y&&this.w==A.w&&this.h==A.h},hitTest:function(A,D){if(A instanceof draw2d.geo.Point){D=A.y;A=A.x}var B=this.x+this.getWidth();var C=this.y+this.getHeight();return(A>=this.x&&A<=B&&D>=this.y&&D<=C)},isInside:function(A){return A.hitTest(this.getTopLeft())&&A.hitTest(this.getTopRight())&&A.hitTest(this.getBottomLeft())&&A.hitTest(this.getBottomRight())},intersects:function(A){x11=A.x,y11=A.y,x12=A.x+A.w,y12=A.y+A.h,x21=this.x,y21=this.y,x22=this.x+this.w,y22=this.y+this.h;x_overlap=Math.max(0,Math.min(x12,x22)-Math.max(x11,x21));y_overlap=Math.max(0,Math.min(y12,y22)-Math.max(y11,y21));return x_overlap*y_overlap!==0},toJSON:function(){return{width:this.w,height:this.h,x:this.x,y:this.y}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandType.js' */
(function ($) {draw2d.command.CommandType=Class.extend({NAME:"draw2d.command.CommandType",init:function(A){this.policy=A},getPolicy:function(){return this.policy}});draw2d.command.CommandType.DELETE="DELETE";draw2d.command.CommandType.MOVE="MOVE";draw2d.command.CommandType.CONNECT="CONNECT";draw2d.command.CommandType.MOVE_BASEPOINT="MOVE_BASEPOINT";draw2d.command.CommandType.RESIZE="RESIZE";draw2d.command.CommandType.RESET="RESET";}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/Command.js' */
(function ($) {draw2d.command.Command=Class.extend({NAME:"draw2d.command.Command",init:function(A){this.label=A},getLabel:function(){return this.label},canExecute:function(){return true},execute:function(){},cancel:function(){},undo:function(){},redo:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandCollection.js' */
(function ($) {draw2d.command.CommandCollection=draw2d.command.Command.extend({NAME:"draw2d.command.CommandCollection",init:function(){this._super("Execute Commands");this.commands=new draw2d.util.ArrayList()},add:function(A){this.commands.add(A)},execute:function(){this.commands.each(function(A,B){B.execute()})},redo:function(){this.commands.each(function(A,B){B.redo()})},undo:function(){this.commands.reverse();this.commands.each(function(A,B){B.undo()});this.commands.reverse()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStack.js' */
(function ($) {draw2d.command.CommandStack=Class.extend({NAME:"draw2d.command.CommandStack",init:function(){this.undostack=[];this.redostack=[];this.maxundo=50;this.transactionCommand=null;this.eventListeners=new draw2d.util.ArrayList()},setUndoLimit:function(A){this.maxundo=A},markSaveLocation:function(){this.undostack=[];this.redostack=[];this.notifyListeners(new draw2d.command.Command(),draw2d.command.CommandStack.POST_EXECUTE)},execute:function(A){if(A===null){return }if(typeof A==="undefined"){throw"Missing parameter [command] for method call CommandStack.execute"}if(A.canExecute()===false){return }if(this.transactionCommand!==null){this.transactionCommand.add(A);return }this.notifyListeners(A,draw2d.command.CommandStack.PRE_EXECUTE);this.undostack.push(A);A.execute();this.redostack=[];if(this.undostack.length>this.maxundo){this.undostack=this.undostack.slice(this.undostack.length-this.maxundo)}this.notifyListeners(A,draw2d.command.CommandStack.POST_EXECUTE)},startTransaction:function(){this.transactionCommand=new draw2d.command.CommandCollection()},commitTransaction:function(){if(this.transactionCommand===null){return }var A=this.transactionCommand;this.transactionCommand=null;this.execute(A)},undo:function(){var A=this.undostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_UNDO);this.redostack.push(A);A.undo();this.notifyListeners(A,draw2d.command.CommandStack.POST_UNDO)}},redo:function(){var A=this.redostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_REDO);this.undostack.push(A);A.redo();this.notifyListeners(A,draw2d.command.CommandStack.POST_REDO)}},getRedoLabel:function(){if(this.redostack.lenght===0){return""}var A=this.redostack[this.redostack.length-1];if(A){return A.getLabel()}return""},getUndoLabel:function(){if(this.undostack.lenght===0){return""}var A=this.undostack[this.undostack.length-1];if(A){return A.getLabel()}return""},canRedo:function(){return this.redostack.length>0},canUndo:function(){return this.undostack.length>0},addEventListener:function(A){if(A instanceof draw2d.command.CommandStackEventListener){this.eventListeners.add(A)}else{if(typeof A.stackChanged==="function"){this.eventListeners.add(A)}else{if(typeof A==="function"){this.eventListeners.add({stackChanged:A})}else{throw"Object doesn't implement required callback interface [draw2d.command.CommandStackListener]"}}}},removeEventListener:function(C){for(var A=0;A<size;A++){var B=this.eventListeners.get(A);if(B===C||B.stackChanged===C){this.eventListeners.remove(B);return }}},notifyListeners:function(E,D){var C=new draw2d.command.CommandStackEvent(this,E,D);var B=this.eventListeners.getSize();for(var A=0;A<B;A++){this.eventListeners.get(A).stackChanged(C)}}});draw2d.command.CommandStack.PRE_EXECUTE=1;draw2d.command.CommandStack.PRE_REDO=2;draw2d.command.CommandStack.PRE_UNDO=4;draw2d.command.CommandStack.POST_EXECUTE=8;draw2d.command.CommandStack.POST_REDO=16;draw2d.command.CommandStack.POST_UNDO=32;draw2d.command.CommandStack.POST_INIT=64;draw2d.command.CommandStack.POST_MASK=draw2d.command.CommandStack.POST_EXECUTE|draw2d.command.CommandStack.POST_UNDO|draw2d.command.CommandStack.POST_REDO;draw2d.command.CommandStack.PRE_MASK=draw2d.command.CommandStack.PRE_EXECUTE|draw2d.command.CommandStack.PRE_UNDO|draw2d.command.CommandStack.PRE_REDO;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEvent.js' */
(function ($) {draw2d.command.CommandStackEvent=Class.extend({NAME:"draw2d.command.CommandStackEvent",init:function(A,C,B){this.stack=A;this.command=C;this.details=B},getStack:function(){return this.stack},getCommand:function(){return this.command},getDetails:function(){return this.details},isPostChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.POST_MASK)},isPreChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.PRE_MASK)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEventListener.js' */
(function ($) {draw2d.command.CommandStackEventListener=Class.extend({NAME:"draw2d.command.CommandStackEventListener",init:function(){},stackChanged:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMove.js' */
(function ($) {draw2d.command.CommandMove=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMove",init:function(B,A,C){this._super("Shape moved");this.figure=B;if(typeof A==="undefined"){this.oldX=B.getX();this.oldY=B.getY()}else{this.oldX=A;this.oldY=C}},setStartPosition:function(A,B){this.oldX=A;this.oldY=B},setPosition:function(A,B){this.newX=A;this.newY=B},canExecute:function(){return this.newX!=this.oldX||this.newY!=this.oldY},execute:function(){this.redo()},undo:function(){this.figure.setPosition(this.oldX,this.oldY)},redo:function(){this.figure.setPosition(this.newX,this.newY)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMoveLine.js' */
(function ($) {draw2d.command.CommandMoveLine=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveLine",init:function(B,C,A,E,D){this._super("Line moved");this.line=B;this.startX1=C;this.startY1=A;this.endX1=E;this.endY1=D;this.startX2=-1;this.startY2=-1;this.endX2=-1;this.endY2=-1},canExecute:function(){return this.startX1!=this.startX2||this.startY1!=this.startY2||this.endX1!=this.endX2||this.endY1!=this.endY2},execute:function(){this.startX2=this.line.getStartX();this.startY2=this.line.getStartY();this.endX2=this.line.getEndX();this.endY2=this.line.getEndY();this.redo()},undo:function(){this.line.setStartPoint(this.startX1,this.startY1);this.line.setEndPoint(this.endX1,this.endY1)},redo:function(){this.line.setStartPoint(this.startX2,this.startY2);this.line.setEndPoint(this.endX2,this.endY2)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandResize.js' */
(function ($) {draw2d.command.CommandResize=draw2d.command.Command.extend({NAME:"draw2d.command.CommandResize",init:function(B,C,A){this._super("Resize Shape");this.figure=B;if(typeof C==="undefined"){this.oldWidth=B.getWidth();this.oldHeight=B.getHeight()}else{this.oldWidth=C;this.oldHeight=A}},setDimension:function(B,A){this.newWidth=B|0;this.newHeight=A|0},canExecute:function(){return this.newWidth!=this.oldWidth||this.newHeight!=this.oldHeight},execute:function(){this.redo()},undo:function(){this.figure.setDimension(this.oldWidth,this.oldHeight)},redo:function(){this.figure.setDimension(this.newWidth,this.newHeight)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandConnect.js' */
(function ($) {draw2d.command.CommandConnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandConnect",init:function(A,B,C){this._super("Connecting Ports");this.canvas=A;this.source=B;this.target=C;this.connection=null},setConnection:function(A){this.connection=A},execute:function(){if(this.connection===null){this.connection=draw2d.Connection.createConnection(this.source,this.target)}this.connection.setSource(this.source);this.connection.setTarget(this.target);this.canvas.addFigure(this.connection);this.canvas.onNewConnection(this.connection)},redo:function(){this.canvas.addFigure(this.connection);this.connection.reconnect()},undo:function(){this.canvas.removeFigure(this.connection)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandReconnect.js' */
(function ($) {draw2d.command.CommandReconnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandReconnect",init:function(A){this._super("Connecting Ports");this.con=A;this.oldSourcePort=A.getSource();this.oldTargetPort=A.getTarget();this.oldRouter=A.getRouter()},canExecute:function(){return true},setNewPorts:function(A,B){this.newSourcePort=A;this.newTargetPort=B},execute:function(){this.redo()},cancel:function(){this.con.calculatePath();this.con.setRouter(this.oldRouter)},undo:function(){this.con.setSource(this.oldSourcePort);this.con.setTarget(this.oldTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())},redo:function(){this.con.setSource(this.newSourcePort);this.con.setTarget(this.newTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandDelete.js' */
(function ($) {draw2d.command.CommandDelete=draw2d.command.Command.extend({init:function(A){this._super("Deleting Shape");this.parent=A.getParent();this.figure=A;this.canvas=A.getCanvas();this.connections=null},execute:function(){this.redo()},undo:function(){this.canvas.addFigure(this.figure);if(this.figure instanceof draw2d.Connection){this.figure.reconnect()}this.canvas.setCurrentSelection(this.figure);if(this.parent!==null){this.parent.addChild(this.figure)}for(var A=0;A<this.connections.getSize();++A){this.canvas.addFigure(this.connections.get(A));this.connections.get(A).reconnect()}},redo:function(){this.canvas.setCurrentSelection(null);if(this.figure instanceof draw2d.shape.node.Node&&this.connections===null){this.connections=new draw2d.util.ArrayList();var E=this.figure.getPorts();for(var C=0;C<E.getSize();C++){var A=E.get(C);for(var D=0,B=A.getConnections().getSize();D<B;D++){if(!this.connections.contains(A.getConnections().get(D))){this.connections.add(A.getConnections().get(D))}}}for(var C=0;C<E.getSize();C++){var A=E.get(C);A.setCanvas(null)}}this.canvas.removeFigure(this.figure);if(this.connections===null){this.connections=new draw2d.util.ArrayList()}if(this.parent!==null){this.parent.removeChild(this.figure)}for(var C=0;C<this.connections.getSize();++C){this.canvas.removeFigure(this.connections.get(C))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandAdd.js' */
(function ($) {draw2d.command.CommandAdd=draw2d.command.Command.extend({init:function(C,B,A,D){this._super("Add Shape");this.figure=B;this.canvas=C;this.x=A;this.y=D},execute:function(){this.canvas.addFigure(this.figure,this.x,this.y)},redo:function(){this.execute()},undo:function(){this.canvas.removeFigure(this.figure)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ConnectionRouter=Class.extend({NAME:"draw2d.layout.connection.ConnectionRouter",init:function(){},route:function(A){throw"subclasses must implement the method [ConnectionRouter.route]"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/DirectRouter.js' */
(function ($) {draw2d.layout.connection.DirectRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.DirectRouter",init:function(){},invalidate:function(){},route:function(B){var D=B.getStartPoint();var A=B.getEndPoint();B.addPoint(D);B.addPoint(A);var C=["M",D.x," ",D.y];C.push("L",A.x," ",A.y);B.svgPathString=C.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanConnectionRouter",MINDIST:20,TOL:0.1,TOLxTOL:0.01,TOGGLE_DIST:5,init:function(){},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(D,E,F,N,C){var M=0;var G=1;var K=2;var A=3;var J=E.x-N.x;var H=E.y-N.y;var L;var B;if(((J*J)<(this.TOLxTOL))&&((H*H)<(this.TOLxTOL))){D.addPoint(new draw2d.geo.Point(N.x,N.y));return }if(F===A){if((J>0)&&((H*H)<this.TOL)&&(C===G)){L=N;B=C}else{if(J<0){L=new draw2d.geo.Point(E.x-this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F==C){var I=Math.min(E.x,N.x)-this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===G){if((J<0)&&((H*H)<this.TOL)&&(C===A)){L=N;B=C}else{if(J>0){L=new draw2d.geo.Point(E.x+this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F===C){var I=Math.max(E.x,N.x)+this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===K){if(((J*J)<this.TOL)&&(H<0)&&(C===M)){L=N;B=C}else{if(H>0){L=new draw2d.geo.Point(E.x,E.y+this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.max(E.y,N.y)+this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}else{if(F===M){if(((J*J)<this.TOL)&&(H>0)&&(C===K)){L=N;B=C}else{if(H<0){L=new draw2d.geo.Point(E.x,E.y-this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.min(E.y,N.y)-this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}}}}this._route(D,L,B,N,C);D.addPoint(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanBridgedConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanBridgedConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanBridgedConnectionRouter",BRIDGE_HORIZONTAL_LR:" r 0 0 3 -4 7 -4 10 0 13 0 ",BRIDGE_HORIZONTAL_RL:" r 0 0 -3 -4 -7 -4 -10 0 -13 0 ",init:function(){},route:function(E){var F=E.getStartPoint();var K=E.getSource().getConnectionDirection(E,E.getTarget());var N=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,N,D,F,K);var O=E.getCanvas().getIntersection(E).sort("x");var L=O.clone().reverse();var G=O;var I=0;var A=E.getPoints();var B=A.get(0);var M=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;for(I=1;I<A.getSize();I++){B=A.get(I);var J=5;var H=this.BRIDGE_HORIZONTAL_LR;if(C.x>B.x){G=L;H=this.BRIDGE_HORIZONTAL_RL;J=-J}G.each(function(P,Q){if(Q.justTouching==false&&draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,Q.x,Q.y)===true){if(B.y===Q.y){M.push(" L",((Q.x-J)|0)+0.5," ",(Q.y|0)+0.5);M.push(H)}}});M.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=M.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/CircuitConnectionRouter.js' */
(function ($) {draw2d.layout.connection.CircuitConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.CircuitConnectionRouter",init:function(){this.setBridgeRadius(4);this.setJunctionRadius(2);this.abortRoutingOnFirstJunctionNode=false},setJunctionRadius:function(A){this.junctionRadius=A},setBridgeRadius:function(A){this.bridgeRadius=A;this.bridge_LR=[" r",0.5,-0.5,A-(A/2),-(A-A/4),A,-A,A+(A/2),-(A-A/4),A*2,"0 "].join(" ");this.bridge_RL=[" r",-0.5,-0.5,-(A-(A/2)),-(A-A/4),-A,-A,-(A+(A/2)),-(A-A/4),-A*2,"0 "].join(" ")},route:function(E){var F=E.getStartPoint();var L=E.getSource().getConnectionDirection(E,E.getTarget());var O=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,O,D,F,L);var P=E.getCanvas().getIntersection(E).sort("x");var M=P.clone().reverse();var G=P;var J=0;if(typeof E.junctionNodes!=="undefined"&&E.junctionNodes!==null){E.junctionNodes.remove()}E.junctionNodes=E.canvas.paper.set();var A=E.getPoints();var B=A.get(0);var N=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;var K=null;var I=null;var H=null;for(J=1;J<A.getSize();J++){B=A.get(J);if(C.x>B.x){G=M;I=this.bridge_RL;K=-this.bridgeRadius}else{G=P;I=this.bridge_LR;K=this.bridgeRadius}G.each($.proxy(function(S,U){if(draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,U.x,U.y)===true){if(E.sharingPorts(U.other)){var Q=U.other;var V=Q.getZOrder();var R=E.getZOrder();if(R<V){var T=E.canvas.paper.ellipse(U.x,U.y,this.junctionRadius,this.junctionRadius).attr({fill:E.lineColor.hash()});E.junctionNodes.push(T);if(this.abortRoutingOnFirstJunctionNode===true){if(E.getSource()==Q.getSource()||E.getSource()==Q.getTarget()){N=["M",(U.x|0)+0.5," ",(U.y|0)+0.5];if(H!==null){H.remove();E.junctionNodes.exclude(H)}}H=T}}}else{if(B.y===U.y){N.push(" L",((U.x-K)|0)+0.5," ",(U.y|0)+0.5);N.push(I)}}}},this));N.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=N.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SplineConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SplineConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.SplineConnectionRouter",init:function(){this.spline=new draw2d.util.spline.CubicSpline();this.MINDIST=50,this.cheapRouter=null},route:function(D){var F=0;var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var J=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,J,C,E,G);var A=D.getPoints();D.oldPoint=null;D.lineSegments=new draw2d.util.ArrayList();D.basePoints=new draw2d.util.ArrayList();var H=this.spline.generate(A,8);H.each(function(K,L){D.addPoint(L)});var A=D.getPoints();length=A.getSize();var B=A.get(0);var I=["M",B.x," ",B.y];for(F=1;F<length;F++){B=A.get(F);I.push("L",B.x," ",B.y)}D.svgPathString=I.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/FanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.FanConnectionRouter=draw2d.layout.connection.DirectRouter.extend({NAME:"gdraw2d.layout.connection.FanConnectionRouter",init:function(){},route:function(F){var B=F.getSource().getConnections();var E=new draw2d.util.ArrayList();var C=0;for(var D=0;D<B.getSize();D++){var A=B.get(D);if(A.getTarget()===F.getTarget()||A.getSource()===F.getTarget()){E.add(A);if(F===A){C=E.getSize()}}}if(E.getSize()>1){this.routeCollision(F,C)}else{this._super(F)}},routeCollision:function(F,L){var C=F.getStartPoint();var I=F.getEndPoint();var H=15;var N=new draw2d.geo.Point((I.x+C.x)/2,(I.y+C.y)/2);var K=I.getPosition(C);var O;if(K==draw2d.geo.PositionConstants.SOUTH||K==draw2d.geo.PositionConstants.EAST){O=new draw2d.geo.Point(I.x-C.x,I.y-C.y)}else{O=new draw2d.geo.Point(C.x-I.x,C.y-I.y)}var D=Math.sqrt(O.x*O.x+O.y*O.y);var M=H*O.x/D;var G=H*O.y/D;var E;if(L%2===0){E=new draw2d.geo.Point(N.x+(L/2)*(-1*G),N.y+(L/2)*M)}else{E=new draw2d.geo.Point(N.x+(L/2)*G,N.y+(L/2)*(-1*M))}F.addPoint(C);F.addPoint(E);F.addPoint(I);var A=F.getPoints();var B=A.get(0);var P=["M",B.x," ",B.y];for(var J=1;J<A.getSize();J++){B=A.get(J);P.push("L",B.x," ",B.y)}F.svgPathString=P.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/MazeConnectionRouter.js' */
(function ($) {var ROUTER_RECTS=null;draw2d.layout.connection.MazeConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.MazeConnectionRouter",init:function(){this.useSpline=false;this.useSimplify=true;this.useSimplifyValue=2;this.useDebug=false;this.useShift=4;this.portOutletOffset=15;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(E,F,J,M,D){var C=this.useShift;oldToPt=M;oldFromPt=F;F=this.getAddjustedPoint(F,J,this.portOutletOffset);M=this.getAddjustedPoint(M,D,this.portOutletOffset);var A=this.generateNoGoGrid(E,F,J,M,D);var N=this.finder.findPath(F.x>>C,F.y>>C,M.x>>C,M.y>>C,A);$.each(N,function(O,P){P.x=P[0]=P[0]<<C;P.y=P[1]=P[1]<<C});if(this.useDebug){if(ROUTER_RECTS!==null){ROUTER_RECTS.remove()}ROUTER_RECTS=E.canvas.paper.set();for(var H=0;H<A.width;H++){for(var G=0;G<A.height;G++){if(!A.isWalkableAt(H,G)){ROUTER_RECTS.push(E.canvas.paper.rect(H<<C,G<<C,1<<C,1<<C).attr({fill:"red",opacity:"0.1"}))}}}ROUTER_RECTS.push(E.canvas.paper.rect(F.x-3,F.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));ROUTER_RECTS.push(E.canvas.paper.rect(M.x-3,M.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#0000ff",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#0000ff"}))}this.adjustPath(F,N,J);N.reverse();this.adjustPath(M,N,D);N.reverse();$.each(N,function(O,P){P.x=P[0];P.y=P[1]});if(this.useSpline){var B=new draw2d.util.ArrayList();B.add(oldFromPt);$.each(N,function(O,P){B.add(new draw2d.geo.Point(P[0],P[1]))});B.add(oldToPt);if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var L=N[0];var K=["M",L.x," ",L.y];for(var H=1;H<N.length;H++){L=N[H];K.push("L",L.x," ",L.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}this.spline=new draw2d.util.spline.CubicSpline();var I=this.spline.generate(B,8);if(this.useSimplify){N=[];I.each(function(O,P){N.push({x:P.x,y:P.y})});N=this.simplify(N,this.useSimplifyValue,true);$.each(N,function(O,P){E.addPoint(P.x,P.y)})}else{I.each(function(O,P){E.addPoint(P)})}}else{if(this.useSimplify){N=this.simplify(N,this.useSimplifyValue,true)}if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}E.addPoint(oldFromPt);$.each(N,function(O,P){E.addPoint(P[0],P[1])});E.addPoint(oldToPt)}},generateNoGoGrid:function(F,G,C,I,B){var Q=this.useShift;var L=(1<<Q)/2;var R=F.getCanvas().paper.width>>Q;var D=F.getCanvas().paper.height>>Q;var A=new PF.Grid(R,D);var E=F.getCanvas().getFigures();E.each(function(V,Y){var X=Y.getBoundingBox();if(X.hitTest(G.x,G.y)===true||X.hitTest(I.x,I.y)){return }var T=X.x>>Q;var Z=X.y>>Q;if(T<1||Z<1){return }var W=(X.x+X.w+L)>>Q;var S=(X.y+X.h+L)>>Q;for(var V=T;V<=W;V++){for(var U=Z;U<=S;U++){A.setWalkableAt(V,U,false)}}});var K=F.getSource().getParent().getBoundingBox();if(B===1||B===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(I.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(I.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}K=F.getTarget().getParent().getBoundingBox();if(C===1||C===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(G.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(G.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}return A},getAddjustedPoint:function(C,B,A){switch(B){case 0:return new draw2d.geo.Point(C.x,C.y-A);case 1:return new draw2d.geo.Point(C.x+A,C.y);case 2:return new draw2d.geo.Point(C.x,C.y+A);case 3:return new draw2d.geo.Point(C.x-A,C.y)}},adjustPath:function(E,D,C){var B=this.useShift;var A=E.x>>B;var F=E.y>>B;$.each(D,function(G,H){if(F===(H[1]>>B)){H[1]=E.y}else{return false}});$.each(D,function(G,H){if(A===(H[0]>>B)){H[0]=E.x}else{return false}})},getSquareDistance:function(D,C){var B=D.x-C.x,A=D.y-C.y;return B*B+A*A},getSquareSegmentDistance:function(F,G,E){var A=G.x,H=G.y,C=E.x-A,B=E.y-H,D;if(C!==0||B!==0){D=((F.x-A)*C+(F.y-H)*B)/(C*C+B*B);if(D>1){A=E.x;H=E.y}else{if(D>0){A+=C*D;H+=B*D}}}C=F.x-A;B=F.y-H;return C*C+B*B},simplifyRadialDistance:function(F,D){var E,B=F.length,A,C=F[0],G=[C];for(E=1;E<B;E++){A=F[E];if(this.getSquareDistance(A,C)>D){G.push(A);C=A}}if(C!==A){G.push(A)}return G},simplifyDouglasPeucker:function(M,A){var I=M.length,K=(typeof Uint8Array!==undefined+"")?Uint8Array:Array,C=new K(I),G=0,L=I-1,E,D,F,H,B=[],J=[],N=[];C[G]=C[L]=1;while(L){D=0;for(E=G+1;E<L;E++){F=this.getSquareSegmentDistance(M[E],M[G],M[L]);if(F>D){H=E;D=F}}if(D>A){C[H]=1;B.push(G);J.push(H);B.push(H);J.push(L)}G=B.pop();L=J.pop()}for(E=0;E<I;E++){if(C[E]){N.push(M[E])}}return N},simplify:function(C,A,D){var B=(A!==undefined)?A*A:1;if(!D){C=this.simplifyRadialDistance(C,B)}C=this.simplifyDouglasPeucker(C,B);return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SketchConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SketchConnectionRouter=draw2d.layout.connection.MazeConnectionRouter.extend({NAME:"draw2d.layout.connection.SketchConnectionRouter",init:function(){this._super();this.useSpline=true;this.useShift=5;this.useSimplifyValue=0.2;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/MeshLayouter.js' */
(function ($) {draw2d.layout.mesh.MeshLayouter=Class.extend({init:function(){},add:function(B,A){return new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ExplodeLayouter.js' */
(function ($) {draw2d.layout.mesh.ExplodeLayouter=draw2d.layout.mesh.MeshLayouter.extend({MIN_MARGIN:40,init:function(){},add:function(A,E){var J=[];J[0]={x:0,y:0};J[1]={x:0,y:0};J[2]={x:0,y:0};J[3]={x:0,y:0};J[4]={x:0,y:0};J[5]={x:0,y:0};J[6]={x:0,y:0};J[7]={x:0,y:0};J[8]={x:0,y:0};var C=E.getBoundingBox();var H=A.getFigures();var I=null;var B=0;var G=0;var F=null;var D=0;for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){B=I.getBoundingBox().getDistance(C);if(B<this.MIN_MARGIN){G=this.determineOctant(C,I.getBoundingBox());switch(G){case 2:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 3:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 4:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 5:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 6:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 8:B=(C.getBottomRight().getDistance(I.getBoundingBox().getTopLeft()))|0;J[2].x=Math.max(J[2].x,this.MIN_MARGIN+B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN+B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN+B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN+B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN+B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN+B);J[8].x=Math.max(J[8].x,this.MIN_MARGIN+B)}}}}var K=new draw2d.util.ArrayList();for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){G=this.determineOctant(C,I.getBoundingBox());F=J[G];if(F.x!==0||F.y!==0){K.add(new draw2d.layout.mesh.ProposedMeshChange(I,F.x,F.y))}}}return K},determineOctant:function(F,D){var C=F.x;var B=F.y;var E=F.w;var K=F.h;var H=D.x;var G=D.y;var I=D.w;var A=D.h;var J=0;if(H+I<=C){if((G+A)<=B){J=0}else{if(G>=(B+K)){J=6}else{J=7}}}else{if(H>=C+E){if(G+A<=B){J=2}else{if(G>=B+K){J=4}else{J=3}}}else{if(G+A<=B){J=1}else{if(G>=B+K){J=5}else{J=8}}}}return J}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ProposedMeshChange.js' */
(function ($) {draw2d.layout.mesh.ProposedMeshChange=Class.extend({init:function(B,A,C){this.figure=B;this.x=A;this.y=C},getFigure:function(){return this.figure},getX:function(){return this.x},getY:function(){return this.y}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/Locator.js' */
(function ($) {draw2d.layout.locator.Locator=Class.extend({NAME:"draw2d.layout.locator.Locator",init:function(A){this.parent=A},getParent:function(){return this.parent},setParent:function(A){this.parent=A},relocate:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PortLocator.js' */
(function ($) {draw2d.layout.locator.PortLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.PortLocator",init:function(){this._super()},applyConsiderRotation:function(A,G,F){var H=A.getParent();var I=H.getWidth()/2;var D=H.getHeight()/2;var C=H.getRotationAngle();var B=Raphael.matrix();B.rotate(C,I,D);if(C===90||C===270){var E=H.getHeight()/H.getWidth();B.scale(E,1/E,I,D)}A.setPosition(B.x(G,F),B.y(G,F))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/InputPortLocator.js' */
(function ($) {draw2d.layout.locator.InputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.InputPortLocator",init:function(){this._super()},relocate:function(B,A){var D=A.getParent();var C=D.getHeight();var E=C/(D.getInputPorts().getSize()+1);this.applyConsiderRotation(A,0,E*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/OutputPortLocator.js' */
(function ($) {draw2d.layout.locator.OutputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.OutputPortLocator",init:function(){this._super()},relocate:function(B,A){var C=A.getParent();var D=C.getHeight()/(C.getOutputPorts().getSize()+1);this.applyConsiderRotation(A,C.getWidth(),D*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ConnectionLocator.js' */
(function ($) {draw2d.layout.locator.ConnectionLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.ConnectionLocator",init:function(A){this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ManhattanMidpointLocator.js' */
(function ($) {draw2d.layout.locator.ManhattanMidpointLocator=draw2d.layout.locator.ConnectionLocator.extend({NAME:"draw2d.layout.locator.ManhattanMidpointLocator",init:function(A){this._super(A)},relocate:function(C,D){var A=this.getParent();var H=A.getPoints();var B=Math.floor((H.getSize()-2)/2);if(H.getSize()<=B+1){return }var I=H.get(B);var G=H.get(B+1);if(!I||!G){return }var F=((G.x-I.x)/2+I.x-D.getWidth()/2)|0;var E=((G.y-I.y)/2+I.y-D.getHeight()/2)|0;D.setPosition(F,E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PolylineMidpointLocator.js' */
(function ($) {draw2d.layout.locator.PolylineMidpointLocator=draw2d.layout.locator.ManhattanMidpointLocator.extend({NAME:"draw2d.layout.locator.PolylineMidpointLocator",init:function(A){this._super(A)},relocate:function(A,D){var C=this.getParent();var B=C.getPoints();if(B.getSize()%2===0){this._super(A,D)}else{var A=Math.floor(B.getSize()/2);var E=B.get(A);D.setPosition(E.x-(D.getWidth()/2),E.y-(D.getHeight()/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/TopLocator.js' */
(function ($) {draw2d.layout.locator.TopLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.TopLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,2)}else{D.setPosition(A.w/2-(E.w/2),-(E.h+2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/BottomLocator.js' */
(function ($) {draw2d.layout.locator.BottomLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.BottomLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h-2)}else{D.setPosition(A.w/2-E.w/2,2+A.h)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/LeftLocator.js' */
(function ($) {draw2d.layout.locator.LeftLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.LeftLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(2,A.h/2)}else{D.setPosition(-E.w-5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/RightLocator.js' */
(function ($) {draw2d.layout.locator.RightLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.RightLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w-2,A.h/2)}else{D.setPosition(A.w+5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/CenterLocator.js' */
(function ($) {draw2d.layout.locator.CenterLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.CenterLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h/2)}else{var E=D.getBoundingBox();D.setPosition(A.w/2-E.w/2,A.h/2-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/EditPolicy.js' */
(function ($) {draw2d.policy.EditPolicy=Class.extend({NAME:"draw2d.policy.EditPolicy",init:function(){},onInstall:function(A){},onUninstall:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CanvasPolicy.js' */
(function ($) {draw2d.policy.canvas.CanvasPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.canvas.CanvasPolicy",init:function(){this._super()},onInstall:function(A){},onUninstall:function(A){},onClick:function(A,B){},onMouseMove:function(B,A,C){},snap:function(C,A,B){return B},onMouseDown:function(B,A,C){},onMouseDrag:function(D,C,B,E,A){},onMouseUp:function(B,A,C){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SelectionPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SelectionPolicy",init:function(){this._super()},unselect:function(B,A){A.unselect();B.getSelection().remove(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SingleSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SingleSelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.SingleSelectionPolicy",init:function(){this._super();this.mouseMovedDuringMouseDown=false;this.mouseDraggingElement=null;this.mouseDownElement=null},select:function(C,A){var B=C.getSelection().getPrimary();if(C.getSelection().getAll().contains(A)){return }C.getSelection().setPrimary(A);if(B!==null){this.unselect(C,B)}if(A!==null){A.select(true)}C.selectionListeners.each(function(E,D){D.onSelectionChanged(A,B)})},onMouseDown:function(C,B,E){this.mouseMovedDuringMouseDown=false;var D=true;var A=C.getBestFigure(B,E);while((A!==null&&A.getParent()!==null)&&!(A instanceof draw2d.Port)){A=A.getParent()}if(A!==null&&A.isDraggable()){D=A.onDragStart(B-A.getAbsoluteX(),E-A.getAbsoluteY());if(D===false){this.mouseDraggingElement=null;this.mouseDownElement=A}else{this.mouseDraggingElement=A;this.mouseDownElement=A}}if(A!==C.getSelection().getPrimary()&&A!==null&&A.isSelectable()===true){this.select(C,A);if(A instanceof draw2d.shape.basic.Line){if(!(A instanceof draw2d.Connection)){C.draggingLineCommand=A.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(C.draggingLineCommand!==null){C.draggingLine=A}}}else{if(D===false){A.unselect()}}}},onMouseDrag:function(D,J,I,H,E){this.mouseMovedDuringMouseDown=true;if(this.mouseDraggingElement!==null){if(D.linesToRepaintAfterDragDrop.isEmpty()===true&&(this.mouseDraggingElement instanceof draw2d.shape.node.Node)){var F=this.mouseDraggingElement.getConnections();var A=D.lineIntersections.clone();D.lineIntersections.each($.proxy(function(L,K){if(F.contains(K.line)||F.contains(K.other)){A.remove(K);D.linesToRepaintAfterDragDrop.add(K.line);D.linesToRepaintAfterDragDrop.add(K.other)}},this));D.lineIntersections=A;D.linesToRepaintAfterDragDrop.each($.proxy(function(L,K){this.repaintLineAfterDragDrop(K)},this))}var C=D.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDrag(J,I)}else{C.each(function(L,K){K.onDrag(J,I)})}var B=D.fromDocumentToCanvasCoordinate(D.mouseDownX,D.mouseDownY).translate(J,I);var G=D.getBestFigure(B.x,B.y,this.mouseDraggingElement);if(G!==D.currentDropTarget){if(D.currentDropTarget!==null){D.currentDropTarget.onDragLeave(this.mouseDraggingElement);D.currentDropTarget=null}if(G!==null){D.currentDropTarget=G.onDragEnter(this.mouseDraggingElement)}}}else{if(this.mouseDownElement!==null&&!(this.mouseDownElement instanceof draw2d.Connection)){this.mouseDownElement.onPanning(J,I)}}},repaintLineAfterDragDrop:function(A){A.svgPathString=null;A.repaint()},onMouseUp:function(B,A,D){if(this.mouseDraggingElement!==null){var C=B.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDragEnd()}else{B.getCommandStack().startTransaction();B.getSelection().getAll().each(function(F,E){E.onDragEnd()});B.getCommandStack().commitTransaction()}if(B.currentDropTarget!==null){this.mouseDraggingElement.onDrop(B.currentDropTarget);B.currentDropTarget.onDragLeave(this.mouseDraggingElement);B.currentDropTarget=null}this.mouseDraggingElement=null}if((this.mouseDownElement===null||this.mouseDownElement.isSelectable()===false)&&this.mouseMovedDuringMouseDown===false){this.select(B,null)}this.mouseDownElement=null;this.mouseMovedDuringMouseDown=false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/PanningSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.PanningSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.PanningSelectionPolicy",init:function(){this._super()},onMouseDrag:function(D,C,B,F,A){this._super(D,C,B,F,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/BoundingBoxSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.BoundingboxSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.BoundingboxSelectionPolicy",init:function(){this._super();this.boundingBoxFigure1=null;this.boundingBoxFigure2=null;this.x=0;this.y=0},select:function(B,A){if(B.getSelection().getAll().contains(A)){return }if(A!==null){A.select(true)}B.getSelection().setPrimary(A);B.selectionListeners.each(function(D,C){C.onSelectionChanged(A)})},onMouseDown:function(B,A,D){this.x=A;this.y=D;var C=B.getSelection().getAll();this._super(B,A,D);if(this.mouseDownElement!==null&&this.mouseDownElement.isResizeHandle===false&&!C.contains(this.mouseDownElement)){C.each($.proxy(function(F,E){this.unselect(B,E)},this))}C=B.getSelection().getAll();C.each($.proxy(function(F,E){var G=E.onDragStart(E.getAbsoluteX(),E.getAbsoluteY());if(E instanceof draw2d.shape.basic.Line){}else{if(G===false){this.unselect(B,E)}}},this))},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null&&this.boundingBoxFigure1===null){this.boundingBoxFigure1=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure1.setPosition(this.x,this.y);this.boundingBoxFigure1.setCanvas(D);this.boundingBoxFigure1.setBackgroundColor("#0f0f0f");this.boundingBoxFigure1.setAlpha(0.1);this.boundingBoxFigure2=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure2.setPosition(this.x,this.y);this.boundingBoxFigure2.setCanvas(D);this.boundingBoxFigure2.setDashArray("- ");this.boundingBoxFigure2.setStroke(1);this.boundingBoxFigure2.setColor(new draw2d.util.Color(84,151,220));this.boundingBoxFigure2.setBackgroundColor(null)}if(this.boundingBoxFigure1!==null){this.boundingBoxFigure1.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure1.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B));this.boundingBoxFigure2.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure2.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B))}},onMouseUp:function(B,A,F){if(this.mouseDownElement===null){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}else{if(this.mouseDownElement!==null&&this.mouseMovedDuringMouseDown===false){var E=B.getSelection().getAll();if(!E.contains(this.mouseDownElement)){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}}}this._super(B,A,F);if(this.boundingBoxFigure1!==null){var D=this.boundingBoxFigure1.getBoundingBox();B.getFigures().each($.proxy(function(H,G){if(G.getBoundingBox().isInside(D)){var I=G.onDragStart(G.getAbsoluteX(),G.getAbsoluteY());if(I===true){this.select(B,G,false)}}},this));var C=B.getSelection();B.getLines().each($.proxy(function(H,G){if(G instanceof draw2d.Connection){if(C.contains(G.getSource().getParent())&&C.contains(G.getTarget().getParent())){this.select(B,G,false)}}},this));this.boundingBoxFigure1.setCanvas(null);this.boundingBoxFigure1=null;this.boundingBoxFigure2.setCanvas(null);this.boundingBoxFigure2=null}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ReadOnlySelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.ReadOnlySelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ReadOnlySelectionPolicy",init:function(){this._super()},onInstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(false)},this))},onUninstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(true)},this))},onMouseDrag:function(D,C,B,F,A){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/DecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.DecorationPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.DecorationPolicy",init:function(){this._super()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/FadeoutDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.FadeoutDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.FadeoutDecorationPolicy",DEFAULT_FADEOUT_DURATION:30,TARGET_COLOR:new draw2d.util.Color("#707070"),init:function(){this._super();this.alpha=1;this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION;this.canvas=null},onInstall:function(A){this.canvas=A;this.timerId=window.setInterval($.proxy(this.onTimer,this),100);this.hidePortsCounter=1;this.alpha=0.1},onUninstall:function(A){window.clearInterval(this.timerId);this.canvas.getAllPorts().each($.proxy(function(C,B){B.setAlpha(1)},this))},onTimer:function(){this.hidePortsCounter--;if(this.hidePortsCounter<=0&&this.alpha>0){this.alpha=Math.max(0,this.alpha-0.05);this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}else{if(this.hidePortsCounter>0&&this.alpha!==1){this.alpha=1;this.duringHide=false;this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}}},onMouseDown:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseMove:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseDrag:function(D,C,B,E,A){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseUp:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CoronaDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.CoronaDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.CoronaDecorationPolicy",init:function(){this._super();this.startDragX=0;this.startDragY=0},onInstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(false)})})},onUninstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(true)})})},onMouseDown:function(B,A,C){this.startDragX=A;this.startDragY=C},onMouseMove:function(B,A,C){this.updatePorts(B,A,C)},onMouseDrag:function(D,C,B,E,A){this.updatePorts(D,this.startDragX+C,this.startDragY+B)},updatePorts:function(B,A,D){var C=B.getFigures();C.each(function(F,E){if(E.isVisible()===true&&E.hitTest(A,D,50)===true&&E instanceof draw2d.shape.node.Node){E.getPorts().each(function(G,H){H.setVisible(true)})}else{E.getPorts().each(function(G,H){H.setVisible(false)})}})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SnapToEditPolicy",init:function(A){this._super();this.grid=A},snap:function(C,A,B){return B}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,D){var C=A.getSnapToGridAnchor();D.x=D.x+C.x;D.y=D.y+C.y;D.x=this.grid*Math.floor(((D.x+this.grid/2)/this.grid));D.y=this.grid*Math.floor(((D.y+this.grid/2)/this.grid));D.x=D.x-C.x;D.y=D.y-C.y;return D},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ShowGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.ShowGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.ShowGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,C){return C},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGeometryEditPolicy.js' */
(function ($) {draw2d.SnapToHelper={};draw2d.SnapToHelper.NORTH=1;draw2d.SnapToHelper.SOUTH=4;draw2d.SnapToHelper.WEST=8;draw2d.SnapToHelper.EAST=16;draw2d.SnapToHelper.CENTER=32;draw2d.SnapToHelper.NORTH_EAST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.NORTH_WEST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.SOUTH_EAST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.SOUTH_WEST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NORTH_SOUTH=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.SOUTH;draw2d.SnapToHelper.EAST_WEST=draw2d.SnapToHelper.EAST|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NSEW=draw2d.SnapToHelper.NORTH_SOUTH|draw2d.SnapToHelper.EAST_WEST;draw2d.policy.canvas.SnapToGeometryEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGeometryEditPolicy",SNAP_THRESHOLD:3,LINE_COLOR:"#1387E6",FADEOUT_DURATION:300,init:function(){this._super();this.rows=null;this.cols=null;this.vline=null;this.hline=null;this.canvas=null},onInstall:function(A){this.canvas=A},onUninstall:function(A){this.canvas=null},onMouseUp:function(B,A,C){this.rows=null;this.cols=null;this.hideVerticalLine();this.hideHorizontalLine()},snap:function(E,B,H){if(B instanceof draw2d.ResizeHandle){var F=B.getSnapToGridAnchor();H.x+=F.x;H.y+=F.y;var A=new draw2d.geo.Point(H.x,H.y);var D=B.getSnapToDirection();var G=this.snapPoint(D,H,A);if((D&draw2d.SnapToHelper.EAST_WEST)&&!(G&draw2d.SnapToHelper.EAST_WEST)){this.showVerticalLine(A.x)}else{this.hideVerticalLine()}if((D&draw2d.SnapToHelper.NORTH_SOUTH)&&!(G&draw2d.SnapToHelper.NORTH_SOUTH)){this.showHorizontalLine(A.y)}else{this.hideHorizontalLine()}A.x-=F.x;A.y-=F.y;return A}else{var C=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var A=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var D=draw2d.SnapToHelper.NSEW;var G=this.snapRectangle(C,A);if((D&draw2d.SnapToHelper.WEST)&&!(G&draw2d.SnapToHelper.WEST)){this.showVerticalLine(A.x)}else{if((D&draw2d.SnapToHelper.EAST)&&!(G&draw2d.SnapToHelper.EAST)){this.showVerticalLine(A.getX()+A.getWidth())}else{this.hideVerticalLine()}}if((D&draw2d.SnapToHelper.NORTH)&&!(G&draw2d.SnapToHelper.NORTH)){this.showHorizontalLine(A.y)}else{if((D&draw2d.SnapToHelper.SOUTH)&&!(G&draw2d.SnapToHelper.SOUTH)){this.showHorizontalLine(A.getY()+A.getHeight())}else{this.hideHorizontalLine()}}return A.getTopLeft()}return H},snapRectangle:function(A,F){var E=A.getTopLeft();var D=A.getBottomRight();var B=this.snapPoint(draw2d.SnapToHelper.NORTH_WEST,A.getTopLeft(),E);F.x=E.x;F.y=E.y;var C=this.snapPoint(draw2d.SnapToHelper.SOUTH_EAST,A.getBottomRight(),D);if(B&draw2d.SnapToHelper.WEST){F.x=D.x-A.getWidth()}if(B&draw2d.SnapToHelper.NORTH){F.y=D.y-A.getHeight()}return B|C},snapPoint:function(D,C,E){if(this.rows===null||this.cols===null){this.populateRowsAndCols()}if((D&draw2d.SnapToHelper.EAST)!==0){var G=this.getCorrectionFor(this.cols,C.getX()-1,1);if(G!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.EAST;E.x+=G}}if((D&draw2d.SnapToHelper.WEST)!==0){var B=this.getCorrectionFor(this.cols,C.getX(),-1);if(B!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.WEST;E.x+=B}}if((D&draw2d.SnapToHelper.SOUTH)!==0){var F=this.getCorrectionFor(this.rows,C.getY()-1,1);if(F!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.SOUTH;E.y+=F}}if((D&draw2d.SnapToHelper.NORTH)!==0){var A=this.getCorrectionFor(this.rows,C.getY(),-1);if(A!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.NORTH;E.y+=A}}return D},populateRowsAndCols:function(){var E=this.canvas.getSelection();this.rows=[];this.cols=[];var D=this.canvas.getFigures();var B=0;for(var C=0;C<D.getSize();C++){var A=D.get(C);if(!E.contains(A)){var F=A.getBoundingBox();this.cols[B*3]={type:-1,location:F.getX()};this.rows[B*3]={type:-1,location:F.getY()};this.cols[B*3+1]={type:0,location:F.x+(F.getWidth()-1)/2};this.rows[B*3+1]={type:0,location:F.y+(F.getHeight()-1)/2};this.cols[B*3+2]={type:1,location:F.getRight()-1};this.rows[B*3+2]={type:1,location:F.getBottom()-1};B++}}},getCorrectionFor:function(B,H,E){var C=this.SNAP_THRESHOLD;var A=this.SNAP_THRESHOLD;for(var D=0;D<B.length;D++){var F=B[D];var G;if(F.type===-1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===0&&E===0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}}}}return A},showVerticalLine:function(A){if(this.vline!=null){return }this.vline=this.canvas.paper.path("M "+A+" 0 l 0 "+this.canvas.getHeight()).attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideVerticalLine:function(A){if(this.vline==null){return }var B=this.vline;B.animate({opacity:0.1},this.FADEOUT_DURATION,function(){B.remove()});this.vline=null},showHorizontalLine:function(A){if(this.hline!=null){return }this.hline=this.canvas.paper.path("M 0 "+A+" l "+this.canvas.getWidth()+" 0").attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideHorizontalLine:function(){if(this.hline==null){return }var A=this.hline;A.animate({opacity:0.1},this.FADEOUT_DURATION,function(){A.remove()});this.hline=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/DragDropEditPolicy.js' */
(function ($) {draw2d.policy.figure.DragDropEditPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.figure.DragDropEditPolicy",init:function(){this._super()},onDragStart:function(B,A){A.shape.attr({cursor:"move"})},onDrag:function(B,A){},onDragEnd:function(B,A){A.shape.attr({cursor:"default"})},adjustPosition:function(B,A,C){if(A instanceof draw2d.geo.Point){return A}return new draw2d.geo.Point(A,C)},adjustDimension:function(A,B,C){return new draw2d.geo.Rectangle(0,0,B,C)},moved:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RegionEditPolicy.js' */
(function ($) {draw2d.policy.figure.RegionEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.RegionEditPolicy",init:function(A,D,B,C){this._super();if(A instanceof draw2d.geo.Rectangle){this.constRect=A}else{if(typeof C==="number"){this.constRect=new draw2d.geo.Rectangle(A,D,B,C)}else{throw"Invalid parameter. RegionConstraintPolicy need a rectangle as parameter in the constructor"}}},adjustPosition:function(B,A,D){var C=null;if(A instanceof draw2d.geo.Point){C=new draw2d.geo.Rectangle(A.x,A.y,B.getWidth(),B.getHeight())}else{C=new draw2d.geo.Rectangle(A,D,B.getWidth(),B.getHeight())}C=this.constRect.moveInside(C);return C.getTopLeft()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HorizontalEditPolicy.js' */
(function ($) {draw2d.policy.figure.HorizontalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.HorizontalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(A,B.getY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VerticalEditPolicy.js' */
(function ($) {draw2d.policy.figure.VerticalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.VerticalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(B.getX(),C)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SelectionFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.SelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){},onUnselect:function(B,A){A.selectionHandles.each(function(C,D){D.hide()});A.selectionHandles=new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/LineSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.LineSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.LineSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){A.selectionHandles.add(this.createLineStartResizeHandle(A));A.selectionHandles.add(this.createLineEndResizeHandle(A));A.selectionHandles.each(function(D,E){E.setDraggable(A.isResizeable());E.show(B)})}this.moved(B,A)},createLineStartResizeHandle:function(A){return new draw2d.shape.basic.LineStartResizeHandle(A)},createLineEndResizeHandle:function(A){return new draw2d.shape.basic.LineEndResizeHandle(A)},moved:function(C,A){if(A.selectionHandles.isEmpty()){return }var G=A.selectionHandles.get(0);var B=A.selectionHandles.get(1);var H=G.getWidth()/2;var E=G.getHeight()/2;var F=A.getStartPoint();var D=A.getEndPoint();G.setPosition(F.x-H,F.y-E);B.setPosition(D.x-H,D.y-E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RectangleSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(D,I,G){if(I.selectionHandles.isEmpty()){var H=new draw2d.shape.basic.Rectangle();H.setBackgroundColor(null);H.setDashArray("- ");H.setColor("#2096fc");H.setStroke(0.5);H.hide=function(){H.setCanvas(null)};H.show=function(M){H.setCanvas(M);H.shape.toFront()};H.show(D);var F=new draw2d.ResizeHandle(I,1);var E=new draw2d.ResizeHandle(I,2);var C=new draw2d.ResizeHandle(I,3);var B=new draw2d.ResizeHandle(I,4);var A=new draw2d.ResizeHandle(I,5);var L=new draw2d.ResizeHandle(I,6);var K=new draw2d.ResizeHandle(I,7);var J=new draw2d.ResizeHandle(I,8);I.selectionHandles.add(F);I.selectionHandles.add(E);I.selectionHandles.add(C);I.selectionHandles.add(B);I.selectionHandles.add(A);I.selectionHandles.add(L);I.selectionHandles.add(K);I.selectionHandles.add(J);F.show(D);C.show(D);A.show(D);K.show(D);F.setDraggable(I.isResizeable());C.setDraggable(I.isResizeable());A.setDraggable(I.isResizeable());K.setDraggable(I.isResizeable());if(I.isResizeable()===true){F.setBackgroundColor(F.DEFAULT_COLOR);C.setBackgroundColor(C.DEFAULT_COLOR);A.setBackgroundColor(A.DEFAULT_COLOR);K.setBackgroundColor(K.DEFAULT_COLOR)}else{F.setBackgroundColor(null);C.setBackgroundColor(null);A.setBackgroundColor(null);K.setBackgroundColor(null)}if(I.isStrechable()&&I.isResizeable()){E.setDraggable(I.isResizeable());B.setDraggable(I.isResizeable());L.setDraggable(I.isResizeable());J.setDraggable(I.isResizeable());E.show(D);B.show(D);L.show(D);J.show(D)}I.selectionHandles.add(H)}this.moved(D,I)},moved:function(E,J){if(J.selectionHandles.isEmpty()){return }var L=J.getHeight();var K=J.getWidth();var I=J.getX();var F=J.getY();var G=J.selectionHandles.get(0);var C=J.selectionHandles.get(2);var A=J.selectionHandles.get(4);var N=J.selectionHandles.get(6);G.setPosition(I-G.getWidth(),F-G.getHeight());C.setPosition(I+K,F-C.getHeight());A.setPosition(I+K,F+L);N.setPosition(I-N.getWidth(),F+L);if(J.isStrechable()){var D=J.selectionHandles.get(1);var B=J.selectionHandles.get(3);var O=J.selectionHandles.get(5);var M=J.selectionHandles.get(7);D.setPosition(I+(K/2)-(D.getWidth()/2),F-D.getHeight());B.setPosition(I+K,F+(L/2)-(B.getHeight()/2));O.setPosition(I+(K/2)-(O.getWidth()/2),F+L);M.setPosition(I-M.getWidth(),F+(L/2)-(M.getHeight()/2))}var H=J.selectionHandles.get(8);H.setPosition(J.getPosition().translate(-2,-2));H.setDimension(J.getWidth()+4,J.getHeight()+4);H.setRotationAngle(J.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BigRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(15,15)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RoundRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(12,12);E.setRadius(4)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BusSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BusSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(C,A,D){if(A.selectionHandles.isEmpty()){var B=new draw2d.ResizeHandle(A,2);var G=new draw2d.ResizeHandle(A,4);var F=new draw2d.ResizeHandle(A,6);var E=new draw2d.ResizeHandle(A,8);A.selectionHandles.add(B);A.selectionHandles.add(G);A.selectionHandles.add(F);A.selectionHandles.add(E);B.setDraggable(A.isResizeable());G.setDraggable(A.isResizeable());F.setDraggable(A.isResizeable());E.setDraggable(A.isResizeable());B.show(C);G.show(C);F.show(C);E.show(C)}this.moved(C,A)},moved:function(B,F){if(F.selectionHandles.isEmpty()){return }var C=F.selectionHandles.get(0);var A=F.selectionHandles.get(1);var J=F.selectionHandles.get(2);var I=F.selectionHandles.get(3);var H=F.getHeight();var G=F.getWidth();var E=F.getX();var D=F.getY();C.setPosition(E+(G/2)-(C.getWidth()/2),D-C.getHeight());A.setPosition(E+G,D+(H/2)-(A.getHeight()/2));J.setPosition(E+(G/2)-(J.getWidth()/2),D+H);I.setPosition(E-I.getWidth(),D+(H/2)-(I.getHeight()/2))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.VBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.VBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(D,B){if(B.selectionHandles.isEmpty()){return }var C=B.selectionHandles.get(0);var E=B.selectionHandles.get(2);var A=B.getWidth();C.setDimension(A,C.getHeight());E.setDimension(A,E.getHeight());this._super(D,B)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.HBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.HBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var D=A.selectionHandles.get(1);var C=A.selectionHandles.get(3);D.setDimension(D.getWidth(),A.getHeight());C.setDimension(D.getWidth(),A.getHeight());this._super(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/AntSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.AntSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.AntSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){var D=new draw2d.shape.basic.Rectangle();D.setBackgroundColor(null);D.setDashArray("- ");D.setColor("#00bdee");D.hide=function(){D.setCanvas(null)};D.show=function(E){D.setCanvas(E);D.shape.toFront()};D.show(B);A.selectionHandles.add(D)}this.moved(B,A)},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var C=A.selectionHandles.get(0);C.setPosition(A.getPosition().translate(-2,-2));C.setDimension(A.getWidth()+4,A.getHeight()+4);C.setRotationAngle(A.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/GlowSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.GlowSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.GlowSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){A.setGlow(true);this.moved(B,A)},onUnselect:function(B,A){this._super(B,A);A.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SlimSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SlimSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.SlimSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(6,6);E.setRadius(0)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/PortFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.PortFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.port.PortFeedbackPolicy",init:function(){this._super()},onHoverEnter:function(B,C,A){},onHoverLeave:function(B,C,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/ElasticStrapFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.ElasticStrapFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.ElasticStrapFeedbackPolicy",init:function(){this._super();this.connectionLine=null},onDragStart:function(B,A){this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(B);this.connectionLine.getShapeElement();this.onDrag(B,A)},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(B,A){this.connectionLine.setCanvas(null);this.connectionLine=null},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/IntrusivePortsFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.IntrusivePortsFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.IntrusivePortsFeedbackPolicy",init:function(){this._super();this.connectionLine=null;this.tweenable=null},onDragStart:function(D,B){var E=0;B.getDropTargets().each(function(G,F){F.__beforeInflate=F.getWidth();E=F.__beforeInflate});var C=B.getDropTargets();C.grep(function(F){return(F.NAME!=B.NAME&&F.parent!==B.parent)||(F instanceof draw2d.HybridPort)||(B instanceof draw2d.HybridPort)});this.prepareDropTargetsForDrag(C);var A=this;this.tweenable=new Tweenable();this.tweenable.tween({from:{size:E/2},to:{size:E},duration:200,easing:"easeOutSine",step:function(F){C.each(function(H,G){A.alterDropTargetOnDrag(G,F)})}});this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(D);this.connectionLine.getShapeElement();this.connectionLine.setDashArray("- ");this.connectionLine.setColor(this.getConnectionLineColour());this.onDrag(D,B)},getConnectionLineColour:function(){return"#30c48a"},prepareDropTargetsForDrag:function(A){},alterDropTargetOnDrag:function(A,B){A.shape.attr({rx:B.size,ry:B.size});A.width=A.height=B.size*2},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(C,B){this.tweenable.stop(false);this.tweenable=null;var A=this;var D=B.getDropTargets();this.prepareDropTargetsForDragEnd(D);D.each(function(F,E){A.alterDropTargetOnDragEnd(E)});this.connectionLine.setCanvas(null);this.connectionLine=null},prepareDropTargetsForDragEnd:function(A){},alterDropTargetOnDragEnd:function(A){A.shape.attr({rx:A.__beforeInflate/2,ry:A.__beforeInflate/2});A.width=A.height=A.__beforeInflate},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Canvas.js' */
(function ($) {draw2d.Canvas=Class.extend({NAME:"draw2d.Canvas",init:function(A){if($.browser.msie&&parseInt($.browser.version,10)===8){this.fromDocumentToCanvasCoordinate=this._fromDocumentToCanvasCoordinate_IE8_HACK}this.setScrollArea(document.body);this.canvasId=A;this.html=$("#"+A);this.html.css({cursor:"default"});this.initialWidth=this.getWidth();this.initialHeight=this.getHeight();this.html.css({"-webkit-tap-highlight-color":"rgba(0,0,0,0)"});this.html.droppable({accept:".draw2d_droppable",over:$.proxy(function(B,C){this.onDragEnter(C.draggable)},this),out:$.proxy(function(B,C){this.onDragLeave(C.draggable)},this),drop:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrop(C.draggable,D.getX(),D.getY())},this)});$(".draw2d_droppable").draggable({appendTo:"body",stack:"body",zIndex:27000,helper:"clone",drag:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrag(C.draggable,D.getX(),D.getY())},this),stop:function(C,B){this.isInExternalDragOperation=false},start:function(C,B){this.isInExternalDragOperation=true;$(B.helper).addClass("shadow")}});this.paper=Raphael(A,this.getWidth(),this.getHeight());this.paper.canvas.style.position="absolute";this.zoomFactor=1;this.selection=new draw2d.Selection();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.currentHoverFigure=null;this.editPolicy=new draw2d.util.ArrayList();this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.resizeHandles=new draw2d.util.ArrayList();this.selectionListeners=new draw2d.util.ArrayList();this.viewBoxListeners=new draw2d.util.ArrayList();this.commandStack=new draw2d.command.CommandStack();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.canvas.BoundingboxSelectionPolicy());this.commandStack.addEventListener($.proxy(function(B){if(B.isPostChangeEvent()===true){this.calculateConnectionIntersection();this.linesToRepaintAfterDragDrop.each(function(D,C){C.svgPathString=null;C.repaint()});this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList()}},this));this.mouseDown=false;this.mouseDownX=0;this.mouseDownY=0;this.mouseDragDiffX=0;this.mouseDragDiffY=0;$(document).bind("mouseup touchend",$.proxy(function(B){if(this.mouseDown===false){return }B=this._getEvent(B);this.calculateConnectionIntersection();this.mouseDown=false;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.editPolicy.each($.proxy(function(D,E){E.onMouseUp(this,C.x,C.y)},this));this.mouseDragDiffX=0;this.mouseDragDiffY=0},this));this.html.bind("mousemove touchmove",$.proxy(function(D){D=this._getEvent(D);if(this.mouseDown===false){var E=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);try{var C=this.getBestFigure(E.x,E.y);if(C!==this.currentHoverFigure&&this.currentHoverFigure!==null){this.currentHoverFigure.onMouseLeave(C)}if(C!==this.currentHoverFigure&&C!==null){C.onMouseEnter(this.currentHoverFigure)}this.currentHoverFigure=C}catch(B){console.log(B)}this.editPolicy.each($.proxy(function(F,G){G.onMouseMove(this,E.x,E.y)},this))}},this));$(document).bind("mousemove touchmove",$.proxy(function(D){if(this.mouseDown){var C=this.fromDocumentToCanvasCoordinate(this.mouseDownX,this.mouseDownY);var F=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);var E=F.x-C.x;var B=F.y-C.y;this.editPolicy.each($.proxy(function(G,H){H.onMouseDrag(this,E,B,this.mouseDragDiffX-E,this.mouseDragDiffY-B)},this));this.mouseDragDiffX=E;this.mouseDragDiffY=B}},this));this.html.bind("mousedown touchstart",$.proxy(function(B){var C=null;switch(B.which){case 1:case 0:B.preventDefault();B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;this.mouseDragDiffX=0;this.mouseDragDiffY=0;C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.mouseDown=true;this.editPolicy.each($.proxy(function(D,E){E.onMouseDown(this,C.x,C.y)},this));break;case 3:B.preventDefault();B=this._getEvent(B);C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onRightMouseDown(C.x,C.y);break;case 2:break;default:}},this));this.html.bind("dblclick",$.proxy(function(B){B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDoubleClick(C.x,C.y)},this));$(document).bind("click",$.proxy(function(B){B=this._getEvent(B);if(this.mouseDownX===B.clientX||this.mouseDownY===B.clientY){var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onClick(C.x,C.y)}},this));$(document).bind("keydown",$.proxy(function(B){if(!$(B.target).is("input")){var C=B.ctrlKey;this.onKeyDown(B.keyCode,C)}},this))},calculateConnectionIntersection:function(){this.lineIntersections=new draw2d.util.ArrayList();var B=this.getLines().clone();while(B.getSize()>0){var A=B.removeElementAt(0);B.each($.proxy(function(E,C){var D=A.intersection(C);if(D.getSize()>0){this.lineIntersections.add({line:A,other:C,intersection:D});this.lineIntersections.add({line:C,other:A,intersection:D})}},this))}},clear:function(){this.lines.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.figures.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.zoomFactor=1;this.selection.clear();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.commandStack.markSaveLocation();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList()},installEditPolicy:function(A){if(A instanceof draw2d.policy.canvas.SelectionPolicy){this.getSelection().getAll().each(function(C,B){B.unselect()});this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SelectionPolicy);if(B===false){C.onUninstall(this)}return B},this))}else{if(A instanceof draw2d.policy.canvas.SnapToEditPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SnapToEditPolicy);if(B===false){C.onUninstall(this)}return B},this))}}A.onInstall(this);this.editPolicy.add(A)},uninstallEditPolicy:function(A){if(!(A instanceof draw2d.policy.EditPolicy)){return }this.editPolicy.grep($.proxy(function(B){if(B===A){B.onUninstall(this);return false}return true},this))},setViewBox:function(A){this.paper.setViewBox(A.getX(),A.getY(),A.getWidth(),A.getHeight());this.viewBoxListeners.each(function(B,C){C()})},setZoom:function(C,B){var A=$.proxy(function(G){this.zoomFactor=Math.min(Math.max(0.01,G),10);var F=(this.initialWidth*this.zoomFactor)|0;var E=(this.initialHeight*this.zoomFactor)|0;this.paper.setViewBox(0,0,F,E)},this);if(B){var D=new Tweenable();D.tween({from:{x:this.zoomFactor},to:{x:C},duration:300,easing:"easeOutSine",step:function(E){A(E.x)}})}else{A(C)}},getZoom:function(){return this.zoomFactor},fromDocumentToCanvasCoordinate:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX()+this.getScrollLeft())*this.zoomFactor,(B-this.getAbsoluteY()+this.getScrollTop())*this.zoomFactor)},_fromDocumentToCanvasCoordinate_IE8_HACK:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX())*this.zoomFactor,(B-this.getAbsoluteY())*this.zoomFactor)},fromCanvasToDocumentCoordinate:function(A,B){return new draw2d.geo.Point((A+this.getAbsoluteX()-this.getScrollLeft())*this.zoomFactor,(B+this.getAbsoluteY()-this.getScrollTop())*this.zoomFactor)},getHtmlContainer:function(){return this.html},_getEvent:function(A){if(typeof A.originalEvent!=="undefined"){if(A.originalEvent.touches&&A.originalEvent.touches.length){return A.originalEvent.touches[0]}else{if(A.originalEvent.changedTouches&&A.originalEvent.changedTouches.length){return A.originalEvent.changedTouches[0]}}}return A},setScrollArea:function(A){this.scrollArea=$(A)},getScrollArea:function(){return this.scrollArea},getScrollLeft:function(){return this.scrollArea.scrollLeft()},getScrollTop:function(){return this.scrollArea.scrollTop()},getAbsoluteX:function(){return this.html.offset().left},getAbsoluteY:function(){return this.html.offset().top},getWidth:function(){return this.html.width()},getHeight:function(){return this.html.height()},addFigure:function(B,A,C){if(B.getCanvas()===this){return }B.setCanvas(this);B.getShapeElement();if(B instanceof draw2d.shape.basic.Line){this.lines.add(B);this.linesToRepaintAfterDragDrop=this.lines}else{this.figures.add(B);if(typeof C!=="undefined"){B.setPosition(A,C)}}B.repaint();B.fireMoveEvent()},removeFigure:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.unselect==="function"){C.unselect(this,A)}},this));if(A===this.currentHoverFigure){this.currentHoverFigure=null}if(A instanceof draw2d.shape.basic.Line){this.lines.remove(A)}else{this.figures.remove(A)}A.setCanvas(null);if(A instanceof draw2d.Connection){A.disconnect()}A.onRemove()},getLines:function(){return this.lines},getFigures:function(){return this.figures},getLine:function(D){var C=this.lines.getSize();for(var B=0;B<C;B++){var A=this.lines.get(B);if(A.getId()===D){return A}}return null},getFigure:function(B){var A=null;this.figures.each(function(C,D){if(D.id===B){A=D;return false}});return A},getIntersection:function(B){var A=new draw2d.util.ArrayList();this.lineIntersections.each($.proxy(function(C,D){if(D.line===B){D.intersection.each(function(E,F){A.add({x:F.x,y:F.y,justTouching:F.justTouching,other:D.other})})}},this));return A},snapToHelper:function(A,B){this.editPolicy.each($.proxy(function(C,D){B=D.snap(this,A,B)},this));return B},registerPort:function(A){A.targets=this.dropTargets;this.commonPorts.add(A);this.dropTargets.add(A)},unregisterPort:function(A){A.targets=null;this.commonPorts.remove(A);this.dropTargets.remove(A)},getAllPorts:function(){return this.commonPorts},getCommandStack:function(){return this.commandStack},getCurrentSelection:function(){return this.selection.getPrimary()},getSelection:function(){return this.selection},setCurrentSelection:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.select==="function"){C.select(this,A)}},this))},addSelectionListener:function(A){if(A!==null){if(typeof A==="function"){this.selectionListeners.add({onSelectionChanged:A})}else{if(typeof A.onSelectionChanged==="function"){this.selectionListeners.add(A)}else{throw"Object doesn't implement required callback method [onSelectionChanged]"}}}},removeSelectionListener:function(A){this.selectionListeners=this.selectionListeners.grep(function(B){return B&&B!==A&&B.onSelectionChanged!==A})},addViewBoxListener:function(A){this.viewBoxListeners.add(A)},removeViewBoxListener:function(A){this.viewBoxListeners=this.viewBoxListeners.grep(function(B){return B!==A})},getBestFigure:function(I,H,A){var K=null;var E=null;var D=0;var B=null;for(D=0,len=this.resizeHandles.getSize();D<len;D++){E=this.resizeHandles.get(D);if(E.isVisible()===true&&E.hitTest(I,H)===true&&E!==A){return E}}for(D=0,len=this.commonPorts.getSize();D<len;D++){E=this.commonPorts.get(D);if(E!==A){if(E.isVisible()===true&&E.hitTest(I,H)===true){return E}}}K=this.getBestLine(I,H,A);if(K!==null){return K}for(D=(this.figures.getSize()-1);D>=0;D--){var G=this.figures.get(D);var C=function(L){L.each(function(M,N){C(N.getChildren());if(K===null&&N.isVisible()===true&&N.hitTest(I,H)===true){K=N}return K===null})};C(G.getChildren());if(K===null&&G.isVisible()===true&&G.hitTest(I,H)===true&&G!==A){if(K===null){K=G}else{if(K.getZOrder()<G.getZOrder()){K=G}}}if(K!==null){return K}}var F=this.lines.getSize();for(D=0;D<F;D++){var J=this.lines.get(D);B=J.getChildren();B.each(function(L,M){if(M.isVisible()===true&&M.hitTest(I,H)===true){K=M;return false}return true})}return K},getBestLine:function(B,G,E){var A=null;var F=this.lines.getSize();for(var D=0;D<F;D++){var C=this.lines.get(D);if(C.isVisible()===true&&C.hitTest(B,G)===true&&C!==E){if(A===null){A=C;break}}}return A},hideSnapToHelperLines:function(){this.hideSnapToHelperLineHorizontal();this.hideSnapToHelperLineVertical()},hideSnapToHelperLineHorizontal:function(){},hideSnapToHelperLineVertical:function(){},onDragEnter:function(A){},onDrag:function(B,A,C){},onDragLeave:function(A){},onDrop:function(B,A,C){},onKeyDown:function(B,A){if(B==46&&this.selection.getPrimary()!==null){this.commandStack.execute(this.selection.getPrimary().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.DELETE)))}else{if(B==90&&A){this.commandStack.undo()}else{if(B==89&&A){this.commandStack.redo()}else{if(B===107){this.setZoom(this.zoomFactor*0.95)}else{if(B===109){this.setZoom(this.zoomFactor*1.05)}}}}}},onDoubleClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onDoubleClick()}},onClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onClick()}},onRightMouseDown:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onContextMenu(B,C)}},onNewConnection:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Selection.js' */
(function ($) {draw2d.Selection=Class.extend({NAME:"draw2d.Selection",init:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},clear:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},getPrimary:function(){return this.primary},setPrimary:function(A){this.primary=A;if(A!==null&&!this.all.contains(A)){this.all.add(A)}},remove:function(A){this.all.remove(A);if(this.primary===A){this.primary=null}},contains:function(A){return this.all.contains(A)},getAll:function(){return this.all.clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Figure.js' */
(function ($) {draw2d.Figure=Class.extend({NAME:"draw2d.Figure",MIN_TIMER_INTERVAL:50,init:function(B,A){this.id=draw2d.util.UUID.create();this.isResizeHandle=false;this.command=null;this.canvas=null;this.shape=null;this.children=new draw2d.util.ArrayList();this.selectable=true;this.deleteable=true;this.resizeable=true;this.draggable=true;this.visible=true;this.canSnapToHelper=true;this.snapToGridAnchor=new draw2d.geo.Point(0,0);this.editPolicy=new draw2d.util.ArrayList();this.timerId=-1;this.timerInterval=0;this.parent=null;this.x=0;this.y=0;this.minHeight=5;this.minWidth=5;this.rotationAngle=0;if(typeof A!=="undefined"){this.width=B;this.height=A}else{this.width=this.getMinWidth();this.height=this.getMinHeight()}this.alpha=1;this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.alpha;this.ox=0;this.oy=0;this.repaintBlocked=false;this.selectionHandles=new draw2d.util.ArrayList();this.moveListener=new draw2d.util.ArrayList();this.resizeListener=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.figure.RectangleSelectionFeedbackPolicy())},select:function(A){if(typeof A==="undefined"){A=true}this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy){C.onSelect(this.canvas,this,A)}},this));this.onSelect&&this.onSelect();return this},unselect:function(){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.SelectionFeedbackPolicy){B.onUnselect(this.canvas,this)}},this));this.onDeselect&&this.onDeselect();return this},getId:function(){return this.id},setId:function(A){this.id=A;return this},setCanvas:function(A){if(A===null&&this.shape!==null){this.unselect();this.shape.remove();this.shape=null}this.canvas=A;if(this.canvas!==null){this.getShapeElement()}if(A===null){this.stopTimer()}else{if(this.timerInterval>=this.MIN_TIMER_INTERVAL){this.startTimer(this.timerInterval)}}this.children.each(function(B,C){C.figure.setCanvas(A)})},getCanvas:function(){return this.canvas},startTimer:function(A){this.stopTimer();this.timerInterval=Math.max(this.MIN_TIMER_INTERVAL,A);if(this.canvas!==null){this.timerId=window.setInterval($.proxy(this.onTimer,this),this.timerInterval)}return this},stopTimer:function(){if(this.timerId>=0){window.clearInterval(this.timerId);this.timerId=-1}},onTimer:function(){},installEditPolicy:function(A){if(A instanceof draw2d.policy.figure.SelectionFeedbackPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy);if(!B){C.onUninstall(this)}return B},this))}A.onInstall(this);this.editPolicy.add(A)},addFigure:function(B,A){B.setDraggable(false);B.setSelectable(false);B.setParent(this);this.children.add({figure:B,locator:A});if(this.canvas!==null){B.setCanvas(this.canvas)}this.repaint();return this},getChildren:function(){var A=new draw2d.util.ArrayList();this.children.each(function(B,C){A.add(C.figure)});return A},resetChildren:function(){this.children.each(function(A,B){B.figure.setCanvas(null)});this.children=new draw2d.util.ArrayList();this.repaint()},getShapeElement:function(){if(this.shape!==null){return this.shape}this.shape=this.createShapeElement();return this.shape},createShapeElement:function(){throw"Inherited class ["+this.NAME+"] must override the abstract method createShapeElement"},repaint:function(A){if(this.visible===true){this.shape.show()}else{this.shape.hide();return }A.opacity=this.alpha;this.shape.attr(A);this.applyTransformation();this.children.each(function(B,C){C.locator.relocate(B,C.figure)})},applyTransformation:function(){},setGlow:function(A){return this},onDragStart:function(B,A){this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.getAlpha();this.command=this.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(this.command!==null){this.ox=this.x;this.oy=this.y;this.isInDragDrop=true;this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.onDragStart(this.canvas,this)}},this));return true}return false},onDrag:function(B,A){this.editPolicy.each($.proxy(function(E,F){if(F instanceof draw2d.policy.figure.DragDropEditPolicy){var D=F.adjustPosition(this,this.ox+B,this.oy+A);B=D.x-this.ox;A=D.y-this.oy}},this));this.x=this.ox+B;this.y=this.oy+A;if(this.getCanSnapToHelper()){var C=new draw2d.geo.Point(this.x,this.y);C=this.getCanvas().snapToHelper(this,C);this.x=C.x;this.y=C.y}this.setPosition(this.x,this.y);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){E.onDrag(this.canvas,this)}},this));if(this.isMoving===false){this.isMoving=true;this.setAlpha(this.originalAlpha*0.7)}},onPanning:function(B,A){},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.command.setPosition(this.x,this.y);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},onDragEnter:function(A){return null},onDragLeave:function(A){},onDrop:function(A){},onMouseEnter:function(){},onMouseLeave:function(){},onDoubleClick:function(){},onClick:function(){},onContextMenu:function(A,B){},setAlpha:function(A){A=Math.min(1,Math.max(0,parseFloat(A)));if(A===this.alpha){return }this.alpha=A;this.repaint();return this},getAlpha:function(){return this.alpha},setRotationAngle:function(A){this.rotationAngle=A;this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.repaint();return this},getRotationAngle:function(){return this.rotationAngle},setVisible:function(A){this.visible=!!A;this.repaint();return this},isVisible:function(){return this.visible&&this.shape!==null},getZOrder:function(){if(this.shape===null){return -1}var A=0;var B=this.shape.node;while((B=B.previousSibling)!==null){A++}return A},setCanSnapToHelper:function(A){this.canSnapToHelper=!!A;return this},getCanSnapToHelper:function(){return this.canSnapToHelper},getSnapToGridAnchor:function(){return this.snapToGridAnchor},setSnapToGridAnchor:function(A){this.snapToGridAnchor=A},getWidth:function(){return this.width},getHeight:function(){return this.height},getMinWidth:function(){return this.minWidth},setMinWidth:function(A){this.minWidth=parseFloat(A);return this},getMinHeight:function(){return this.minHeight;return this},setMinHeight:function(A){this.minHeight=parseFloat(A);return this},getX:function(){return this.x},getY:function(){return this.y},getAbsoluteX:function(){if(this.parent===null){return this.x||0}return this.x+this.parent.getAbsoluteX()},getAbsoluteY:function(){if(this.parent===null){return this.y||0}return this.y+this.parent.getAbsoluteY()},getAbsolutePosition:function(){return new draw2d.geo.Point(this.getAbsoluteX(),this.getAbsoluteY())},getAbsoluteBounds:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));this.fireMoveEvent();return this},getPosition:function(){return new draw2d.geo.Point(this.x,this.y)},translate:function(B,A){this.setPosition(this.x+B,this.y+A);return this},setDimension:function(A,B){A=Math.max(this.getMinWidth(),A);B=Math.max(this.getMinHeight(),B);if(this.width===A&&this.height===B){return }this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){var C=E.adjustDimension(this,A,B);A=C.w;B=C.h}},this));this.width=Math.max(this.getMinWidth(),A);this.height=Math.max(this.getMinHeight(),B);this.repaint();this.fireResizeEvent();this.fireMoveEvent();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getBoundingBox:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},hitTest:function(A,C,B){if(typeof B==="number"){return this.getBoundingBox().scale(B,B).hitTest(A,C)}return this.getBoundingBox().hitTest(A,C)},setDraggable:function(A){this.draggable=!!A;return this},isDraggable:function(){return this.draggable},isResizeable:function(){return this.resizeable},setResizeable:function(A){this.resizeable=!!A;return this},isSelectable:function(){return this.selectable},setSelectable:function(A){this.selectable=!!A;return this},isStrechable:function(){return true},isDeleteable:function(){return this.deleteable},setDeleteable:function(A){this.deleteable=!!A;return this},setParent:function(A){this.parent=A;return this},getParent:function(){return this.parent},attachResizeListener:function(A){if(A===null){return }this.resizeListener.add(A);return this},detachResizeListener:function(A){if(A===null){return }this.resizeListener.remove(A);return this},fireResizeEvent:function(){this.resizeListener.each($.proxy(function(A,B){B.onOtherFigureIsResizing(this)},this));return this},onOtherFigureIsResizing:function(A){},attachMoveListener:function(A){if(A===null){return }if(!this.moveListener.contains(A)){this.moveListener.add(A)}return this},detachMoveListener:function(A){if(A===null){return }this.moveListener.remove(A);return this},fireMoveEvent:function(){this.moveListener.each($.proxy(function(A,B){B.onOtherFigureIsMoving(this)},this));return this},onOtherFigureIsMoving:function(A){},createCommand:function(A){if(A===null){return null}if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMove(this)}if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(!this.isDeleteable()){return null}return new draw2d.command.CommandDelete(this)}if(A.getPolicy()===draw2d.command.CommandType.RESIZE){if(!this.isResizeable()){return null}return new draw2d.command.CommandResize(this)}return null},getPersistentAttributes:function(){var A={type:this.NAME,id:this.id,x:this.x,y:this.y,width:this.width,height:this.height};return A},setPersistentAttributes:function(A){this.id=A.id;this.x=A.x;this.y=A.y;if(typeof A.width!=="undefined"){this.width=A.width}if(typeof A.height!=="undefined"){this.height=A.height}return this},onRemove:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Node.js' */
(function ($) {draw2d.shape.node.Node=draw2d.Figure.extend({NAME:"draw2d.shape.node.Node",init:function(B,A){this.inputPorts=new draw2d.util.ArrayList();this.outputPorts=new draw2d.util.ArrayList();this.hybridPorts=new draw2d.util.ArrayList();this.portRelayoutRequired=true;this.cachedPorts=null;this._super(B,A)},onDoubleClick:function(){var A=this.getWidth();var B=this.getHeight();this.setRotationAngle((this.getRotationAngle()+90)%360);this.setDimension(B,A);this.portRelayoutRequired=true},getPorts:function(){if(this.cachedPorts===null){this.cachedPorts=new draw2d.util.ArrayList();this.cachedPorts.addAll(this.inputPorts);this.cachedPorts.addAll(this.outputPorts);this.cachedPorts.addAll(this.hybridPorts);this.children.each($.proxy(function(A,B){this.cachedPorts.addAll(B.figure.getPorts())},this))}return this.cachedPorts},getInputPorts:function(){return this.inputPorts.clone().addAll(this.hybridPorts)},getOutputPorts:function(){return this.outputPorts.clone().addAll(this.hybridPorts)},getPort:function(B){var A=null;this.getPorts().each(function(C,D){if(D.getName()===B){A=D;return false}});return A},getInputPort:function(C){if(typeof C==="number"){return this.inputPorts.get(C)}for(var B=0;B<this.inputPorts.getSize();B++){var A=this.inputPorts.get(B);if(A.getName()===C){return A}}return null},getOutputPort:function(C){if(typeof C==="number"){return this.outputPorts.get(C)}for(var B=0;B<this.outputPorts.getSize();B++){var A=this.outputPorts.get(B);if(A.getName()===C){return A}}return null},getHybridPort:function(C){if(typeof C==="number"){return this.hybridPorts.get(C)}for(var B=0;B<this.hybridPorts.getSize();B++){var A=this.hybridPorts.get(B);if(A.getName()===C){return A}}return null},addPort:function(B,A){if(!(B instanceof draw2d.Port)){throw"Argument is not typeof 'draw2d.Port'. \nFunction: draw2d.shape.node.Node#addPort"}this.cachedPorts=null;this.portRelayoutRequired=true;if(B instanceof draw2d.InputPort){this.inputPorts.add(B)}else{if(B instanceof draw2d.OutputPort){this.outputPorts.add(B)}else{if(B instanceof draw2d.HybridPort){this.hybridPorts.add(B)}}}if((typeof A!=="undefined")&&(A instanceof draw2d.layout.locator.Locator)){B.setLocator(A)}B.setParent(this);B.setCanvas(this.canvas);B.setDeleteable(false);if(this.canvas!==null){B.getShapeElement();this.canvas.registerPort(B)}},removePort:function(A){this.portRelayoutRequired=true;this.inputPorts.remove(A);this.outputPorts.remove(A);this.hybridPorts.remove(A);if(A.getCanvas()!==null){A.getCanvas().unregisterPort(A);var C=A.getConnections();for(var B=0;B<C.getSize();++B){A.getCanvas().removeFigure(C.get(B))}}A.setCanvas(null)},createPort:function(C,B){var A=null;var D=0;switch(C){case"input":A=new draw2d.InputPort();D=this.inputPorts.getSize();break;case"output":A=new draw2d.OutputPort();D=this.outputPorts.getSize();break;case"hybrid":A=new draw2d.HybridPort();D=this.hybridPorts.getSize();break;default:throw"Unknown type ["+C+"] of port requested"}A.setName(C+D);this.addPort(A,B);this.setDimension(this.width,this.height);return A},getConnections:function(){var D=new draw2d.util.ArrayList();var F=this.getPorts();for(var C=0;C<F.getSize();C++){var A=F.get(C);for(var E=0,B=A.getConnections().getSize();E<B;E++){if(!D.contains(A.getConnections().get(E))){D.add(A.getConnections().get(E))}}}return D},setCanvas:function(B){var A=this.canvas;this._super(B);var C=this.getPorts();if(A!==null){C.each(function(E,D){A.unregisterPort(D)})}if(B!==null){C.each(function(E,D){D.setCanvas(B);B.registerPort(D)});this.setDimension(this.width,this.height)}else{C.each(function(E,D){D.setCanvas(null)})}},setRotationAngle:function(A){this.portRelayoutRequired=true;this._super(A);this.layoutPorts()},setDimension:function(A,B){this.portRelayoutRequired=true;this._super(A,B)},onPortValueChanged:function(A){},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this._super(A);this.layoutPorts()},layoutPorts:function(){if(this.portRelayoutRequired===false){return }this.portRelayoutRequired=false;this.outputPorts.each(function(B,A){A.locator.relocate(B,A)});this.inputPorts.each(function(B,A){A.locator.relocate(B,A)});this.hybridPorts.each(function(B,A){A.locator.relocate(B,A)})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/VectorFigure.js' */
(function ($) {draw2d.VectorFigure=draw2d.shape.node.Node.extend({NAME:"draw2d.VectorFigure",init:function(){this.stroke=1;this.bgColor=new draw2d.util.Color(255,255,255);this.lineColor=new draw2d.util.Color(128,128,255);this.color=new draw2d.util.Color(128,128,128);this.strokeBeforeGlow=this.stroke;this.glowIsActive=false;this._super()},setGlow:function(A){if(A===this.glowIsActive){return this}this.glowIsActive=A;if(A===true){this.strokeBeforeGlow=this.getStroke();this.setStroke(this.strokeBeforeGlow*2.5)}else{this.setStroke(this.strokeBeforeGlow)}return this},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();if(typeof A.stroke==="undefined"){if(this.color===null||this.stroke===0){A.stroke="none"}else{A.stroke=this.color.hash()}}A["stroke-width"]=this.stroke;if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)},setBackgroundColor:function(A){this.bgColor=new draw2d.util.Color(A);this.repaint();return this},getBackgroundColor:function(){return this.bgColor},setStroke:function(A){this.stroke=A;this.repaint();return this},getStroke:function(){return this.stroke},setColor:function(A){this.color=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.color}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Rectangle.js' */
(function ($) {draw2d.shape.basic.Rectangle=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Rectangle",init:function(B,A){this.radius=2;this.dasharray=null;this._super();this.setBackgroundColor(new draw2d.util.Color(100,100,100));this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}A.width=this.getWidth();A.height=this.getHeight();A.r=this.radius;this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);if(this.getRotationAngle()===90||this.getRotationAngle()===270){var B=this.getHeight()/this.getWidth();var A="...S"+B+","+1/B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.shape.transform(A)}},createShapeElement:function(){return this.canvas.paper.rect(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setRadius:function(A){this.radius=A;this.repaint()},getRadius:function(){return this.radius},setDashArray:function(A){this.dasharray=A},getPersistentAttributes:function(){var A=this._super();A.radius=this.radius;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.radius==="number"){this.radius=A.radius}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SetFigure.js' */
(function ($) {draw2d.SetFigure=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.SetFigure",init:function(B,A){this.svgNodes=null;this.originalWidth=null;this.originalHeight=null;this.scaleX=1;this.scaleY=1;this._super(B,A);this.setStroke(0);this.setBackgroundColor(null)},setCanvas:function(A){if(A===null&&this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=null}this._super(A)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.originalWidth!==null){this.scaleX=this.width/this.originalWidth;this.scaleY=this.height/this.originalHeight}if(typeof A==="undefined"){A={}}if(this.visible===true){this.svgNodes.show()}else{this.svgNodes.hide()}this._super(A)},applyTransformation:function(){var D="S"+this.scaleX+","+this.scaleY+",0,0 R"+this.rotationAngle+","+((this.getWidth()/2)|0)+","+((this.getHeight()/2)|0)+"T"+this.getAbsoluteX()+","+this.getAbsoluteY()+"";this.svgNodes.transform(D);if(this.rotationAngle===90||this.rotationAngle===270){var E=this.svgNodes.getBBox(true);var C=E.height/E.width;var B=E.width/E.height;var A="...S"+C+","+B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.svgNodes.transform(A)}},createShapeElement:function(){var A=this.canvas.paper.rect(this.getX(),this.getY(),this.getWidth(),this.getHeight());this.svgNodes=this.createSet();var B=this.svgNodes.getBBox();this.originalWidth=B.width;this.originalHeight=B.height;return A},createSet:function(){return this.canvas.paper.set()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SVGFigure.js' */
(function ($) {draw2d.SVGFigure=draw2d.SetFigure.extend({NAME:"draw2d.SVGFigure",init:function(B,A){this._super(B,A)},createSet:function(){return this.importSVG(this.canvas,this.getSVG())},importSVG:function(C,A){var F=C.paper.set();try{if(typeof A==="undefined"){throw"No data was provided."}var E=$(A);if(E.attr("width")&&E.attr("height")){this.setDimension(E.attr("width"),E.attr("height"))}var D=new RegExp("([a-z0-9-]+) ?: ?([^ ;]+)[ ;]?","gi");E.children().each(function(K,L){var N=null;var G=null;var O={};var I=L.tagName;var M=I.indexOf(":");if(M!=-1){I=I.substr(M+1)}$(L.attributes).each(function(){switch(this.nodeName){case"stroke-dasharray":O[this.nodeName]="- ";break;case"style":G=this.nodeValue;break;case"id":case"xml:space":break;default:O[this.nodeName]=this.nodeValue;break}});if(G!==null){while(D.exec(G)){O[RegExp.$1]=RegExp.$2}}if(typeof O["stroke-width"]==="undefined"){O["stroke-width"]=(typeof O.stroke==="undefined"?0:1.2)}switch(I){case"rect":N=C.paper.rect();break;case"circle":N=C.paper.circle();break;case"ellipse":N=C.paper.ellipse();break;case"path":O.fill="none";N=C.paper.path(O.d);break;case"line":O.d="M "+O.x1+" "+O.y1+"L"+O.x2+" "+O.y2;O.fill="none";N=C.paper.path(O.d);break;case"polyline":var Q=O.points;O.d="M "+Q.replace(" "," L");N=C.paper.path(O.d);break;case"polygon":N=C.paper.polygon(O.points);break;case"image":N=C.paper.image();break;case"tspan":case"text":if(L.childNodes.length>0){var H=L.firstChild;do{switch(H.nodeType){case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:return ;case 1:}var J=C.paper.text(0,0,$(H).text());var P={x:parseFloat(H.attributes.x.value),y:parseFloat(H.attributes.y.value)};P["text-anchor"]="start";if(typeof H.attributes["font-size"]!=="undefined"){P["font-size"]=parseInt(H.attributes["font-size"].value)}else{if(typeof O["font-size"]!=="undefined"){P["font-size"]=parseInt(O["font-size"])}}if(typeof H.attributes["font-family"]!=="undefined"){P["font-family"]=H.attributes["family-family"].value}else{if(typeof O["font-family"]!=="undefined"){P["font-family"]=O["font-family"]}}P.fill="#000000";if(typeof H.attributes.fill!=="undefined"){P.fill=H.attributes.fill.value}else{if(typeof O.fill!=="undefined"){P.fill=O.fill}}P.y=P.y+J.getBBox().height/2;J.attr(P);F.push(J)}while(H=H.nextSibling)}else{N=C.paper.text(0,0,$(L).html());if(typeof O.fill==="undefined"){O.fill="#000000"}if(typeof O["text-anchor"]==="undefined"){O["text-anchor"]="start"}if(typeof O["font-size"]!=="undefined"){O["font-size"]=parseInt(O["font-size"])}if(typeof O["font-family"]!=="undefined"){O["font-family"]=parseInt(O["font-family"])}O.y=parseFloat(O.y)+N.getBBox().height/2}break}if(N!==null){N.attr(O);F.push(N)}})}catch(B){alert("The SVG data you entered was invalid! ("+B+")")}return F}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Hub.js' */
(function ($) {draw2d.shape.node.Hub=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Hub",DEFAULT_COLOR:new draw2d.util.Color("#4DF0FE"),BACKGROUND_COLOR:new draw2d.util.Color("#29AA77"),init:function(C,A,B){this.label=null;this._super(C,A);this.port=this.createPort("hybrid",new draw2d.layout.locator.CenterLocator(this));this.CONNECTION_DIR_STRATEGY=[$.proxy(function(E,D){return this.getParent().getBoundingBox().getDirection(D.getAbsolutePosition())},this.port),$.proxy(function(E,D){return this.getAbsoluteY()>D.getAbsoluteY()?0:2},this.port),$.proxy(function(E,D){return this.getAbsoluteX()>D.getAbsoluteX()?3:1},this.port)];this.port.setGlow=$.proxy(this.setGlow,this);this.port._orig_hitTest=this.port.hitTest;this.port.hitTest=$.proxy(this.hitTest,this);this.port.setConnectionAnchor(new draw2d.layout.anchor.ShortesPathConnectionAnchor(this.port));this.port.setVisible(false);if(typeof A==="undefined"){this.setDimension(150,50)}this.setConnectionDirStrategy(0);this.setColor(this.DEFAULT_COLOR.darker());this.setBackgroundColor(this.BACKGROUND_COLOR);if(typeof B!=="undefined"){this.label=new draw2d.shape.basic.Label(B);this.label.setColor("#0d0d0d");this.label.setFontColor("#0d0d0d");this.label.setStroke(0);this.addFigure(this.label,new draw2d.layout.locator.CenterLocator(this))}},onDragEnter:function(A){return this.getHybridPort(0).onDragEnter(A)},getMinWidth:function(){if(this.label!==null){return Math.max(this.label.getMinWidth(),this._super())}else{return this._super()}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){if(this.bgColor!==null){A.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95"}else{A.fill="none"}}this._super(A)},setConnectionDirStrategy:function(A){switch(A){case 0:case 1:case 2:this.port.getConnectionDirection=this.CONNECTION_DIR_STRATEGY[A];break}},getPersistentAttributes:function(){var A=this._super();A.dirStrategy=this.CONNECTION_DIR_STRATEGY.indexOf(this.port.getConnectionDirection);return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.dirStrategy==="number"){this.setConnectionDirStrategy(A.dirStrategy)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/HorizontalBus.js' */
(function ($) {draw2d.shape.node.HorizontalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.HorizontalBus",init:function(C,A,B){this._super(C,A,B);this.setConnectionDirStrategy(1);this.installEditPolicy(new draw2d.policy.figure.HBusSelectionFeedbackPolicy())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/VerticalBus.js' */
(function ($) {draw2d.shape.node.VerticalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.VerticalBus",init:function(C,A,B){this._super(C,A,B);if(this.label!==null){this.label.setRotationAngle(90)}this.setConnectionDirStrategy(2);this.installEditPolicy(new draw2d.policy.figure.VBusSelectionFeedbackPolicy())},getMinHeight:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinWidth()},getMinWidth:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinHeight()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Fulcrum.js' */
(function ($) {draw2d.shape.node.Fulcrum=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.Fulcrum",init:function(){this._super(40,40);this.port.setConnectionAnchor(new draw2d.layout.anchor.ConnectionAnchor(this.port));this.port.setVisible(true);this.port.hitTest=this.port._orig_hitTest;this.setConnectionDirStrategy(0);this.setColor(null);this.setRadius(10);this.setBackgroundColor(null);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Oval.js' */
(function ($) {draw2d.shape.basic.Oval=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Oval",init:function(B,A){this._super();this.setBackgroundColor("#C02B1D");this.setColor("#1B1B1B");if((typeof A==="number")&&(typeof B==="number")){this.setDimension(B,A)}else{this.setDimension(50,50)}},createShapeElement:function(){var A=this.getWidth()/2;var B=this.getHeight()/2;return this.canvas.paper.ellipse(this.getAbsoluteX()+A,this.getAbsoluteY()+B,A,B)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.rx==="undefined"){A.rx=this.width/2;A.ry=this.height/2}if(typeof A.cx==="undefined"){A.cx=this.getAbsoluteX()+A.rx;A.cy=this.getAbsoluteY()+A.ry}this._super(A)},intersectionWithLine:function(S,Q){var D=this.getWidth()/2;var C=this.getHeight()/2;var G=new draw2d.util.ArrayList();var R=new draw2d.geo.Point(S.x,S.y);var J=Q.subtract(S);var O=new draw2d.geo.Point(this.getAbsoluteX()+D,this.getAbsoluteY()+C);var I=R.subtract(O);var B=new draw2d.geo.Point(J.x/(D*D),J.y/(C*C));var A=new draw2d.geo.Point(I.x/(D*D),I.y/(C*C));var P=J.dot(B);var N=J.dot(A);var M=I.dot(A)-1;var L=N*N-P*M;if(L<0){}else{if(L>0){var K=Math.sqrt(L);var F=(-N-K)/P;var E=(-N+K)/P;if((F<0||1<F)&&(E<0||1<E)){if((F<0&&E<0)||(F>1&&E>1)){}else{}}else{if(0<=F&&F<=1){G.add(S.lerp(Q,F))}if(0<=E&&E<=1){G.add(S.lerp(Q,E))}}}else{var H=-N/P;if(0<=H&&H<=1){G.add(S.lerp(Q,H))}else{}}}return G}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Circle.js' */
(function ($) {draw2d.shape.basic.Circle=draw2d.shape.basic.Oval.extend({NAME:"draw2d.shape.basic.Circle",init:function(A){this._super();if(typeof A==="number"){this.setDimension(A,A)}else{this.setDimension(40,40)}},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}},isStrechable:function(){return false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Label.js' */
(function ($) {draw2d.shape.basic.Label=draw2d.SetFigure.extend({NAME:"draw2d.shape.basic.Label",FONT_FALLBACK:{Georgia:"Georgia, serif","Palatino Linotype":'"Palatino Linotype", "Book Antiqua", Palatino, serif',"Times New Roman":'"Times New Roman", Times, serif',Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Gadget, sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',Impact:"Impact, Charcoal, sans-serif","Lucida Sans Unicode":'"Lucida Sans Unicode", "Lucida Grande", sans-serif',"Tahoma, Geneva":"Tahoma, Geneva, sans-seri","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',Verdana:"Verdana, Geneva, sans-serif","Courier New":'"Courier New", Courier, monospace',"Lucida Console":'"Lucida Console", Monaco, monospace'},init:function(A){this._super();if(typeof A==="string"){this.text=A}else{this.text=""}this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=12;this.fontColor=new draw2d.util.Color("#080808");this.fontFamily=null;this.padding=4;this.bold=false;this.setStroke(1);this.setDimension(10,10);this.editor=null;this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},createSet:function(){return this.canvas.paper.text(0,0,this.text)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;var B={};B.text=this.text;B.x=this.padding+this.getStroke();B.y=this.getHeight()/2;B["font-weight"]=(this.bold===true)?"bold":"normal";B["text-anchor"]="start";B["font-size"]=this.fontSize;if(this.fontFamily!==null){B["font-family"]=this.fontFamily}B.fill=this.fontColor.hash();this.svgNodes.attr(B);this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);this.svgNodes.transform("R"+this.rotationAngle+"T"+this.getAbsoluteX()+","+this.getAbsoluteY())},isResizeable:function(){return false},setFontSize:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=A;this.repaint()},setBold:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.bold=A;this.repaint()},setFontColor:function(A){this.fontColor=new draw2d.util.Color(A);this.repaint()},getFontColor:function(){return this.fontColor},setPadding:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;this.padding=A;this.repaint()},setFontFamily:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;if(this.FONT_FALLBACK[A]!=="undefined"){A=this.FONT_FALLBACK[A]}this.fontFamily=A;this.repaint()},setDimension:function(A,B){this.cachedWidth=null;this.cachedHeight=null;this._super(A,B)},getMinWidth:function(){if(this.shape===null){return 0}if(this.cachedMinWidth===null){this.cachedMinWidth=this.svgNodes.getBBox(true).width+2*this.padding+2*this.getStroke()}return this.cachedMinWidth},getMinHeight:function(){if(this.shape===null){return 0}if(this.cachedMinHeight===null){this.cachedMinHeight=this.svgNodes.getBBox(true).height+2*this.padding+2*this.getStroke()}return this.cachedMinHeight},getWidth:function(){if(this.shape===null){return 0}if(this.cachedWidth===null){this.cachedWidth=Math.max(this.width,this.getMinWidth())}return this.cachedWidth},getHeight:function(){if(this.shape===null){return 0}if(this.cachedHeight===null){this.cachedHeight=Math.max(this.height,this.getMinHeight())}return this.cachedHeight},installEditor:function(A){this.editor=A},onDoubleClick:function(){if(this.editor!==null){this.editor.start(this)}},getText:function(){return this.text},setText:function(A){this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.text=A;this.repaint();this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.fireResizeEvent();if(this.parent!==null){this.parent.repaint()}},hitTest:function(I,F){if(this.rotationAngle===0){return this._super(I,F)}var H=this.shape.matrix;var J=this.getBoundingBox().getPoints();J.each(function(M,L){var K=H.x(L.x,L.y);var N=H.y(L.x,L.y);L.x=K;L.y=N});var A=4;var D=0;var B=A-1;var G=false;for(D=0;D<A;D++){var E=J.get(D);var C=J.get(B);if((E.y<F&&C.y>=F||C.y<F&&E.y>=F)&&(E.x<=I||C.x<=I)){if(E.x+(F-E.y)/(C.y-E.y)*(C.x-E.x)<I){G=!G}}B=D}return G},getPersistentAttributes:function(){var A=this._super();A.text=this.text;A.fontSize=this.fontSize;A.fontColor=this.fontColor.hash();A.fontFamily=this.fontFamily;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.text!=="undefined"){this.setText(A.text)}if(typeof A.fontFamily!=="undefined"){this.setFontFamily(A.fontFamily)}if(typeof A.fontSize!=="undefined"){this.setFontSize(A.fontSize)}if(typeof A.fontColor!=="undefined"){this.setFontColor(A.fontColor)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Line.js' */
(function ($) {draw2d.shape.basic.Line=draw2d.Figure.extend({NAME:"draw2d.shape.basic.Line",DEFAULT_COLOR:new draw2d.util.Color(0,0,0),init:function(B,A,D,C){this.repaintBlocked=false;this.corona=10;this.isGlowing=false;this.lineColor=this.DEFAULT_COLOR;this.stroke=1;this.dasharray=null;if(typeof C==="number"){this.startX=B;this.startY=A;this.endX=D;this.endY=C}else{this.startX=30;this.startY=30;this.endX=100;this.endY=100}this._super();this.installEditPolicy(new draw2d.policy.figure.LineSelectionFeedbackPolicy());this.setSelectable(true);this.setDeleteable(true)},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},setDashArray:function(A){this.dasharray=A;return this},setCoronaWidth:function(A){this.corona=A;return this},createShapeElement:function(){return this.canvas.paper.path("M"+this.getStartX()+" "+this.getStartY()+"L"+this.getEndX()+" "+this.getEndY())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={stroke:"#"+this.lineColor.hex(),"stroke-width":this.stroke,path:["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}}else{if(typeof A.path==="undefined"){A.path=["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}A.stroke=this.lineColor.hash();A["stroke-width"]=this.stroke}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}this._super(A)},setGlow:function(A){if(this.isGlowing===A){return }if(A===true){this._lineColor=this.lineColor;this._stroke=this.stroke;this.setColor(draw2d.util.Color("#3f72bf"));this.setStroke((this.stroke*4)|0)}else{this.setColor(this._lineColor);this.setStroke(this._stroke)}this.isGlowing=A;return this},isResizeable:function(){return true},setStroke:function(A){this.stroke=A;this.repaint();return this},setColor:function(A){this.lineColor=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.lineColor},setStartPoint:function(A,B){if(this.startX===A&&this.startY===B){return }this.startX=A;this.startY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},setEndPoint:function(A,B){if(this.endX===A&&this.endY===B){return }this.endX=A;this.endY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getStartX:function(){return this.startX},getStartY:function(){return this.startY},getStartPoint:function(){return new draw2d.geo.Point(this.startX,this.startY)},getEndX:function(){return this.endX},getEndY:function(){return this.endY},getEndPoint:function(){return new draw2d.geo.Point(this.endX,this.endY)},getSegments:function(){var A=new draw2d.util.ArrayList();A.add({start:this.getStartPoint(),end:this.getEndPoint()});return A},getLength:function(){if(this.shape!==null){return this.shape.getTotalLength()}return Math.sqrt((this.startX-this.endX)*(this.startX-this.endX)+(this.startY-this.endY)*(this.startY-this.endY))},getAngle:function(){var A=this.getLength();var B=-(180/Math.PI)*Math.asin((this.startY-this.endY)/A);if(B<0){if(this.endX<this.startX){B=Math.abs(B)+180}else{B=360-Math.abs(B)}}else{if(this.endX<this.startX){B=180-B}}return B},createCommand:function(E){if(E.getPolicy()===draw2d.command.CommandType.MOVE){var B=this.getStartX();var D=this.getStartY();var A=this.getEndX();var C=this.getEndY();return new draw2d.command.CommandMoveLine(this,B,D,A,C)}if(E.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===false){return null}return new draw2d.command.CommandDelete(this)}return null},hitTest:function(B,A){return draw2d.shape.basic.Line.hit(this.corona,this.startX,this.startY,this.endX,this.endY,B,A)},intersection:function(B){var A=new draw2d.util.ArrayList();if(B===this){return A}var D=this.getSegments();var C=B.getSegments();D.each(function(F,E){C.each(function(H,G){var I=draw2d.shape.basic.Line.intersection(E.start,E.end,G.start,G.end);if(I!==null){A.add(I)}})});return A},getPersistentAttributes:function(){var A=this._super();delete A.x;delete A.y;delete A.width;delete A.height;A.stroke=this.stroke;A.color=this.getColor().hash();return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.stroke!=="undefined"){this.setStroke(parseInt(A.stroke))}if(typeof A.color!=="undefined"){this.setColor(A.color)}}});draw2d.shape.basic.Line.intersection=function(E,C,I,H){var J=null;var F=(H.x-I.x)*(E.y-I.y)-(H.y-I.y)*(E.x-I.x);var G=(C.x-E.x)*(E.y-I.y)-(C.y-E.y)*(E.x-I.x);var D=(H.y-I.y)*(C.x-E.x)-(H.x-I.x)*(C.y-E.y);if(D!=0){var B=F/D;var A=G/D;if(0<=B&&B<=1&&0<=A&&A<=1){J=new draw2d.geo.Point((E.x+B*(C.x-E.x))|0,(E.y+B*(C.y-E.y))|0);J.justTouching=(0==B||B==1||0==A||A==1)}}return J};draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){A=0}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){A=0}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/PolyLine.js' */
(function ($) {draw2d.shape.basic.PolyLine=draw2d.shape.basic.Line.extend({NAME:"draw2d.shape.basic.PolyLine",init:function(){this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this._super()},setStartPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},setEndPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},calculatePath:function(){if(this.shape===null){return }this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this.router.route(this);this.routingRequired=false},repaint:function(){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgPathString===null||this.routingRequired===true){this.calculatePath()}this._super({path:this.svgPathString,"stroke-linejoin":"round"})},onDragEnter:function(A){this.setGlow(true);return this},onDragLeave:function(A){this.setGlow(false)},getPoints:function(){return this.basePoints},getSegments:function(){return this.lineSegments},addPoint:function(A,B){if(typeof B!=="undefined"){A=new draw2d.geo.Point(A,B)}this.basePoints.add(A);if(this.oldPoint!==null){this.lineSegments.add({start:this.oldPoint,end:A})}this.svgPathString=null;this.oldPoint=A},onOtherFigureIsMoving:function(A){this.repaintBlocked=true;this._super(A);this.calculatePath();this.repaintBlocked=false;this.repaint()},hitTest:function(D,B){for(var C=0;C<this.lineSegments.getSize();C++){var A=this.lineSegments.get(C);if(draw2d.shape.basic.Line.hit(this.corona,A.start.x,A.start.y,A.end.x,A.end.y,D,B)){return true}}return false},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===true){return new draw2d.command.CommandDelete(this)}}return null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Diamond.js' */
(function ($) {draw2d.shape.basic.Diamond=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Diamond",init:function(B,A){this._super();this.setBackgroundColor("#00a3f6");this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}var B=this.getBoundingBox();var C=["M",B.x+(B.w/2)," ",B.y];C.push("L",B.x+B.w," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y+B.h);C.push("L",B.x," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y);A.path=C.join("");this._super(A)},createShapeElement:function(){return this.canvas.paper.path("M0 0L1 1")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Image.js' */
(function ($) {draw2d.shape.basic.Image=draw2d.shape.node.Node.extend({NAME:"draw2d.shape.basic.Image",init:function(C,B,A){this._super(B,A);this.path=C},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();A.width=this.getWidth();A.height=this.getHeight();this._super(A)},createShapeElement:function(){return this.canvas.paper.image(this.path,this.getX(),this.getY(),this.getWidth(),this.getHeight())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Connection.js' */
(function ($) {draw2d.Connection=draw2d.shape.basic.PolyLine.extend({NAME:"draw2d.Connection",init:function(A){this._super();this.sourcePort=null;this.targetPort=null;this.oldPoint=null;this.sourceDecorator=null;this.targetDecorator=null;this.sourceDecoratorNode=null;this.targetDecoratorNode=null;this.router=A||draw2d.Connection.DEFAULT_ROUTER;this.setColor("#1B1B1B");this.setStroke(1)},disconnect:function(){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.fireTargetPortRouteEvent()}},reconnect:function(){if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.fireTargetPortRouteEvent()}this.onReconnect(this.getSourcePort(),this.getTargetPort());this.routingRequired=true;this.repaint()},isResizeable:function(){return this.isDraggable()},addFigure:function(B,A){if(!(A instanceof draw2d.layout.locator.ConnectionLocator)){throw"Locator must implement the class draw2d.layout.locator.ConnectionLocator"}this._super(B,A)},setSourceDecorator:function(A){this.sourceDecorator=A;this.routingRequired=true;if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}this.repaint()},getSourceDecorator:function(){return this.sourceDecorator},setTargetDecorator:function(A){this.targetDecorator=A;this.routingRequired=true;if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}this.repaint()},getTargetDecorator:function(){return this.targetDecorator},setRouter:function(A){if(typeof A==="undefined"||A===null){this.router=new draw2d.layout.connection.NullRouter()}else{this.router=A}this.routingRequired=true;this.repaint()},getRouter:function(){return this.router},calculatePath:function(){if(this.sourcePort===null||this.targetPort===null){return }this._super()},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(this.sourcePort===null||this.targetPort===null){return }this._super(B);if(this.getSource().getParent().isMoving===false&&this.getTarget().getParent().isMoving===false){if(this.targetDecorator!==null&&this.targetDecoratorNode===null){this.targetDecoratorNode=this.targetDecorator.paint(this.getCanvas().paper)}if(this.sourceDecorator!==null&&this.sourceDecoratorNode===null){this.sourceDecoratorNode=this.sourceDecorator.paint(this.getCanvas().paper)}}if(this.sourceDecoratorNode!==null){var C=this.getPoints().get(0);this.sourceDecoratorNode.transform("r"+this.getStartAngle()+","+C.x+","+C.y+" t"+C.x+","+C.y)}if(this.targetDecoratorNode!==null){var A=this.getPoints().getLastElement();this.targetDecoratorNode.transform("r"+this.getEndAngle()+","+A.x+","+A.y+" t"+A.x+","+A.y)}},getAbsoluteX:function(){return 0},getAbsoluteY:function(){return 0},postProcess:function(A){this.router.postProcess(this,this.getCanvas(),A)},onDragEnter:function(A){if(A instanceof draw2d.shape.basic.LineResizeHandle){return null}return this},onDragLeave:function(A){},getStartPoint:function(){if(this.isMoving===false){return this.sourcePort.getConnectionAnchorLocation(this.targetPort.getConnectionAnchorReferencePoint())}else{return this._super()}},getEndPoint:function(){if(this.isMoving===false){return this.targetPort.getConnectionAnchorLocation(this.sourcePort.getConnectionAnchorReferencePoint())}else{return this._super()}},setSource:function(A){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}this.sourcePort=A;if(this.sourcePort===null){return }this.routingRequired=true;this.fireSourcePortRouteEvent();this.sourcePort.attachMoveListener(this);if(this.canvas!==null){this.sourcePort.onConnect(this)}this.setStartPoint(A.getAbsoluteX(),A.getAbsoluteY())},getSource:function(){return this.sourcePort},setTarget:function(A){if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}this.targetPort=A;if(this.targetPort===null){return }this.routingRequired=true;this.fireTargetPortRouteEvent();this.targetPort.attachMoveListener(this);if(this.canvas!==null){this.targetPort.onConnect(this)}this.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},getTarget:function(){return this.targetPort},sharingPorts:function(A){return this.sourcePort==A.sourcePort||this.sourcePort==A.targetPort||this.targetPort==A.sourcePort||this.targetPort==A.targetPort},setCanvas:function(A){this._super(A);if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}if(this.canvas===null){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}}else{if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.sourcePort.onConnect(this)}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.targetPort.onConnect(this)}}},onOtherFigureIsMoving:function(A){if(A===this.sourcePort){this.setStartPoint(this.sourcePort.getAbsoluteX(),this.sourcePort.getAbsoluteY())}else{this.setEndPoint(this.targetPort.getAbsoluteX(),this.targetPort.getAbsoluteY())}this._super(A)},getStartAngle:function(){if(this.lineSegments.getSize()===0){return 0}var D=this.lineSegments.get(0).start;var B=this.lineSegments.get(0).end;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},getEndAngle:function(){if(this.lineSegments.getSize()===0){return 90}var D=this.lineSegments.get(this.lineSegments.getSize()-1).end;var B=this.lineSegments.get(this.lineSegments.getSize()-1).start;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(this.lineSegments.getSize()-5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},fireSourcePortRouteEvent:function(){var B=this.sourcePort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},fireTargetPortRouteEvent:function(){var B=this.targetPort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE_BASEPOINT){return new draw2d.command.CommandReconnect(this)}return this._super(A)},getPersistentAttributes:function(){var B=this._super();var A=this.getSource().getParent();while(A.getParent()!==null){A=A.getParent()}B.source={node:A.getId(),port:this.getSource().getName()};var A=this.getTarget().getParent();while(A.getParent()!==null){A=A.getParent()}B.target={node:A.getId(),port:this.getTarget().getName()};B.router=this.router.NAME;return B},setPersistentAttributes:function(memento){this._super(memento);if(typeof memento.router!=="undefined"){this.setRouter(eval("new "+memento.router+"()"))}},onReconnect:function(A,B){}});draw2d.Connection.createConnection=function(A,B){return new draw2d.Connection()};draw2d.Connection.DEFAULT_ROUTER=new draw2d.layout.connection.ManhattanConnectionRouter();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ResizeHandle.js' */
(function ($) {draw2d.ResizeHandle=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.ResizeHandle",DEFAULT_COLOR:"#00bdee",init:function(A,B){this._super();this.isResizeHandle=true;this.owner=A;this.type=B;this.command=null;this.commandMove=null;this.commandResize=null;this.setDimension();this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor("#7A7A7A");this.setStroke(1);this.setSelectable(false);this.setRadius(0)},select:function(A){},unselect:function(){},getSnapToDirection:function(){switch(this.type){case 1:return draw2d.SnapToHelper.NORTH_WEST;case 2:return draw2d.SnapToHelper.NORTH;case 3:return draw2d.SnapToHelper.NORTH_EAST;case 4:return draw2d.SnapToHelper.EAST;case 5:return draw2d.SnapToHelper.SOUTH_EAST;case 6:return draw2d.SnapToHelper.SOUTH;case 7:return draw2d.SnapToHelper.SOUTH_WEST;case 8:return draw2d.SnapToHelper.WEST;case 9:return draw2d.SnapToHelper.NSEW;default:return draw2d.SnapToHelper.EAST}},createShapeElement:function(){var A=this._super();switch(this.type){case 1:A.attr({cursor:"nw-resize"});break;case 2:A.attr({cursor:"n-resize"});break;case 3:A.attr({cursor:"ne-resize"});break;case 4:A.attr({cursor:"e-resize"});break;case 5:A.attr({cursor:"se-resize"});break;case 6:A.attr({cursor:"s-resize"});break;case 7:A.attr({cursor:"sw-resize"});break;case 8:A.attr({cursor:"w-resize"});break}return A},onDragStart:function(){if(!this.isDraggable()){return false}this.ox=this.getAbsoluteX();this.oy=this.getAbsoluteY();this.commandMove=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));this.commandResize=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.RESIZE));return true},onDrag:function(K,J){if(this.isDraggable()===false){return }var I=this.getAbsoluteX();var H=this.getAbsoluteY();this._super(K,J);var F=this.getAbsoluteX()-I;var D=this.getAbsoluteY()-H;var A=this.owner;var C=A.getAbsoluteX();var B=A.getAbsoluteY();var E=A.getWidth();var G=A.getHeight();switch(this.type){case 1:A.setDimension(E-F,G-D);A.setPosition(C+(E-A.getWidth()),B+(G-A.getHeight()));break;case 2:A.setDimension(E,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 3:A.setDimension(E+F,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 4:A.setDimension(E+F,G);break;case 5:A.setDimension(E+F,G+D);break;case 6:A.setDimension(E,G+D);break;case 7:A.setDimension(E-F,G+D);A.setPosition(C+(E-A.getWidth()),B);break;case 8:A.setDimension(E-F,G);A.setPosition(C+(E-A.getWidth()),B);break}},onDragEnd:function(){if(!this.isDraggable()){return }if(this.commandMove!==null){this.commandMove.setPosition(this.owner.getX(),this.owner.getY());this.canvas.getCommandStack().execute(this.commandMove);this.commandMove=null}if(this.commandResize!==null){this.commandResize.setDimension(this.owner.getWidth(),this.owner.getHeight());this.canvas.getCommandStack().execute(this.commandResize);this.commandResize=null}this.canvas.hideSnapToHelperLines()},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint()},setDimension:function(C,A){if(typeof A!=="undefined"){this._super(C,A)}else{if(draw2d.isTouchDevice){this._super(15,15)}else{this._super(8,8)}}var D=this.getWidth();var B=D/2;switch(this.type){case 1:this.setSnapToGridAnchor(new draw2d.geo.Point(D,D));break;case 2:this.setSnapToGridAnchor(new draw2d.geo.Point(B,D));break;case 3:this.setSnapToGridAnchor(new draw2d.geo.Point(0,D));break;case 4:this.setSnapToGridAnchor(new draw2d.geo.Point(0,B));break;case 5:this.setSnapToGridAnchor(new draw2d.geo.Point(0,0));break;case 6:this.setSnapToGridAnchor(new draw2d.geo.Point(B,0));break;case 7:this.setSnapToGridAnchor(new draw2d.geo.Point(D,0));break;case 8:this.setSnapToGridAnchor(new draw2d.geo.Point(D,B));break;case 9:this.setSnapToGridAnchor(new draw2d.geo.Point(B,B));break}},show:function(A){this.setCanvas(A);this.canvas.resizeHandles.add(this);this.shape.toFront()},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill="#e6e6e8"}else{A.fill="90-#b8c8ec-#e6e6e8"}this._super(A)},supportsSnapToHelper:function(){return true},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineResizeHandle=draw2d.shape.basic.Circle.extend({NAME:"draw2d.shape.basic.LineResizeHandle",init:function(A){this._super();this.owner=A;this.isResizeHandle=true;if(draw2d.isTouchDevice){this.setDimension(14,14)}else{this.setDimension(7,7)}this.setBackgroundColor("#d04437");this.setColor("#d04437");this.setStroke(1);this.setSelectable(false);this.currentTarget=null},select:function(A){},unselect:function(){},getRelatedPort:function(){return null},getOppositePort:function(){return null},getOppositePortTo:function(A){return _.without([this.owner.getSource(),this.owner.getTarget()],A)[0]},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(!("fill" in A)){if(this.getAlpha()<0.9){A.fill="#d04437"}else{A.fill="r(.4,.3)#d04437:40-#d04437:60-#d04437"}}this._super(A)},onDragStart:function(){this.ox=this.x;this.oy=this.y;this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_BASEPOINT));return true},onDrag:function(D,A){this.setPosition(this.ox+D,this.oy+A);var C=this.getRelatedPort();var B=this.getBoundingBox().getCenter();var E=(C!==null)?this._getDropTarget(B.x,B.y,C):null;if(E!==this.currentTarget&&E!==this.getOppositePortTo(C)){if(this.currentTarget!==null){this.currentTarget.onDragLeave(C);this.currentTarget.setGlow(false)}if(E!==null){this.currentTarget=E.onDragEnter(C);if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}else{this.currentTarget=C}}else{if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}return true},_getDropTarget:function(A,C,B){return B.getDropTarget(A,C)},onDragEnd:function(){if(!this.isDraggable()){return false}var A=this.getRelatedPort();if(A!==null){if(this.currentTarget!==null){this.onDrop(this.currentTarget);this.currentTarget.onDragLeave(A);this.currentTarget.setGlow(false);this.currentTarget=null}}if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){if(this.command!==null){this.command.cancel()}}else{if(this.command!==null){this.getCanvas().getCommandStack().execute(this.command)}}this.command=null;this.getCanvas().hideSnapToHelperLines();return true},supportsSnapToHelper:function(){if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){return false}return true},show:function(B,A,C){this.setCanvas(B);this.setPosition(A,C);this.shape.toFront();this.canvas.resizeHandles.add(this)},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineStartResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineStartResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineStartResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getStartPoint();this.owner.setStartPoint(B.x-E,B.y-C);this.owner.isMoving=true;return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(A,this.owner.getTarget());this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineEndResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineEndResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineEndResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getEndPoint();this.owner.setEndPoint(B.x-E,B.y-C);this.owner.isMoving=true;this.detachMoveListener(this.owner);return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(this.owner.getSource(),A);this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Port.js' */
(function ($) {draw2d.Port=draw2d.shape.basic.Circle.extend({NAME:"draw2d.Port",DEFAULT_BORDER_COLOR:new draw2d.util.Color("#1B1B1B"),init:function(A){this.locator=null;this.lighterBgColor=null;this._super();if(draw2d.isTouchDevice){this.setDimension(25,25)}else{this.setDimension(10,10)}this.ox=this.x;this.oy=this.y;this.coronaWidth=5;this.corona=null;this.currentTargetPort=null;this.currentTarget=null;this.setBackgroundColor("#4f6870");this.setStroke(1);this.setColor(this.DEFAULT_BORDER_COLOR);this.setSelectable(false);if(typeof A==="undefined"){this.name=null}else{this.name=A}this.connectionAnchor=new draw2d.layout.anchor.ConnectionAnchor(this);this.value=null;this.maxFanOut=Number.MAX_VALUE;this.setCanSnapToHelper(false);this.installEditPolicy(new draw2d.policy.port.IntrusivePortsFeedbackPolicy())},setMaxFanOut:function(A){this.maxFanOut=Math.max(1,A);return this},getMaxFanOut:function(){return this.maxFanOut},setConnectionAnchor:function(A){if(typeof A==="undefined"||A===null){A=new draw2d.layout.anchor.ConnectionAnchor()}this.connectionAnchor=A;this.connectionAnchor.setOwner(this);return this},getConnectionAnchorLocation:function(A){return this.connectionAnchor.getLocation(A)},getConnectionAnchorReferencePoint:function(){return this.connectionAnchor.getReferencePoint()},getConnectionDirection:function(B,A){return this.getParent().getBoundingBox().getDirection(this.getAbsolutePosition())},setLocator:function(A){this.locator=A;return this},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.3).hash();return this},setValue:function(A){this.value=A;if(this.getParent()!==null){this.getParent().onPortValueChanged(this)}return this},getValue:function(){return this.value},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.cx=this.getAbsoluteX();A.cy=this.getAbsoluteY();A.rx=this.width/2;A.ry=A.rx;A.cursor="move";if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)},onMouseEnter:function(){this.setStroke(2)},onMouseLeave:function(){this.setStroke(1)},getConnections:function(){var A=new draw2d.util.ArrayList();var C=this.moveListener.getSize();for(var B=0;B<C;B++){var D=this.moveListener.get(B);if(D instanceof draw2d.Connection){A.add(D)}}return A},setParent:function(A){this._super(A);if(this.parent!==null){this.parent.detachMoveListener(this)}if(this.parent!==null){this.parent.attachMoveListener(this)}},getCoronaWidth:function(){return this.coronaWidth},setCoronaWidth:function(A){this.coronaWidth=A},onDragStart:function(){if(this.getConnections().getSize()>=this.maxFanOut){return false}this.getShapeElement().toFront();this.ox=this.x;this.oy=this.y;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragStart(this.canvas,this)}},this));return true},onDrag:function(B,A){this.isInDragDrop=true;this._super(B,A);var C=this.getDropTarget(this.getAbsoluteX(),this.getAbsoluteY(),this);if(C!==this.currentTarget){if(this.currentTarget!==null){this.currentTarget.onDragLeave(this);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}if(C!==null){this.currentTarget=C.onDragEnter(this);if(this.currentTarget!==null){this.currentTargetPort=C;this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverEnter(this.canvas,this,this.currentTarget)}},this))}}else{this.currentTarget=null}}},onDragEnd:function(){this.setAlpha(1);this.setPosition(this.ox,this.oy);this.isInDragDrop=false;if(this.currentTarget){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.port.PortFeedbackPolicy){B.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.currentTarget=null},onDragEnter:function(B){if(!(B instanceof draw2d.Port)){return null}if(this.getConnections().getSize()>=this.maxFanOut){return null}var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=B;A.target=this;var C=this.createCommand(A);if(C===null){return null}return this},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }},onDrop:function(C){if(!(C instanceof draw2d.Port)){return }var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=C;A.target=this;var B=this.createCommand(A);if(B!==null){this.parent.getCanvas().getCommandStack().execute(B)}this.setGlow(false)},onConnect:function(A){},onDisconnect:function(A){},onOtherFigureIsMoving:function(A){this.repaint();this.fireMoveEvent()},getName:function(){return this.name},setName:function(A){this.name=A},hitTest:function(B,F){var A=this.getAbsoluteX()-(this.coronaWidth*2)-this.getWidth()/2;var E=this.getAbsoluteY()-(this.coronaWidth*2)-this.getHeight()/2;var C=A+this.width+(this.coronaWidth*4);var D=E+this.height+(this.coronaWidth*4);return(B>=A&&B<=C&&F>=E&&F<=D)},setGlow:function(A){if(A===true&&this.corona===null){this.corona=new draw2d.Corona();this.corona.setDimension(this.getWidth()+(this.getCoronaWidth()*2),this.getWidth()+(this.getCoronaWidth()*2));this.corona.setPosition(this.getAbsoluteX()-this.getCoronaWidth()-this.getWidth()/2,this.getAbsoluteY()-this.getCoronaWidth()-this.getHeight()/2);this.corona.setCanvas(this.getCanvas());this.corona.getShapeElement();this.corona.repaint()}else{if(A===false&&this.corona!==null){this.corona.setCanvas(null);this.parent.getCanvas().removeFigure(this.corona);this.corona=null}}return this},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMovePort(this)}if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.parent.id===A.target.parent.id){return null}else{return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}}return null},fireMoveEvent:function(){if(this.isInDragDrop===true){return }this._super()},getDropTarget:function(A,E,B){for(var C=0;C<this.targets.getSize();C++){var D=this.targets.get(C);if(D!==B){if(D.hitTest(A,E)===true){return D}}}return null},getDropTargets:function(){return this.targets.clone().grep($.proxy(function(A){return A!==this},this))}});draw2d.Corona=draw2d.shape.basic.Circle.extend({init:function(){this._super();this.setAlpha(0.3);this.setBackgroundColor(new draw2d.util.Color(178,225,255));this.setColor(new draw2d.util.Color(102,182,252))},setAlpha:function(A){this._super(Math.min(0.3,A));this.setDeleteable(false);this.setDraggable(false);this.setResizeable(false);this.setSelectable(false);return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/InputPort.js' */
(function ($) {draw2d.InputPort=draw2d.Port.extend({NAME:"draw2d.InputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.OutputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.OutputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/OutputPort.js' */
(function ($) {draw2d.OutputPort=draw2d.Port.extend({NAME:"draw2d.OutputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.OutputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.InputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.InputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/HybridPort.js' */
(function ($) {draw2d.HybridPort=draw2d.Port.extend({NAME:"draw2d.HybridPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.Port){return this._super(A)}return null},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }if(A instanceof draw2d.Port){this._super(A)}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}else{if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}else{if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}}}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ConnectionAnchor=Class.extend({NAME:"draw2d.layout.anchor.ConnectionAnchor",init:function(A){this.owner=A},getLocation:function(A){return this.getReferencePoint()},getOwner:function(){return this.owner},setOwner:function(A){if(typeof A==="undefined"){throw"Missing parameter for 'owner' in ConnectionAnchor.setOwner"}this.owner=A},getBox:function(){return this.getOwner().getAbsoluteBounds()},getReferencePoint:function(){return this.getOwner().getAbsolutePosition()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ChopboxConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ChopboxConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ChopboxConnectionAnchor",init:function(A){this._super(A)},getLocation:function(B){var E=new draw2d.geo.Rectangle(0,0);E.setBounds(this.getBox());E.translate(-1,-1);E.resize(1,1);var A=E.getCenter();if(E.isEmpty()||(B.x==A.x&&B.y==A.y)){return A}var D=B.x-A.x;var C=B.y-A.y;var F=0.5/Math.max(Math.abs(D)/E.w,Math.abs(C)/E.h);D*=F;C*=F;A.translate(D,C);return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ShortesPathConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ShortesPathConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ShortesPathConnectionAnchor",init:function(A){this._super(A)},getLocation:function(E){var D=this.getOwner().getParent().getBoundingBox();var B=D.getCenter();if(this.getOwner().getParent() instanceof draw2d.shape.basic.Oval){var A=this.getOwner().getParent().intersectionWithLine(E,B);if(A.getSize()==1){return A.get(0)}}var C=D.determineOctant(new draw2d.geo.Rectangle(E.x,E.y,2,2));switch(C){case 0:return D.getTopLeft();case 1:return new draw2d.geo.Point(E.x,D.getTop());case 2:return D.getTopRight();case 3:return new draw2d.geo.Point(D.getRight(),E.y);case 4:return D.getBottomRight();case 5:return new draw2d.geo.Point(E.x,D.getBottom());case 6:return D.getBottomLeft();case 7:return new draw2d.geo.Point(D.getLeft(),E.y)}return D.getTopLeft()},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/CenterEdgeConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.CenterEdgeConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.CenterEdgeConnectionAnchor",init:function(A){this._super(A)},getLocation:function(D){var C=this.getOwner().getParent().getBoundingBox();var B=C.getDirection(D);var A=C.getCenter();switch(B){case 0:A.y=C.y;break;case 1:A.x=C.x+C.w;break;case 2:A.y=C.y+C.h;break;case 3:A.x=C.x}return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowLeft",init:function(){this._super()},getSVG:function(){return'<svg width="230" height="60" xmlns="http://www.w3.org/2000/svg" version="1.1">  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3024" d="m 218.87943,27.464763 c -1.21088,-0.0563 -2.42064,-0.14616 -3.63262,-0.16893 c -5.82495,-0.10948 -18.61676,-0.0226 -22.97385,0.0122 c -7.12848,0.057 -14.25673,0.14021 -21.38495,0.22333 c -9.03765,0.10539 -18.07511,0.22813 -27.11266,0.3422 c -10.2269,0.11878 -20.4538,0.23756 -30.6807,0.35634 c -35.488759,0.4089 -70.975849,0.82793 -106.4669238,0.95195 c 0,0 7.9718628,-5.70244 7.9718628,-5.70244 l 0,0 c 6.374241,0.28694 12.745594,0.64561 19.122722,0.86083 c 28.09499,0.94816 56.21338,0.92473 84.315959,0.32205 c 10.51273,-0.32805 21.0288,-0.56402 31.53819,-0.98412 c 27.47361,-1.09824 54.91405,-2.91665 82.28177,-5.53697 c 0,0 -12.9788,9.32351 -12.9788,9.32351 z" inkscape:connector-curvature="0" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3026" d="m 100.75066,1.6309831 c -7.165239,3.9571 -14.284929,7.47866 -22.036659,10.2707299 c -5.00195,1.80163 -10.10374,3.31886 -15.2402,4.79424 c -8.25878,2.37815 -16.55626,4.65805 -24.9012,6.79479 c -2.89107,0.71593 -5.74687,1.56407 -8.66266,2.20424 c -3.211679,0.70512 -6.49468,1.17333 -9.752959,1.6747 c -5.447101,0.92112 -10.9044008,1.81762 -16.3983488,2.50082 c -1.608931,0.0814 -0.850754,0.10697 -2.275834,-0.0365 C 20.004071,21.041553 19.256899,21.517873 32.515691,19.216243 c 6.21537,-1.05913 12.34875,-2.37668 18.3945,-4.03234 c 8.12719,-2.02803 16.23765,-4.1157 24.26421,-6.4321199 c 5.23574,-1.55053 10.41682,-3.15473 15.46857,-5.12875 c 1.38953,-0.54295 2.7579,-1.12682 4.12253,-1.71603 c 0.98421,-0.42496 3.86537,-1.81801999 2.92296,-1.32600999 C 93.642191,2.6934931 89.529511,4.7073031 85.450031,6.7704531 l 15.300629,-5.1394 z" inkscape:connector-curvature="0" sodipodi:nodetypes="csccsccccccsssccc" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3028" d="m 80.764281,58.068863 c -2.45498,-3.50762 -6.58178,-6.10525 -10.40324,-8.66732 c -4.30614,-2.72676 -7.93958,-6.28283 -12.6021,-8.28702 c -7.39912,-4.50257 -11.70055,-7.85592 -20.85866,-9.23429 c -4.9257,-0.85706 -17.294247,-1.32043 -22.226462,-2.15427 c -3.445882,-0.42869 -6.2035918,0.70541 -9.6845138,0.57715 c -1.496337,-0.0586 -2.99355,-0.0965 -4.491229,-0.12472 l 13.9525278,-6.24562 l 3.25,-1.17153 c 1.441459,0.0813 -1.116338,0.15309 0.325505,0.23016 c 3.574557,0.17902 7.211864,0.0695 10.712655,0.73822 c 4.723107,1.08097 9.443947,2.1624 14.234177,3.05317 c 2.76739,0.64203 3.92627,0.87082 6.64127,1.66289 c 4.42146,1.28993 8.60075,3.01513 12.86503,4.58129 c 1.90199,0.73446 5.05193,1.93181 6.89302,2.7216 c 4.92005,2.11061 9.5916,4.57045 13.9716,7.31023 c 4.16708,2.62011 8.48023,5.20033 11.72012,8.56863 z" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccccccccscsccc" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowDownLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowDownLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowDownLeft",init:function(){this._super()},getSVG:function(){return'<svg width="180" height="300" xmlns="http://www.w3.org/2000/svg" version="1.1">     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3084" d="m 159.63578,17.846597 c 0.43137,9.44641 -0.0636,18.88035 -0.8284,28.30165 c -1.73211,18.38336 -4.05381,36.71698 -6.08253,55.075313 c -1.61738,13.7075 -3.03402,27.43467 -3.97611,41.19113 c -1.09101,11.16584 -1.31019,22.36559 -1.28541,33.56466 c -0.1328,4.82188 0.3218,9.6468 0.14332,14.46812 c -0.0888,2.39977 -0.28315,3.73625 -0.55012,6.12095 c -0.85848,4.73147 -2.27416,9.40019 -4.7769,13.68272 c -1.47003,2.51544 -3.78493,5.6647 -5.47739,8.05048 c -5.02888,6.66256 -11.08555,12.65652 -18.10552,17.75963 c -4.23302,3.07716 -7.74942,5.12065 -12.22081,7.86298 c -13.253319,6.72606 -25.889792,15.11686 -40.84124,18.60576 c -3.016829,0.7039 -4.431417,0.8157 -7.450859,1.2076 c -6.983246,0.5774 -14.009174,0.3375 -21.010676,0.2509 c -3.278795,-0.033 -6.55749,0.01 -9.835897,0.045 c 0,0 20.838833,-13.2364 20.838833,-13.2364 l 0,0 c 3.147056,0.093 6.294483,0.1852 9.443646,0.2007 c 6.966697,0.011 13.971433,0.1301 20.897176,-0.6344 c 3.732439,-0.5577 7.321215,-1.2431 10.881203,-2.4145 c 1.517208,-0.4992 5.830867,-2.43339 4.487902,-1.6386 c -6.098183,3.6088 -25.104875,12.8748 -9.52514,5.223 c 4.40875,-2.5927 8.262057,-4.7459 12.425175,-7.65986 c 6.839117,-4.78709 12.633657,-10.50427 17.500607,-16.86761 c 2.53518,-3.56692 5.24684,-7.12748 7.07617,-11.03446 c 1.42357,-3.0404 2.21532,-6.28727 2.91146,-9.50152 c 0.91919,-6.88822 1.03991,-13.81392 1.25118,-20.74151 c 0.47683,-11.27871 0.96259,-22.55877 1.61689,-33.83062 c 1.21127,-14.03392 3.64191,-27.94339 5.46543,-41.92167 c 2.26899,-18.186603 4.6835,-36.384373 5.4487,-54.679643 c 0.0788,-2.46092 0.23808,-4.92087 0.23618,-7.38276 c -0.005,-6.45916 -0.62194,-13.00218 -2.13821,-19.32664 c 0,0 23.48134,-10.73998 23.48134,-10.73998 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3086" d="m 41.271518,252.40239 c 2.465518,-0.7264 4.879503,-1.7726 7.145328,-2.9859 c 0.955597,-0.5117 3.736822,-2.1986 2.791991,-1.6673 c -5.218817,2.9348 -10.409826,5.9187 -15.61474,8.878 c 5.366557,-3.4898 10.227818,-7.6685 14.119927,-12.75576 c 3.507157,-5.09382 4.097613,-11.17122 4.301158,-17.17644 c 0.02635,-3.95844 -0.31227,-7.90612 -0.635377,-11.84752 c 0,0 19.920693,-10.3059 19.920693,-10.3059 l 0,0 c 0.171761,4.05015 0.409899,8.09777 0.50079,12.15101 c -0.185739,6.23619 -0.347804,12.66862 -3.492579,18.24747 c -0.503375,0.75197 -0.961922,1.53596 -1.510126,2.25591 c -3.478528,4.56826 -8.226837,8.04586 -12.757403,11.47443 c -7.345206,4.3297 -14.671333,8.692 -22.035619,12.9891 c -3.551305,2.0723 -7.368692,3.8726 -11.394645,4.7773 c 0,0 18.660602,-14.0344 18.660602,-14.0344 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3088" d="m 37.815923,255.49919 c 3.41111,0.1581 6.814569,0.2213 10.182693,0.8184 c 6.92998,2.6928 13.533527,6.2357 20.043462,9.8162 c 3.912139,2.1362 7.91195,4.4644 10.690321,8.0298 c 1.039962,1.2802 1.510411,2.7604 1.893523,4.3313 c 0,0 -20.370847,10.9259 -20.370847,10.9259 l 0,0 c -0.225419,-1.2711 -0.55067,-2.4558 -1.329618,-3.5184 c -2.332229,-3.3633 -5.869056,-5.6279 -9.247191,-7.8233 c -6.335066,-3.7106 -12.98611,-7.1834 -20.232784,-8.6836 c -3.497247,-0.3814 -7.011372,-0.4307 -10.521829,-0.1703 c 0,0 18.89227,-13.726 18.89227,-13.726 z" inkscape:connector-curvature="0" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Start.js' */
(function ($) {draw2d.shape.node.Start=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Start",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("output");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/End.js' */
(function ($) {draw2d.shape.node.End=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.End",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("input");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Between.js' */
(function ($) {draw2d.shape.node.Between=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Between",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker());this.createPort("output");this.createPort("input")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/note/PostIt.js' */
(function ($) {draw2d.shape.note.PostIt=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.PostIt",init:function(A){this._super(A);this.setStroke(1);this.setBackgroundColor("#5b5b5b");this.setColor("#FFFFFF");this.setFontColor("#ffffff");this.setFontSize(14);this.setPadding(5);this.setRadius(5)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Widget.js' */
(function ($) {draw2d.shape.widget.Widget=draw2d.SetFigure.extend({init:function(B,A){this._super(B,A)},getWidth:function(){return this.width},getHeight:function(){return this.height}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Slider.js' */
(function ($) {draw2d.shape.widget.Slider=draw2d.shape.widget.Widget.extend({NAME:"draw2d.shape.widget.Slider",DEFAULT_COLOR_THUMB:new draw2d.util.Color("#bddf69"),DEFAULT_COLOR_BG:new draw2d.util.Color("#d3d3d3"),init:function(B,A){if(typeof B==="undefined"){B=120;A=15}this.currentValue=0;this.slideBoundingBox=new draw2d.geo.Rectangle(0,0,10,20);this._super(B,A);this.setBackgroundColor(this.DEFAULT_COLOR_BG);this.setColor(this.DEFAULT_COLOR_THUMB);this.setStroke(1);this.setRadius(4);this.setResizeable(true);this.setMinHeight(10);this.setMinWidth(80)},createSet:function(){var A=this.canvas.paper.set();var B=this.canvas.paper.rect(5,5,10,20);B.node.style.cursor="col-resize";A.push(B);return A},setDimension:function(A,B){this._super(A,B);this.slideBoundingBox.setBoundary(0,0,this.getWidth()-10,this.getHeight());this.slideBoundingBox.setHeight(this.getHeight()+1);this.repaint()},onValueChange:function(A){},onDragStart:function(B,A){if(this.slideBoundingBox.hitTest(B,A)){this.origX=this.slideBoundingBox.getX();this.origY=this.slideBoundingBox.getY();return false}return this._super(B,A)},onPanning:function(B,A){this.slideBoundingBox.setPosition(this.origX+B,this.origY+A);this.setValue(100/(this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())*this.slideBoundingBox.getX())},setValue:function(A){this.currentValue=Math.min(Math.max(0,(A|0)),100);this.repaint();this.onValueChange(this.currentValue)},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(typeof B==="undefined"){B={}}var C=((this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())/100*this.currentValue)|0;this.slideBoundingBox.setX(C);if(this.svgNodes!==null){var A=this.slideBoundingBox.toJSON();A.y=A.y-5;A.height=A.height+10;A.fill=this.getColor().hash();A.stroke=this.getColor().darker(0.2).hash();A.r=4;this.svgNodes.attr(A)}B.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95";B.stroke=this.bgColor.darker(0.1).hash();this._super(B)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Diagram.js' */
(function ($) {draw2d.shape.diagram.Diagram=draw2d.SetFigure.extend({init:function(B,A){this.data=[];this.padding=5;this.cache={};this._super(B,A);this.setBackgroundColor("#8dabf2");this.setStroke(1);this.setColor("#f0f0f0");this.setRadius(2);this.setResizeable(true)},setData:function(A){this.data=A;this.cache={};if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},setDimension:function(A,B){this.cache={};this._super(A,B)},getWidth:function(){return this.width},getHeight:function(){return this.height},repaint:function(A){if(this.repaintBlocked===true||this.shape==null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill="none"}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+this.getAbsoluteX()+","+this.getAbsoluteY())}else{this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Pie.js' */
(function ($) {draw2d.shape.diagram.Pie=draw2d.shape.diagram.Diagram.extend({COLORS:["#00A8F0","#b9dd69","#f3546a","#4DA74D","#9440ED"],TWO_PI:Math.PI*2,init:function(A){this._super(A,A);this.setStroke(0)},setData:function(B){this.sum=0;$.each(B,$.proxy(function(C,D){this.sum+=D},this));var A=1/this.sum;$.each(B,$.proxy(function(C,D){B[C]=A*D},this));this._super(B)},createSet:function(){var A=this.getWidth()/2;var F=this.data.length;var C=this.canvas.paper.set();var H=0;for(var E=0;E<F;E++){var G=this.TWO_PI*this.data[E];var D=this.COLORS[E%F];var B=this.drawSegment(A,G,H,0.1);B.attr({stroke:this.color.hash(),fill:D});C.push(B);H+=G}return C},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},polarPath:function(B,D,C){var A,E;A=B*Math.cos(D+C)+B;E=B*Math.sin(D+C)+B;return"L "+A+" "+E+" "},drawSegment:function(A,E,D,B){var F="M "+A+" "+A;for(var C=0;C<E;C+=B){F+=this.polarPath(A,C,D)}F+=this.polarPath(A,E,D);F+="L "+A+" "+A;return this.getCanvas().paper.path(F)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Sparkline.js' */
(function ($) {draw2d.shape.diagram.Sparkline=draw2d.shape.diagram.Diagram.extend({init:function(B,A){this.min=0;this.max=10;if(typeof B==="undefined"){B=180;A=50}this._super(B,A)},setData:function(A){this.min=Math.min.apply(Math,A);this.max=Math.max.apply(Math,A);if(this.max==this.min){this.max=this.min+1}this._super(A)},createSet:function(){return this.canvas.paper.path("M0 0 l0 0")},repaint:function(E){if(this.repaintBlocked===true||this.shape===null){return }if(typeof E==="undefined"){E={}}E.fill="90-#000:5-#4d4d4d:95";var H=this.padding;var A=this.getWidth()-2*+this.padding;var I=this.getHeight()-2*+this.padding;var C=this.data.length;var D=this.min;var G=this.max;var B=function(L,J){var K=1;if(C>1){K=(A/(C-1))}return{y:-((L-D)/(G-D)*I)+I+H,x:H+J*K}};if(this.svgNodes!==null&&(typeof this.cache.pathString==="undefined")){var F=null;$.each(this.data,$.proxy(function(J,K){var L=B(K,J);if(F===null){this.cache.pathString=["M",L.x,L.y].join(" ")}else{this.cache.pathString=[this.cache.pathString,"L",L.x,L.y].join(" ")}F=L},this));this.svgNodes.attr({path:this.cache.pathString,stroke:"#f0f0f0"})}this._super(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/OpAmp.js' */
(function ($) {draw2d.shape.analog.OpAmp=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.OpAmp",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,B){var D=B.getParent();var A=(8+18.5*C)*D.scaleY;this.applyConsiderRotation(B,1,A)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.createPort("input",this.inputLocator);this.createPort("input",this.inputLocator);this.createPort("output");this.setBackgroundColor("#f0f0ff")},getSVG:function(){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m8.2627,0l0,35.36035l31.23926,-17.76025l-31.23926,-17.60011l0,0l0,0.00001zm2.27832,27.36719l4.08105,0m-2.10449,-2.20703l0,4.27979m2.26367,-21.35938l-4.15918,0"  stroke="#1B1B1B" fill="none"/><line x1="0.53516"  y1="8"  x2="8.21191"  y2="8"  stroke="#010101"/><line x1="39.14941" y1="18" x2="45.81055" y2="18" stroke="#010101" /><line x1="0.53516"  y1="27" x2="8.21191"  y2="27" stroke="#010101" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.bgColor!=null){this.svgNodes[0].attr({fill:this.bgColor.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorBridge.js' */
(function ($) {draw2d.shape.analog.ResistorBridge=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.ResistorBridge",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2+1,D*C)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B*(C-2),D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12322" d="m47.62207,22.71094l0,0c0.73145,0.73242 0.71777,1.93359 -0.03027,2.68164c-0.74805,0.74951 -1.94922,0.76123 -2.68073,0.0293c-0.73138,-0.73242 -0.71967,-1.93211 0.03033,-2.68115c0.74707,-0.74803 1.94727,-0.76219 2.68066,-0.02979l0,0z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12324" d="m25.84082,0.93115l0,0c0.73145,0.73096 0.71875,1.93359 -0.02832,2.68066c-0.75,0.74951 -1.94922,0.76123 -2.68164,0.0293c-0.73242,-0.73241 -0.71973,-1.93164 0.0293,-2.68065c0.74805,-0.74756 1.94922,-0.76172 2.68066,-0.0293l0,0l0,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12326" d="m25.75098,44.58203l0,0c0.73145,0.73193 0.71875,1.93311 -0.02832,2.68115c-0.75,0.74902 -1.94922,0.76074 -2.68262,0.0293c-0.73145,-0.73193 -0.71973,-1.93262 0.03033,-2.68164c0.74707,-0.74756 1.94922,-0.76123 2.68066,-0.02879l0,0l-0.00006,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12328" d="m3.9707,22.80127l0,0c0.73242,0.73193 0.71777,1.93359 -0.0293,2.68115c-0.74902,0.74951 -1.94922,0.76172 -2.68164,0.0293c-0.73145,-0.73242 -0.71973,-1.93164 0.03027,-2.68115c0.74707,-0.74707 1.94922,-0.76074 2.68066,-0.0293l0,0z"/><polyline fill="none" stroke="#010101" id="polyline12334" points="24.908203125,45.49267578125 31.71875,38.68310546875 31.2119140625,36.98876953125 34.892578125,37.95703125 33.953125,34.22265625 37.6650390625,35.18359375 36.6767578125,31.52490234375 40.3759765625,32.47314453125 39.873046875,30.52783203125 45.884765625,24.51708984375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12338" points="36.3408203125,23.98876953125 38.146484375,29.55810546875 33.630859375,29.55810546875 35.435546875,23.98779296875 "/><line fill="none" stroke="#010101" id="line12340" y2="28.90967" x2="35.8877" y1="41.13428" x1="35.88867" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12346" points="3.2109375,23.79248046875 10.01953125,16.98388671875 9.513671875,15.2890625 13.193359375,16.25732421875 12.251953125,12.5234375 15.9658203125,13.48486328125 14.9775390625,9.82568359375 18.6767578125,10.7734375 18.173828125,8.82958984375 24.185546875,2.81787109375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12350" points="13.126953125,23.80419921875 11.3212890625,18.236328125 15.8369140625,18.236328125 14.0322265625,23.806640625 "/><line fill="none" stroke="#010101" id="line12352" y2="18.8833" x2="13.58008" y1="6.65967" x1="13.5791" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12358" points="46.65625,24.33642578125 39.84765625,17.52783203125 38.154296875,18.033203125 39.1220703125,14.353515625 35.3876953125,15.29345703125 36.34765625,11.58056640625 32.689453125,12.56884765625 33.6376953125,8.86865234375 31.6923828125,9.373046875 24.322265625,2.00341796875 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12362" points="36.578125,1.87109375 38.3828125,7.439453125 33.8681640625,7.439453125 35.6728515625,1.869140625 "/><line fill="none" stroke="#010101" id="line12364" y2="6.7915" x2="36.125" y1="19.01758" x1="36.125" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12370" points="24.494140625,46.49951171875 17.685546875,39.69091796875 15.9921875,40.1953125 16.958984375,36.515625 13.2265625,37.45556640625 14.185546875,33.7421875 10.52734375,34.73193359375 11.474609375,31.03125 9.529296875,31.53515625 2.1611328125,24.166015625 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12374" points="12.150390625,44.80029296875 10.34765625,39.23193359375 14.861328125,39.23095703125 13.0556640625,44.80224609375 "/><line fill="none" stroke="#010101" id="line12376" y2="39.87891" x2="12.60352" y1="27.6543" x1="12.60352" stroke-miterlimit="14.3"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorVertical.js' */
(function ($) {draw2d.shape.analog.ResistorVertical=draw2d.SetFigure.extend({NAME:"draw2d.shape.analog.ResistorVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},createSet:function(){var A=this._super();A.push(this.canvas.paper.path("M15,0 L15,5 L0,7.5 L30,10 L0,15 L30,20 L0,25 L30,30 L15,32.5 L15,40"));return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyHorizontal.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyHorizontal=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyHorizontal",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(B,A){var C=A.getParent().getHeight();this.applyConsiderRotation(A,0,C/2)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B,D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=30}this._super(B,A);this.createPort("hybrid",new this.MyInputPortLocator());this.createPort("hybrid",new this.MyOutputPortLocator())},getSVG:function(){return'<svg width="49" height="28" xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m24.99933,18.95592l0,-9.54576m-5.78374,-9.40907l0,28.35939m-5.78718,-9.40457l0,-9.54576m-5.78374,-9.40907l0,28.35939" id="path10566" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m26.79878,14.13039l6.90583,0m-33.22691,0l6.90583,0" id="path10568" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyVertical.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyVertical=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m19.62398,12.37594l-9.87926,0m-9.74355,8.22145l29.36289,0m-9.74007,8.22469l-9.87927,0m-9.74355,8.22145l29.36289,0" id="path10560" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m14.63157,9.81646l0,-9.81646m0,47.2328l0,-9.81646" id="path10562" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/Layout.js' */
(function ($) {draw2d.shape.layout.Layout=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.layout.Layout",init:function(){this._super();this.setBackgroundColor(null);this.setRadius(0);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},addFigure:function(B,A){this._super(B,this.locator);B.attachResizeListener(this)},onOtherFigureIsResizing:function(A){if(this.getParent() instanceof draw2d.shape.layout.Layout){this.fireResizeEvent()}else{this.setDimension(1,1)}},onDoubleClick:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/HorizontalLayout.js' */
(function ($) {draw2d.shape.layout.HorizontalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.HorizontalLayout",init:function(){this._super();var A=this;this.locator={relocate:function(B,E){var D=A.getStroke();var F=D;for(var C=0;C<B;C++){var G=A.children.get(C).figure;F+=G.getWidth()+A.gap}E.setPosition(F,D)}};this.setDimension(1,1);this.gap=0},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=this.stroke*2+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinWidth()});return A},getMinHeight:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinHeight())});return A+this.stroke*2},setDimension:function(A,B){this._super(A,B);var C=this.width-this.getMinWidth();if(C>0){C=(C/this.children.getSize())|0;this.children.each(function(D,E){E.figure.setDimension(E.figure.getMinWidth()+C,E.figure.getHeight())})}else{this.children.each(function(D,E){E.figure.setDimension(1,1)})}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/VerticalLayout.js' */
(function ($) {draw2d.shape.layout.VerticalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.VerticalLayout",init:function(){this._super();this.gap=0;var A=this;this.locator={relocate:function(B,F){var E=A.getStroke()/2;var D=E;for(var C=0;C<B;C++){var G=A.children.get(C).figure;D=D+G.getHeight()+A.gap}F.setPosition(E,D)}};this.setDimension(10,10)},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinWidth())});return A+this.stroke},getMinHeight:function(){var A=+this.stroke+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinHeight()});return A},setDimension:function(A,C){this._super(A,C);var B=this.width-this.stroke;this.children.each(function(D,E){E.figure.setDimension(B,E.figure.getHeight())})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/pert/Activity.js' */
(function ($) {draw2d.shape.pert.Activity=draw2d.shape.layout.VerticalLayout.extend({NAME:"draw2d.shape.pert.Activity",init:function(){this._super();var C=this;this.mementoValues={duration:null};this.lighterBgColor=null;this.darkerBgColor=null;this.setBackgroundColor("#f3f3f3");this.setStroke(2);this.setColor(this.darkerBgColor);this.setRadius(5);var B=new draw2d.shape.layout.HorizontalLayout();B.setStroke(0);this.earlyStartLabel=this.createLabel("Early Start").setStroke(0);this.durationLabel=new draw2d.shape.basic.Label("Duration");this.durationLabel.setStroke(1);this.durationLabel.setColor(this.darkerBgColor);this.durationLabel.setRadius(0);this.durationLabel.setBackgroundColor(null);this.durationLabel.setPadding(5);this.durationLabel.setColor(this.bgColor.darker(0.2));this.durationLabel.installEditor(new draw2d.ui.LabelEditor({onCommit:function(D){C.setDuration(parseFloat(D))}}));this.earlyEndLabel=this.createLabel("Early End").setStroke(0);B.addFigure(this.earlyStartLabel);B.addFigure(this.durationLabel);B.addFigure(this.earlyEndLabel);this.activityLabel=new draw2d.shape.basic.Label("Activity Name");this.activityLabel.setRadius(0);this.activityLabel.setPadding(10);this.activityLabel.setColor(this.darkerBgColor);this.activityLabel.setBackgroundColor(null);this.activityLabel.installEditor(new draw2d.ui.LabelInplaceEditor());this.inputPort=this.activityLabel.createPort("input");this.inputPort.getActivity=function(){return C};this.inputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.setValue=function(D){C.setDuration(C.mementoValues.duration)};this.outputPort=this.activityLabel.createPort("output");this.outputPort.getActivity=function(){return C};this.outputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.outputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};var A=new draw2d.shape.layout.HorizontalLayout();A.setStroke(0);this.lateStartLabel=this.createLabel("Late Start").setStroke(0);this.stackLabel=this.createLabel("Stack");this.lateEndLabel=this.createLabel("Late End").setStroke(0);A.addFigure(this.lateStartLabel);A.addFigure(this.stackLabel);A.addFigure(this.lateEndLabel);this.addFigure(B);this.addFigure(this.activityLabel);this.addFigure(A);this.setDuration(1)},setDuration:function(C){if(this.mementoValues.duration!==C){this.mementoValues.duration=C;this.durationLabel.setText(this.mementoValues.duration)}var D=this.getEarlyStart();this.earlyStartLabel.setText(D);this.earlyEndLabel.setText(D+this.mementoValues.duration);var B=this.outputPort.getConnections();B.each($.proxy(function(F,G){var E=G.getTarget();E.setValue()},this));if(B.getSize()===0){var A=parseFloat(this.earlyEndLabel.getText());this.setLateFinish(A)}},getEarlyEnd:function(){return this.getEarlyStart()+this.mementoValues.duration},getEarlyStart:function(){var A=0;this.inputPort.getConnections().each(function(B,D){var C=D.getSource().getActivity();A=Math.max(A,C.getEarlyEnd())});return A},setLateFinish:function(C){var A=C-this.mementoValues.duration;this.lateEndLabel.setText(C);this.lateStartLabel.setText(A);this.stackLabel.setText(A-parseFloat(this.earlyStartLabel.getText()));var B=this.inputPort.getConnections();B.each($.proxy(function(E,F){var D=F.getSource();D.getActivity().setLateFinish(A)},this))},createLabel:function(A){var B=new draw2d.shape.basic.Label(A);B.setStroke(1);B.setColor(this.darkerBgColor);B.setRadius(0);B.setBackgroundColor(null);B.setPadding(5);B.setColor(this.bgColor.darker(0.2));B.onDoubleClick=function(C){};return B},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.2).hash();this.darkerBgColor=this.bgColor.darker(0.2).hash()},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelEditor.js' */
(function ($) {draw2d.ui.LabelEditor=Class.extend({init:function(A){this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(A){var B=prompt("Label: ",A.getText());if(B){A.setText(B);this.listener.onCommit(A.getText())}else{this.listener.onCancel()}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelInplaceEditor.js' */
(function ($) {draw2d.ui.LabelInplaceEditor=draw2d.ui.LabelEditor.extend({init:function(A){this._super();this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(B){this.label=B;this.commitCallback=$.proxy(this.commit,this);$("body").bind("click",this.commitCallback);this.html=$('<input id="inplaceeditor">');this.html.val(B.getText());this.html.hide();$("body").append(this.html);this.html.autoResize({animate:false});this.html.bind("keyup",$.proxy(function(E){switch(E.which){case 13:this.commit();break;case 27:this.cancel();break}},this));this.html.bind("blur",this.commitCallback);this.html.bind("click",function(E){E.stopPropagation();E.preventDefault()});var A=this.label.getCanvas();var C=this.label.getBoundingBox();C.setPosition(A.fromCanvasToDocumentCoordinate(C.x,C.y));var D=A.getScrollArea();if(D.is($("body"))){C.translate(A.getScrollLeft(),A.getScrollTop())}C.translate(-1,-1);C.resize(2,2);this.html.css({position:"absolute",top:C.y,left:C.x,"min-width":C.w,height:C.h});this.html.fadeIn($.proxy(function(){this.html.focus()},this))},commit:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);var A=this.html.val();this.label.setText(A);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCommit(this.label.getText())},this))},cancel:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCancel()},this))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/Decorator.js' */
(function ($) {draw2d.decoration.connection.Decorator=Class.extend({NAME:"draw2d.decoration.connection.Decorator",init:function(B,A){if(typeof B==="undefined"||B<1){this.width=20}if(typeof A==="undefined"||A<1){this.height=15}this.color=new draw2d.util.Color(0,0,0);this.backgroundColor=new draw2d.util.Color(250,250,250)},paint:function(A){},setColor:function(A){this.color=new draw2d.util.Color(A);return this},setBackgroundColor:function(A){this.backgroundColor=new draw2d.util.Color(A);return this},setDimension:function(B,A){this.width=B;this.height=A;return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/ArrowDecorator.js' */
(function ($) {draw2d.decoration.connection.ArrowDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.ArrowDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M0 0","L",this.width," ",-this.height/2,"L",this.width," ",this.height/2,"L0 0"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/DiamondDecorator.js' */
(function ($) {draw2d.decoration.connection.DiamondDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.DiamondDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M",this.width/2," ",-this.height/2,"L",this.width," ",0,"L",this.width/2," ",this.height/2,"L",0," ",0,"L",this.width/2," ",-this.height/2,"Z"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/CircleDecorator.js' */
(function ($) {draw2d.decoration.connection.CircleDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.CircleDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.circle(0,0,this.width/2);A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/BarDecorator.js' */
(function ($) {draw2d.decoration.connection.BarDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.BarDecorator",init:function(B,A){this._super(B,A)},paint:function(C){var A=C.set();var B=["M",this.width/2," ",-this.height/2];B.push("L",this.width/2," ",this.height/2);A.push(C.path(B.join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Reader.js' */
(function ($) {draw2d.io.Reader=Class.extend({init:function(){},unmarshal:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Writer.js' */
(function ($) {draw2d.io.Writer=Class.extend({init:function(){},marshal:function(A){return""},formatXml:function(A){var C="";var B=/(>)(<)(\/*)/g;A=A.replace(B,"$1\r\n$2$3");var D=0;jQuery.each(A.split("\r\n"),function(F,H){var E=0;if(H.match(/.+<\/\w[^>]*>$/)){E=0}else{if(H.match(/^<\/\w/)){if(D!=0){D-=1}}else{if(H.match(/^<\w[^>]*[^\/]>.*$/)){E=1}else{E=0}}}var I="";for(var G=0;G<D;G++){I+="  "}C+=I+H+"\r\n";D+=E});return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/svg/Writer.js' */
(function ($) {draw2d.io.svg.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(B){var C=B.getCurrentSelection();B.setCurrentSelection(null);var A=B.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");A=this.formatXml(A);A=A.replace(/<desc>.*<\/desc>/g,"<desc>Create with draw2d JS graph library and RaphaelJS</desc>");B.setCurrentSelection(C);return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/png/Writer.js' */
(function ($) {draw2d.io.png.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(D){var C=D.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");C=C.replace('<svg xmlns="http://www.w3.org/2000/svg"',"<svg");var B=$('<canvas id="canvas" width="1000px" height="600px"></canvas>');$("body").append(B);canvg("canvas",C,{ignoreMouse:true,ignoreAnimation:true});var A=document.getElementById("canvas").toDataURL("image/png");B.remove();return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Writer.js' */
(function ($) {draw2d.io.json.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(C){var A=[];var E=C.getFigures();var D=0;var F=null;for(D=0;D<E.getSize();D++){F=E.get(D);A.push(F.getPersistentAttributes())}var B=C.getLines();B.each(function(H,G){A.push(G.getPersistentAttributes())});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Reader.js' */
(function ($) {draw2d.io.json.Reader=draw2d.io.Reader.extend({init:function(){this._super()},unmarshal:function(canvas,json){var node=null;$.each(json,function(i,element){var o=eval("new "+element.type+"()");var source=null;var target=null;for(i in element){var val=element[i];if(i==="source"){node=canvas.getFigure(val.node);source=node.getPort(val.port)}else{if(i==="target"){node=canvas.getFigure(val.node);target=node.getPort(val.port)}}}if(source!==null&&target!==null){o.setSource(source);o.setTarget(target)}o.setPersistentAttributes(element);canvas.addFigure(o)});canvas.calculateConnectionIntersection();canvas.getLines().each(function(i,line){line.svgPathString=null;line.repaint()});canvas.linesToRepaintAfterDragDrop=canvas.getLines().clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/Icon.js' */
(function ($) {draw2d.shape.icon.Icon=draw2d.SetFigure.extend({NAME:"draw2d.shape.icon.Icon",init:function(B,A){this._super(B,A);this.setBackgroundColor("#333333")},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.svgNodes!==null){this.svgNodes.attr({fill:this.bgColor.hash(),stroke:"none"})}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}else{this.svgNodes.transform("T"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}},createShapeElement:function(){var A=this._super();var B=this.svgNodes.getBBox();this.offsetX=B.x;this.offsetY=B.y;return A},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/ArrowLeft.js' */
(function ($) {draw2d.shape.icon.ArrowLeft=draw2d.shape.icon.Icon.extend({NAME:"draw2d.shape.icon.ArrowLeft",init:function(B,A){this._super(B,A)},createSet:function(){return this.canvas.paper.path("M24.316,5.318L6.684,15.5l17.632,10.182V5.318L24.316,5.318z")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/LineResizeHandleMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.LineResizeHandleMixin");JIRA.WorkflowDesigner.LineResizeHandleMixin={init:function(){this._actionableArea=new draw2d.shape.basic.Circle(20);this._actionableArea.draggable=true;this.setActionableAreaAttributes({})},setPosition:function(){this._actionableArea.setPosition(this.x-this._actionableArea.width/2+this.width/2,this.y-this._actionableArea.height/2+this.height/2)},show:function(A){this._actionableArea.setCanvas(A);this._actionableArea.sendToFront()},hide:function(){this._actionableArea.setCanvas(null)},repaint:function(A){A=_.extend({},A,{cursor:"crosshair",fill:"#333333",stroke:"#333333"});var B=this.getGap();this.x-=B.x;this.y-=B.y;if(this._actionableArea&&this._actionableAreaAttributes){this._actionableArea.repaint(this._actionableAreaAttributes);this._actionableArea.sendToFront()}return draw2d.shape.basic.LineResizeHandle.prototype.repaint.call(this,A)},setActionableAreaAttributes:function(A){this._actionableAreaAttributes=_.defaults({},A,{cursor:"crosshair","fill-opacity":0,"stroke-opacity":0})},hitTest:function(A,B){return this._actionableArea.hitTest(A,B)},sendActionableAreaToFront:function(){this._actionableArea.sendToFront()},onDragStart:function(){var A=this.getRelatedPort();A.triggerDragStart();_.chain(this._getDropTargets(A)).without(this.getOppositePortTo(A)).invoke("show")},onDragEnd:function(){var A=this.getRelatedPort();A.triggerDragEnd();_.invoke(this._getDropTargets(A),"hide")},_getDropTarget:function(A,C,B){return JIRA.WorkflowDesigner.StatusPort.getHitPort(A,C,this._getDropTargets(B))}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/RequestResponseMixin.js' */
(function(A){AJS.namespace("JIRA.WorkflowDesigner.RequestResponseMixin");JIRA.WorkflowDesigner.RequestResponseMixin={initialize:function(){this.requestResponse=new A.Wreqr.RequestResponse()},remove:function(){this.requestResponse.removeAllHandlers()}}}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/SelectableFigureMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SelectableFigureMixin");JIRA.WorkflowDesigner.SelectableFigureMixin={deselect:function(){if(this.isSelected()){this._canvas.selectFigure(null)}else{this._onDeselect()}},isSelected:function(){return this._canvas.getSelectedFigure()===this._getFigure()},select:function(){if(this.isSelected()){this._onSelect()}else{this._canvas.selectFigure(this._getFigure())}}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'soy/Forms.soy' */
// This file was automatically generated from Forms.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Forms == 'undefined') { JIRA.WorkflowDesigner.Templates.Forms = {}; }


JIRA.WorkflowDesigner.Templates.Forms.checkbox = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group"><div class="checkbox">');
  aui.form.input({id: opt_data.id, isChecked: opt_data.isChecked, type: 'checkbox'}, output);
  aui.form.label({content: soy.$$escapeHtml(opt_data.labelContent), forField: opt_data.id, isRequired: false}, output);
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'soy/WorkflowDesigner.soy' */
// This file was automatically generated from WorkflowDesigner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }


JIRA.WorkflowDesigner.Templates.actions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.primaryActions(opt_data, param3);
  }
  if (opt_data.fullScreenButton || ! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.secondaryActions(opt_data, param3);
  }
  aui.toolbar2.toolbar2({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasStatuses__soy18 = opt_data.statusOptions.length > 0;
  var param20 = new soy.StringBuilder();
  var param21 = new soy.StringBuilder();
  aui.form.select({extraAttributes: {'data-container-class': 'full-width-field'}, extraClasses: 'full-width-field', id: 'status-name', options: opt_data.statusOptions}, param21);
  aui.form.fieldDescription({message: "Search for an existing status or name a new one."}, param21);
  aui.form.fieldGroup({content: param21.toString()}, param20);
  JIRA.WorkflowDesigner.Templates.Forms.checkbox({id: 'create-global-transition-add', isChecked: opt_data.createGlobalTransition, labelContent: soy.$$escapeHtml("Allow all statuses to transition to this one")}, param20);
  var param35 = new soy.StringBuilder();
  aui.form.submit({isDisabled: ! hasStatuses__soy18, name: 'submit', text: "Add"}, param35);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param35);
  aui.form.buttons({content: param35.toString()}, param20);
  aui.form.form({action: '', content: param20.toString(), isTopLabels: true}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.browserNotSupportedMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml("This feature is not available in Internet Explorer prior to version 9."));
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.browserNotSupportedWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param50 = new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.browserNotSupportedMessage(null, param50);
  aui.message.warning({content: '', titleContent: param50.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param56 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial status cannot be deleted.",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param56);
  param56.append('</div></div>');
  aui.form.form({action: '', content: param56.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param71 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("The status \x27\x27{0}\x27\x27 cannot be removed.",opt_data.name)), '</h2><div class="form-body"><p>', soy.$$escapeHtml("Statuses cannot be removed from draft workflows."), '</p><p><a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Configuring+Workflow#ConfiguringWorkflow-Limitationswheneditinganactiveworkflow">', soy.$$escapeHtml("More information."), '</a></p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param71);
  param71.append('</div></div>');
  aui.form.form({action: '', content: param71.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param88 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Remove Status"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to remove the status \x27\x27{0}\x27\x27 and delete the related transitions?",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', name: 'submit', text: "Remove"}, param88);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param88);
  param88.append('</div></div>');
  aui.form.form({action: '', content: param88.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.container = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="container"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.createStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.statusDialog(soy.$$augmentData(opt_data, {submitText: "Create", title: "Create New Status"}), output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.editStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var beforeContent__soy111 = new soy.StringBuilder();
  if (opt_data.numberOfWorkflows > 1) {
    aui.message.warning({content: "This status is used in other workflows, editing it will affect them."}, beforeContent__soy111);
  }
  beforeContent__soy111 = beforeContent__soy111.toString();
  JIRA.WorkflowDesigner.Templates.statusDialog(soy.$$augmentData(opt_data, {beforeContent: beforeContent__soy111, submitText: "Save", title: "Edit Status"}), output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.fullScreenButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button({extraClasses: 'enter-full-screen full-screen-trigger', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Enter full screen"}}, output);
  aui.buttons.button({extraClasses: 'exit-full-screen full-screen-trigger hidden', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Exit full screen"}}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<strong>', soy.$$escapeHtml(opt_data.name), '</strong><p>', soy.$$escapeHtml(AJS.format("All statuses can transition to \x27\x27{0}\x27\x27.",opt_data.statusName)), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.lastEditedMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.updatedDate && opt_data.updateAuthor) {
    var authorName__soy142 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.updateAuthor.displayName));
    authorName__soy142 = authorName__soy142.toString();
    var timeElement__soy145 = new soy.StringBuilder('<time datetime="', soy.$$escapeHtml(opt_data.updatedDate), '"></time>');
    timeElement__soy145 = timeElement__soy145.toString();
    var wasCurrentUser__soy149 = opt_data.currentUserName == opt_data.updateAuthor.userName;
    output.append('<span class="last-edited-message">', (wasCurrentUser__soy149) ? AJS.format("Last edited by you, {0}",timeElement__soy145) : AJS.format("Last edited by {0}, {1}",authorName__soy142,timeElement__soy145), '</span>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.primaryActions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param160 = new soy.StringBuilder();
  aui.buttons.button({extraClasses: 'add-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add status", iconType: 'aui', text: "Add status"}, param160);
  aui.buttons.button({extraClasses: 'add-transition', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add transition", iconType: 'aui', text: "Add transition"}, param160);
  aui.form.checkboxField({extraClasses: 'show-transition-labels', fields: [{'id': 'show-transition-labels', 'isChecked': opt_data.showTransitionLabels, 'labelText': "Show transition labels"}], legendContent: ''}, param160);
  aui.toolbar2.item({content: param160.toString(), item: 'primary'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.progressIndicatorBlanket = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="blanket"></div><div class="spinner"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.secondaryActions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param182 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.lastEditedMessage(opt_data, param182);
  }
  if (opt_data.fullScreenButton) {
    JIRA.WorkflowDesigner.Templates.fullScreenButtons(null, param182);
  }
  aui.toolbar2.item({content: param182.toString(), item: 'secondary'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.statusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param197 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body">', (opt_data.beforeContent) ? opt_data.beforeContent : '');
  aui.form.textField({id: 'status-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param197);
  aui.form.textareaField({id: 'status-description', labelContent: "Description", name: 'description', rows: 4, value: opt_data.description}, param197);
  if (opt_data.showStatusCategoryField) {
    JIRA.WorkflowDesigner.Templates.statusCategorySelectField({id: 'status-category-id', statusCategoryOptions: opt_data.statusCategoryOptions}, param197);
  }
  param197.append('</div><div class="buttons-container form-footer">', (! opt_data.statusId) ? '<div class="checkbox buttons-container-left"><input ' + ((opt_data.createGlobalTransition) ? 'checked="checked"' : '') + ' class="checkbox" id="create-global-transition-create" type="checkbox"><label for="create-global-transition-create">' + soy.$$escapeHtml("Allow all statuses to transition to this one") + '</label></div>' : '', '<div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', name: 'submit', text: opt_data.submitText}, param197);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param197);
  param197.append('</div></div>');
  aui.form.form({action: '', content: param197.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.zoomControl = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button ', (opt_data.zoomInDisabled) ? 'aria-disabled="true"' : '', ' class="aui-button zoom-in" title="', soy.$$escapeHtml("Zoom in"), '" type="button">+</button><button ', (opt_data.zoomOutDisabled) ? 'aria-disabled="true"' : '', ' class="aui-button zoom-out" title="', soy.$$escapeHtml("Zoom out"), '" type="button">&ndash;</button>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/lib/cocktail-0.3.0.js' */
(function(){var A;if(typeof exports!=="undefined"){A=exports}else{A=this.Cocktail={}}A.mixins={};A.mixin=function C(F){var G=_.chain(arguments).toArray().rest().flatten().value();var H={};_(G).each(function(I){if(_.isString(I)){I=A.mixins[I]}_(I).each(function(K,J){if(_.isFunction(K)){if(F.prototype[J]){H[J]=H[J]||[F.prototype[J]];H[J].push(K)}F.prototype[J]=K}else{if(_.isObject(K)){F.prototype[J]=_.extend({},K,F.prototype[J]||{})}}})});_(H).each(function(I,J){F.prototype[J]=function(){var M=this,K=arguments,L=undefined;_(I).each(function(N){var O=_.isFunction(N)?N.apply(M,K):N;L=(O===undefined?L:O)});return L}})};var D;A.patch=function E(G){D=G.Model.extend;var F=function(J,K){var H=D.call(this,J,K);var I=H.prototype.mixins;if(I&&H.prototype.hasOwnProperty("mixins")){A.mixin(H,I)}return H};_([G.Model,G.Collection,G.Router,G.View]).each(function(H){H.mixin=function I(){A.mixin(this,_.toArray(arguments))};H.extend=F})};A.unpatch=function B(F){_([F.Model,F.Collection,F.Router,F.View]).each(function(G){G.mixin=undefined;G.extend=D})}})();
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/WorkflowDesignerBackboneDefine.js' */
(function(Backbone){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/Application.js' */
(function(B){function A(C){var D=JIRA.WorkflowDesigner.Templates.browserNotSupportedWarning;jQuery(D()).appendTo(C)}AJS.namespace("JIRA.WorkflowDesigner.Application");JIRA.WorkflowDesigner.Application=function(C){C=_.defaults({},C,{draft:false,immutable:false});if(!JIRA.WorkflowDesigner.browserIsSupported()){A(C.element);return }this._workflowModel=new JIRA.WorkflowDesigner.WorkflowModel({currentStepId:C.currentStepId,draft:C.draft,name:C.workflowId});this._canvas=this._createCanvas(C).render();if(!C.immutable){this._layoutAutoSaver=new JIRA.WorkflowDesigner.IO.LayoutAutoSaver({workflowModel:this._workflowModel})}this._initialiseWorkflow(C)};_.extend(JIRA.WorkflowDesigner.Application.prototype,B.Events,{_createCanvas:function(C){C=_.extend(C,{el:C.element,workflowModel:this._workflowModel});return new JIRA.WorkflowDesigner.Canvas(C)},destroy:function(){this._canvas&&this._canvas.remove();this._layoutAutoSaver&&this._layoutAutoSaver.destroy()},discardDraft:function(C){C=_.defaults({},C,{reloadDesigner:true});this._canvas.showProgressIndicator();return JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.discard(this._workflowModel.get("name")).pipe(_.bind(this._onPublishOrDiscardSuccessHandler,this,C.reloadDesigner),_.bind(this._onPublishOrDiscardFailHandler,this))},publishDraft:function(C){C=_.defaults({},C,{reloadDesigner:true});this._canvas.showProgressIndicator();return JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.publish(this._workflowModel).pipe(_.bind(this._onPublishOrDiscardSuccessHandler,this,C.reloadDesigner),_.bind(this._onPublishOrDiscardFailHandler,this))},_initialiseWorkflow:function(D){var C=this,E=this._loadWorkflow(D);E.done(function(){C._workflowModel.set("loadedAt",new Date());C._canvas.autoFit();C.trigger("loaded")})},_loadWorkflow:function(E){var D=jQuery.Deferred(),C=this,F;if(E.layoutData){F=jQuery.Deferred().resolve(E.layoutData)}else{if(E.workflowId){F=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(E.workflowId,!!E.draft)}}if(F){this._canvas.showProgressIndicator();F.always(function(){C._canvas.hideProgressIndicator()});F.done(function(G){C._workflowModel.reset(G);D.resolve()});F.fail(function(G){JIRA.WorkflowDesigner.Messages.showErrorMessage(G);D.reject(G)})}else{D.resolve()}return D.promise()},_onPublishOrDiscardSuccessHandler:function(C){this._layoutAutoSaver.removeUnsavedChangesMessage();if(C){return this._loadWorkflow({workflowId:this._workflowModel.get("name"),draft:this._workflowModel.get("draft")})}},_onPublishOrDiscardFailHandler:function(C){JIRA.WorkflowDesigner.Messages.showErrorMessage(C);this._canvas.hideProgressIndicator()}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/Canvas.js' */
(function(A){A.define("JIRA.WorkflowDesigner.Canvas",A.Marionette.ItemView.extend({template:JIRA.WorkflowDesigner.Templates.container,ui:{container:".container"},initialize:function(B){B=_.defaults(B,{actions:true,fullScreenButton:true,immutable:false});this._browserZoomChecker=new JIRA.WorkflowDesigner.BrowserZoomChecker();this._canvasModel=new JIRA.WorkflowDesigner.CanvasModel({},{workflowModel:B.workflowModel});this._canvasView=new JIRA.WorkflowDesigner.CanvasView({canvasModel:this._canvasModel,immutable:B.immutable,workflowModel:B.workflowModel});B.actions&&(this._actionsView=this._createActionsView(B));B.immutable||(this._propertiesPanelView=this._createPropertiesPanelView(B));this._zoomControlView=this._createZoomControlView()},autoFit:function(){this._canvasView.autoFit()},_createActionsView:function(C){var B;B=new JIRA.WorkflowDesigner.ActionsView({canvasModel:this._canvasModel,fullScreenButton:C.fullScreenButton,immutable:C.immutable,workflowModel:C.workflowModel});this.listenTo(B,{"addStatus:done":this.hideProgressIndicator,"addStatus:submit":this.showProgressIndicator,"fullScreen:enter":this._enterFullScreen,"fullScreen:exit":this._exitFullScreen});return B},_createPropertiesPanelView:function(B){var C;C=new JIRA.WorkflowDesigner.PropertiesPanel.PropertiesPanelView({canvasModel:this._canvasModel,workflowModel:B.workflowModel});this.listenTo(C,{"transaction:end":this.hideProgressIndicator,"transaction:start":this.showProgressIndicator});return C},_createZoomControlView:function(){var B,C;B={maximumZoomLevel:2,minimumZoomLevel:0.5,model:this._canvasModel};C=new JIRA.WorkflowDesigner.ZoomControlView(B);this.listenTo(C,{zoomIn:_.bind(this._canvasView.zoom,this._canvasView,0.75),zoomOut:_.bind(this._canvasView.zoom,this._canvasView,1.25)});return C},_enterFullScreen:function(){var B=this._canvasView;B.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.enterFullScreen(this.el).done(function(){B.setResizeInterval(JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL)})},_exitFullScreen:function(){var C=this._canvasView,B=this;C.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.exitFullScreen(this.el).done(function(){C.setResizeInterval(JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL);B.$el.css("width","auto")})},hideProgressIndicator:function(){this._canvasView.setLocked(false);this._progressIndicator.hide()},onRender:function(){this.$el.addClass("workflow-designer");this._actionsView&&this.$el.prepend(this._actionsView.render().el);this._canvasView.render(this.ui.container);this._propertiesPanelView&&this.ui.container.append(this._propertiesPanelView.render().el);this.ui.container.append(this._zoomControlView.render().el)},remove:function(){A.Marionette.ItemView.prototype.remove.apply(this,arguments);this._browserZoomChecker.destroy();this._canvasView.remove()},showProgressIndicator:function(){var B={container:this.el},C=JIRA.WorkflowDesigner.ProgressIndicatorBlanketView;this._canvasView.setLocked(true);this._progressIndicator||(this._progressIndicator=new C(B));this._progressIndicator.show()}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/CanvasModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.CanvasModel",A.Model.extend({defaults:{selectedModel:null,selectedView:null,showTransitionLabels:false,zoomLevel:null},initialize:function(B,C){this._workflowModel=C.workflowModel;this.listenTo(this,"change:showTransitionLabels",this._onShowTransitionLabelsChange);this.listenTo(this._workflowModel,{"new:status":this._selectModel,"new:transition":this._selectModel,"reset:before":this._deselect});this.listenTo(this._workflowModel.get("transitions"),"destroy",this._onDestroy)},_deselect:function(){this.set({selectedModel:null,selectedView:null})},_onDestroy:function(C){var B=this.get("selectedModel")===C;B&&this._deselect()},_onShowTransitionLabelsChange:function(B,C){JIRA.WorkflowDesigner.Analytics.triggerToggleLabels(C)},_selectModel:function(B){this.get("selectedModel")||this.set("selectedModel",B)},selectView:function(B){this.set({selectedModel:B&&B.model,selectedView:B})}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/collections/StatusCollection.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusCollection",A.Collection.extend({model:function(B,C){return new JIRA.WorkflowDesigner.StatusModel(B,C)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/collections/TransitionCollection.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionCollection",A.Collection.extend({model:function(B,C){return new JIRA.WorkflowDesigner.TransitionModel(B,C)},getInitial:function(){return this.find(function(B){return B.isInitial()})}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ajax/AJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.AJAXManager");JIRA.WorkflowDesigner.IO.AJAX.AJAXManager={_makeRequest:function(B){var A=jQuery.Deferred(),C;B.headers=_.extend({},B.headers,{"X-Atlassian-Token":"nocheck"});C=JIRA.SmartAjax.makeWebSudoRequest(B,{cancel:function(D){_.defer(A.reject,undefined,"abort");D.preventDefault()}});C.done(A.resolve);C.fail(A.reject);return A.promise()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ajax/WorkflowAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{discard:function(C){var B=jQuery.Deferred(),A=this;this._publishOrDiscardRequest=this._makeRequest({contentType:"application/json",data:C,success:B.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/discardDraft"});this._publishOrDiscardRequest.fail(function(E,D){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});this._publishOrDiscardRequest.always(function(){delete A._publishOrDiscardRequest});return B.promise()},load:function(C,A){var B=jQuery.Deferred(),D;D=this._makeRequest({data:{name:C,draft:!!A},dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});D.done(function(E){var G,F=E.layout;G=JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(F);G=_.extend(G,{liveStepIds:E.liveStepIds});B.resolve(G,E)});D.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});return B.promise()},publish:function(C){var B=jQuery.Deferred(),A=this,D=JIRA.WorkflowDesigner.IO.WorkflowDataWriter.write(C);this._publishOrDiscardRequest=this._makeRequest({contentType:"application/json",data:JSON.stringify(D),success:B.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/publishDraft"});this._publishOrDiscardRequest.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});this._publishOrDiscardRequest.always(function(){delete A._publishOrDiscardRequest});return B.promise()},save:function(C){var A=jQuery.Deferred(),B,D=JIRA.WorkflowDesigner.IO.WorkflowDataWriter.write(C);if(!this._publishOrDiscardRequest){B=this._makeRequest({contentType:"application/json",data:JSON.stringify(D),success:A.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});B.fail(function(F,E){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))})}return A.promise()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ErrorHandler.js' */
(function(){var A;function B(D,C){return !!/websudo/i.exec(D)&&C===401}AJS.namespace("JIRA.WorkflowDesigner.IO.ErrorHandler");A={generic:"The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation.",notAuthenticated:"You are not authorised to perform this operation. Please log in.",timeout:"The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation.",webSudo:"Your temporary administrative access has timed out. Please refresh the page and try again."};JIRA.WorkflowDesigner.IO.ErrorHandler={getErrorMessage:function(D,C,H){var F=D&&D.responseText,E=D&&D.status;H=_.defaults({},H,A);if(C==="timeout"){return H.timeout}if(B(F,E)){return H.webSudo}if(E===401){return H.notAuthenticated}if(_.contains([400,403,404],E)){try{return JSON.parse(F).errorMessages[0]||F}catch(G){return F}}if(C!=="abort"){return H.generic}return null},handle:function(D,C){var E;E=this.getErrorMessage(D,C);E&&JIRA.WorkflowDesigner.Messages.showErrorMessage(E)}};_.bindAll(JIRA.WorkflowDesigner.IO.ErrorHandler,"getErrorMessage","handle")}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/WorkflowDataReader.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.WorkflowDataReader");JIRA.WorkflowDesigner.IO.WorkflowDataReader={read:function(D){var B={},C=[];if(!D||!D.statuses||!D.transitions){return }_.each(D.statuses,function(F){var E=new JIRA.WorkflowDesigner.StatusModel(F);B[E.id]=E});_.each(D.transitions,function(E){C.push(A(E,B))});return{statuses:_.values(B),transitions:C,updateAuthor:D.updateAuthor,updatedDate:new Date(D.updatedDate)}}};function A(B,C){B=_.chain(B).omit("sourceId","targetId").extend({source:C[B.sourceId],target:C[B.targetId]}).value();return new JIRA.WorkflowDesigner.TransitionModel(B)}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/connection/GappedConnection.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.GappedConnection");JIRA.WorkflowDesigner.Layout.Connection.GappedConnection=draw2d.Connection.extend({init:function(A,B){this._super();this._sourceGap=A;this._targetGap=B},_getTransformation:function(C,D){var B=0,A=0;switch(C){case JIRA.WorkflowDesigner.Direction.UP:A=-D;break;case JIRA.WorkflowDesigner.Direction.RIGHT:B=D;break;case JIRA.WorkflowDesigner.Direction.DOWN:A=D;break;case JIRA.WorkflowDesigner.Direction.LEFT:B=-D;break}return{x:B,y:A}},getEndPointGapTransformation:function(){return this._getTransformation(this.getTarget().getConnectionDirection(),this._targetGap)},getStartPointGapTransformation:function(){return this._getTransformation(this.getSource().getConnectionDirection(),this._sourceGap)},setEndPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getEndPointGapTransformation();this._super(A+B.x,C+B.y)}},setStartPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getStartPointGapTransformation();this._super(A+B.x,C+B.y)}},getEndPoint:function(){var B,A=this._super();if(this.isMoving){return A}B=this.getEndPointGapTransformation();return A.clone().translate(B.x,B.y)},getStartPoint:function(){var B=this.getStartPointGapTransformation(),A=this._super();if(this.isMoving){return A}return A.clone().translate(B.x,B.y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/connection/RoundedManhattanConnectionRouter.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter");JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({CORNER_RADIUS:5,init:function(){this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Vector2D},_calculateConnectionPoints:function(B){this._route(B,B.getEndPoint(),B.getTarget().getConnectionDirection(),B.getStartPoint(),B.getSource().getConnectionDirection());return B.getPoints().asArray()},_getPointInstructions:function(C,D,F){var E=new A(C,F[D+1]||C),G=new A(C,F[D-1]||C),B;B=Math.min(E.getLength()/2,G.getLength()/2,this.CORNER_RADIUS);return["L",C.add(G.normalize().multiply(B)).getComponents(),"S",C.getComponents(),C.add(E.normalize().multiply(B)).getComponents()]},route:function(D){var C=this,E;function B(G,F,H,I){return G.concat(C._getPointInstructions(F,H,I))}E=this._calculateConnectionPoints(D);D.svgPathString=_.reduce(E,B,["M",E[0].x,E[0].y]).join(" ")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/ManhattanPercentageLocator.js' */
(function(){function B(C){return new JIRA.WorkflowDesigner.Vector2D(C.start,C.end).getLength()}function A(C){var D=C.getSegments().asArray();return _.reduce(D,function(E,F){return E+B(F)},0)}AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator");JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator=draw2d.layout.locator.ConnectionLocator.extend({init:function(D,C){this._percentage=C;this._super(D)},relocate:function(D,F){var C=this.getParent(),H=A(C)*this._percentage,E,G;E=_.find(C.getSegments().asArray(),function(J){var I=B(J);if(I>=H){return true}H-=I});if(E){G=new JIRA.WorkflowDesigner.Vector2D(E.start,E.end);G.normalize().multiply(H).translate(F.getWidth()/-2,F.getHeight()/-2);F.setPosition(E.start.getTranslated(G))}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/PositionOnParentBoundsLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator");JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator=draw2d.layout.locator.Locator.extend({init:function(A){this._super(A.parent);this.side=A.side;this.bias=A.bias},relocate:function(B,D){var F=this.getParent().getBoundingBox(),C=JIRA.WorkflowDesigner.Direction,A,E;if(this.side===C.UP||this.side===C.DOWN){A=F.getWidth()*this.bias;E=(this.side===C.UP)?0:F.getHeight()}else{if(this.side===C.LEFT||this.side===C.RIGHT){E=F.getHeight()*this.bias;A=(this.side===C.LEFT)?0:F.getWidth()}}D.setPosition(A,E)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/StaticLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.StaticLocator");JIRA.WorkflowDesigner.Layout.Locator.StaticLocator=draw2d.layout.locator.Locator.extend({init:function(B,A,C){this._super(B);this._x=A;this._y=C},relocate:function(A,B){B.setPosition(this._x,this._y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/StatusModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusModel",A.Model.extend({defaults:{description:"",id:null,initial:false,name:"",statusCategory:null,statusId:null,stepId:null,x:null,y:null},hasCoordinates:function(){var B=this.get("x"),C=this.get("y");return _.isNumber(B)&&_.isNumber(C)},hasTransition:function(B){return(B.get("source")===this||B.get("target")===this)},isInitial:function(){return this.get("initial")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/TransitionModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionModel",A.Model.extend({defaults:{id:null,actionId:null,conditionsCount:null,description:null,globalTransition:false,name:null,postFunctionsCount:null,propertiesCount:null,screenId:null,screenName:null,source:null,sourceAngle:null,target:null,targetAngle:null,validatorsCount:null},initialize:function(){this._createId();this.on("change:actionId change:source change:target",_.bind(this._createId,this))},_createId:function(){var E=this.getActionId(),C,B=this.get("source"),D=this.get("target");if(E&&B&&D){C=B.isInitial()?"IA":"A";this.set("id",C+"<"+E+":"+B.get("id")+":"+D.get("id")+">")}},isGlobalTransition:function(){return this.get("globalTransition")},isInitial:function(){return this.get("source").isInitial()},getActionId:function(){return this.get("actionId")},getSourceStepId:function(){var B=this.get("source");return B&&B.get("stepId")},getTargetStepId:function(){var B=this.get("target");return B&&B.get("stepId")},setSource:function(C,B){this.set({source:C,sourceAngle:B})},setTarget:function(C,B){this.set({target:C,targetAngle:B})},sync:jQuery.noop}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/WorkflowModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.WorkflowModel",A.Model.extend({defaults:function(){return{currentStepId:null,draft:false,name:null,liveStepIds:null,loadedAt:null,statuses:new JIRA.WorkflowDesigner.StatusCollection(),transitions:new JIRA.WorkflowDesigner.TransitionCollection(),updatedDate:null,updateAuthor:null}},initialize:function(){var B=_.bind(this.trigger,this,"layoutChanged");this.listenTo(this.get("statuses"),{"change:x change:y":B,reset:this._detectNewStatus});this.listenTo(this.get("transitions"),{"change:actionId change:sourceAngle change:target change:targetAngle remove":B,reset:this._detectNewTransition})},addStatus:function(B){var C=B instanceof JIRA.WorkflowDesigner.StatusModel;C||(B=new JIRA.WorkflowDesigner.StatusModel(B));this.get("statuses").add(B);return B},addTransition:function(C){var B=C instanceof JIRA.WorkflowDesigner.TransitionModel;B||(C=new JIRA.WorkflowDesigner.TransitionModel(C));this.get("transitions").add(C);return C},_detectNewStatus:function(D,C){var B=this._getNewModel(D,C.previousModels);B&&this.trigger("new:status",B)},_detectNewTransition:function(D,B){var C=this._getNewModel(D,B.previousModels);C&&this.trigger("new:transition",C)},getGlobalTransitionForStatus:function(B){return this.get("transitions").findWhere({globalTransition:true,target:B})},_getNewModel:function(B,D){var C=D.length===0;B=B.filter(function(E){return _.every(D,function(F){return E.id!==F.id})});if(B.length===1&&!C){return B[0]}},getStatus:function(B){return this.get("statuses").get(B)},removeTransition:function(B){this.get("transitions").remove(B)},reset:function(B){this.trigger("reset:before");this.get("statuses").reset(B.statuses);this.get("transitions").reset(B.transitions);this.set(_.omit(B,"statuses","transitions"));this.trigger("reset:after")},statusHasGlobalTransition:function(B){return !!this.getGlobalTransitionForStatus(B)},statusIsDeletable:function(C){var D=this.get("draft"),B=_.contains(this.get("liveStepIds"),C.get("stepId"));return !(D&&B)},updateTransitionSource:function(B){var C=this.get("statuses").findWhere({initial:false,stepId:B.sourceStepId});B.transition.setSource(C,B.sourceAngle)},updateTransitionTargets:function(C){var D=C.transition.get("actionId"),B;B=this.get("statuses").findWhere({initial:false,stepId:C.targetStepId});C.transition.setTarget(B,C.targetAngle);this.get("transitions").chain().filter(function(E){return E!==C.transition&&E.get("actionId")===D}).invoke("setTarget",B)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/PanningSingleSelectionPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy");JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({init:function(A){this._super();this._getCanvasBoundingBox=A},onMouseDown:function(B,A,C){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this._super(B,A,C);this._initialViewBox=B.getViewBox();this._boundingBox=this._getCanvasBoundingBox()},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDownElement===null&&this.mouseDraggingElement===null){D.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getPanViewBox({diagramBoundingBox:this._boundingBox,displacement:new JIRA.WorkflowDesigner.Vector2D(-C,-B),viewBox:this._initialViewBox}))}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/GuideLineEditPolicy.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({GUIDE_LINE_COLOUR:"#ff0000",init:function(){this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_collectFigures:function(){var B=this;if(this.figures){return }this.figures=[];this.canvas.getFigures().each(function(D,C){if(C.snapToGeometry){if(C.isInDragDrop){B.dragFigure=C}else{B.figures.push(C)}}})},_collectSnapPoints:function(){if(this.SnapPoints){return }this.SnapPoints={x:A.getXSnapPoints(this.figures),y:A.getYSnapPoints(this.figures)}},_drawGuideLine:function(C,E,B,D){var F=["M",C,E,"L",B,D].join(" ");this.guideLines||(this.guideLines=[]);this.guideLines.push(this.canvas.paper.path(F).attr({stroke:this.GUIDE_LINE_COLOUR}))},_drawGuideLines:function(B,C,D){var E=_.cartesianProduct(C,D);_.each(E,function(F){if(this._equalSnapPoints(F[0],F[1])){B.apply(this,F)}},this)},_drawHorizontalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getRight(),G.rectangle.getRight()),D=Math.min(E.rectangle.getLeft(),G.rectangle.getLeft());this._drawGuideLine(D,E.value,F,E.value)}C=A.getYSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.y)},_drawVerticalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getBottom(),G.rectangle.getBottom()),D=Math.min(E.rectangle.getTop(),G.rectangle.getTop());this._drawGuideLine(E.value,D,E.value,F)}C=A.getXSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.x)},_equalSnapPoints:function(C,B){return Math.abs(C.value-B.value)<=0.1},onInstall:function(B){this.canvas=B},onMouseDrag:function(){this._collectFigures();this._removeGuideLines();if(!this.dragFigure||this.figures.length===0){return }this._collectSnapPoints();this._drawHorizontalGuideLines();this._drawVerticalGuideLines()},onMouseUp:function(){delete this.dragFigure;delete this.figures;delete this.SnapPoints;this._removeGuideLines()},onUninstall:function(){delete this.canvas},_removeGuideLines:function(){_.invoke(this.guideLines,"remove");this.guideLines=[]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/SnapEditPolicy.js' */
(function(){var B;var A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({SNAP_THRESHOLD:3,init:function(){this._super.apply(this,arguments);B=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper;A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_createSnappers:function(C){var D;if(this.snappers){return }D=this._getFigures(C);this.snappers={x:new B(this._getXSnapPoints(D)),y:new B(this._getYSnapPoints(D))}},_getFigures:function(C){return _.filter(C.getFigures().asArray(),function(D){return !D.isInDragDrop&&D.snapToGeometry})},_getXSnapPoints:function(C){return _.pluck(A.getXSnapPoints(C),"value")},_getYSnapPoints:function(C){return _.pluck(A.getYSnapPoints(C),"value")},onMouseUp:function(){delete this.snappers},snap:function(E,D,C){if(!D.snapToGeometry){return C}this._createSnappers(E);return this._snapFigure(D).getTopLeft()},_snapFigure:function(C){return C.getBoundingBox().translate(this._snapPoints(this._getXSnapPoints(C),this.snappers.x),this._snapPoints(this._getYSnapPoints(C),this.snappers.y))},_snapPoints:function(E,D){var C=_.chain(E).map(D.snap).min(Math.abs).value();return Math.abs(C)<=this.SNAP_THRESHOLD?C:0}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/Snapper.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper=function(A){_.bindAll(this,"snap");this.points=A};JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper.prototype={snap:function(B){function A(C){return C-B}if(this.points.length===0){return 0}return _.chain(this.points).map(A).min(Math.abs).value()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/SnapPoints.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints={getXSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getLeft(),D.getCenter().getX(),D.getRight()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},getYSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getTop(),D.getBottom()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},_makeSnapPoint:function(A){return function(B){return{rectangle:A.getBoundingBox(),value:B}}}};_.bindAll(JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints,"getXSnapPoints","getYSnapPoints")}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/port/StatusPortsFeedbackPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy");JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy=draw2d.policy.port.IntrusivePortsFeedbackPolicy.extend({prepareDropTargetsForDrag:function(A){_.invoke(A.asArray(),"show")},alterDropTargetOnDrag:jQuery.noop,alterDropTargetOnDragEnd:jQuery.noop,getConnectionLineColour:function(){return"#1a8cff"},onHoverEnter:function(B,C,A){A.setGlow(true)},onHoverLeave:function(B,C,A){A.setGlow(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Analytics.js' */
(function(){var A,D;function E(F,G){if(AJS.EventQueue){AJS.EventQueue.push({name:"administration.workflow."+F,properties:G})}}function C(F,G){jQuery(document).on("click",F,function(){E(G)})}C(".enter-full-screen","fullscreen");C(".transition-properties","view.transition.properties");C(".transition-conditions","view.transition.conditions");C(".transition-validators","view.transition.validators");C(".transition-postfunctions","view.transition.postfunctions");C(".status-properties","view.status.properties");function B(G,F){E("edit",{mode:"new-diagram",action:G,object:F})}AJS.namespace("JIRA.WorkflowDesigner.Analytics");JIRA.WorkflowDesigner.Analytics={_reset:function(){A=false;D=false},triggerToggleLabels:function(F){E("toggle.labels."+(F?"on":"off"))},triggerAddStatus:function(){B("add","status")},triggerUpdateStatus:function(){B("update","status")},triggerAddStep:function(){B("add","step")},triggerFirstAddStatus:function(H){var G="jira.workflowdesigner.added.first.status",F=jQuery.Deferred(),I=JIRA.WorkflowDesigner.IO.AJAX.UserPropertiesAJAXManager;A||(F=I.getProperty(G));F.done(function(K){var J=!K.value;if(J){E("first.add.status",{duration:H});I.setProperty(G,true)}A=true})},triggerUpdateStep:function(){B("update","step")},triggerRemoveStep:function(){B("remove","step")},triggerAddCommonTransition:function(){B("add","commontransition")},triggerAddTransition:function(){B("add","transition")},triggerFirstAddTransition:function(H){var G="jira.workflowdesigner.added.first.transition",F=jQuery.Deferred(),I=JIRA.WorkflowDesigner.IO.AJAX.UserPropertiesAJAXManager;D||(F=I.getProperty(G));F.done(function(K){var J=!K.value;if(J){E("first.add.transition",{duration:H});I.setProperty(G,true)}D=true})},triggerUpdateTransition:function(){B("update","transition")},triggerRemoveTransition:function(){B("remove","transition")},triggerAddGlobalTransition:function(){B("add","globaltransition")},triggerUpdateGlobalTransition:function(){B("update","globaltransition")},triggerRemoveGlobalTransition:function(){B("remove","globaltransition")}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/BrowserUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserUtilities");JIRA.WorkflowDesigner.BrowserUtilities={escapeQueryParameter:function(A){return encodeURIComponent(A).replace(/[!'()]/g,escape).replace(/\*/g,"%2A").replace(/%20/g,"+")},makeQueryString:function(B){function A(D){var C=JIRA.WorkflowDesigner.BrowserUtilities.escapeQueryParameter;return _.map(D,C).join("=")}return _.map(_.pairs(B),A).join("&")},getZoomLevel:function(){var A;if(jQuery.browser.mozilla){return null}else{if(jQuery.browser.msie){A=screen.deviceXDPI/screen.logicalXDPI}else{if(jQuery.browser.webkit){A=window.outerWidth/window.innerWidth}}}return Math.round(A*10)/10},isMac:function(){return navigator.platform.toUpperCase().indexOf("MAC")!==-1}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/BrowserZoomChecker.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserZoomChecker");JIRA.WorkflowDesigner.BrowserZoomChecker=function(){_.bindAll(this,"_startWindowResizeSession","_endWindowResizeSession");jQuery(window).on("resize",this._startWindowResizeSession);this._debouncedEndWindowResizeSession=_.debounce(this._endWindowResizeSession,250);this._intervalId=setInterval(_.bind(this._check,this),1000)};_.extend(JIRA.WorkflowDesigner.BrowserZoomChecker.prototype,{_isMac:JIRA.WorkflowDesigner.BrowserUtilities.isMac(),_check:function(){var A=this._isMac?"The workflow designer may not behave correctly at your current browser zoom level, press \u2318 + 0 to reset it.":"The workflow designer may not behave correctly at your current browser zoom level, press Ctrl + 0 to reset it.",B;if(this._windowIsResizing){return }B=JIRA.WorkflowDesigner.BrowserUtilities.getZoomLevel();if(!B){return }if(B!==1){this._browserZoomMessage=JIRA.WorkflowDesigner.Messages.showErrorMessage(A)}else{if(this._browserZoomMessage){this._browserZoomMessage.remove()}}},destroy:function(){clearInterval(this._intervalId);jQuery(window).off("resize",this._startWindowResizeSession);this._browserZoomMessage&&this._browserZoomMessage.remove()},_endWindowResizeSession:function(){this._windowIsResizing=false},_startWindowResizeSession:function(){this._windowIsResizing=true;this._debouncedEndWindowResizeSession()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Collection.js' */
(function(B){var A=["chain","filter","find","invoke","without"];AJS.namespace("JIRA.WorkflowDesigner.Collection");JIRA.WorkflowDesigner.Collection=function(C){this.length=0;this._objects=[];this.reset(C||[])};_.extend(JIRA.WorkflowDesigner.Collection.prototype,B.Events,{add:function(C){C=[].concat(C);_.each(C,function(D){D.on("all",this.trigger,this)},this);this._objects=this._objects.concat(C);this.length=this._objects.length;return this},at:function(C){return this._objects[C]},remove:function(C){C=_.isArray(C)?C:[C];_.each(C,function(D){D.off("all",this.trigger,this)},this);this._objects=_.difference(this._objects,C);this.length=this._objects.length;return this},reset:function(C){this.remove(this._objects);return this.add(C)}});_.each(A,function(C){JIRA.WorkflowDesigner.Collection.prototype[C]=function(){return _[C].apply(_,[this._objects].concat(_.toArray(arguments)))}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Direction.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Direction");JIRA.WorkflowDesigner.Direction={DOWN:2,LEFT:3,RIGHT:1,UP:0}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Draw2DUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DUtilities");JIRA.WorkflowDesigner.Draw2DUtilities={setCursor:function(A,C){var B=A.svgNodes||A.shape;B&&B.attr("cursor",C)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/FigureUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.FigureUtilities");JIRA.WorkflowDesigner.FigureUtilities={calculateBoundingBox:function(D){var B=null,F=null,G=null,E=null,C,A;_.each(D,function(H){var J=H.getX(),I=H.getY();if(!B||B>J){B=J}if(!F||F<J){F=J}if(!G||G>I){G=I}if(!E||E<I){E=I}});C=F-B;A=E-G;return new draw2d.geo.Rectangle(B,G,C,A)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Messages.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Messages");JIRA.WorkflowDesigner.Messages={showErrorMessage:function(C,B){var A;B=_.defaults({},B,{closeable:true,timeout:0});if(C){A=JIRA.Messages.showErrorMsg(C,B);A.css("z-index",2510)}return A}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/FigurePatch.js' */
(function(){_.extend(draw2d.Figure.prototype,{sendToBack:function(){this.svgNodes&&this.svgNodes.toBack();this.shape&&this.shape.toBack();return this},sendToFront:function(){this.shape&&this.shape.toFront();this.svgNodes&&this.svgNodes.toFront();return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/LabelPatch.js' */
(function(){var A=draw2d.shape.basic.Label.prototype.setText;_.extend(draw2d.shape.basic.Label.prototype,{setText:function(){A.apply(this,arguments);this.cachedHeight=null;this.cachedMinHeight=null}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/LinePatch.js' */
(function(){_.extend(draw2d.shape.basic.Line.prototype,{getBoundingBox:function(){return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox([this.getStartPoint(),this.getEndPoint()])}});draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){return false}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){return false}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/NodePatch.js' */
(function(){_.extend(draw2d.shape.node.Node.prototype,{onDoubleClick:jQuery.noop})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/PointPatch.js' */
(function(){_.extend(draw2d.geo.Point.prototype,{add:function(){return this.getTranslated.apply(this,arguments)},getComponents:function(){return[this.x,this.y]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/PolyLinePatch.js' */
(function(){_.extend(draw2d.shape.basic.PolyLine.prototype,{getBoundingBox:function(){var A=this.getPoints().asArray();return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox(A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/RectanglePatch.js' */
(function(){var A={union:function(C){var B,D;B={x:Math.max(C.getRight(),this.getRight()),y:Math.max(C.getBottom(),this.getBottom())};D={x:Math.min(C.getLeft(),this.getLeft()),y:Math.min(C.getTop(),this.getTop())};return new draw2d.geo.Rectangle(D.x,D.y,B.x-D.x,B.y-D.y)},clone:function(){return new draw2d.geo.Rectangle(this.x,this.y,this.w,this.h)},scaleByFactor:function(B){return this.scale(this.w*(B-1),this.h*(B-1))},getRelativePosition:function(B){return B.subtract(this.getTopLeft())},getRelativePositionAsPercentage:function(C){var B=this.getRelativePosition(C);return new draw2d.geo.Point(B.x/this.w,B.y/this.h)}};_.extend(draw2d.geo.Rectangle.prototype,A)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/StatusLozengeColours.js' */
(function(){function A(D){D=D.match(/\d+/g);return"#"+_.map(D,function(E){E=parseInt(E,10).toString(16);return("0"+E).slice(-2)}).join("")}function B(E){var F=C(E),D=F.css(E.property);F.remove();return A(D)}function C(D){return jQuery(JIRA.Template.Util.Issue.Status.issueStatus({isSubtle:!!D.isSubtle,issueStatus:{statusCategory:{colorName:D.colourName}}})).hide().appendTo("body")}AJS.namespace("JIRA.WorkflowDesigner.StatusLozengeColours");JIRA.WorkflowDesigner.StatusLozengeColours={getBackgroundColour:function(D){D.property="background-color";return B(D)},getBorderColour:function(D){D.property="border-top-color";return B(D)},getColour:function(D){D.property="color";return B(D)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/SVGUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SVGUtilities");JIRA.WorkflowDesigner.SVGUtilities={fromScreenToSVGCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM().inverse(),B,D)},fromSVGToPageCoordinate:function(E,D,F){var C=jQuery(window.document),B=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(E,D,F);B.x+=C.scrollLeft();B.y+=C.scrollTop();return B},fromSVGToScreenCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM(),B,D)},getPageBoundingBox:function(D){var C,B=jQuery(D).get(0).getBBox(),E;E=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x,B.y);C=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x+B.width,B.y+B.height);return{height:C.y-E.y,width:C.x-E.x,x:E.x,y:E.y}}};function A(E,D,C,F){var B=jQuery(E).closest("svg").get(0).createSVGPoint();B.x=C;B.y=F;B=B.matrixTransform(D);return{x:B.x,y:B.y}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/UnderscoreMixins.js' */
(function(){_.mixin({cartesianProduct:function(){var A=Array.prototype.slice.call(arguments,0);return _.reduce(A,function(C,D){var B=[];_.each(C,function(E){_.each(D,function(F){B.push(E.concat(F))})});return B},[[]])},flatMap:_.compose(_.flatten,_.map),sum:function(B,A){return _.reduce(B,function(C,D){return C+D},0,A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Vector2D.js' */
(function(){var A=draw2d.geo.Point;AJS.namespace("JIRA.WorkflowDesigner.Vector2D");JIRA.WorkflowDesigner.Vector2D=A.extend({init:function(D,C){var E=D instanceof A&&C instanceof A,B=D,F=C;if(E){B=C.x-D.x;F=C.y-D.y}this._super(B,F)},getLength:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},multiply:function(B){this.x*=B;this.y*=B;return this},normalize:function(){var B=this.getLength();if(B>0){this.multiply(1/B)}return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/ViewBoxTransformer.js' */
(function(){var E=0.25;var C=2;var B=0.5;function D(G){return G.clone().scaleByFactor(E*2)}function F(I,H,G){return I.clone().translate(-H,-G).resize(H,G)}function A(I,H){var K=C*H,G=B*H,J=Math.max(Math.min(I,K),G);if(Math.abs(J-1)>0.0001){return J}else{return 1}}JIRA.WorkflowDesigner.ViewBoxTransformer={getZoomViewBox:function(Q){var H=Q.viewBox,L=Q.diagramBoundingBox,P=A(Q.factor,Q.zoom),G,N,I,O=Q.target,K,M,J;N=H.getWidth()*P;G=H.getHeight()*P;J=D(L);K=F(J,N,G);I=H.getRelativePositionAsPercentage(O);M=new draw2d.geo.Point(O.getX()-I.x*N,O.getY()-I.y*G);M.setBoundary(K.getLeft(),K.getTop(),K.getRight(),K.getBottom());return new draw2d.geo.Rectangle(M.getX(),M.getY(),N,G)},getPanViewBox:function(K){var M=K.viewBox,J=K.diagramBoundingBox,I=K.displacement,H,G,L;L=D(J);H=F(L,M.getWidth(),M.getHeight());G=M.getTopLeft().translate(I.x,I.y).setBoundary(H.getLeft(),H.getTop(),H.getRight(),H.getBottom());return new draw2d.geo.Rectangle(G.getX(),G.getY(),M.getWidth(),M.getHeight())}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/actions/ActionsView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.ActionsView",A.Marionette.ItemView.extend({className:"actions",events:{"change .show-transition-labels":"_setShowTransitionLabels","click .add-status":"_addStatus","click .add-transition":"_addTransition","click .enter-full-screen":"_enterFullScreen","click .exit-full-screen":"_exitFullScreen"},template:JIRA.WorkflowDesigner.Templates.actions,ui:{addStatusButton:".add-status",fullScreenTriggers:".full-screen-trigger",lastEditedMessage:".last-edited-message"},initialize:function(B){this._canvasModel=B.canvasModel;this._fullScreenButton=B.fullScreenButton;this._immutable=B.immutable;this._workflowModel=B.workflowModel;this.listenTo(this._workflowModel,"change:updateAuthor change:updatedDate",function(){if(this._workflowModel.get("updateAuthor")&&this._workflowModel.get("updatedDate")){this.stopListening(this._workflowModel);this.render()}})},_addStatus:function(){var B=this.ui.addStatusButton.hasClass("active");this._addStatusDialog||(this._addStatusDialog=this._createAddStatusDialog());if(B){this._addStatusDialog.hide()}else{this._addStatusDialog.show()}},_addTransition:function(){var B=this._canvasModel.get("selectedModel"),C=B&&B instanceof JIRA.WorkflowDesigner.StatusModel,D=new JIRA.WorkflowDesigner.TransitionModel();if(C){D.set({source:B,target:B})}new JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView({canvasModel:this._canvasModel,transitionModel:D,workflowModel:this._workflowModel}).show()},_createAddStatusDialog:function(){var B;B=new JIRA.WorkflowDesigner.Dialogs.AddStatusInlineDialogView({trigger:this.ui.addStatusButton,workflowModel:this._workflowModel});this.listenTo(B,{done:_.bind(this.trigger,this,"addStatus:done"),submit:_.bind(this.trigger,this,"addStatus:submit")});return B},_enterFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:enter")},_exitFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:exit")},onRender:function(){this.ui.fullScreenTriggers.tooltip();this.ui.fullScreenTriggers.filter(".hidden").tipsy("disable");this.ui.lastEditedMessage.find("time").livestamp()},remove:function(){A.Marionette.ItemView.prototype.remove.apply(this,arguments);this._addStatusDialog&&this._addStatusDialog.remove()},serializeData:function(){return{currentUserName:JIRA.Users.LoggedInUser.userName(),updatedDate:this._workflowModel.get("updatedDate")&&this._workflowModel.get("updatedDate").getTime(),updateAuthor:this._workflowModel.get("updateAuthor"),fullScreenButton:this._fullScreenButton,immutable:this._immutable,showTransitionLabels:this._canvasModel.get("showTransitionLabels")}},_setShowTransitionLabels:function(B){var C=jQuery(B.target).is(":checked");this._canvasModel.set("showTransitionLabels",C)},_toggleFullScreenTriggers:function(){this.ui.fullScreenTriggers.each(function(C,B){jQuery(B).tipsy("toggleEnabled")}).toggleClass("hidden")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/actions/ZoomControlView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.ZoomControlView",A.Marionette.ItemView.extend({className:"zoom-control",events:{"click .zoom-in":"_triggerZoomIn","click .zoom-out":"_triggerZoomOut"},modelEvents:{"change:zoomLevel":"_debouncedRender"},template:JIRA.WorkflowDesigner.Templates.zoomControl,initialize:function(B){this._debouncedRender=_.debounce(this.render,100);this._maximumZoomLevel=B.maximumZoomLevel;this._minimumZoomLevel=B.minimumZoomLevel},serializeData:function(){var C=0.001,B=this.model.get("zoomLevel");return{zoomInDisabled:B>=this._maximumZoomLevel-C,zoomOutDisabled:B<=this._minimumZoomLevel+C}},_triggerZoomIn:function(){this.trigger("zoomIn")},_triggerZoomOut:function(){this.trigger("zoomOut")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/CanvasView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.CanvasView",A.View.extend({className:"canvas",initialize:function(B){_.bindAll(this,"_onKeyDown");B=_.defaults({},B,{immutable:false});this._canvasModel=B.canvasModel;this.immutable=B.immutable;this.statusViews=new JIRA.WorkflowDesigner.Collection();this.transitionViews=new JIRA.WorkflowDesigner.Collection();this._workflowModel=B.workflowModel;this._zoomHandler=new JIRA.WorkflowDesigner.ZoomHandler(this.el);this.immutable||jQuery(document).on("keydown",this._onKeyDown);this.listenTo(this._canvasModel,"change:selectedModel",this._onSelectedModelChange);this.listenTo(this.statusViews,{deselected:this._clearSelectedView,"port:drag:end":this._onPortDragEnd,"port:drag:start":_.bind(this._setPortDragged,this,true),selected:this._setSelectedView});this.listenTo(this.transitionViews,{deselected:this._onTransitionDeselected,reconnect:this._onReconnect,selected:this._onTransitionSelected});this.listenTo(this._workflowModel,"reset:after",this._positionNewStatuses);this.listenTo(this._workflowModel.get("statuses"),{add:this.addStatus,remove:this.removeStatus,reset:this.resetStatuses});this.listenTo(this._workflowModel.get("transitions"),{add:this.addTransition,"change:source change:target":this._updateTransitionSourceAndTarget,remove:this.removeTransition,reset:this.resetTransitions});this.listenTo(this._zoomHandler,"zoom",this._onZoom)},addStatus:function(C){var F=C.get("initial"),D=this._canvasModel.get("selectedModel")===C,B,E;if(F){E=JIRA.WorkflowDesigner.InitialStatusView}else{E=JIRA.WorkflowDesigner.StatusView}B=new E({canvas:this.canvas,getAllTargetPorts:_.bind(this._getAllTargetPorts,this),immutable:this.immutable,isPortDragged:_.bind(this._isPortDragged,this),model:C,workflowModel:this._workflowModel}).render();this.statusViews.add(B);D&&B.select();return B},addTransition:function(B){var F=B.get("globalTransition"),C=this._canvasModel.get("selectedModel")===B,D=this._getTransitionViewWithModel(B),E;if(D){return D}if(F){E=JIRA.WorkflowDesigner.GlobalTransitionView}else{E=JIRA.WorkflowDesigner.TransitionView}D=new E({canvas:this.canvas,canvasModel:this._canvasModel,immutable:this.immutable,model:B,sourceView:this._getStatusViewWithModel(B.get("source")),targetView:this._getStatusViewWithModel(B.get("target")),workflowModel:this._workflowModel});D.requestResponse&&D.requestResponse.setHandler("isSelected",this._transitionIsSelected,this);D.render();this.transitionViews.add(D);C&&D.select();return D},autoFit:function(){var B,E,C,D=10,F;this.canvas.fitToContainer();B=this.getCanvasBoundingBox();if(B){B.scale(D*2,D*2);F=new draw2d.geo.Rectangle(0,0,this.$el.width(),this.$el.height());C=B.getHeight()<=F.getHeight()&&B.getWidth()<=F.getWidth();if(!C){this.canvas.setViewBox(B);F=this.canvas.getViewBox()}E=B.getCenter();this.canvas.setViewBox(new draw2d.geo.Rectangle(E.getX()-F.getWidth()/2,E.getY()-F.getHeight()/2,F.getWidth(),F.getHeight()));this._canvasModel.set("zoomLevel",this.canvas.getZoom())}},_clearSelectedView:function(B){var C=this._canvasModel.get("selectedView")===B;C&&this._canvasModel.selectView(null)},_createCanvas:function(B){var C,D=_.bind(this.getCanvasBoundingBox,this),F=this._getUniqueId(),E;B=jQuery(B);B.append(this.el);this.$el.attr("id",F);E=["statuses","selected-status","transitions","global-transitions","highlighted-transition","selected-transition","transition-labels"];C=new JIRA.WorkflowDesigner.Draw2DCanvas(F);C.createLayers(E);C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy(D));C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy());C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy());C.onNewConnection=_.bind(this._onNewConnection,this);return C},_delete:function(){var B=this._canvasModel.get("selectedView");B&&B.destroy();return !!B},_getAllTargetPorts:function(){function C(D){return D.model.isInitial()}function B(D){return D.getPorts()}return this.statusViews.chain().reject(C).flatMap(B).value()},getCanvasBoundingBox:function(){var C,E=this.canvas.getFigures().asArray(),B=this.canvas.getLines().asArray();function D(G){var H=G.getBoundingBox();if(C){C=C.union(H)}else{C=H}}function F(G){return G instanceof JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure}_.chain(E).reject(F).each(D);_.each(B,D);return C},_getSiblingTransitions:function(B){var D=B.model.get("actionId");function C(E){return E.model.get("actionId")===D}return this.transitionViews.chain().filter(C).without(B).value()},_getStatusViewWithModel:function(B){return this.statusViews.find(function(C){return C.model===B})},getStatusViewWithPort:function(B){return this.statusViews.find(function(C){return _.contains(C.getPorts(),B)})},_getTransitionViewWithModel:function(B){return this.transitionViews.find(function(C){return C.model===B})},_getUniqueId:function(){var B=0,C;do{B++;C="workflow-designer"+B}while(jQuery("#"+C).length);return C},_isPortDragged:function(){return !!this.portDragged},_onKeyDown:function(B){if(this._shouldHandleDelete(B)){this._delete()&&B.preventDefault()}},_onNewConnection:function(D){var C=D.getSource(),B=this.getStatusViewWithPort(C),F=D.getTarget(),E=this.getStatusViewWithPort(F),G;G=new JIRA.WorkflowDesigner.TransitionModel({source:B.model,sourceAngle:B.getAngleToPort(C),target:E.model,targetAngle:E.getAngleToPort(F)});this.canvas.removeFigure(D);new JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView({canvasModel:this._canvasModel,transitionModel:G,workflowModel:this._workflowModel}).show()},_onReconnect:function(F){var H,C=F.getConnection().getSource(),B=this.getStatusViewWithPort(C),G,E=F.getConnection().getTarget(),D=this.getStatusViewWithPort(E);H=B.model!==F.model.get("source");G=D.model!==F.model.get("target");if(H){new JIRA.WorkflowDesigner.Dialogs.EditTransitionSourceDialogView({newSourcePort:C,newSourceView:B,originalSourceStatus:F.model.get("source"),transitionView:F,workflowModel:this._workflowModel}).show()}else{if(G){new JIRA.WorkflowDesigner.Dialogs.EditTransitionTargetDialogView({targetPort:E,targetView:D,transitionView:F,workflowModel:this._workflowModel}).show()}else{F.model.set({source:B.model,sourceAngle:B.getAngleToPort(C),target:D.model,targetAngle:D.getAngleToPort(E)})}}},_onTransitionDeselected:function(B){this._clearSelectedView(B);_.invoke(this._getSiblingTransitions(B),"unhighlight")},_onTransitionSelected:function(B){this._setSelectedView(B);_.invoke(this._getSiblingTransitions(B),"appearSelected")},_onZoom:function(B){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this.zoom(B.factor,this.canvas.fromDocumentToCanvasCoordinate(B.clientX,B.clientY))},_positionNewStatuses:function(){var B=this._workflowModel.get("statuses").map(this._getStatusViewWithModel,this);JIRA.WorkflowDesigner.StatusPositioner.positionStatuses(B,this.canvas.getViewBox())},remove:function(){A.View.prototype.remove.apply(this,arguments);jQuery(document).off("keydown",this._onKeyDown);this._zoomHandler.destroy()},removeStatus:function(C){var B=this._getStatusViewWithModel(C);if(B){B.remove();this.statusViews.remove(B)}},removeTransition:function(B){var C=this._getTransitionViewWithModel(B);if(C){C.remove();this.transitionViews.remove(C)}},render:function(B){this.canvas||(this.canvas=this._createCanvas(B));return this},resetStatuses:function(){while(this.statusViews.length){this.removeStatus(this.statusViews.at(0).model)}this._workflowModel.get("statuses").each(function(B){this.addStatus(B)},this)},resetTransitions:function(){while(this.transitionViews.length){this.removeTransition(this.transitionViews.at(0).model)}this._workflowModel.get("transitions").forEach(function(B){this.addTransition(B)},this)},_transitionIsSelected:function(D){var F=D.model.get("actionId"),C=this._canvasModel.get("selectedView")===D,B=this._canvasModel.get("selectedModel"),E=!!B&&B.get("actionId")===F;return C||E},_onSelectedModelChange:function(E,B){var D=this._getStatusViewWithModel(B)||this._getTransitionViewWithModel(B),C=this._canvasModel.get("selectedView");if(B&&D&&D!==C){D.select()}},_onPortDragEnd:function(){function B(C){return C.model.isInitial()}this._setPortDragged(false);this.statusViews.chain().reject(B).invoke("updatePortsVisibility")},setLocked:function(B){this._isLocked=B},_setPortDragged:function(B){this.portDragged=B},setResizeInterval:function(B){this.canvas.setResizeInterval(B)},_setSelectedView:function(B){this._canvasModel.selectView(B)},_shouldHandleDelete:function(E){var B=[jQuery.ui.keyCode.BACKSPACE,jQuery.ui.keyCode.DELETE],F=!!jQuery(".aui-blanket:visible").length,D=_.contains(B,E.which),C=jQuery(E.target).is(":input");return !F&&D&&!C&&!this._isLocked},_updateTransitionSourceAndTarget:function(C){var B=this._getStatusViewWithModel(C.get("source")),D=this._getStatusViewWithModel(C.get("target")),E=this._getTransitionViewWithModel(C);E.setViews(B,D);E.resetConnection()},zoom:function(B,C){this.canvas.zoom(B,C||this.canvas.getViewBox().getCenter(),this.getCanvasBoundingBox());this._canvasModel.set("zoomLevel",this.canvas.getZoom())}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/Draw2DCanvas.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas");JIRA.WorkflowDesigner.Draw2DCanvas=draw2d.Canvas.extend({init:function(){_.bindAll(this,"_scheduleResize");this._super.apply(this,arguments);this.paper.canvas.style.position="";this.svgElement=jQuery(this.paper.canvas);this._debouncedSetViewBox=_.debounce(this.setViewBox,100);this._scheduleResize()},createLayers:function(){var B=JIRA.WorkflowDesigner.Draw2DCanvas.Layer,A=this._layers||(this._layers={});_.each(_.flatten(arguments),function(C){A[C]||(A[C]=new B(this))},this)},fitToContainer:function(){var C=Number(this.svgElement.attr("height")),A=Number(this.svgElement.attr("width")),E=this.getHeight(),D=this.getWidth(),B=C!==E||A!==D;if(!this.html.is(":visible")){return }if(B){this.paper.setSize(D,E);this.svgElement.css({height:E,width:D})}},fromCanvasToDocumentCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},fromDocumentToCanvasCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromScreenToSVGCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},getBestFigure:function(A,E,D){var C=D instanceof draw2d.Port,B=D instanceof draw2d.shape.basic.LineResizeHandle;if(!D||C||B){return this._super(A,E,D)}return null},getLayer:function(A){return this._layers&&this._layers[A]},getSelectedFigure:function(){return this.getSelection().getPrimary()},getViewBox:function(){var B,C=jQuery(this.html).offset(),A;A=this.paper.canvas.getAttribute("viewBox");A=A&&_.map(A.split(" "),parseFloat).slice(0,2)||[0,0];B=this.fromDocumentToCanvasCoordinate(C.left+this.svgElement.width()-jQuery(document).scrollLeft(),C.top+this.svgElement.height()-jQuery(document).scrollTop());return new draw2d.geo.Rectangle(A[0],A[1],B.x-A[0],B.y-A[1])},getZoom:function(){return this.svgElement.width()/this.getViewBox().getWidth()},removeFigure:function(A){this._super.apply(this,arguments);A._layer&&A._layer.removeFigure(A)},_scheduleResize:function(){var C=JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL,A=!!this.svgElement.closest("body").length,B=_.isNumber(this._resizeInterval)?this._resizeInterval:C;if(A){setTimeout(this._scheduleResize,B);this.fitToContainer()}},selectFigure:function(A){var B=this;this.editPolicy.each(function(D,C){var E=C instanceof draw2d.policy.canvas.SingleSelectionPolicy;if(E){C.select(B,A)}})},setResizeInterval:function(A){this._resizeInterval=A},setViewBoxQuick:function(A){this.paper.canvas.setAttribute("viewBox",[A.getX(),A.getY(),A.getWidth(),A.getHeight()].join(" "));this._debouncedSetViewBox(A)},zoom:function(B,C,A){this.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getZoomViewBox({diagramBoundingBox:A,factor:B,target:C,viewBox:this.getViewBox(),zoom:this.getZoom()}))}});JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL=100}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/Layer.js' */
(function(){function A(B,E){var C=B.getChildren().clone().asArray().reverse(),D=E.svgNodes||E.shape;_.each(C,function(F){A(F,E)});B.svgNodes&&B.svgNodes.insertAfter(D);B.shape&&B.shape.insertAfter(D)}AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas.Layer");JIRA.WorkflowDesigner.Draw2DCanvas.Layer=function(B){var C=new JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure();this._canvas=B;this._canvas.addFigure(C);this._figures=[C]};_.extend(JIRA.WorkflowDesigner.Draw2DCanvas.Layer.prototype,{addFigure:function(B){B.getCanvas()||this._canvas.addFigure(B);B._layer&&B._layer.removeFigure(B);B._layer=this;A(B,_.last(this._figures));this._figures.push(B)},removeFigure:function(B){this._figures=_.without(this._figures,B)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/LayerRootFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure");JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure=draw2d.shape.basic.Rectangle.extend({init:function(){this._super(0,0);this.setAlpha(0);this.setDeleteable(false);this.setDraggable(false);this.setResizeable(false);this.setSelectable(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/ZoomHandler.js' */
(function(A){AJS.namespace("JIRA.WorkflowDesigner.ZoomHandler");JIRA.WorkflowDesigner.ZoomHandler=function(B){_.bindAll(this,"_onMouseWheel");jQuery(document).on({mousewheel:this._onMouseWheel,MozMousePixelScroll:this._onMouseWheel});this._canvas=jQuery(B).get(0)};_.extend(JIRA.WorkflowDesigner.ZoomHandler.prototype,A.Events,{_computeZoomFactor:function(C){var E,D=0.1,B;C=C.originalEvent;E=!!C.detail;if(E){B=this._getDeltaFirefox(C)}else{B=this._getDeltaOthers(C)}isNaN(B)&&(B=1);return Math.max(D,B)},destroy:function(){jQuery(document).off({mousewheel:this._onMouseWheel,MozMousePixelScroll:this._onMouseWheel})},_getDeltaFirefox:function(C){var B=200,D=C.axis===C.VERTICAL_AXIS&&C.detail||0;return 1+D/B},_getDeltaOthers:function(C){var B=500,D=C.wheelDelta;if("wheelDeltaY" in C){D=C.wheelDeltaY}return 1-D/B},_isWorkflowDesigner:function(B){return B===this._canvas||jQuery.contains(this._canvas,B)},_onMouseWheel:function(C){var B=C.altKey&&this._isWorkflowDesigner(C.target);if(B){C.preventDefault();this.trigger("zoom",{clientX:C.originalEvent.clientX,clientY:C.originalEvent.clientY,factor:this._computeZoomFactor(C)})}}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/Draw2DView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.Draw2DView",A.View.extend({initialize:function(B){this._canvas=B.canvas},remove:function(){A.View.prototype.remove.apply(this,arguments);this._canvas.removeFigure(this._figure)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/FullScreenController.js' */
(function(){var G=500;var B="full-screen-controller-original-properties";var F="full-screen-controller-placeholder";function E(J,I){return _.reduce(I,function(L,K){L[K]=J.css(K);return L},{})}function A(I){var J;J=jQuery("<div>").css({height:I.outerHeight()}).insertAfter(I);I.data(F,J)}function D(I){I.data(F).remove();I.removeData(F)}function C(I){var J=I.data(B);I.css(J).removeData(B)}function H(J,I){var K=E(J,_.keys(I));J.css(I).data(B,K)}AJS.namespace("JIRA.WorkflowDesigner.FullScreenController");JIRA.WorkflowDesigner.FullScreenController={enterFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document);L=jQuery(L);A(L);H(L,{height:L.outerHeight(),left:L.offset().left-I.scrollLeft(),position:"fixed",top:L.offset().top-I.scrollTop(),width:L.outerWidth(),zIndex:2000});H(J,{overflow:"hidden"});L.appendTo(J);L.animate({height:"100%",left:0,top:0,width:"100%"},G,K.resolve);return K.promise()},exitFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document),M;function N(){L.insertBefore(M);D(L);C(L);K.resolve()}L=jQuery(L);M=L.data(F);C(J);L.animate({height:M.outerHeight(),left:M.offset().left-I.scrollLeft(),top:M.offset().top-I.scrollTop(),width:M.outerWidth()},G,N);return K.promise()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/InlineDialogSVGPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.InlineDialogSVGPositioner");JIRA.WorkflowDesigner.InlineDialogSVGPositioner={calculatePosition:function(E,F,G,D){var C,A,B;C=JIRA.WorkflowDesigner.SVGUtilities.getPageBoundingBox(F.target);B=jQuery("<div/>").css({height:C.height,left:C.x,position:"absolute",top:C.y,width:C.width}).appendTo("body");A=AJS.InlineDialog.opts.calculatePositions(E,{target:B},G,D);B.remove();return A}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/ProgressIndicatorBlanketView.js' */
(function(C){var B=40,A=440;C.define("JIRA.WorkflowDesigner.ProgressIndicatorBlanketView",C.Marionette.ItemView.extend({className:"progress-indicator-blanket",template:JIRA.WorkflowDesigner.Templates.progressIndicatorBlanket,ui:{spinner:".spinner"},initialize:function(D){this._container=jQuery(D.container)},hide:function(){clearInterval(this._intervalID);this.$el.remove()},show:function(){var F=0,D=this;function E(){F=(F-B)%A;D.ui.spinner.css("background-position","0 "+F+"px")}clearInterval(this._intervalID);this._intervalID=setInterval(E,50);this.render().$el.appendTo(this._container)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/BaseStatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.BaseStatusView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);B=_.defaults({},B,{immutable:false});this.immutable=B.immutable;this.isPortDragged=B.isPortDragged;this.getAllTargetPorts=B.getAllTargetPorts;this.workflowModel=B.workflowModel;this.listenTo(this.model,"change",this.render)},_createAndConfigureFigure:function(){var C=this._createFigure(),B=this;C.onDrag=_.wrap(C.onDrag,function(D){D.apply(this,_.toArray(arguments).slice(1));B.trigger("drag")});C.onDragEnd=_.wrap(C.onDragEnd,function(D){D.apply(this,_.toArray(arguments).slice(1));B._updatePosition();B.trigger("dragEnd")});if(this.immutable){C.setDeleteable(false);C.setResizeable(false)}else{C.installEditPolicy(new draw2d.policy.figure.DragDropEditPolicy())}return C},_createPort:function(B){B=_.extend({},B,{canvas:this._canvas,isPortDragged:this.isPortDragged,getAllTargetPorts:this.getAllTargetPorts});return new JIRA.WorkflowDesigner.StatusPort(B)},_getAngleToFigure:function(B){var D=B.getBoundingBox().getCenter(),C=this._figure.getBoundingBox().getCenter();return Math.atan2(D.getY()-C.getY(),D.getX()-C.getX())/Math.PI*180},getAngleToPort:function(B){return this._getAngleToFigure(B)},getAngleToStatus:function(B){return this._getAngleToFigure(B._figure)},getPortForAngle:function(C){function B(D){var E=Math.abs(C-this._getAngleToFigure(D));return E<180?E:Math.abs(E-360)}return _.min(this.getPorts(),B,this)},_positionFigure:function(){if(this.model.hasCoordinates()){this._figure.setPosition(this.model.get("x"),this.model.get("y"))}},render:function(){this._figure||(this._figure=this._createAndConfigureFigure());return this},setPosition:function(B,C){this.model.set({x:B,y:C})},_updatePosition:function(){var B=this.getBoundingBox();this.setPosition(B.getX(),B.getY())}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/InitialStatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.InitialStatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_createFigure:function(){var B,C;B=this._figure=new draw2d.shape.basic.Circle(30);B.setBackgroundColor("#C0C0C0");B.setStroke(0);B.setSelectable(false);B.snapToGeometry=true;C=this._fill=new draw2d.shape.basic.Circle(30);C.onMouseEnter=_.bind(this.trigger,this,"highlight");C.onMouseLeave=_.bind(this.trigger,this,"unhighlight");C.setBackgroundColor("#C0C0C0");C.setStroke(0);B.addFigure(C,new draw2d.layout.locator.CenterLocator(B));this._canvas.addFigure(B);JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(C,"move");this._addPort();this._positionFigure();return B},_addPort:function(){var C=JIRA.WorkflowDesigner.Direction.DOWN,B;this.port=this._createPort({connectionDirection:C});B=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this._figure,side:C,bias:0.5});this._figure.addPort(this.port,B)},getBoundingBox:function(){return this._figure.getBoundingBox()},getPorts:function(){return[this.port]},isSelected:function(){return false}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/StatusFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusFigure");JIRA.WorkflowDesigner.StatusFigure=draw2d.shape.basic.Rectangle.extend({init:function(){var E,F,D,C,A,B;A=new draw2d.layout.locator.CenterLocator(this);this._super.apply(this,arguments);this.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this.setAlpha(0);this.setDeleteable(false);this.setStroke(0);this.snapToGeometry=true;D=this._hover=new draw2d.shape.basic.Rectangle();D.onDoubleClick=_.bind(this._onDoubleClick,this);D.onMouseEnter=_.bind(this._onMouseEnter,this);D.onMouseLeave=_.bind(this._onMouseLeave,this);D.setAlpha(0);this.addFigure(D,A);E=this._edge=new draw2d.shape.basic.Rectangle();E.setRadius(4);E.setStroke(0);this.addFigure(E,A);B=this._selectedOutline=new draw2d.shape.basic.Rectangle();B.setColor("#1a8cff");B.setRadius(4);B.setStroke(2);B.setVisible(false);this.addFigure(B,A);F=this._fill=new draw2d.shape.basic.Rectangle();F.setRadius(3);F.setStroke(0);this.addFigure(F,A);C=this._label=new draw2d.shape.basic.Label();C.setBold(true);C.setFontFamily("Arial");C.setFontSize(11);C.setStroke(0);this.addFigure(C,A)},getTextColor:function(){return this._label.getFontColor()},_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_onMouseEnter:function(){this.onMouseEnter.apply(this,arguments)},_onMouseLeave:function(){this.onMouseLeave.apply(this,arguments)},repaint:function(){function A(B){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(B.figure,"move")}this._super.apply(this,arguments);_.each(this.children.asArray(),A)},_resize:function(){var A=Math.max(this._label.getBoundingBox().getWidth()+40,60);this.setDimension(A,30)},select:function(){this._super.apply(this,arguments);this._selectedOutline.setVisible(true)},setBackgroundColor:function(A){this._super.apply(this,arguments);this._fill&&this._fill.setBackgroundColor(A)},setCanvas:function(A){this._super.apply(this,arguments);A&&this._selectedOutline.shape.attr("fill-opacity","0")},setColor:function(A){this._super.apply(this,arguments);this._edge&&this._edge.setBackgroundColor(A)},setDimension:function(B,A){var C=!!this._edge;this._super.apply(this,arguments);if(C){this._edge.setDimension(B,A);this._fill.setDimension(B-2,A-2);this._hover.setDimension(B+12,A+12);this._selectedOutline.setDimension(B+1,A+1)}},setText:function(A){this._label.setText(A.toUpperCase());this._resize()},setTextColor:function(A){this._label&&this._label.setFontColor(A)},unselect:function(){this._super.apply(this,arguments);this._selectedOutline.setVisible(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/StatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_addPort:function(E,F){var C=this,B,D;D=this._createPort({connectionDirection:F});B=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this._figure,side:F,bias:E});this._figure.addPort(D,B);D.bind("mouse:enter",function(H,G){C._onMouseEnter(G)});D.bind("mouse:leave",function(G,H){C._onMouseLeave(H)});D.bind("drag:start",_.bind(this._portStatusDragStart,this));D.bind("drag:end",_.bind(this._portStatusDragEnd,this));D.bind("select",_.bind(this.select,this));return D},_createFigure:function(){var B,C;C={onOtherFigureIsMoving:_.throttle(_.bind(this.trigger,this,"move"),25)};B=this._figure=new JIRA.WorkflowDesigner.StatusFigure();B.attachMoveListener(C);B.onDeselect=_.bind(this._onDeselect,this);B.onMouseEnter=_.bind(this._onMouseEnter,this);B.onMouseLeave=_.bind(this._onMouseLeave,this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this.immutable);this.immutable||(B.onDoubleClick=_.bind(this.edit,this));this._canvas.getLayer("statuses").addFigure(B);this._createPorts();this._positionFigure();return B},_createPorts:function(){var B=JIRA.WorkflowDesigner.Direction;this.ports=[this._addPort(0.22,B.UP),this._addPort(0.5,B.UP),this._addPort(0.78,B.UP),this._addPort(0.5,B.RIGHT),this._addPort(0.78,B.DOWN),this._addPort(0.5,B.DOWN),this._addPort(0.22,B.DOWN),this._addPort(0.5,B.LEFT)]},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},_getBackgroundColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getBackgroundColour({colourName:B.colourName,isSubtle:C})}else{if(C){D="#ffffff"}else{D="#4a6785"}}return D},_getBorderColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(!C){D="#ffffff"}else{if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getBorderColour({colourName:B.colourName,isSubtle:C})}else{D="#4a6785"}}return D},getBoundingBox:function(){return this._figure.getBoundingBox()},_getFigure:function(){return this._figure},getPorts:function(){return this.ports},_getTextColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getColour({colourName:B.colourName,isSubtle:C})}else{if(C){D="#4a6785"}else{D="#ffffff"}}return D},highlight:function(){this.immutable||_.invoke(this.getPorts(),"show");this.trigger("highlight")},_isSubtle:function(){var D=this.workflowModel.has("currentStepId"),B=this.model.get("stepId")===this.workflowModel.get("currentStepId"),C=this.model.get("initial");return D&&!B&&!C},_isThisStatusHighlightTarget:function(B){var C=B&&B.getParent()===this._figure,E=this._figure===B,D=_.contains(this.ports,B);return C||E||D},_onDeselect:function(){this._canvas.getLayer("statuses").addFigure(this._figure);this.trigger("deselected",this);this.selected=false;this.unhighlight()},_onMouseEnter:function(B){this._isThisStatusHighlightTarget(B)||this.highlight()},_onMouseLeave:function(B){this._isThisStatusHighlightTarget(B)||this.unhighlight()},_onSelect:function(){this._canvas.getLayer("selected-status").addFigure(this._figure);this.highlight();this.selected=true;this.trigger("selected",this)},_portStatusDragEnd:function(){this.trigger("port:drag:end")},_portStatusDragStart:function(){this.trigger("port:drag:start")},render:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype.render.apply(this,arguments);this._figure.setBackgroundColor(this._getBackgroundColor());this._figure.setColor(this._getBorderColor());this._figure.setText(this.model.get("name"));this._figure.setTextColor(this._getTextColor());this._positionFigure();return this},unhighlight:function(){if(this.selected){return }this.immutable||_.invoke(this.getPorts(),"hide");this.trigger("unhighlight")},updatePortsVisibility:function(){_.invoke(this.getPorts(),this.selected?"show":"hide")}}));Cocktail.mixin(JIRA.WorkflowDesigner.StatusView,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/StatusPort.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPort");JIRA.WorkflowDesigner.StatusPort=draw2d.HybridPort.extend({RADIUS:8,STROKE_WIDTH:1,init:function(A){this._super();this.connectionDirection=A.connectionDirection;this.canvas=A.canvas;this.isPortDragged=A.isPortDragged;this.getAllTargetPorts=A.getAllTargetPorts;this.lighterBgColor=this.bgColor.hash();this.setBackgroundColor("#ffffff");this.setColor("#1a8cff");this.setCoronaWidth(6);this.setDimension(this.RADIUS,this.RADIUS);this.setStroke(this.STROKE_WIDTH);this.hide();this._resetEditPolicies();this.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy())},_resetEditPolicies:function(){var A=this;this.editPolicy.each(function(B,C){C.onUninstall(A)});this.editPolicy=new draw2d.util.ArrayList()},getConnectionDirection:function(){return this.connectionDirection},getDropTarget:function(A,B){return JIRA.WorkflowDesigner.StatusPort.getHitPort(A,B,this.getDropTargets().asArray())},getDropTargets:function(){var A=_.without(this.getAllTargetPorts(),this);return new draw2d.util.ArrayList(A).trimToSize()},onMouseEnter:function(A){this.trigger("mouse:enter",A)},onMouseLeave:function(A){this.trigger("mouse:leave",A)},onDragStart:function(){this.triggerDragStart();this.trigger("select");this._super()},onDragEnd:function(){this._super();this.triggerDragEnd()},triggerDragStart:function(){this.trigger("drag:start")},triggerDragEnd:function(){this.trigger("drag:end")},hitTest:function(B,H){if(this.isPortDragged()){return this._super(B,H)}var E=this.getAbsoluteX();var C=this.getAbsoluteY();var D=E-this.getWidth()/2;var A=C-this.getHeight()/2;var G=E+this.getWidth()/2;var F=C+this.getHeight()/2;return(B>=D&&B<=G&&H>=A&&H<=F)},show:function(){this.sendToFront().setVisible(true)},hide:function(){this.setVisible(false)},repaint:function(){this._super.apply(this,arguments);this._setCursor(this)},setGlow:function(A){var B="#3b7fc4";this._super(A);if(A){this.corona.setBackgroundColor(B);this.corona.setColor(B);this.corona.shape.attr("opacity",0.45);this._setCursor(this.corona);this.sendToFront();this.setStroke(0)}else{this.setStroke(this.STROKE_WIDTH)}},_setCursor:function(A){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(A,"crosshair")}});JIRA.WorkflowDesigner.StatusPort.getHitPort=function(A,G,D){var F=new draw2d.geo.Point(A,G),E;function B(H){return H.hitTest(F.x,F.y)}function C(H){return H.getAbsolutePosition().getDistance(F)}E=_.chain(D).filter(B).min(C).value();return E instanceof JIRA.WorkflowDesigner.StatusPort?E:null}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/StatusPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPositioner");JIRA.WorkflowDesigner.StatusPositioner={positionStatuses:function(G,F){var H,E;H=new draw2d.geo.Point(F.getCenter().getX(),F.getY()+F.getHeight()*0.2);function D(J){var I=_.sum(_.map(J,B));E=H.getY()-I/2}function C(I){I.setPosition(H.getX()-I.getBoundingBox().getWidth()/2,E);E+=B(I)}_.chain(G).reject(A).tap(D).each(C)}};function B(C){return C.getBoundingBox().getHeight()}function A(C){return C.model.hasCoordinates()}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/GlobalTransitionFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.GlobalTransitionFigure");JIRA.WorkflowDesigner.GlobalTransitionFigure=draw2d.shape.basic.Rectangle.extend({init:function(){var E,C,A,B,D;_.bindAll(this,"_onDoubleClick");this._super.apply(this,arguments);this.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this.setAlpha(0);this.setDeleteable(false);this.setDimension(68,14);this.setResizeable(false);A=this._line=new draw2d.shape.basic.Line(0,0,0,0);A.onDoubleClick=this._onDoubleClick;A.setColor("#cccccc");A.setStroke(1);this.addFigure(A,new draw2d.layout.locator.CenterLocator(this));E=this._arrow=new JIRA.WorkflowDesigner.TriangleFigure();E.onDoubleClick=this._onDoubleClick;E.setDimension(7,8);E.setBackgroundColor("#cccccc");E.setColor("#cccccc");E.setStroke(1);this.addFigure(E,new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,0,3));B=this._createLozenge();D=new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,49,0);this.addFigure(B,D);C=this._hover=new draw2d.shape.basic.Rectangle(19,14);C.onDoubleClick=this._onDoubleClick;C.setAlpha(0);this.addFigure(C,D)},_createLozenge:function(){var A,B;A=this._lozengeRectangle=new draw2d.shape.basic.Rectangle(19,14);A.setBackgroundColor("#333333");A.setStroke(0);B=this._lozengeText=new draw2d.shape.basic.Label();B.setAlpha(0);B.setBold(true);B.setFontColor("#ffffff");B.setFontFamily("Arial");B.setFontSize(11);B.setStroke(0);B.setText("All");A.addFigure(B,new draw2d.layout.locator.CenterLocator(A));return A},getHoverElement:function(){return this._hover.shape.node},getPorts:function(){return new draw2d.util.ArrayList()},onDrag:jQuery.noop,_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_resizeLozenge:function(){var A=this._lozengeText.getWidth();this._hover.setDimension(A,this._hover.getHeight());this._lozengeRectangle.setDimension(A,this._lozengeRectangle.getHeight())},select:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#ffffff");this._arrow.setColor("#1a8cff");this._line.setColor("#1a8cff")},setCanvas:function(){this._super.apply(this,arguments);this._resizeLozenge()},setPosition:function(A,C){var B;this._super(A,C);B=this.getBoundingBox();this._line.setStartPoint(B.getLeft(),B.getCenter().getY());this._line.setEndPoint(B.getRight(),B.getCenter().getY())},unselect:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#cccccc");this._arrow.setColor("#cccccc");this._line.setColor("#cccccc")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/GlobalTransitionView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.GlobalTransitionView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);B=_.defaults({},B,{immutable:false});this._immutable=B.immutable;this._targetView=B.targetView;this._workflowModel=B.workflowModel;this.listenTo(this._targetView,"move",this._onMove)},_createDialog:function(){var D=this._figure.getHoverElement(),F=_.uniqueId("global-transition-dialog-"),B=this;function E(){return{fill:"#333333",stroke:"#333333"}}function C(I,H,G){var J=JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent;I.html(J({name:B.model.get("name"),statusName:B.model.get("target").get("name")}));G()}this._dialog=AJS.InlineDialog(D,F,C,{calculatePositions:JIRA.WorkflowDesigner.InlineDialogSVGPositioner.calculatePosition,getArrowAttributes:E,hideDelay:50,onHover:true})},_createFigure:function(){var B;B=this._figure=new JIRA.WorkflowDesigner.GlobalTransitionFigure();B.onDeselect=_.bind(this._onDeselect,this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this._immutable);this._immutable||(B.onDoubleClick=_.bind(this.edit,this));this._canvas.getLayer("global-transitions").addFigure(B);this._createDialog();this._positionFigure()},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditGlobalTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},_getFigure:function(){return this._figure},_onDeselect:function(){this._canvas.getLayer("global-transitions").addFigure(this._figure);this.trigger("deselected",this)},_onMove:function(){this._dialog&&this._dialog.hide();this._positionFigure()},_onSelect:function(){this._canvas.getLayer("selected-transition").addFigure(this._figure);this.trigger("selected",this)},_positionFigure:function(){var B=this._figure.getBoundingBox(),C=this._targetView.getBoundingBox();this._figure.setPosition(C.getRight()+2,C.getCenter().getY()-B.getHeight()/2)},render:function(){this._figure||this._createFigure();return this}}));Cocktail.mixin(JIRA.WorkflowDesigner.GlobalTransitionView,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/TransitionConnection.js' */
(function(){var A="#707070",D=30,C="#cccccc",E="#ffffff",F="#1a8cff",B="#f5f5f5";AJS.namespace("JIRA.WorkflowDesigner.TransitionConnection");JIRA.WorkflowDesigner.TransitionConnection=JIRA.WorkflowDesigner.Layout.Connection.GappedConnection.extend({init:function(G){var I,H;_.bindAll(this,"_onDoubleClick","_onMouseEnter","_onMouseLeave");this._isInitialTransition=G;if(G){this._super(0,3)}else{this._super(3,3)}I=new draw2d.decoration.connection.ArrowDecorator();I.onDoubleClick=this._onDoubleClick;I.setBackgroundColor(C);I.setColor(C);I.setDimension(7,7);H=this._label=new draw2d.shape.basic.Label();H.onDoubleClick=this._onDoubleClick;H.onMouseEnter=this._onMouseEnter;H.onMouseLeave=this._onMouseLeave;H.setBackgroundColor(E);H.setColor("#cccccc");H.setBold(true);H.setDraggable(false);H.setFontColor("#333333");H.setFontFamily("Arial");H.setFontSize(11);H.setPadding(2);H.setParent(this);H.setRadius(3);H.setSelectable(false);H.setStroke(0);this.setColor(C);this.setCoronaWidth(6);this.setDeleteable(false);this.setResizeable(false);this.setRouter(new JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter());this.setStroke(1);this.setTargetDecorator(I)},appearSelected:function(){this.setColor(F);this.targetDecoratorNode.attr({fill:"#ffffff",stroke:F}).insertAfter(this.shape);this._label.setBackgroundColor(B).setStroke(1)},highlight:function(){this.setColor(A);this.targetDecoratorNode.attr({fill:A,stroke:A}).insertAfter(this.shape)},_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_onMouseEnter:function(){this.onMouseEnter.apply(this,arguments)},_onMouseLeave:function(){this.onMouseLeave.apply(this,arguments)},positionArrow:function(){this.targetDecoratorNode.insertAfter(this.shape)},_positionLabel:function(){this._labelLocator||(this._labelLocator=new JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator(this,0.8));this._labelLocator.relocate(0,this._label)},select:function(){var G;this._super.apply(this,arguments);this.appearSelected();G=this.selectionHandles.get(0);this._isInitialTransition&&G.hide();G.sendToFront();this.selectionHandles.get(0).sendActionableAreaToFront();this.selectionHandles.get(1).sendActionableAreaToFront();return this},setCanvas:function(G){var H=G!==null,I=G===null;if(H){G.getLayer("transition-labels").addFigure(this._label)}else{if(I){this.canvas.removeFigure(this._label)}}this._super(G)},setText:function(G){this._label.setText(this._truncate(G));this._positionLabel()},_truncate:function(H){var G=this._getEllipsis();if(!H||H.length<=D){return H}return H.substring(0,D-G.length)+G},_getEllipsis:function(){return "\u2026"},setTextVisible:function(G){this._label.setVisible(G);this._positionLabel()},setSource:function(G){this._super(G);this._positionLabel()},setTarget:function(G){this._super(G);this._positionLabel()},textIsVisible:function(){return this._label.isVisible()},unhighlight:function(){this._label.setBackgroundColor(E).setStroke(0);this.setColor(C);this.targetDecoratorNode.attr({fill:C,stroke:C}).insertAfter(this.shape)},unselect:function(){this._super.apply(this,arguments);this.unhighlight();this._label.setBackgroundColor(E).setStroke(0);return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/TransitionView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);this._canvasModel=B.canvasModel;this._immutable=B.immutable;this._views=new JIRA.WorkflowDesigner.Collection();this._views.reset([B.sourceView,B.targetView]);this._workflowModel=B.workflowModel;this.listenTo(this._canvasModel,"change:showTransitionLabels",this._setTextVisibility);this.listenTo(this.model,"change:name",this.render);this.listenTo(this._views,{drag:this._onStatusDrag,dragEnd:this._onStatusDragEnd,highlight:this._onMouseEnter,unhighlight:this._onMouseLeave})},appearSelected:function(){this._canvas.getLayer("selected-transition").addFigure(this._connection);this._connection.appearSelected();this._connection.positionArrow();this.render()},_createConnection:function(){var B;B=new JIRA.WorkflowDesigner.TransitionConnection(this.isInitialTransition());B.onDeselect=_.bind(this._onDeselect,this);B.onMouseEnter=_.bind(this._onMouseEnter,this);B.onMouseLeave=_.bind(this._onMouseLeave,this);B.onReconnect=_.bind(this.trigger,this,"reconnect",this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this._immutable);if(!this._immutable){B.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.LineSelectionFeedbackPolicy());B.onDoubleClick=_.bind(this.edit,this)}this._canvas.getLayer("transitions").addFigure(B);this._connection=this._figure=B;this._setConnectionPorts();this._setTextVisibility()},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},getConnection:function(){return this._connection},_getFigure:function(){return this._connection},_getSourceAngle:function(){var C=this._getSourceView()===this._getTargetView(),B=this.model.get("sourceAngle");if(_.isNumber(B)){return B}else{if(C){return -90}else{return this._getSourceView().getAngleToStatus(this._getTargetView())}}},_getSourceView:function(){return this._views.at(0)},_getTargetAngle:function(){var C=this._getSourceView()===this._getTargetView(),B=this.model.get("targetAngle");if(_.isNumber(B)){return B}else{if(C){return 0}else{return this._getTargetView().getAngleToStatus(this._getSourceView())}}},_getTargetView:function(){return this._views.at(1)},_highlight:function(){this._canvas.getLayer("highlighted-transition").addFigure(this._connection);this._connection.highlight();this._highlighted=true;this.render()},isHighlighted:function(){return this._highlighted},isInitialTransition:function(){return this.model.get("source").get("initial")},_isSelected:function(){return this.requestResponse.request("isSelected",this)},_onDeselect:function(){this.trigger("deselected",this);this.unhighlight()},_onMouseEnter:function(){this._isSelected()||this._highlight()},_onMouseLeave:function(){var B=_.some(this._views.invoke("isSelected"));B||this._isSelected()||this.unhighlight()},_onSelect:function(){this.trigger("selected",this);this.appearSelected()},_onStatusDragEnd:function(){this._connection.setTextVisible(true)},_onStatusDrag:function(){this._connection.setTextVisible(false)},remove:function(){JIRA.WorkflowDesigner.Draw2DView.prototype.remove.apply(this,arguments);this._views.off({drag:this._onStatusDrag,dragEnd:this._onStatusDragEnd,highlight:this._onMousEnter,unhighlight:this._onMouseLeave})},render:function(){this._connection||this._createConnection();this._connection.setText(this.model.get("name"));this._setTextVisibility();return this},resetConnection:function(){this._canvas.removeFigure(this._connection);this._connection=null;this.render()},_setConnectionPorts:function(){var B=this._getSourceView().getPortForAngle(this._getSourceAngle()),C=this._getTargetView().getPortForAngle(this._getTargetAngle());this._connection.setSource(B);this._connection.setTarget(C);this.model.set({sourceAngle:this._getSourceView().getAngleToPort(B),targetAngle:this._getTargetView().getAngleToPort(C)})},_setTextVisibility:function(){var D=!!this.model.get("name"),B=this._canvasModel.get("showTransitionLabels"),C=D&&(B||this.isHighlighted()||this._isSelected());this._connection.setTextVisible(this.isInitialTransition()||C)},setViews:function(B,C){this._views.reset([B,C])},unhighlight:function(){this._canvas.getLayer("transitions").addFigure(this._connection);this._connection.unhighlight();this._highlighted=false;this.render()}}));Cocktail.mixin(JIRA.WorkflowDesigner.TransitionView,JIRA.WorkflowDesigner.RequestResponseMixin,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/TriangleFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.TriangleFigure");JIRA.WorkflowDesigner.TriangleFigure=draw2d.VectorFigure.extend({repaint:function(A){var B;if(this.shape===null){return }B=["M",this.getAbsoluteX(),this.getAbsoluteY()+this.getHeight()/2,"l",this.getWidth(),-(this.getHeight()/2),"l",0,this.getHeight(),"Z"].join(" ");this._super(_.extend({},A,{path:B}))},createShapeElement:function(){return this.canvas.paper.path("")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/WorkflowDesigner.js' */
(function(){_.extend(JIRA.WorkflowDesigner,{browserIsSupported:function(){return !(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)<9)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/views/dialogs/Dialog.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Dialog");JIRA.WorkflowDesigner.Dialog=JIRA.FormDialog.extend({init:function(A){_.bindAll(this,"_sizeAndPositionDialog");A=_.defaults({},A,{content:this.createDialogContent,isDraft:false,onContentRefresh:this._showWorkflowDesigner,widthClass:"large"});this.options=A;this.sizeAndPositionDialog=_.throttle(this._sizeAndPositionDialog,100);this._super(A);this.onContentReady(this._addLabelHint)},createDialogContent:function(A){A(JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog({title:_.result(this.options,"workflowId")}))},show:function(){this._super.apply(this,arguments);jQuery(window).on("resize",this.sizeAndPositionDialog)},hide:function(){this._designer&&this._designer.destroy();this._super.apply(this,arguments);jQuery(window).off("resize",this.sizeAndPositionDialog)},_sizeAndPositionDialog:function(){var A,B;if(JIRA.Dialog.current===this){B=JIRA.WorkflowDesigner.DialogSizeCalculator.calculateDialogSize(this);this.options.width=B.width;A=this.$popup.find(".form-body");A.css({height:B.height,maxHeight:""});this._positionInCenter()}},_showWorkflowDesigner:function(){this._sizeAndPositionDialog();this._designer=new JIRA.WorkflowDesigner.Application({actions:false,element:this.get$popup().find(".form-body"),immutable:true,draft:_.result(this.options,"isDraft"),layoutData:_.result(this.options,"layoutData"),workflowId:_.result(this.options,"workflowId"),currentStepId:_.result(this.options,"currentStepId")})},_addLabelHint:function(){this.getButtonsContainer().prepend(JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint())}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/util/DialogSizeCalculator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.DialogSizeCalculator");JIRA.WorkflowDesigner.DialogSizeCalculator={DISTANCE_FROM_EDGE:100,calculateDialogSize:function(B,A){this.dialog=B;A=_.defaults(A||{},{windowHeight:this._getWindowHeight(),windowWidth:this._getWindowWidth(),dialogHeaderHeight:this._getDialogHeaderHeight(),dialogFooterHeight:this._getDialogFooterHeight()});return{height:this._calculateDialogHeight(A.windowHeight,A.dialogHeaderHeight,A.dialogFooterHeight),width:this._calculateDialogWidth(A.windowWidth)}},_calculateDialogHeight:function(C,A,B){return C-A-B-(this.DISTANCE_FROM_EDGE*2)},_calculateDialogWidth:function(A){return A-(this.DISTANCE_FROM_EDGE*2)},_getWindowHeight:function(){return jQuery(window).height()},_getWindowWidth:function(){return jQuery(window).width()},_getDialogHeaderHeight:function(){return this.dialog.$popupHeading.outerHeight()},_getDialogFooterHeight:function(){return this.dialog.$buttonContainer.outerHeight()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'soy/Dialog.soy' */
// This file was automatically generated from Dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Dialog == 'undefined') { JIRA.WorkflowDesigner.Templates.Dialog = {}; }


JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container-left"><small>', soy.$$escapeHtml("Mouse over objects to see transition names."), '</small></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'js/views/ViewIssue.js' */
(function(){var F;var D;var E;var C;function B(H,G){var I=parseUri(H).queryKey[G];return decodeURIComponent(I.replace(/\+/g,"%20"))}function A(){var G;if(D){return jQuery.Deferred().resolve(D).promise()}else{G=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(C);G.done(function(I,H){D=H});return G}}AJS.namespace("JIRA.WorkflowDesigner.ViewIssue");JIRA.WorkflowDesigner.ViewIssue={replaceViewWorkflowLink:function(G){var H=JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink,J,I;G=jQuery(G);J=G.find(".issueaction-viewworkflow:not(.new-workflow-designer)");I=J.attr("href");if(J.length){F=parseInt(B(I,"stepId"),10);D=null;J.replaceWith(H({href:I}));C=B(I,"workflowName")}}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(H,G){if(JIRA.WorkflowDesigner.browserIsSupported()){JIRA.WorkflowDesigner.ViewIssue.replaceViewWorkflowLink(G)}});E=new JIRA.WorkflowDesigner.Dialog({content:function(I){var G=A();var H=this;G.done(function(){H.createDialogContent(I)});G.fail(function(J){JIRA.WorkflowDesigner.Messages.showErrorMessage(J);E.hide(true)})},id:"view-workflow-dialog",trigger:".issueaction-viewworkflow.new-workflow-designer",workflowId:function(){return C},currentStepId:function(){return F},layoutData:function(){return JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'soy/ViewIssue.soy' */
// This file was automatically generated from ViewIssue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.ViewIssue == 'undefined') { JIRA.WorkflowDesigner.Templates.ViewIssue = {}; }


JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issueaction-viewworkflow new-workflow-designer" href="', soy.$$escapeHtml(opt_data.href), '">', soy.$$escapeHtml("View Workflow"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jirafisheyeplugin:css', location = 'script/fisheye.js' */
AJS.$(function(){AJS.JFEP=AJS.JFEP||{};var a=function(b){AJS.$(".review-filter",b).live("change",function(d){var f=AJS.$(d.target).val(),c=AJS.$(d.target).is(":checked")?"block":"none";AJS.$(".review-status-"+f).css("display",c)});AJS.$(".tab-content",b).find(".project-activity:gt(0)").addClass("hidden");AJS.$("#activity-filter",b).live("change",function(c){var d=AJS.$("#activity-filter").val();AJS.$(".project-activity").addClass("hidden");AJS.$(".limit-"+d).removeClass("hidden")})};AJS.$("#preview-hide-tab",AJS.$(document)).live("click",function(b){AJS.$("#preview_form").submit();b.preventDefault()});if(JIRA.ViewIssueTabs){JIRA.ViewIssueTabs.onTabReady(a)}else{a(document)}AJS.JFEP.reviewIssueToggle=function(){AJS.$(".review-issue-target").addClass("hidden");AJS.$(".review-issue-trigger").click(function(c){c.preventDefault();var b=AJS.$(this).attr("href");AJS.$(b).toggleClass("hidden")})};AJS.JFEP.ignoreCookieName=function(){var b=AJS.$("#header-details-user-fullname").attr("data-username");if(!b){b="__ANON"}return"JFEP.ignoredAppLinks."+b};AJS.JFEP.ignoreAppLink=function(f){var e;var c=document.cookie;if(c.indexOf(AJS.JFEP.ignoreCookieName()+"=")>-1){var d=new RegExp(AJS.JFEP.ignoreCookieName()+"=([^;]*)");e=d.exec(c)[1]}else{e=""}if(e.indexOf(f)==-1){e+=(e.length>0?"|":"")+f;var b=new Date();b.setDate(b.getDate()+365);document.cookie=AJS.JFEP.ignoreCookieName()+"="+e+"; expires="+b.toUTCString()+"; path="+contextPath}};AJS.JFEP.clearIgnoredAppLinks=function(){var b=new Date();b.setDate(b.getDate()-5);document.cookie=AJS.JFEP.ignoreCookieName()+"=expired;expires="+b.toUTCString()+"; path="+contextPath};AJS.$(".ignore-applink").live("click",function(){var b=AJS.$(this).attr("data-id");AJS.JFEP.ignoreAppLink(b);AJS.$(this).parents(".credentials-required-message").slideUp()});AJS.$(".clear-ignored-applinks").live("click",function(){AJS.JFEP.clearIgnoredAppLinks();document.location.reload(true)});AJS.JFEP.loadMoreChangesets=function(c,b,d,e){jQuery("#more-changesets-action-spinner").show();jQuery("#more-changesets-blurb").hide();JIRA.SmartAjax.makeRequest({url:c+"/rest/tabs/1.0/more-changesets/"+b+d,type:"GET",dataType:"json",contentType:"application/json",complete:function(i,f,h){if(!h.successful){var g=(h.status!==401||h.statusText===JIRA.SmartAjax.SmartAjaxResult.TIMEOUT)?JSON.parse(h.data).errorMessages:JIRA.SmartAjax.buildSimpleErrorContent(h);jQuery(document).trigger(JIRA.SERVER_ERROR_EVENT,g)}else{e(h.data.changesets)}}})}});
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:css', location = 'templates/plugins/bamboo/script/common.js' */
(function(b,a){if(typeof a.CONFIG==="undefined"){a.CONFIG={$planSelect:b(),$buildTypes:b(),buildResultsContainerId:"bamboo-build-results",stagesContainerId:"bamboo-plan-stages",variablesContainerId:"bamboo-override-variables",initialised:false,updateTimeout:null,init:function(){if(a.CONFIG.initialised){return}b(document).bind("dialogContentReady",function(f){var d=a.CONFIG.buildResultsContainerId,c=a.CONFIG.stagesContainerId,g=a.CONFIG.variablesContainerId;a.CONFIG.$planSelect=b("#bamboo-plan").change(a.CONFIG.onPlanChange);a.CONFIG.BuildResults.init({container:{id:d,insertAfter:a.CONFIG.$planSelect.closest(".field-group")}});a.CONFIG.Stages.init({container:{id:c,insertAfter:"#"+d}});a.CONFIG.Variables.init({container:{id:g,insertAfter:"#"+c}});a.CONFIG.$buildTypes=b("input:radio[name='buildType']").change(a.CONFIG.onBuildTypeChange).filter(":checked").change().end()});a.CONFIG.initialised=true}};a.CONFIG.Spinner=function(c,d){this.beforeShow=d;this.add=function(){return b(bamboo.components.icon({type:"loading"})).appendTo(c)}};a.CONFIG.Spinner.prototype.show=function(){var c=this.$spinner;this.beforeShow();if(!c||(c&&(!c.length||!c.parent().length))){this.$spinner=this.add()}else{c.show()}return this};a.CONFIG.Spinner.prototype.hide=function(){this.$spinner.hide();return this}}a.CONFIG.onPlanChange=function(j){var f=b("#existing-build").is(":checked"),i=b(this),d=i.add(a.CONFIG.$buildTypes).attr("disabled",true),m=i.find("option:selected"),h=(f?m.attr("data-selected-build-result"):null),n=(f?null:m.attr("data-selected-stages")),k=(f?null:m.attr("data-selected-variables")),l,g,c;if(k){k=b.parseJSON(k)}a.CONFIG.BuildResults.updateSelectedBuildResult(h);a.CONFIG.Stages.updateSelectedStages(n);a.CONFIG.Variables.updateSelectedVariables(k);a.CONFIG.Variables.hide();if(f){a.CONFIG.Stages.hide();a.CONFIG.BuildResults.showSpinner();l=a.restURL+"history/"+a.jiraProjectKey+"/"+i.val()+"/5";g={continuable:true,buildstate:"successful"};c=function(e){if(e.results.result&&e.results.result.length){a.CONFIG.BuildResults.show(e.results.result)}else{a.CONFIG.BuildResults.showNoResultsMsg()}d.attr("disabled",false)}}else{a.CONFIG.BuildResults.hide();a.CONFIG.Stages.showSpinner();l=a.restURL+"plan/"+a.jiraProjectKey+"/"+i.val();c=function(e){if(e.stages.stage&&e.stages.stage.length){a.CONFIG.Stages.show(e.stages.stage)}else{a.CONFIG.Stages.showNoStagesMsg()}if(e.variableContext.variable&&e.variableContext.variable.length){a.CONFIG.Variables.show(e.variableContext.variable)}d.attr("disabled",false)}}b.ajax({url:l,dataType:"json",data:g,beforeSend:function(){i.attr("disabled","true")},success:c,error:function(u,v){var q,t,o,p,r=b('<div class="form-body"></div><div class="form-footer"><a class="cancel">Cancel</a></div>');r.find(".cancel").click(function(w){if(a.CONFIG.FormDialog&&a.CONFIG.FormDialog.hide){a.CONFIG.FormDialog.hide()}});try{p=u.responseText||u.response;if(p){q=b.parseJSON(p);t=q.message;o=(q.messageBody?"<p>"+q.messageBody+"</p>":null);if(q.oauthCallback){r.filter(".content-footer").prepend('<a href="'+q.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a> | ')}}else{throw"noJSONResponse"}}catch(s){t="An error occurred while trying to retrieve the build information."}AJS.messages.warning(r.filter(".form-body"),{title:t,body:o,closeable:false});i.closest("form").replaceWith(r)},ajaxComplete:function(){i.attr("disabled","false")}})};a.CONFIG.onBuildTypeChange=function(g){var c=b(this),f=c.closest("fieldset.group"),d=f.nextAll(".field-group,.group"),h=b("#"+a.CONFIG.buildResultsContainerId);switch(c.val()){case"no-build":d.hide();f.css({"margin-bottom":0,"padding-bottom":0});break;case"new-build":d.show();h.hide();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break;case"existing-build":d.show();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break}};a.CONFIG.Stages=(function(){var d={container:{id:null,insertAfter:null,i18n:{legend:"Stages"}},selectedStages:null},k,j,f,g=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:f}).insertAfter(k.container.insertAfter).delegate("input:checkbox","click",h)},c=function(m){var l=false,v,o,x;for(o=0,x=m.length;o<x;o++){var q=m[o],r=!!(q.state&&q.state!="Unknown"),w=!!(q.manual),n=!!(!q.manual||r),p,t,u="stage-"+o,s;if(!l&&q.manual&&!r){l=true}t=b('<input type="checkbox" />').attr({name:"selectedStages",id:u,"class":"checkbox",checked:w,disabled:n}).val(q.name);s=b("<label />",{text:q.name,"for":u});p=b("<div/>",{"class":"checkbox"+(q.manual?(r?" already-run":" manual"):"")+(!l?" selected":"")}).append(t).append(s).appendTo(j);if(!r&&w){v=p}}if(v){v.find("input:checkbox").trigger("click",true)}},e=function(){j.find("div.checkbox,p").remove()},h=function(p,l){if(l){p.preventDefault()}var m=b(this),o=m.is(":checked"),n=false;m.closest("div.checkbox").toggleClass("selected",o).prevAll("div.checkbox").each(function(s){var r=b(this),t=r.children("input:checkbox"),q=r.hasClass("manual");if(o){r.addClass("selected");if(q){t.attr("checked","checked").attr("disabled","disabled")}}else{if(q&&!n){t.removeAttr("disabled");n=true}}}).end().nextAll("div.checkbox").each(function(r){var q=b(this);if(q.hasClass("manual")){return false}else{q.toggleClass("selected",o)}})},i;return{init:function(l){k=b.extend(true,d,l);f="<legend><span>"+k.container.i18n.legend+"</span></legend>";g();i=new a.CONFIG.Spinner(j,e)},show:function(l){j.html(f).show();c(l)},hide:function(){j.hide().html(f)},showNoStagesMsg:function(){i.hide();j.append(b("<p/>",{text:"No stages found."}))},showSpinner:function(){i.show()},updateSelectedStages:function(l){k.selectedStages=l}}})();a.CONFIG.Variables=(function(){var c={container:{id:null,insertAfter:null,i18n:{legend:"Build Variables"}},selectedVariables:null},l,j,k,g,h=function(){j=b("<fieldset/>",{id:l.container.id,"class":"group",html:g}).insertAfter(l.container.insertAfter).delegate("#override-another","click",i).delegate(".bamboo-icon-variable-delete","click",f).delegate("select","change",e)},d=function(r){var m,q,o,p;k=b("<select/>",{"class":"select"});for(o=0,p=r.length;o<p;o++){var n=r[o];if(m!=n.variableType){m=n.variableType;q=b("<optgroup/>",{label:m}).appendTo(k)}b("<option/>",{text:n.key,data:{"server-value":n.value}}).appendTo(q)}},i=function(){var n=k.clone(true),o,p,q,m="";if(arguments.length==2){p=n.find("option[text='"+arguments[0]+"']");m=arguments[1]}else{p=n.find("option:first")}p.attr("selected","selected");q=b('<input type="text" />').attr({name:"variable_"+p.val(),placeholder:p.data("server-value"),"class":"text medium-field"}).val(m);o=b("<div/>",{"class":"field-group"}).append(n).append(q).append(bamboo.components.icon({type:"variable-delete"})).insertBefore(j.children("a"))},f=function(m){b(this).closest(".field-group").remove()},e=function(o){var m=b(this),n=m.find("option:selected");m.nextAll(".text").attr({name:"variable_"+n.val(),placeholder:n.data("server-value")})};return{init:function(m){l=b.extend(true,c,m);g="<legend><span>"+l.container.i18n.legend+'</span></legend><a id="override-another" class="aui-button aui-button-link">Override variable<span class="icon icon-edit-sml"></span></a>';h()},show:function(m){d(m);if(l.selectedVariables&&l.selectedVariables.variables){b.each(l.selectedVariables.variables,i)}j.show()},hide:function(){j.hide().html(g)},updateSelectedVariables:function(m){l.selectedVariables=m}}})();a.CONFIG.BuildResults=(function(){var e={container:{id:null,insertAfter:null,i18n:{legend:"Existing build"}},selectedBuildResult:null},k,j,g,h=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:g}).insertAfter(k.container.insertAfter).delegate("input:radio","change",f).delegate("a","click",function(l){l.preventDefault();window.open(this.href)})},d=function(p){var o,q,n="build-result-"+p.number,l,m=(p.lifeCycleState=="Finished"?(p.continuable?"SuccessfulPartial":p.state):p.lifeCycleState);q=b('<input type="radio" />').attr({name:"buildResult",id:n,"class":"radio",checked:(p.key==k.selectedBuildResult)}).val(p.key).data("stages",(p.stages.stage&&p.stages.stage.length?p.stages.stage:[]));l=b("<label />",{html:'<a href="'+a.bambooBaseURL+"/browse/"+p.key+'" class="'+m+'">#'+p.number+'</a><span class="trigger-reason">'+a.replaceWithBambooIcon(p.buildReason)+"</span>","for":n}).prepend(bamboo.components.icon({type:m}));o=b("<div/>",{"class":"radio"}).append(q).append(l).appendTo(j)},c=function(){j.find("div.radio,p").remove()},f=function(l){var m=b(this).data("stages");if(m&&m.length){a.CONFIG.Stages.show(m)}else{a.CONFIG.Stages.showNoStagesMsg()}},i;return{init:function(l){k=b.extend(true,e,l);g="<legend><span>"+k.container.i18n.legend+"</span></legend>";h();i=new a.CONFIG.Spinner(j,c)},show:function(n){j.html(g).show();for(var l=0,m=n.length;l<m;l++){d(n[l])}},hide:function(){j.hide().html(g)},showNoResultsMsg:function(){i.hide();j.append(b("<p/>",{text:"No builds found with unbuilt manual stages."})).show()},showSpinner:function(){i.show()},updateSelectedBuildResult:function(l){k.selectedBuildResult=l}}})();a.CheckReleaseBuildStatus=function(d,c){b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+d,dataType:"json",success:function(h){var f=h.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),e;if((f.lifeCycleState!="InProgress"&&f.lifeCycleState!="Queued")||(h.jira&&h.jira.forceRefresh)){AJS.reloadViaWindowLocation()}else{if(f.lifeCycleState=="InProgress"&&f.progress){if(!c){e=b("#build-details");c=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(e).find("dd");e.find(".build + dd > span.bamboo-icon").replaceWith(bamboo.components.icon({type:g}))}else{c.html(f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>")}}}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(d,c)},5000)},error:function(l,m){var i,k,g,h,f=b("#build-details").empty();try{h=l.responseText||l.response;if(h){i=b.parseJSON(h);k=i.message;g=(i.messageBody?"<p>"+i.messageBody+"</p>":"");if(i.oauthCallback){g+='<p><a href="'+i.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(j){k="An error occurred while trying to retrieve the build information."}AJS.messages.warning(f,{title:k,body:g,closeable:false})}})};a.ShowBuildReleaseDetails=function(e){var d=b("#build-details"),c=b(bamboo.components.icon({type:"loading"}));if(d.length){c.appendTo(d);b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+e,dataType:"json",success:function(i){var f=i.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),h;if(i.jira&&i.jira.forceRefresh){AJS.reloadViaWindowLocation()}c.remove();d.append(bamboo.components.buildDetail({key:"Build",keyClass:"build",value:bamboo.components.icon({type:g})+' <a href="'+a.bambooBaseURL+"/browse/"+e+'"><span class="'+g+'">#'+f.number+"</span> "+f.planName+"</a>"}));d.append(bamboo.components.buildDetail({key:"Trigger",keyClass:"trigger",value:a.replaceWithBambooIcon(f.buildReason)}));if(f.vcsRevisionKey){d.append(bamboo.components.buildDetail({key:"Revision",keyClass:"revision",value:f.vcsRevisionKey}))}if(f.labels.label&&f.labels.label.length){d.append(bamboo.components.buildDetail({key:"Labels",keyClass:"labels",value:bamboo.components.labels({baseBambooUrl:a.bambooBaseURL,labels:f.labels.label})}))}if(f.lifeCycleState=="InProgress"||f.lifeCycleState=="Queued"){if(f.lifeCycleState=="InProgress"&&f.progress){h=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(d).find("dd")}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(e,h)},5000)}else{if(f.lifeCycleState=="Finished"){if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}if(f.buildDuration){d.append(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.buildDurationDescription}))}}else{if(f.lifeCycleState=="NotBuilt"){if(f.buildStartedTime){d.append(bamboo.components.buildDetail({key:"Started",keyClass:"started",value:'<time datetime="'+f.buildStartedTime+'">'+f.prettyBuildStartedTime+"</time>"}))}if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}d.append(bamboo.components.buildDetail({key:"Status",keyClass:"status",value:(f.buildStartedTime&&!f.buildCompletedTime?"Reason for not completing is unknown":"Reason for not building is unknown")}))}}}if(f.artifacts.artifact&&f.artifacts.artifact.length){d.append(bamboo.components.buildDetail({key:"Artifacts",keyClass:"artifacts",value:bamboo.components.artifacts({artifacts:f.artifacts.artifact})}))}},error:function(k,l){var h,j,f,g;c.remove();try{g=k.responseText||k.response;if(g){h=b.parseJSON(g);j=h.message;f=(h.messageBody?"<p>"+h.messageBody+"</p>":"");if(h.oauthCallback){f+='<p><a href="'+h.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(i){j="An error occurred while trying to retrieve the build information."}AJS.messages.warning(d,{title:j,body:f,closeable:false})}})}};a.replaceWithBambooIcon=function(c){return c.replace(/(\b)icon(\b)/g,"$1bamboo-icon$2")};a.init=function(d){a.CONFIG.init();var c=b("#runRelease",d);if(c.length){a.CONFIG.FormDialog=new JIRA.FormDialog({trigger:c,widthClass:"large",autoClose:true});if(/showReleaseDialog=true/.test(window.location.href)){c.click()}}};b(function(){a.init(AJS.$(document))});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,c,d){if(d===JIRA.CONTENT_ADDED_REASON.tabUpdated){a.init(c)}})}(AJS.$,window.JBAM=(window.JBAM||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/backbone-brace/backbone.brace.min.js' */
//     Backbone Brace - 2012/10/29
//     Copyright 2012 Atlassian Software Systems Pty Ltd
//     Licensed under the Apache License, Version 2.0
(function(){function i(e){return n.isArray(e)?n.reduce(e,function(e,t){return e[t]=null,e},{}):e}function s(e,t){if(!e||t==null)return t;if(typeof e=="string"||e instanceof String){if(typeof t!=""+e)throw"The typeof "+t+" is "+typeof t+" but expected it to be "+e;return t}if(n.isArray(e)||e===Array){if(!u(t))throw"Array type expected, but nonnull, non-Array value provided.";return e===Array||!e[0]?t:n.map(t,n.bind(s,null,e[0]))}if(typeof e!="function")throw"Invalid expected type "+e+". Should be falsy, String, Array, Backbone.Collection constructor, or function.";return t instanceof e?t:o(e)?new e(s([e.model],t)):new e(t)}function o(e,t){return e&&(e.__super__ instanceof(t||r.Collection)||e.__super__===(t||r.Collection).prototype||e===(t||r.Collection))}function u(e){return n.has(e,"length")&&!(e instanceof String||n.has({string:1,"function":1},typeof e)||e instanceof r.Collection)}function a(e,t){var r={};return n.each(e,function(e,n){if(!!t[n]&&!f(e,t[n])){if(!e||f(t[n],e))return;throw n+" has conflicted type descriptors."}r[n]=e}),r}function f(e,t){return!t||t===e?!0:!e||typeof e=="string"?!1:e instanceof Array?t===Array||t instanceof Array&&f(e[0],t[0]):typeof t!="function"?!1:o(t)?o(e,t):e.prototype instanceof t}function l(e){return n.isObject(e)?n.reduce(e,function(e,t,r){return t&&n.isFunction(t.toJSON)?e[r]=t.toJSON():n.isArray(t)&&(e[r]=n.map(t,function(e){return e&&n.isFunction(e.toJSON)?e.toJSON():e})),e},e):e}function c(e){return function(){var n=e.call(this);return l(n)}}function h(e){return function r(s,o){var u,a=n.extend({},s),f;return s&&s.mixins&&(f=s.mixins,delete a.mixins),u=e.call(this,a,o),this.prototype.namedEvents&&t.Mixins.applyMixin(u,{namedEvents:this.prototype.namedEvents}),this.prototype.namedAttributes&&t.Mixins.applyMixin(u,{namedAttributes:this.prototype.namedAttributes}),f&&n.each(s.mixins,function(e){t.Mixins.applyMixin(u,e)}),u.prototype.namedEvents&&t.Mixins.applyMixin(u,t.EventsMixinCreator.create(u.prototype.namedEvents)),u.prototype.namedAttributes&&(u.prototype.namedAttributes=i(u.prototype.namedAttributes),t.Mixins.applyMixin(u,t.AttributesMixinCreator.create(u.prototype.namedAttributes))),u.prototype.toJSON&&(u.prototype.toJSON=c(u.prototype.toJSON)),u.extend=r,u}}function p(e,t){var r=e.prototype,i=t.prototype,o=r.set;i.set=function(e,t,r){var i,u=this.namedAttributes;if(!u||e==null)return o.apply(this,arguments);n.isObject(e)?(i=n.clone(e),r=t):(i={},i[e]=t);for(var a in i){if(!n.has(i,a))continue;if(!n.has(u,a))throw"Attribute '"+a+"' does not exist";i[a]=s(u[a],i[a])}return o.call(this,i,r)};var u=r.get;i.get=function(e){if(this.namedAttributes&&!n.has(this.namedAttributes,e))throw"Attribute '"+e+"' does not exist";return u.apply(this,arguments)}}function d(e){var t=e.extend(),n=e.extend;return t.extend=h(n),t}function v(e){var t=d(e);return p(e,t),t}var e=this,t;typeof exports!="undefined"?t=exports:t=e.Brace={};var n=e._;!n&&typeof require!="undefined"&&(n=require("underscore"));var r=e.Backbone;!r&&typeof require!="undefined"&&(r=require("backbone")),t.Mixins={createMethodName:function(e,t){return e+t.charAt(0).toUpperCase()+t.substr(1)},applyMixin:function(e,t){n.forEach(n.keys(t),function(r){var s=e.prototype;if("initialize"===r){var o=s.initialize;s.initialize=function(){o&&o.apply(this,arguments),t.initialize.apply(this,arguments)};return}if("validate"===r){var u=s.validate;s.validate=function(){if(u){var e=u.apply(this,arguments);if(e)return e}return t.validate.apply(this,arguments)};return}if("defaults"===r){var f=s.defaults||(s.defaults={}),l=t[r];for(var c in l){if(f.hasOwnProperty(c))throw"Mixin error: class already has default '"+c+"' defined";f[c]=l[c]}return}if("namedAttributes"===r){var h=i(s.namedAttributes)||{},p=i(t[r]);s.namedAttributes=n.extend(h,a(p,h));return}if("namedEvents"===r){if(!n.isArray(t[r]))throw"Expects events member on mixin to be an array";s.namedEvents||(s.namedEvents=[]),s.namedEvents=n.uniq(s.namedEvents.concat(t[r]));return}if(s.hasOwnProperty(r))throw"Mixin error: class already has property '"+r+"' defined";s[r]=t[r]},this)}},t.AttributesMixinCreator={create:function(e){var r={};return e||(e={}),n.has(e,"id")||(e.id=null),n.each(e,function(e,n){var i=t.Mixins.createMethodName("set",n);r[i]=function(e,t){return this.set(n,e,t)};var s=t.Mixins.createMethodName("get",n);r[s]=function(){return this.get(n)}}),r},ensureType:s},t.EventsMixinCreator={create:function(e){var r={},i=function(e){var i=t.Mixins.createMethodName("on",e);r[i]=function(){return this.on.apply(this,[e].concat(n.toArray(arguments)))};var s=t.Mixins.createMethodName("trigger",e);r[s]=function(){return this.trigger.apply(this,[e].concat(n.toArray(arguments)))}};return n.each(e,n.bind(i,this)),r}},t.Model=v(r.Model),t.Collection=d(r.Collection),t.View=d(r.View),t.Router=d(r.Router)})();
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/deployments.js' */
(function(c,b){b.Model={};b.Model.DeploymentProject=Brace.Model.extend({namedAttributes:{name:"string",bambooId:"number",url:"string",environmentCount:"number",upToDateEnvironmentCount:"number",applinkId:"string"}});b.Model.Version=Brace.Model.extend({namedAttributes:{name:"string",id:"number",url:"string"}});b.Model.Environment=Brace.Model.extend({namedAttributes:{name:"string",id:"number",issueStatus:"string",statusOk:"boolean",url:"string",version:b.Model.Version}});b.Model.IssueDeploymentStatus=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProject:b.Model.DeploymentProject,versions:Brace.Collection.extend({model:b.Model.Version}),environments:Brace.Collection.extend({model:b.Model.Environment})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.Model.ErrorMessage=Brace.Model.extend({namedAttributes:{message:"string",messageBody:"string"}});b.Model.OauthCallback=Brace.Model.extend({namedAttributes:{oauthCallback:"string",serverName:"string"}});b.Model.RelatedDeploymentProjects=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProjects:Brace.Collection.extend({model:b.Model.DeploymentProject}),errorMessages:Brace.Collection.extend({model:b.Model.ErrorMessage}),oauthCallbacks:Brace.Collection.extend({model:b.Model.OauthCallback})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.IssueDeploymentStatus={};b.IssueDeploymentStatus.View=Brace.View.extend({oAuthDanceReturnUrl:"",initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.model=new b.Model.IssueDeploymentStatus(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){this.$el.html(bamboo.deployments.issueDetailsDialogContent({data:this.model.toJSON()}));return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.removeSpinner,this)).fail(_.bind(this.clearError,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){a(d,f,e,this.$el)},clearError:function(){this.$el.children(".aui-message").remove()},removeSpinner:function(){this.$el.children(".bamboo-icon-loading").remove()}});b.RelatedDeploymentProjects={};b.RelatedDeploymentProjects.PopupDialog=b.RelatedDeploymentProjects.PopupDialog||new JIRA.FormDialog({trigger:".bamboo-deployments-details-link",width:640,autoClose:true});b.RelatedDeploymentProjects.View=Brace.View.extend({initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.issueId=d.issueId||"";this.selector=d.el;this.model=new b.Model.RelatedDeploymentProjects(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){c(this.selector).html(bamboo.deployments.issuePanelContent({data:this.model.toJSON(),issueId:this.issueId,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}));return this.showPanelIfNotEmpty()},showPanelIfNotEmpty:function(){if(!c(this.selector).is(":empty")){c("#bamboo-deployment-projects-right").show()}else{c("#bamboo-deployment-projects-right").hide()}return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){c(this.selector).children(".aui-message").remove();a(d,f,e,c(this.selector))}});function a(h,l,j,g){var f,k,d;try{d=h.responseText||h.response;if(d){f=c.parseJSON(d);g.append(bamboo.components.errorResponseMessage({errorMessage:f,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}))}else{k="Unknown error: no response from server"}}catch(i){k="An error occurred while trying to retrieve the deployment project information."}if(k){AJS.messages.warning(g,{title:k,closeable:false})}c("#bamboo-deployment-projects-right").show()}}(AJS.$,window.JBAM_DEPLOYMENT=(window.JBAM_DEPLOYMENT||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/deployments/deployments.soy' */
// This file was automatically generated from deployments.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.deployments == 'undefined') { bamboo.deployments = {}; }


bamboo.deployments.issueDetailsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Issue deployment details"), '</h2><div id=\'bamboo-deployments-issue-status-container\'><span class="bamboo-icon bamboo-icon-loading" title="loading"><span> </span></span></div><script>new JBAM_DEPLOYMENT.IssueDeploymentStatus.View({el: \'#bamboo-deployments-issue-status-container\', fetchUrl: \'', soy.$$escapeHtml("/jira" + '/rest/bamboo/latest/deploy/' + opt_data.issueKey + '/' + opt_data.applinkId + '/' + opt_data.deploymentProjectId), '\', oAuthDanceReturnUrl: \'', soy.$$escapeHtml(opt_data.returnUrl), '\'});<\/script>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issuePanelContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.data.deploymentProjects) {
    output.append('<ul class=\'property-list\'>');
    var deploymentProjectList14 = opt_data.data.deploymentProjects;
    var deploymentProjectListLen14 = deploymentProjectList14.length;
    for (var deploymentProjectIndex14 = 0; deploymentProjectIndex14 < deploymentProjectListLen14; deploymentProjectIndex14++) {
      var deploymentProjectData14 = deploymentProjectList14[deploymentProjectIndex14];
      output.append('<li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml(deploymentProjectData14.name), '</strong><span class=\'value\'>', (deploymentProjectData14.environmentCount == 0) ? '<span class="aui-icon aui-icon-info"> </span> ' + soy.$$escapeHtml("No environments defined") : (deploymentProjectData14.upToDateEnvironmentCount == 0) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml("None of the environments have all related commits.") : (deploymentProjectData14.environmentCount > deploymentProjectData14.upToDateEnvironmentCount) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml(AJS.format("{0} of {1} environments don\x27\x27t have all related commits.",deploymentProjectData14.environmentCount - deploymentProjectData14.upToDateEnvironmentCount,deploymentProjectData14.environmentCount)) : '<span class="aui-icon aui-icon-success"> </span> ' + soy.$$escapeHtml("All environments have all related commits."), ' <a id="bamboo-deployment-details_', soy.$$escapeHtml(deploymentProjectData14.bambooId), '" class="bamboo-deployments-details-link" href="', soy.$$escapeHtml("/jira"), '/secure/ViewIssueDeploymentStatus.jspa?id=', soy.$$escapeHtml(opt_data.issueId), '&deploymentProjectId=', soy.$$escapeHtml(deploymentProjectData14.bambooId), '&applicationLinkId=', soy.$$escapeHtml(deploymentProjectData14.applinkId), '">', "Details\x26hellip;", '</a></span></div></li>');
    }
    output.append('</ul>');
  }
  if (opt_data.data.errorMessages) {
    var errorMessageList49 = opt_data.data.errorMessages;
    var errorMessageListLen49 = errorMessageList49.length;
    for (var errorMessageIndex49 = 0; errorMessageIndex49 < errorMessageListLen49; errorMessageIndex49++) {
      var errorMessageData49 = errorMessageList49[errorMessageIndex49];
      bamboo.components.errorResponseMessage({errorMessage: errorMessageData49, oAuthDanceReturnUrl: opt_data.oAuthDanceReturnUrl}, output);
    }
  }
  if (opt_data.data.oauthCallbacks && opt_data.data.oauthCallbacks.length) {
    output.append('<div class="aui-message no-border no-background"><span class="aui-icon icon-warning"></span> ', soy.$$escapeHtml("For more deployment information, you need to log in to and approve the following servers:"), '<ul>');
    var oauthCallbackList59 = opt_data.data.oauthCallbacks;
    var oauthCallbackListLen59 = oauthCallbackList59.length;
    for (var oauthCallbackIndex59 = 0; oauthCallbackIndex59 < oauthCallbackListLen59; oauthCallbackIndex59++) {
      var oauthCallbackData59 = oauthCallbackList59[oauthCallbackIndex59];
      output.append('<li><a href="', oauthCallbackData59.oauthCallback, '&amp;redirectUrl=', opt_data.oAuthDanceReturnUrl, '">', soy.$$escapeHtml(oauthCallbackData59.serverName), '</a></li>');
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueDetailsDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Bamboo releases with related commits"), '</h3><ul class=\'property-list\'><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Deployment project"), '</strong><span class=\'value\'>');
  bamboo.deployments.itemLink({item: opt_data.data.deploymentProject}, output);
  output.append('</span></div></li><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Releases with commits"), '</strong><span class=\'value\'>');
  var versionList82 = opt_data.data.versions;
  var versionListLen82 = versionList82.length;
  if (versionListLen82 > 0) {
    for (var versionIndex82 = 0; versionIndex82 < versionListLen82; versionIndex82++) {
      var versionData82 = versionList82[versionIndex82];
      bamboo.deployments.itemLink({item: versionData82}, output);
      output.append((! (versionIndex82 == versionListLen82 - 1)) ? ', ' : '');
    }
  } else {
    output.append(soy.$$escapeHtml("No related releases found"));
  }
  output.append('</span></div></li></ul>');
  bamboo.deployments.environmentsTable({environments: opt_data.data.environments}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.environmentsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Issue availability across environments"), '</h3>');
  if (opt_data.environments.length > 0) {
    output.append('<table width=\'100%\' class=\'aui\'><colgroup><col width=\'45%\'><col width=\'30%\'><col width=\'25%\'></colgroup><thead><tr><th>', soy.$$escapeHtml("Environment"), '</th><th>', soy.$$escapeHtml("Issue availability"), '</th><th>', soy.$$escapeHtml("Current release"), '</th></tr></thead><tbody>');
    var environmentList107 = opt_data.environments;
    var environmentListLen107 = environmentList107.length;
    for (var environmentIndex107 = 0; environmentIndex107 < environmentListLen107; environmentIndex107++) {
      var environmentData107 = environmentList107[environmentIndex107];
      output.append('<tr><td>');
      bamboo.deployments.itemLink({item: environmentData107}, output);
      output.append((! environmentData107.statusOk) ? ' <span class="aui-icon aui-icon-error">Error</span>' : '', '</td><td>');
      bamboo.deployments.issueAvailabilityLozenge({issueStatus: environmentData107.issueStatus}, output);
      output.append('</td><td>');
      if (environmentData107.version) {
        bamboo.deployments.itemLink({item: environmentData107.version}, output);
      } else {
        output.append('<em>', soy.$$escapeHtml("Never deployed"), '</em>');
      }
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<p>', soy.$$escapeHtml("No environments defined"), '</p>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueAvailabilityLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.issueStatus == 'AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-success">' + soy.$$escapeHtml("deployed") + '</span>' : (opt_data.issueStatus == 'PARTIALLY_AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-current">' + soy.$$escapeHtml("partly deployed") + '</span>' : '<span class="aui-lozenge">' + soy.$$escapeHtml("not deployed") + '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.itemLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.item.url) ? '<a href="' + opt_data.item.url + '">' + soy.$$escapeHtml(opt_data.item.name) + '</a>' : soy.$$escapeHtml(opt_data.item.name));
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){AJS.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a="gh.analytics.async";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};
/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/ui/help/HelpAnalytics.js' */
AJS.$(function(){var a=function(c){if(GH&&GH.AnalyticsTracker){return new GH.AnalyticsTracker(c).setAsync(false)}else{return{trigger:function(){}}}};AJS.$("#gh_view_help").click(function(c){a("gh.gethelp").trigger("usermenu","docs");return b(AJS.$(this))});AJS.$("#gh_view_agile_answers").click(function(c){a("gh.gethelp").trigger("usermenu","answers");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement").click(function(c){a("gh.myjirahome").trigger("usermenu","enabled");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-disablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","disable");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-set").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#beta_gh\\.configuration\\.rapid\\.removal").click(function(f){var c=AJS.$(this),d=c.attr("checked")?"on":"off";a("gh.labs.feature").trigger("rapid_removal",d);return true});AJS.$(document).delegate("#js-classic-link_lnk","click",function(c){a("gh.agile.menu").trigger("classic");return true});var b=function(c){if(c.attr("target")=="_blank"){return true}else{setTimeout('document.location = "'+c.attr("href")+'"',100);return false}}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/Analytics.js' */
if(typeof GH==="undefined"){window.GH={}}(function(c,g,e,d){d.AnalyticsEnabled=true;var b="gh.analytics.async";function f(){g(document).on(b,function(i,h){a(h)})}function a(i){var j={};var h=i.category;if(!e.isUndefined(i.action)){h=h+"."+i.action}if(!e.isUndefined(i.label)){j.label=i.label}if(!e.isUndefined(i.value)){j.value=i.value}c.trigger("analytics",{name:h,data:j})}f()})(AJS,AJS.$,_,GH);
/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:function(){return JIRA.Dialogs.getDefaultAjaxOptions.apply(this,arguments)}});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function k(u,p,r){u=soy.$$escapeHtml(u);p=soy.$$escapeHtml(p);r=soy.$$escapeHtml(r);var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(e){var m={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var i=10;var k,n;var s=e.element.data("saved-state"),r=e.element.data("saved-id");var g,p=this;var d=AJS.SelectSuggestHandler.extend({formatSuggestions:function(v,w){v=this._super(v,w);if(w.length===0){v[v.length-1].footerText("Start typing for sprints.")}return v}});AJS.$.extend(e,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:i,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:t}});o();function h(w){var v=k.apply(this,arguments);v.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(w.properties));return v}function u(x){var w=this.getSelectedDescriptor(),v;if(!x&&!w){b(null)}j();this.hideErrorMessage();if(!w){v=c(x)}else{v=q(w)}if(v.message){this.options.errorMessage=v.message;n.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(v.needsScopeChangeWarning){l()}}function c(x){var w=null,v=false;if(x&&x.length>0){if(s){w=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",x);if(s===m.ACTIVE){v=true}}else{w=AJS.format("{0} is not a valid sprint name.",x)}}else{if(s===m.ACTIVE){v=true}}return{message:w,needsScopeChangeWarning:v}}function q(w){var v=false;if(s===m.ACTIVE){if(r!=w.properties.value){v=true}}else{if(s===m.FUTURE){if(w.properties.stateKey===m.ACTIVE){v=true}}else{if(!s){if(w.properties.stateKey===m.ACTIVE){v=true}}}}return{message:null,needsScopeChangeWarning:v}}function l(){if(!g){g=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var v=p.$container.closest(".inline-edit-fields");if(v.size()>0){v.closest(".editable-field").append(g)}else{p.$container.closest(".field-group").append(g)}}g.show()}function j(){if(g){g.remove();g=null}}function t(v){if(!v.suggestions&&!v.allMatches){return[]}var x=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var w=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(v.suggestions),function(y){x.addItem(f(y,true))});_.each(a(v.allMatches),function(y){w.addItem(f(y,false))});return[x,w]}function f(x,w){var v=soy.$$escapeHtml(x.name);return new AJS.ItemDescriptor({value:x.id.toString(),label:x.name,html:v,stateKey:x.stateKey,boardName:x.boardName,allowDuplicate:false,isSuggestion:w})}function a(v){return _.sortBy(v,function(w){return w.name.toLowerCase()})}function b(v){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:r,updated:v?v.properties.value:null}})}}function o(){p._super(e);k=p.listController._renders.suggestion;n=p.showErrorMessage;p.listController._renders.suggestion=h;p.showErrorMessage=u;e.element.bind("selected",function(x,w,v){v.showErrorMessage(v.getQueryVal());b(w)});p.suggestionsHandler=new d(p.options,p.model)}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});AJS.$(".ghx-feedback").css({visibility:"hidden"});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}AJS.$(".ghx-feedback").css({visibility:""})};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.js' */

/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.soy' */

/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplates.soy' */
// This file was automatically generated from ProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Constrain work-in-progress and manage your task flow.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Manage your product development with backlogs, stories, and sprints.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Track development tasks and bugs. Optionally connect your source and build managers.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.infoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-info workflow-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}},generateApplinksAdminUrl:function(d,c,a){var b=d+"/plugins/servlet/applinks/listApplicationLinks";if(c==="confluence"){b=d+"/admin/listapplicationlinks.action"}return AppLinks.Urls.generateUrl(b,a)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
/**
 * Initialises anything requiring OAuth authentication. Requires the following elements:
 * <div class="issue-link-applinks-authentication-message"></div>
 */
var IssueLinkAppLinks = IssueLinkAppLinks || (function($) {
    function createHelper(servers, context, settings) {
        var helper = {};
        var selectedServer = null;

        function selectServer(appId) {
            selectedServer = getServer(servers, appId);

            var authenticationRequired = selectedServer && selectedServer.requireCredentials;
            doAuthenticationRequired(authenticationRequired, context);

            return {"authenticationRequired": authenticationRequired};
        }

        function setAuthenticationRequired(appId, authenticationRequired) {
            var server = getServer(servers, appId);
            if (server) {
                server.requireCredentials = authenticationRequired;

                // Refresh the authenication message if we have updated the selected server
                if (selectedServer && selectedServer.id === appId) {
                    doAuthenticationRequired(authenticationRequired, context);
                }
            }
        }

        function doAuthenticationRequired(required, context) {
            $(".issue-link-applinks-authentication-message", context).empty();
            if (required) {
                createAuthRequiredBanner($(".issue-link-applinks-authentication-message", context), context);
                $(".issue-link-oauth-toggle").hide();
                $(".buttons-container input[type=submit]", context).attr("disabled", "disabled")
            } else {
                $(".issue-link-oauth-toggle").show();
                $(".buttons-container input[type=submit]", context).removeAttr("disabled");
            }
        }

        function createAuthRequiredBanner($container, context) {
            var oauthCallbacks = {
                onSuccess: function () {
                    selectedServer.requireCredentials = false;
                    doAuthenticationRequired(false, context);
                    if (settings.onAuthenticationSuccessCallback) {
                        settings.onAuthenticationSuccessCallback(context, selectedServer.id, helper);
                    }
                },
                onFailure: function () {
                    if (settings.onAuthenticationFailedCallback) {
                        settings.onAuthenticationFailedCallback(context, selectedServer.id, helper);
                    }
                }
            };

            var encodedServerName = AJS.escapeHtml(selectedServer.name);
            if (selectedServer.authUrl) {
                var $banner = $('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');
                $banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\">authenticate\u003c\/a> with \u003ca href=\"{1}\">{2}\u003c\/a>.", selectedServer.authUrl, selectedServer.url, encodedServerName));
                $("a", $banner).addClass("applink-authenticate");
                $('.applink-authenticate', $banner).click(function (e) {
                    authenticateRemoteCredentials(selectedServer.authUrl, oauthCallbacks.onSuccess, oauthCallbacks.onFailure);
                    e.preventDefault();
                });
                $container.append($banner);
            } else {
                var warningMessage = AJS.format("Unable to create a link to \u003ca href=\"{0}\">{1}\u003c\/a> as the application does not have any authentication configured.", selectedServer.url, encodedServerName);
                AJS.messages.warning($container, {body: warningMessage});
            }
        }

        function createOAuthCallback() {
            if (!AppLinks.OAuthCallback && typeof(oauthCallback) === "undefined") {
                AppLinks.OAuthCallback = function() {

                };

                AppLinks.OAuthCallback.prototype.success = function() {
                    this.aouthWindow.close();
                    this.onSuccess();
                    delete oauthCallback;
                    delete AppLinks.OAuthCallback;
                };

                AppLinks.OAuthCallback.prototype.failure = function() {
                    this.aouthWindow.close();
                    this.onFailure();
                    delete oauthCallback;
                    delete AppLinks.OAuthCallback;
                };

                AppLinks.OAuthCallback.prototype.show = function(url, onSuccess, onFailure) {
                    this.onSuccess = onSuccess;
                    this.onFailure = onFailure;
                    this.aouthWindow = window.open(url, "com_atlassian_applinks_authentication");
                };
                // set the global oAuthCallback variable required by AppLinks
                oauthCallback = new AppLinks.OAuthCallback();
            }
        }

        function authenticateRemoteCredentials(url, onSuccess, onFailure) {
            createOAuthCallback();

            $('.applinks-error').remove();
            oauthCallback.show(url, onSuccess, onFailure);
        }

        return $.extend(helper, {
            selectServer: selectServer,
            setAuthenticationRequired: setAuthenticationRequired
        });
    }

    function getServer(servers, appId) {
        var i;
        if (servers.length) {
            for (i = 0; i < servers.length; i++) {
                if (servers[i].id === appId) {
                    return servers[i];
                }
            }
        }
        return null;
    }

    /**
     * Called only once during the initialisation to retrieve the list of servers.
     *
     * @param context the context to perform the initialisation. This is either the inline dialog or the entire document
     *                body.
     */
    function initApplinkServers(settings, context, deferred) {
        var currentAppId = settings.getCurrentAppId(context);
        var applicationType = $(".issue-link-applinks-application-type", context).val();
        $.get(AJS.contextPath() + '/rest/issueLinkAppLink/1/appLink/info?type=' + applicationType, function (servers) {
            var helper = createHelper(servers, context, settings);
            var currentRequiresCredentials;
            if (servers && servers.length) {
                var currentServer = getServer(servers, currentAppId);
                if (currentServer) {
                    currentRequiresCredentials = $(".issue-link-applinks-authentication-message", context).hasClass("required");
                    if (currentRequiresCredentials) {
                        currentServer.requireCredentials = true;
                    }
                    helper.selectServer(currentAppId);
                }
                deferred.resolve(context, helper);
            } else {
                deferred.reject(context);
            }
        });
    }

    /**
     * @return jQuery.Promise<String>
     */
    function init(settings, context) {
        var deferred = $.Deferred();

        var isIssueLinkAppLinkContent = $(".issue-link-applinks-authentication-message", context).length !== 0;
        if (isIssueLinkAppLinkContent && settings.shouldExecute(context)) {
            initApplinkServers(settings, context, deferred);
        }

        return deferred.promise();
    }

    return {
        init: init
    };
})(AJS.$);

/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
/**
 * Initialises OAuth authentication for JIRA Application Links. Requires the following elements:
 * <div class="issue-link-applinks-authentication-message"></div>
 */
(function ($) {

    var settings = {
        getCurrentAppId: function (context) {
            return $("#jira-app-link", context).val();
        },
        shouldExecute: function (context) {
            return $("#jira-app-link", context).length !== 0;
        }
    };

    var updateIssuePicker = function($select, appId) {
        if ($select.length) {
            // Update the appId param
            $select.attr("data-ajax-options.data.app-id", appId);
            if (appId && appId !== "") {
                // Set the url for remote JIRA queries
                $select.attr("data-ajax-options.url", contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/picker");
            }
            else {
                // Set the url for local JIRA queries
                $select.attr("data-ajax-options.url", contextPath + "/rest/api/1.0/issues/picker");
            }
        
            $select.trigger("updateOptions");

            // Now that we have changed server, our current issue selection is no longer relevant
            $select.trigger("clearSelection");
        }
    };

    var updateCreateReciprocalCheckbox = function(appId, context) {
        var $reciprocalCheckbox = $("#create-reciprocal", context);
        if ($reciprocalCheckbox.length) {
            if (appId && appId !== "") {
                // Get default choice for creating a remote reciprocal link
                var defaultChoice = ($("#create-reciprocal-default", context).val() == "true");
                if (defaultChoice) {
                    $reciprocalCheckbox.attr("checked", "checked");
                } else {
                    $reciprocalCheckbox.removeAttr("checked");
                }
                $reciprocalCheckbox.removeAttr("disabled");
                $("#create-reciprocal-fieldset", context).removeClass("disabled");
            } else {
                // Set to checked for local links, as they always create a reciprocal link
                $reciprocalCheckbox.attr("checked", "checked");
                $reciprocalCheckbox.attr("disabled", "disabled");
                $("#create-reciprocal-fieldset", context).addClass("disabled");
            }
        }
    };

    JIRA.bind(JIRA.Events.NEW_PAGE_ADDED, function (e, context) {

        var $select = $("#jira-issue-keys", context);
        if ($select.length) {
            var appId = $("#jira-app-link", context).val();
            updateIssuePicker($select, appId);
            updateCreateReciprocalCheckbox(appId, context);
        }

        IssueLinkAppLinks.init(settings, context).done(function (context, helper) {
            $("#jira-app-link", context).change(function () {
                var appId = $(this).val();
                helper.selectServer(appId);
                updateIssuePicker($select, appId);
                updateCreateReciprocalCheckbox(appId, context);
            });
        });
    });
})(AJS.$);

/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
(function(){var jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];var jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];var jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];var jql_logical_operators_and_order_by=jql_logical_operators.concat(jql_order_by);var jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];var empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];var jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];var jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];var jql_changed_predicates=jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);var jql_was_predicates_and_order_by=jql_was_predicates.concat(jql_logical_operators_and_order_by);var jql_was_predicates_and_logical_operators=jql_was_predicates.concat(jql_logical_operators);var jql_changed_predicates_and_order_by=jql_changed_predicates.concat(jql_logical_operators_and_order_by);var jql_changed_predicates_and_logical_operators=jql_changed_predicates.concat(jql_logical_operators);var REGEXP_ANDS=/^AND\s/i;var REGEXP_ORS=/^OR\s/i;var REGEXP_NOTS=/^NOT\s/i;var REGEXP_SNOT=/^\s+not/i;var REGEXP_SIN=/^\s+in/i;var REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;var REGEXP_COMMA_DELIMITER=/^\s*,/;var REGEXP_ASCENDING=/^\s+asc/i;var REGEXP_DESCENDING=/^\s+desc/i;var REGEXP_ORDER_BY=/^order\s+by/i;var REGEXP_WHITESPACE=/^\s/;var REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;var REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;var REGEXP_NEW_LINE=/[\r\n]/;var REGEXP_NUMBER=/\d/;var REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;var REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;var REGEXP_SPACE_OR_ELSE=/[\s(]/;var REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;var REGEXP_NOTSTART=/^NO?$/i;var REGEXP_INSTART=/^IN?$/i;var REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;JIRA.JQLAutoComplete=function(options){var that=begetObject(JIRA.AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/1.0/jql/autocomplete";that.textToSuggestionCursorPosition=function(){return this.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayName}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=AJS.$('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",AJS.Meta.get("advanced-search-help-title")).attr("href",AJS.Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=AJS.$('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(this.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":that.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:that.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=that.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");this.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(that.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":that.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:that.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");this.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{var tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{var tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var that=this;var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);result=parser.parse(parseValue).getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(that.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){var operator=result.getLastOperator();var operatorLength=operator.length;var parsedOperator=(operator.length>0)?parseValue.substr(result.getLastOperatorStartIndex()):null;var functionSuggestions=(that.isEmptyOnlyOperator(result.getLastOperator()))?empty_operand:jql_function_names;var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,jql_operators);if(operatorLength>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operatorLength+numSpaces+1)}if(operatorSuggestions&&operatorSuggestions.length>0){var tokens=result.getTokens();var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,that.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){var value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){var value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(that.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!that.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}var functionSuggestions=(that.isEmptyOnlyOperator(result.getLastOperator()))?empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal},that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(this.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&that.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(this.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==this.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(this.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=this.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(this.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=that.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return that.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&that.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!that.isListSupportingOperator(operator))||(!arrValue.isList&&that.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<jql_changed_predicates.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_changed_predicates[i].value),predicate)){supportedType=jql_changed_predicates[i].type;supportsList=jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||that.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!that.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<jql_changed_predicates.length;i++){if(that.equalsIgnoreCase(result.getUnquotedString(jql_changed_predicates[i].value),predicate)){auto=jql_changed_predicates[i].auto;break}}return auto};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return this.isWasOperator(operator)||this.isChangedOperator(operator)};that.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};that.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};JIRA.JQLAutoComplete.MyParser=function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=JIRA.JQLAutoComplete.Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!REGEXP_COMMA_DELIMITER.test(remainingString)){if(REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(this.isWasOperator(operator)||this.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!=null&&(REGEXP_NOTSTART.test(remainingString)||REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!=null&&(REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;if(this.startsWithIgnoreCase("is",value)){var matchArray=value.substring(2).match(REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){var matchArray=value.substring(3).match(REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||jql_operators[i].value.length>longestMatch){longestMatch=jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},isWasOperator:function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"},isChangedOperator:function(operator){return operator==="changed"},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=jql_changed_predicates.length;for(var i=0,len=arLen;i<len;++i){if(predicate.toLowerCase()==jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}};JIRA.JQLAutoComplete.ParseResult=function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}};JIRA.JQLAutoComplete.Token=function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=JIRA.JQLAutoComplete.ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},getResult:function(){return this.result}}};jQuery(function(){restore("jqlHistory");jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:"jqltext",parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();AJS.namespace("jira.widget.autocomplete.JQL",null,JIRA.JQLAutoComplete);
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
/**
 * Instantiates jql autocomplete functionality on request instead of on page load.
 */
var IssueLinkJQLAutoComplete = IssueLinkJQLAutoComplete || (function($) {

    /**
     * Initializes an auto complete field
     */
    function initialize(options) {

        var fieldID = options.fieldID;
        var errorID = options.errorID;
        var autoCompleteUrl = options.autoCompleteUrl;
        var autoCompleteData = options.autoCompleteData;
        var formSubmitFunction = options.formSubmitFunction;

        var $field = $('#'+fieldID);
        var hasFocus = $field.length > 0 && $field[0] == document.activeElement;

        var jqlFieldNames = autoCompleteData.visibleFieldNames || [];
        var jqlFunctionNames = autoCompleteData.visibleFunctionNames || [];
        var jqlReservedWords = autoCompleteData.jqlReservedWords || [];

        var jqlAutoComplete = JIRA.JQLAutoComplete({
            fieldID: fieldID,
            parser: JIRA.JQLAutoComplete.MyParser(jqlReservedWords),
            queryDelay: .65,
            jqlFieldNames: jqlFieldNames,
            jqlFunctionNames: jqlFunctionNames,
            minQueryLength: 0,
            allowArrowCarousel: true,
            autoSelectFirst: false,
            errorID: errorID,
            autoCompleteUrl: autoCompleteUrl
        });

        $field.unbind("keypress", submitOnEnter);

        if (formSubmitFunction) {
            $field.keypress(function (e) {
                if (jqlAutoComplete.dropdownController === null || !jqlAutoComplete.dropdownController.displayed || jqlAutoComplete.selectedIndex < 0) {
                    if (e.keyCode == 13 && !e.ctrlKey && ! e.shiftKey)
                    {
                        formSubmitFunction();
                        return false;
                    }
                    else
                    {
                        return true;
                    }
                }
            });
        }

        jqlAutoComplete.buildResponseContainer();
        jqlAutoComplete.parse($field.text());
        jqlAutoComplete.updateColumnLineCount();

        $field.click(function(){
            jqlAutoComplete.dropdownController.hideDropdown();
        });

        if (hasFocus) {
            $field.select();
        }
    }

    return {
        initialize: initialize
    };
})(AJS.$);

/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function ($) {
    var remoteJiraSearchDialog =  new JIRA.FormDialog({
        id: "remote-jira-search-dialog",
        trigger: "#link-jira-issue .remote-jira-search-trigger",
        widthClass: "large",
        content: function (render) {
            render(JIRA.Templates.RemoteJiraIssueSearch.dialog());
            initSearchDialog(this.$popup);
        },
        submitHandler: function(e, callback){
            e.preventDefault();
            $("#simple-search-panel-button").removeAttr("disabled");
            $("#advanced-search-panel-button").removeAttr("disabled");
            if($(e.target).attr("id") == "remote-jira-simple-search-form"){
                $("#simple-search-panel-button").click();
            } else {
                $("#advanced-search-panel-button").click();
            }
            callback();
        }
    });

    function initSearchDialog($dialog) {
        // Gather the JQL auto complete data
        var appId = $("#jira-app-link").val();
        var autoCompletePromise = getJqlAutoCompleteData(appId);

        // Bind the simple search button
        $("#simple-search-panel-button", $dialog).click(function () {
            $("#search-results-table", $dialog).empty();
            var searchText = $("#link-search-text", $dialog).val();
            searchText = $.trim(searchText);
            if (searchText) {
                doSimpleSearch(searchText, $dialog);
            } else {
                AJS.messages.info("#search-results-table", {
                    body: "Please enter search value.",
                    closeable: false
                });
            }

            return false;
        });

        // Bind the advanced search button
        $("#advanced-search-panel-button", $dialog).click(function() {
            advancedSearchButtonClick($dialog);
            return false;
        });

        $("#simple-search-toggle", $dialog).click(function() {
            $("#remote-jira-simple-search-form", $dialog).show();
            $("#remote-jira-advanced-search-form", $dialog).hide();
            return false;
        });

        $("#linkjiraissue-add-selected", $dialog).click(function(){
            //select selected checkboxes of only *visible* rows
            //filtering to visible is necessary due to tabbed layout
            $("table tbody tr:visible  td.selection input:checked", $dialog).each(function(){
                var issueKey = $(this).parent().data("key");
                $("#jira-issue-keys").trigger("selectOption", [{
                    value: issueKey
                }]);
            });


            // Clear all error messages on the parent dialog, as we now have a newly selected issue
            $("#link-issue-dialog .error").hide();

            remoteJiraSearchDialog.hide();

            $("#link-issue-dialog")
                    .show()
                    .trigger("multiSelectRevealed");

            $("#jira-issue-keys-textarea").focus().select();
        });


        $("#advanced-search-toggle", $dialog).click(function() {
            $("#remote-jira-advanced-search-form", $dialog).show();
            $("#remote-jira-simple-search-form", $dialog).hide();

            // Initialise the JQL auto complete once we have the data
            // Ensure that we only initialise it once only
            var $jqlSearchText = $("#jql-search-text");
            if (!$jqlSearchText.attr("jql-initialized")) {
                setAutoCompleteLoadingIconVisible(true, $dialog);
                autoCompletePromise.done(function (smartAjaxResult) {
                    if (smartAjaxResult.successful) {
                        // Enable JQL AutoComplete
                        IssueLinkJQLAutoComplete.initialize({
                            fieldID: "jql-search-text",
                            errorID: "jql-search-error",
                            autoCompleteUrl: getAutoCompleteUrl(appId),
                            autoCompleteData: smartAjaxResult.data,
                            formSubmitFunction: function() {
                                advancedSearchButtonClick($dialog);
                            }
                        });
                    }
                    else {
                        setJQLErrorVisible(false, $dialog);
                        setAutoCompleteFailedIconVisible(true, $dialog);
                    }
                    setAutoCompleteLoadingIconVisible(false, $dialog);
                    $jqlSearchText.attr("jql-initialized", 1);
                });
            }
            $jqlSearchText.focus();

            return false;
        });

        $("#simple-search-toggle", $dialog).trigger("click");
    }

    function getAutoCompleteUrl(appId) {
        if (appId && appId !== "") {
            // Remote JIRA instance
            return contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId=" + appId;
        }
        // Local JIRA instance - will use the default URL in JQLAutoComplete
        return "";
    }

    function advancedSearchButtonClick($dialog) {
        $("#search-results-table", $dialog).empty();
        var searchText = $("#jql-search-text", $dialog).val();
        searchText = $.trim(searchText);
        if (searchText) {
            doAdvancedSearch(searchText, $dialog);
        } else {
            AJS.messages.info("#search-results-table", {
                body: "Please enter search value.",
                closeable: false
            });
        }
    }

    function setLoadingIconVisible(visible, $context) {
        $("#link-search-loading", $context).toggleClass("hidden", !visible);
    }

    function setAutoCompleteLoadingIconVisible(visible, $context) {
        $("#autocomplete-loading", $context).toggleClass("hidden", !visible);
    }

    function setAutoCompleteFailedIconVisible(visible, $context) {
        $("#autocomplete-failed", $context).toggleClass("hidden", !visible);
    }

    function setJQLErrorVisible(visible, $context) {
        $("#jql-search-error", $context).toggleClass("hidden", !visible);
    }

    function doSimpleSearch(searchText, $context) {
        setLoadingIconVisible(true, $context);
        var appId = $("#jira-app-link").val();
        var issueKeyJql = 'key = "' + searchText + '"';
        var projectJql = 'project = "' + searchText + '"';
        var plainTextJql = 'summary ~ "' + searchText + '" OR description ~ "' + searchText + '" OR comment ~ "' + searchText + '"';

        // First, check if search text is an issue key
        // We need to do this because the search will fail if it is not an issue key,
        // even if it is OR'd with a condition that returns results!
        jqlSearch(issueKeyJql, appId).done(function (smartAjaxResult) {
            if (smartAjaxResult.successful && smartAjaxResult.data.issues.length > 0) {
                setLoadingIconVisible(false, $context);
                showResults(smartAjaxResult, $context);
            } else {

                // Then check if search text is a project
                jqlSearch(projectJql, appId).done(function (smartAjaxResult) {
                    if (smartAjaxResult.successful && smartAjaxResult.data.issues.length > 0) {
                        // The search text is a project name or key
                        setLoadingIconVisible(false, $context);
                        showResults(smartAjaxResult, $context);
                    } else {

                        // Finally, a plain text search
                        jqlSearch(plainTextJql, appId).done(function (smartAjaxResult) {
                            setLoadingIconVisible(false, $context);
                            if (smartAjaxResult.successful) {
                                showResults(smartAjaxResult, $context);
                            } else {
                                showResultsError(smartAjaxResult);
                            }
                        });
                    }
                });
            }
        });
    }

    function doAdvancedSearch(jql, $context) {
        setLoadingIconVisible(true, $context);
        var appId = $("#jira-app-link").val();
        jqlSearch(jql, appId).done(function (smartAjaxResult) {
            setLoadingIconVisible(false, $context);
            if (smartAjaxResult.successful) {
                showResults(smartAjaxResult, $context);
            } else {
                if (smartAjaxResult.status === 400) {
                    AJS.messages.warning("#search-results-table", {
                        body: "Invalid JQL query.",
                        closeable: false
                    });
                } else {
                    showResultsError(smartAjaxResult);
                }
            }
        });
    }

    function jqlSearch(jql, appId) {
        var deferred = $.Deferred();
        var url;
        if (appId && appId !== "") {
            // Remote JIRA instance
            url = contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/search?jql=" + jql + "&appId=" + appId + "&maxResults=10";
        } else {
            // Local JIRA instance
            // Filter out current issue from results
            var currentIssueKey = $("#current-issue-key").val();
            jql = "(" + jql + ") and key != " + currentIssueKey;
            url = contextPath + "/rest/api/2/search?jql=" + jql + "&maxResults=10";
        }
        JIRA.SmartAjax.makeRequest({
            url: url,
            complete: function (xhr, textStatus, smartAjaxResult) {
                deferred.resolve(smartAjaxResult);
            }
        });
        return deferred.promise();
    }

    function getJqlAutoCompleteData(appId) {
        var deferred = $.Deferred();
        var remote;
        var url;
        if (appId && appId !== "") {
            // Remote JIRA instance
            url = contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId=" + appId;
            remote = true;
        } else {
            // Local JIRA instance
            url = contextPath + "/rest/api/2/jql/autocompletedata";
            remote = false;
        }
        JIRA.SmartAjax.makeRequest({
            url: url,
            complete: function (xhr, textStatus, smartAjaxResult) {
                if (!smartAjaxResult.successful && remote) {
                    // If a remote JIRA request fails, it probably doesn't have the autocompletedata REST endpoint (added in JIRA v5.1)
                    // Get the auto complete data by parsing the issue navigator page
                    JIRA.SmartAjax.makeRequest({
                        url: contextPath + "/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId=" + appId,
                        complete: function (xhr, textStatus, smartAjaxResult) {
                            deferred.resolve(smartAjaxResult);
                        }
                    });
                } else {
                    deferred.resolve(smartAjaxResult);
                }
            }
        });
        return deferred.promise();
    }

    function showResults(smartAjaxResult, $context) {
        var resultHtml = JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result: smartAjaxResult.data});
        $("#search-results-table", $context).html(resultHtml);

        $("#linkjiraissue-select-all", $context).click(function(){
            var $masterStatus = $(this).prop("checked");
            $("tbody tr td.selection input", $context).prop("checked", $masterStatus);
        });

        $("tbody tr", $context).click(function (e) {

            //if we click on checkbox directly we don't want to change its value
            if($(e.target).is(":checkbox")){
                return;
            }
            var checkbox = $(this).find("td.selection input");
            checkbox.prop("checked", !checkbox.prop("checked"));


        });
    }

    function showResultsError(smartAjaxResult) {
        AJS.messages.error("#search-results-table", {
            body: JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),
            closeable: false
        });
    }
});

/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-feedback-plugin:shared-resources', location = '/js/shared/Link.js' */
(function(){var c;var a=function(d){return AJS.Meta.getBoolean(d)===true};var b=Class.extend({suppress:function(){c=true;return undefined},isSuppressed:function(){if(c===true){return true}return a("disable-issue-collector")}});JIRA=JIRA||{};JIRA.Feedback=JIRA.Feedback||{};JIRA.Feedback.Link=new b()})();
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/templates/feedback-link.soy' */
// This file was automatically generated from feedback-link.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Feedback == 'undefined') { JIRA.Feedback = {}; }
if (typeof JIRA.Feedback.Plugin == 'undefined') { JIRA.Feedback.Plugin = {}; }


JIRA.Feedback.Plugin.subtleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jira-feedback-link-container float subtle-style\'><a class=\'js-feedback-link jira-feedback-link\' href=\'#\'>', soy.$$escapeHtml("Got Feedback?"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Feedback.Plugin.footerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class=\'jira-feedback-link-container footer-style\'><a class="aui-button jira-feedback-link ">', soy.$$escapeHtml("Got Feedback?"), '</a></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jic-bootstrap.js' */
(function($){var ATL_JQ=function(){return $.apply($,arguments)};var baseUrl="https://jira.atlassian.com";var css=".atlwdg-blanket {background: black;height: 100%;left: 0;opacity: .5;position: fixed;top: 0;width: 100%;z-index: 1000000;}.atlwdg-popup {background: white;border: 1px solid #666;position: fixed;top: 50%;left: 50%;z-index: 10000011;}.atlwdg-popup.atlwdg-box-shadow {-moz-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);-webkit-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);box-shadow: 10px 10px 20px rgba(0,0,0,0.5);background-color: white;}.atlwdg-hidden {display: none;}.atlwdg-trigger {position: fixed;background: #013466;padding: 5px;border: 2px solid white;border-top: none;font-weight: bold;color: white !important;display: block;white-space: nowrap;text-decoration: none !important;font-family: arial, FreeSans, Helvetica, sans-serif;font-size: 12px;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-webkit-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-moz-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);border-radius: 0 0 5px 5px;-moz-border-radius: 0 0 5px 5px;}.atlwdg-trigger.atlwdg-TOP {left: 45%;top: 0;}.atlwdg-trigger.atlwdg-RIGHT {left: 100%;top: 40%;-webkit-transform-origin: top left;-webkit-transform: rotate(90deg);-moz-transform: rotate(90deg);-moz-transform-origin: top left;-ms-transform: rotate(90deg);-ms-transform-origin: top left;}.atlwdg-trigger.atlwdg-SUBTLE {right: 0;bottom: 0;border: 1px solid #ccc;border-bottom: none;border-right: none;background-color: #f5f5f5;color: #444;font-size: 11px;padding: 6px;box-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5);border-radius: 2px 0 0 0;}.atlwdg-loading {position: absolute;top: 220px;left: 295px;}";var cssIE=".atlwdg-trigger {position: absolute;}.atlwdg-blanket {position: absolute;filter: alpha(opacity=50);width: 110%;}.atlwdg-popup {position: absolute;}.atlwdg-trigger.atlwdg-RIGHT {left: auto;right: 0;filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);}";ATL_JQ.isQuirksMode=function(){return document.compatMode!="CSS1Compat"};ATL_JQ.IssueDialog=function(options){var $body=$("body"),that=this,showDialog=function(){that.show();return false};this.options=options;this.frameUrl=baseUrl+"/rest/collectors/1.0/template/form/"+this.options.collectorId+"?os_authType=none";$("head").append("<style type='text/css'>"+css+"</style>");if(this.options.triggerPosition==="CUSTOM"){var oldTriggerFunction;if(this.options.triggerFunction){try{oldTriggerFunction=eval("("+this.options.triggerFunction+")")}catch(ex){}}$(function(){try{var newTriggerFunction;if(window.ATL_JQ_PAGE_PROPS&&((window.ATL_JQ_PAGE_PROPS.triggerFunction)||(window.ATL_JQ_PAGE_PROPS[this.options.collectorId]&&window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction))){newTriggerFunction=window.ATL_JQ_PAGE_PROPS.triggerFunction||window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction}else{newTriggerFunction=oldTriggerFunction}if($.isFunction(newTriggerFunction)){newTriggerFunction(showDialog)}}catch(ex){}})}else{if($.isFunction(this.options.triggerPosition)){try{this.options.triggerPosition(showDialog)}catch(ex){}}else{if(this.options.triggerPosition&&this.options.triggerText){var triggerClass="atlwdg-trigger atlwdg-"+this.options.triggerPosition;var $trigger=$("<a href='#' id='atlwdg-trigger'/>").addClass(triggerClass).text(this.options.triggerText);$body.append($trigger);$trigger.click(showDialog)}}}var $iframeContainer=$("<div id='atlwdg-container'/>").addClass("atlwdg-popup atlwdg-box-shadow atlwdg-hidden");var $blanket=$("<div id='atlwdg-blanket' class='atlwdg-blanket'/>").hide();$body.append($blanket).append($iframeContainer);if($.browser.msie&&(ATL_JQ.isQuirksMode()||$.browser.version<9)){$("head").append("<style type='text/css'>"+cssIE+"</style>");var triggerAdjuster=function(e){};if(this.options.triggerPosition==="TOP"){triggerAdjuster=function(e){$("#atlwdg-trigger").css("top",$(window).scrollTop()+"px")}}else{if(this.options.triggerPosition==="RIGHT"){triggerAdjuster=function(e){var $trigger=$("#atlwdg-trigger");$trigger.css("top",($(window).height()/2-$trigger.outerWidth()/2+$(window).scrollTop())+"px");if(!ATL_JQ.isQuirksMode()&&$.browser.version==="8.0"){$trigger.css("right",-($trigger.outerHeight()-$trigger.outerWidth())+"px")}}}else{if(this.options.triggerPosition==="SUBTLE"){var outerHeight=$trigger.outerHeight();triggerAdjuster=function(e){var $window=$(window);$trigger.css("top",($window.scrollTop()+$window.height()-outerHeight)+"px")}}}}$(window).bind("scroll resize",triggerAdjuster);triggerAdjuster()}};ATL_JQ.IssueDialog.prototype={hideDialog:undefined,updateContainerPosition:function(){var width=810,height=450;$("#atlwdg-container").css({height:height+"px",width:width+"px","margin-top":-Math.round(height/2)+"px","margin-left":-Math.round(width/2)+"px"});$("#atlwdg-frame").height("100%").width("100%")},show:function(){var that=this,$iframeContainerElem=$("#atlwdg-container"),$body=$("body"),$iframeElem=$('<iframe id="atlwdg-frame" frameborder="0" src="'+this.frameUrl+'"></iframe>'),$loadingImage=$('<img class="atlwdg-loading" style="display:none;" src="https://jira.atlassian.com/images/throbber/loading_barber_pole_horz.gif">');hideDialog=function(e){if(e.keyCode===27){that.hide()}};$iframeContainerElem.append($loadingImage);var throbberTimeout=setTimeout(function(){$loadingImage.show()},300);$body.css("overflow","hidden").keydown(hideDialog);window.scroll(0,0);var feedbackString="";if(this.options.collectFeedback){var feedback=this.options.collectFeedback();for(var prop in feedback){if(feedback.hasOwnProperty(prop)&&feedback[prop]!==undefined&&feedback[prop]!==""&&typeof feedback[prop]==="string"){feedbackString+="*"+prop+"*: "+feedback[prop]+"\n"}}}var fieldValues={};if(this.options.fieldValues&&!$.isEmptyObject(this.options.fieldValues)){$.extend(fieldValues,this.options.fieldValues)}$iframeElem.load(function(){var message={feedbackString:feedbackString,fieldValues:fieldValues};$iframeElem[0].contentWindow.postMessage(JSON.stringify(message),"https://jira.atlassian.com");$(window).bind("message",function(e){if(e.originalEvent.data&&e.originalEvent.data==="cancelFeedbackDialog"){that.hide()}})});$iframeElem.load(function(e){clearTimeout(throbberTimeout);$loadingImage.hide();$iframeElem.show()});var currentMilis=new Date().getTime();var dummyElement=document.createElement("a");dummyElement.href="https://jira.atlassian.com";$iframeContainerElem.append($iframeElem);this.updateContainerPosition();$iframeContainerElem.show();$("#atlwdg-blanket").show()},hide:function(){$("body").css("overflow","auto").unbind("keydown",hideDialog);$("#atlwdg-container").hide().empty();$("#atlwdg-blanket").hide()}};var filterStrings=function(obj,recursingIn){for(var key in obj){if(!obj.hasOwnProperty(key)){continue}var value=obj[key];if(recursingIn===undefined&&$.isArray(value)){filterStrings(value,key);continue}if(typeof value!=="string"){var paramName=recursingIn===undefined?key:recursingIn+":"+key;console.log("bootstrap.js:filterStrings ignoring key for value '"+paramName+"'; typeof must be string");delete obj[key]}}return obj};window.JIRAS_OWN_ATL_JQ=ATL_JQ})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jira-feedback-plugin.js' */
AJS.$(function(f){var d="d3de7fb5";var g="c612fb25";var e=AJS.Meta.get("version-number");var c=!(f.browser.msie&&parseInt(f.browser.version,10)<9);var b=function(){if(!c){return false}if(AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND")){return g}if(AJS.params.baseURL&&AJS.params.baseURL.indexOf("sandbox.onjira.com")>=0){return d}if(AJS.Meta.get("is-beta")||AJS.Meta.get("is-rc")||AJS.Meta.get("is-snapshot")||AJS.Meta.get("is-milestone")){return d}if(f(".licensemessagered:contains('JIRA evaluation license')").length>0){return d}return false};var a=b();if(!JIRA.Feedback.Link.isSuppressed()&&a){h();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,i);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,i)}function i(o,l,n){if((o.type==="newContentAdded"&&n==="pageLoad")||(o.type==="layoutRendered"&&l==="list-view")){var m=f(".navigator-sidebar").hasClass("collapsed");var k=f(".jira-feedback-link-container");k.remove();k=h();if(m&&k.hasClass("subtle-style")){k.addClass("left noborder")}}}function j(){var k=f("#footer-build-information").text();var m=function(){return{Location:window.location.href,"User-Agent":navigator.userAgent,Referrer:document.referrer,"Screen Resolution":screen.width+" x "+screen.height,"JIRA Version":e,"JIRA Footer Version":k}};var l=new JIRAS_OWN_ATL_JQ.IssueDialog({collectorId:a,collectFeedback:m});l.show()}function h(){var m=f("#footer .atlassian-footer:visible").eq(0);var l;if(m.length>0){l=m;l.append(JIRA.Feedback.Plugin.footerLink())}else{l=f("body");l.append(JIRA.Feedback.Plugin.subtleLink())}var k=l.find(".jira-feedback-link-container");k.on("click",".jira-feedback-link",j);return k}});
/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.optionName && opt_data.optionName != '-1') ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) + ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.$dialogElement.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.$dialogElement.show();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?","。"],noEllipsis:[]}})})};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml("/jira"), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm,submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});
/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}var params={avatarId:avatar.getId(),size:size.param};if(this.username){params["username"]=this.username}else{params["ownerId"]=this.ownerId}return this.avatarSrcBaseUrl+"?"+jQuery.param(params)},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createProjectAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectKey){restQueryUrl=contextPath+"/rest/api/latest/project/"+options.projectKey+"/avatars";restUpdateUrl=contextPath+"/rest/api/latest/project/"+options.projectKey+"/avatar";restCreateTempUrl=contextPath+"/rest/api/latest/project/"+options.projectKey+"/avatar/temporary";restUpdateTempUrl=restUpdateUrl;restSingleAvatarUrl=restUpdateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar img"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(e.target===el[0]){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});userAvatarDialog._focusFirstField=function(){}};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label>', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader" /><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" data-id="', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" /></span></li>');
  }
  var avatarList25 = opt_data.avatars.custom;
  var avatarListLen25 = avatarList25.length;
  for (var avatarIndex25 = 0; avatarIndex25 < avatarListLen25; avatarIndex25++) {
    var avatarData25 = avatarList25[avatarIndex25];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData25.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData25.id), '" data-id="', soy.$$escapeHtml(avatarData25.id), '" src="', soy.$$escapeHtml(avatarData25.src), '" width="', soy.$$escapeHtml(avatarData25.width), '" height="', soy.$$escapeHtml(avatarData25.height), '" /></span><span class="jira-delete-avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">Delete</span></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var triggerImg=jQuery(".jira-avatar-picker-trigger",ctx);if("project"!==jQuery(ctx).find("#avatar-type").text()){return }JIRA.createProjectAvatarPickerDialog({trigger:triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),select:function(avatar,src){triggerImg.attr("src",src)}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();
/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],init:function(A){A=A||{};
this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";
this._hasRetainFeature=true;
this._hasVisibilityFeature=true;
this.retainedFields=[];
this.initIssueType=A.issueType;
this.initProjectId=A.projectId;
this.parentIssueId=A.parentIssueId;
this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;
if(A.nonRetainedFields){this.nonRetainedFields=_.union(A.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)
}},getParentIssueId:function(){return this.parentIssueId
},isInMultipleMode:function(){return this.multipleMode
},setIsMultipleMode:function(A){this.multipleMode=A
},getActiveFieldIds:function(){var A=this,B=jQuery.Deferred(),C=[];
this.getUserFields().done(function(D){jQuery.each(D,function(F,E){C.push(E)
});
A.getRequiredFields().done(function(E){jQuery.each(E,function(G,F){if(jQuery.inArray(F.id,C)===-1){C.push(F.id)
}});
B.resolve(C)
})
});
return B.promise()
},hasVisibilityFeature:function(A){return !A.required
},getFieldsResource:function(){var A=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";
if(this.parentIssueId){return A+"&parentIssueId="+this.parentIssueId
}if(this.initIssueType){A=A+"&issuetype="+this.initIssueType;
delete this.initIssueType
}if(this.initProjectId){A=A+"&pid="+this.initProjectId;
delete this.initProjectId
}return A
},addFieldToRetainValue:function(D,B){var A=!_.contains(this.nonRetainedFields,D);
var C=D.match(/^filetoconvert/)!==null;
if(A||C||B){this._super(D)
}},getRequiredFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.required){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getConfigurableFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id!=="project"&&E.id!=="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getIssueSetupFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id==="project"||E.id==="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
}});
JIRA.Forms.CreateIssueHelper=Class.extend({init:function(A){this.form=A
},handleSubmitSuccess:function(D){function C(E,G,F){var H='<a href="'+F+'">'+E+" - "+AJS.escapeHTML(G)+"</a>";
return AJS.format("Issue {0} has been successfully created",H)
}var A=this,B=this.form.$element.find("#summary").val();
D.summary=B;
this.form.triggerEvent("submitted",[D,this]);
this.form.triggerEvent("issueCreated",[D,this],true);
if(A.form.model.isInMultipleMode()){this.form.render().done(function(){var E=C(D.issueKey,B,contextPath+"/browse/"+D.issueKey);
JIRA.applySuccessMessageToForm(A.form.getForm(),E)
})
}else{this.form.triggerEvent("sessionComplete")
}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")
},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")
},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")
},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")
},serializeForToggle:function(C){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()
}var E=this.form.model.prevActiveFields||[];
var J=this.form.getForm().serializeArray();
var D=this.form.getActiveFieldIds();
var F=jQuery.grep(J,function(K){return jQuery.inArray(K.name,D)!==-1
});
var A=jQuery.grep(E,function(K){return jQuery.inArray(K.name,D)===-1
});
var B=jQuery.map(A,function(K){return K.name
});
var H=jQuery.merge(F,A);
var G=jQuery.merge(D,B);
this.form.model.prevActiveFields=jQuery.extend(true,[],H);
if(C){G=this.executeProjectChangedSecuritySettingAction(G)
}var I=jQuery.merge([{name:"retainValues",value:true}],H);
jQuery.each(J,function(K,L){if(L.name==="pid"||L.name==="issuetype"){I.push(L)
}});
I.push({name:"toggle",value:true});
jQuery.each(G,function(K,L){I.push({name:"fieldsToRetain",value:L})
});
return jQuery.param(I)
},executeProjectChangedSecuritySettingAction:function(A){return _.reject(A,function(B){return B==="security"
})
},prepareFieldsToRetain:function(A,B){jQuery.each(A,function(C,D){B.push({name:"fieldsToRetain",value:D})
});
return B
},setIssueType:function(){var A=this,B=this.serializeForToggle();
this.form.invalidateFieldsCache();
this.form.disable();
this.form.model.refresh(B).done(function(){A.form.render();
A.form.enable()
})
},setProjectId:function(){var A=this,B=this.serializeForToggle(true);
this.form.invalidateFieldsCache();
this.form.disable();
this.form.model.refresh(B).done(function(){A.form.render();
A.form.enable()
})
},decorate:function(){var A=this;
this.getProjectField().change(function(){A.setProjectId(this.value)
});
this.getIssueTypeField().change(function(){A.setIssueType(this.value)
});
this.getCreateAnotherCheckbox().change(function(){A.form.model.setIsMultipleMode(this.checked)
})
}});
JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this._serialization={};
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.title=A.title;
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},handleSubmitSuccess:function(A){this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){A.model.getIssueSetupFields().done(function(F){var E=JIRA.Templates.Issue.createIssueForm({issueSetupFields:F,fieldsHtml:C,parentIssueId:A.model.getParentIssueId(),atlToken:A.model.getAtlToken(),title:A.title,multipleMode:A.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),D=JIRA.extractScripts(E);
A.$element.empty().append(D.html);
A.helper.decorate();
B.resolveWith(A,[A.$element,D.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this._serialization={};
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){return this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
A.model.getIssueSetupFields().done(function(D){var C=JIRA.Templates.Issue.createIssueForm({issueSetupFields:D,atlToken:A.model.getAtlToken(),isConfigurable:true,title:A.title,parentIssueId:A.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:A.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});
A.$element.html(C);
A.helper.decorate();
A.renderFormContents().done(function(F,E){B.resolveWith(A,[A.$element,E])
})
});
return B.promise()
}});
JIRA.Forms.createCreateIssueForm=function(A){A=A||{};
return new JIRA.Forms.Container(function(){A.globalEventNamespaces=A.globalEventNamespaces||["QuickCreateIssue"];
var E="Create Issue",B=new JIRA.Forms.CreateIssueModel({projectId:A.pid,issueType:A.issueType}),D=new JIRA.Forms.ConfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces}),C=new JIRA.Forms.UnconfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces});
return{globalEventNamespaces:A.globalEventNamespaces,model:B,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:D,unconfigurableForm:C}
})
};
JIRA.Forms.createSubtaskForm=(function(){var A=function A(C){return C.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
};
var B=function B(C){C=C||{};
return new JIRA.Forms.Container(function(){C.globalEventNamespaces=C.globalEventNamespaces||["QuickCreateSubtask"];
var G=A(C),H=JIRA.Dialog.getIssueActionTitle("Create Subtask"),D=new JIRA.Forms.CreateIssueModel({parentIssueId:G,projectId:C.pid,issueType:C.issueType}),F=new JIRA.Forms.ConfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces}),E=new JIRA.Forms.UnconfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces});
return{globalEventNamespaces:C.globalEventNamespaces,model:D,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:F,unconfigurableForm:E}
})
};
return B
})();
jQuery(function(){var A;
jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(E){var B=jQuery(E.target);
var D=B.is("a")?B:B.find("a");
var F=parseUri(D.attr("href")).queryKey;
var C={pid:F.pid,issueType:F.issuetype};
C=jQuery.extend(C,{pid:B.attr("data-pid"),issueType:B.attr("data-issue-type")});
JIRA.Forms.createCreateIssueForm(C).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();
E.preventDefault()
});
A=document.getElementById("stqc_show");
if(A){A.onclick=null
}JIRA.Forms.createSubtaskForm().asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")
},trigger:".issueaction-create-subtask",id:"create-subtask-dialog"})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList66 = opt_data.tabs;
    var tabListLen66 = tabList66.length;
    for (var tabIndex66 = 0; tabIndex66 < tabListLen66; tabIndex66++) {
      var tabData66 = tabList66[tabIndex66];
      output.append((tabData66) ? '<li class="menu-item ' + ((tabData66.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData66.position) + '" ><strong>' + soy.$$escapeHtml(tabData66.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList80 = opt_data.tabs;
    var tabListLen80 = tabList80.length;
    for (var tabIndex80 = 0; tabIndex80 < tabListLen80; tabIndex80++) {
      var tabData80 = tabList80[tabIndex80];
      if (tabData80) {
        output.append('<div class="tabs-pane ', (tabData80.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData80.position), '">');
        var fieldList90 = tabData80.fields;
        var fieldListLen90 = fieldList90.length;
        for (var fieldIndex90 = 0; fieldIndex90 < fieldListLen90; fieldIndex90++) {
          var fieldData90 = fieldList90[fieldIndex90];
          output.append((fieldData90.editHtml) ? fieldData90.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList100 = opt_data.fields;
    var fieldListLen100 = fieldList100.length;
    for (var fieldIndex100 = 0; fieldIndex100 < fieldListLen100; fieldIndex100++) {
      var fieldData100 = fieldList100[fieldIndex100];
      output.append((fieldData100.editHtml) ? fieldData100.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList124 = opt_data.issueSetupFields;
    var fieldListLen124 = fieldList124.length;
    for (var fieldIndex124 = 0; fieldIndex124 < fieldListLen124; fieldIndex124++) {
      var fieldData124 = fieldList124[fieldIndex124];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData124.id), ' qf-required">', fieldData124.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList187 = opt_data.errors;
  var errorListLen187 = errorList187.length;
  for (var errorIndex187 = 0; errorIndex187 < errorListLen187; errorIndex187++) {
    var errorData187 = errorList187[errorIndex187];
    output.append('<li>', soy.$$escapeHtml(errorData187), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);
/* module-key = 'com.atlassian.support.stp:stp-license-status-resources', location = 'js/stp-licenseStatus.js' */

/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);
/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml("This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">', soy.$$escapeHtml("Story"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:analytics', location = 'analytics/analytics.js' */
var _gaq=_gaq||[];AJS.$(function(){_gaq.push(["navlinks._setAccount","UA-20272869-14"]);_gaq.push(["navlinks._setDomainName","none"]);_gaq.push(["navlinks._setAllowLinker",true]);_gaq.push(["navlinks._setDetectTitle",false]);_gaq.push(["navlinks._trackPageview",location.pathname]);AJS.$.ajax(AJS.contextPath()+"/rest/nav-links-analytics-data/1.0/",{success:function(a){_gaq.push(["navlinks._setCustomVar",1,"isUserAdmin",a.isUserAdmin?"true":"false",2])}})});(function(a){function b(e,g,d,c,f){AJS.log("Firing analytics event"+(c?" - synchronous":""));AJS.log("  Category: "+e);AJS.log("  Action:   "+g);AJS.log("  Label:    "+d);if(f!==undefined){AJS.log("  Value:    "+f)}}a.trackEvent=function(d,f,c,e){if(e===undefined){b(d,f,c,false);_gaq.push(["navlinks._trackEvent",d,f,c])}else{b(d,f,c,false,e);_gaq.push(["navlinks._trackEvent",d,f,c,e])}if(AJS.EventQueue){AJS.EventQueue.push({name:d+"."+f,properties:{label:c,value:e}})}};a.getCurrentApplication=function(){if(window.Confluence!==undefined){return"confluence"}else{if(window.BAMBOO!==undefined){return"bamboo"}else{if(window.JIRA!==undefined){return"jira"}else{return""}}}}}(window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:analytics', location = 'analytics/help-analytics.js' */
(function(c,b){function a(g,d,f){try{b.trackEvent("helpmenu",g,d,f)}catch(h){AJS.log("failed to track analytics event, category: helpmenu, action: "+g+", label: "+d+", value: "+f)}}c(function(){var d=c("#system-help-menu-content,#help-menu-link-content,#bamboo\\.global\\.header-help\\.menu");d.bind({"aui-dropdown2-show":function(f){a("show","")},"aui-dropdown2-hide":function(f){a("hide","")}}).find("a").unbind(".analytics").bind("click.analytics",function(){var e=this.attributes.href;a("linkFollowed",typeof e==="object"?e.value:e)}).addClass("interactive")})}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,h){var j,l={},o="key",b="name",k="entity-type";function n(r,p,q){try{h.trackEvent("projectshortcuts",r,p,q)}catch(s){AJS.log("failed to track analytics event, category: projectshortcuts, action: "+r+", label: "+p+", value: "+q)}}function f(u){var p=e(this),q=p.data(o),s=p.data(b),r=p.data(k);if(typeof q==="undefined"){return}u.preventDefault();j=new AJS.Dialog({width:600,keypressListener:function(w){if(w.which==jQuery.ui.keyCode.ESCAPE){j.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){j.remove();n("hide",h.getCurrentApplication())}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:s,logoUrl:i(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links…"})})).show();c(j);if(!l[q]){l[q]={entity:{title:s},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+q,{entityType:r}).done(v);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+q,{entityType:r}).done(t).fail(function(){var w=j.getCurrentPanel().body.find(".project-content-wrapper");w.find(".projectshortcuts-loading").remove();AJS.messages.error(w,{body:"Could not retrieve remote project shortcuts",closeable:false});c(j)})}else{m(l[q])}function v(w){l[q].localShortcuts=w.shortcuts;m(l[q])}function t(w){l[q].remoteShortcuts=w.shortcuts;m(l[q])}n("show",h.getCurrentApplication())}function i(){return e(".project-shortcut-dialog-trigger img").attr("src")}function g(p){p.getCurrentPanel().body.find("a").unbind(".analytics").bind("click.analytics",function(){var q=this.attributes.href;n("navLinkFollowed",typeof q==="object"?q.value:q)})}function m(p){if(p.localShortcuts){j.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:p.entity.title,logoUrl:i(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(p)}));g(j);c(j)}}function a(r){var q=210;if(!r||r.length<=q){return r}var p=q;while(p>0&&r.charAt(p)!=" "){p--}if(p==0){p=q}r=r.substring(0,p);if(r.length>=p){r=r+"..."}return r}function c(p){var s=p.popup.element,r=s.find(".dialog-panel-body"),q=s.find(".dialog-components");r.height("auto");s.height(q.outerHeight()-1);e(".aui-shadow").remove()}function d(p,q){return e.ajax({url:p,cache:false,data:q,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(h){AJS.EventQueue=AJS.EventQueue||[];var k="jira.project";var B={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function d(J){var L={};for(var K in J.types){if(K!==k){L[K]=J.types[K]}}return L};ATLAS_PROJECT_CREATE.loadRemoteRoots=function a(J){var L=jQuery.Deferred(),M=[],K=[];e(J,function(N){var O=N.capabilitiesUrl;return AJS.$.ajax(O+"/aggregate-root",{success:function(P){var Q=ATLAS_PROJECT_CREATE.getFilteredRootTypes(P);M=M.concat(_.map(Q,function(S,R){return AJS.$.ajax(S.href,{xhrFields:{withCredentials:true},success:function(T){K.push(ATLAS_PROJECT_CREATE.constructFullRootType(T,S.label,R,O,N.id))},error:function(V,T,U){AJS.log("Got "+U+" from aggregate root type "+S.href)}}).promise()}))},error:function(R,P,Q){AJS.log("Got "+Q+" from aggregate roots capapbility for "+O)}}).promise()}).done(function(){u(M).done(function(){L.resolve(K)})});return L.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function g(J,K,N,M,L){return{keys:J.keys,url:J.links.self,label:K,capabilityKey:N,baseUrl:M,instanceId:L}};ATLAS_PROJECT_CREATE.createLink=function w(K,J){console.log("creating link from "+K.entityType+" to "+K.remoteEntityType);var L=JSON.stringify({local:K.baseUrl+"/aggregate-root/"+K.entityType+"/"+K.entityKey,target:K.remoteInstanceBaseUrl+"/aggregate-root/"+K.remoteEntityType+"/"+K.remoteEntityKey});AJS.$.ajax(K.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:L,timeout:8000,complete:J})};ATLAS_PROJECT_CREATE.linkAllTheThings=function q(M,P,J,R,Q){var L=[];h.each(P,function O(S,T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:n()+"/rest/capabilities",remoteEntityType:k,remoteEntityKey:J});L.push({baseUrl:n()+"/rest/capabilities",entityType:k,entityKey:J,remoteInstanceBaseUrl:T.type.baseUrl,remoteEntityType:T.type.capabilityKey,remoteEntityKey:T.data.key});AJS.$.each(P,function U(W,V){if(V!==T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key})}})});var N=0;function K(W,S){if(S!=="success"){N++;var T=W.statusText;try{var V=JSON.parse(W.responseText);if(V&&V.message){T=V.message}}catch(U){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:T});M.updateHeight()}if(L.length>0){ATLAS_PROJECT_CREATE.createLink(L.pop(),K)}else{if(N>0){R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}Q.prop("disabled",false);Q.attr("aria-disabled","false")}}K(null,"success")};var H;function i(M,J,K){var L=J();h.when(M).then(function(N){L.getCurPanel().body.find(".field-group.loading").remove();N.sort(o);if(N.length!==0){var O=L.getCurPanel().body.find("form");O.append(project.creation.remoteRootsCheckboxes({rootTypes:N}));if(K){O.find('input[type="checkbox"]').filter(".remote-root").change(K)}L.updateHeight()}m(L,true)},function(){L.getCurPanel().body.find(".field-group.loading").remove();m(L,true);L.updateHeight()})}var t;function p(J,K){var L=J();t=L.getCurPanel();t.body.find("form").append(project.creation.remoteRootsLoading({}));m(L,false);L.updateHeight();t.page.element.find(".add-project-back-button").click(function(){L.updateHeight()});G(i,J,K)}function j(K){var L=_.filter(t.body.find("input.remote-root.checkbox"),function(M){return M.checked===true});var J=_.map(L,function(M){return M.id});return _.filter(K,function(M){return _.contains(J,"capability_"+M.capabilityKey)})}var c=AJS.$('meta[name="ajs-remote-user"]');if(!c||!c[0]||!c[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var I=function I(O,L,N,K,M){var J=function J(P,Q){Q.prop("disabled",true);Q.attr("aria-disabled","true");Q.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");P()};h.when(H).then(function(Q){var P=j(Q);f(P);if(P.length===0){O.prevPage();L();return}r(O,J,L);var R=[];var S=[];e(P,function(T){var U="creation_status_"+T.capabilityKey.replace(".","_")+"_"+T.instanceId;R.push({statusId:U,label:T.label});return AJS.$.ajax(T.url+"/"+K,{type:"PUT",data:JSON.stringify({label:M}),xhrFields:{withCredentials:true},success:function(V){S=S.concat(D(V,T));z(V,U)},error:function(W,X,V){y(U,T,W,V)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){F(O);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(O,S,K,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:R}))})};var l=function l(K){var J;h.when(H).then(function(N){var M=j(N);_.each(M,function(P){if(P.keys){for(var O in P.keys){if(P.keys.hasOwnProperty(O)){if(K.toUpperCase()===O.toUpperCase()){J=P}}}}})});var L={errors:{}};if(J){L.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",J.label)}return L};function E(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function n(){var J=E();return J+AJS.contextPath()}function G(M,K,L){AJS.$.ajax(n()+"/rest/capabilities/awareness",{type:"GET",success:function J(O){var R="source/rest/capabilities";var P=_.pairs(O.applications);var Q=E()+"/svn";var N=_.map(_.filter(P,function(S){return(S[0].substr(0,Q.length))!==Q}),function(T){var S=T[0];if(S.substr(S.length-R.length)===R){A=T[1]}return _.extend(T[1],{capabilitiesUrl:S})});N.push({id:O.links.selfInstanceId,capabilitiesUrl:O.links.collection});H=ATLAS_PROJECT_CREATE.loadRemoteRoots(N);v=O.links.selfInstanceId;if(typeof M==="function"){M(H,K,L)}},error:function(P,N,O){console.log("Project create error - error gathering roots from awareness capability");if(K){h(K().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var v;var A=null;function e(L,K){var J=_.map(L,K);return u(J)}function u(K){var J=h.Deferred();var L=0;if(K.length===0){J.resolve()}else{_.each(K,function(M){M.always(function(){L++;if(L===K.length){J.resolve()}})})}return J.promise()}function r(L,J,K){L.addPanel("title","","post-project-created-page-content");L.addHeader("Creating and linking companions for your JIRA project");L.addButton("All done!",function(){J(K,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(K,J){var L=[];if(J.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");L.push({type:{capabilityKey:"fecru.repository",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:K.key}});L.push({type:{capabilityKey:"fecru.project",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:"CR-"+K.key}})}else{console.log("got back created thing "+J.capabilityKey);var M={type:J,data:K};L.push(M)}return L}function z(L,M){var K=AJS.$("."+M);K.empty();K.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(L.links.resource){var J=AJS.$("<a target='_blank'></a>");J.text(L.label);J.attr("href",L.links.resource);J.attr("title",L.label);K.closest("li").append(J)}}function y(Q,K,P,O){var M=AJS.$("."+Q);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var J=O;if(P&&P.responseText){try{var N=JSON.parse(P.responseText);if(N&&N.message){J=N.message}}catch(L){J=P.responseText}}AJS.messages.error(".li-"+Q,{title:AJS.format("Could not create {0}",K.label),body:J})}function F(J){var K=J.getCurrentPanel();if(K.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});J.updateHeight()}}function f(J){var K=_.map(J,function(M){return M.capabilityKey});var L=(K.length==0)?"none":K.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:L}})}function m(K,J){h(K.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!J)}function o(K,J){return x(J.capabilityKey)-x(K.capabilityKey)}function x(J){return _.has(B,J)?B[J]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(l);var C=function C(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var b=function b(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){p(C,b)});JPT.AddProjectController.registerPostProjectCreationCallback(function(N,O,M,K,L){var J=function(){window.location=AJS.contextPath()+O};I(N,J,M,K,L)});var s=function s(){var M="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function L(O){if(O==M){G()}});GH.StartWizardView.registerWizardStepPostRenderCallback(function N(Q,O){if(Q==M){p(function P(){return O});O.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function J(T,Q){if(T==M){var S=Q.getCurPanel().body.find("#ghx-wizard-project-projectkey");var P=l(S.val());if(P.errors.projectKey){var O=AJS.$("<div class='error project-creation-error'></div>");var R=S.parent();R.find(".project-creation-error").remove();R.append(O);O.text(P.errors.projectKey);O.show();return false}}return true});GH.StartWizardView.registerWizardStepOnCreateCallbacks(function K(P,Q,O){console.log("creating external entities");P.addPage("post-project-created-page");I(P,Q,null,O.project.key,O.project.name)})};h(function(){AJS.$(".add-project-trigger").live("click",G);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){s()}}});h(function(){AJS.$(".add-project-trigger").live("click",G)})})(jQuery);
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList63 = opt_data.labels;
  var labelListLen63 = labelList63.length;
  for (var labelIndex63 = 0; labelIndex63 < labelListLen63; labelIndex63++) {
    var labelData63 = labelList63[labelIndex63];
    bamboo.components.labelItem(soy.$$augmentData(labelData63, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData63.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function () {
    var $hiddenImg = AJS.$("<img>"),
        $iconUrlInput,
        $urlInput,
        faviconUrl,
        throbberTimeoutId;

    $hiddenImg.load(function() {
        $iconUrlInput.val(faviconUrl);
        $urlInput.css("background-image", 'url("' + faviconUrl + '")');

        clearTimeout(throbberTimeoutId);
        $urlInput.removeClass("loading");
    });
    $hiddenImg.error(function() {
        clearTimeout(throbberTimeoutId);
        $urlInput.removeClass("loading");
    });

    function init(context) {
        $iconUrlInput = AJS.$("#web-link-icon-url", context);
        $urlInput = AJS.$("#web-link-url", context).bind("change", fetchFavicon);

        if ($iconUrlInput.val()) {
            $urlInput.css("background-image", "url(" + $iconUrlInput.val() + ")");
        }
    }

    function fetchFavicon() {
        // Initialise state
        $hiddenImg.attr("src", '');
        $iconUrlInput.val('');
        $urlInput.css("background-image", '');
        faviconUrl = parseFaviconUrl($urlInput.val());

        if (!faviconUrl) {
            return;
        }

        /**
         * IE specific hack: For some reason I cannot change the class inside event handler for the event source.
         */
        setTimeout(function() { $urlInput.addClass("loading"); }, 0);
        throbberTimeoutId = setTimeout(function() { $urlInput.removeClass("loading"); }, 3000);

        $hiddenImg.attr("src", faviconUrl);
    }

    function parseFaviconUrl(url) {
        var hostUrl = url.match(/^([^/]*\/\/[^/]+)/)[1];

        if (!hostUrl) {
            return;
        }

        return hostUrl + "/favicon.ico"
    }

    JIRA.bind(JIRA.Events.NEW_PAGE_ADDED, function (e, context) {
        init(context);
    });
})();
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
/**
 * Initialises OAuth authentication for Confluence Application Links. Requires the following elements:
 * <div class="issue-link-applinks-authentication-message"></div>
 */
(function ($) {

    var settings = {
        getCurrentAppId: function (context) {
            return $("#issue-link-confluence-app-id", context).val();
        },
        shouldExecute: function (context) {
            return $("#confluence-page-link", context).length !== 0;
        }
    };

    JIRA.bind(JIRA.Events.NEW_PAGE_ADDED, function (e, context) {
        IssueLinkAppLinks.init(settings, context);
    });

})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function ($) {
    var confluenceSearchDialog =  new JIRA.FormDialog({
        id: "confluence-page-search-dialog",
        trigger: "#confluence-page-link .confluence-search-trigger",
        widthClass: "large",
        height: "565px",
        content: function (render) {
            var dialog = this;
            JIRA.SmartAjax.makeRequest({
                url: contextPath + "/rest/confluenceIssueLink/1/confluence/applink",
                complete: function (xhr, textStatus, smartAjaxResult) {
                    if (smartAjaxResult.successful) {
                        var appLinks = smartAjaxResult.data.applicationLinks;
                        render(JIRA.Templates.ConfluencePageSearch.result({appLinks: appLinks}));

                        initAppLinks(dialog.$popup).done(function (context, helper) {
                            initSearchDialog(context, helper);
                            $("#link-search-text", context).focus();
                        });
                    } else {
                        AJS.messages.error("#search-results-table", {
                            body: "The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",
                            closeable: false
                        });
                        render();
                    }
                }
            });
        },
        submitHandler: function(e, callback){
            e.preventDefault();
            $("#search-panel-button").click().removeAttr("disabled");
            callback();
        }
    });

    function initSearchDialog($dialog, helper) {
        // Bind the select drop-down
        $("#confluence-app-link", $dialog).change(function () {
            var authenticationRequired = helper.selectServer($(this).val()).authenticationRequired;
            if (!authenticationRequired) {
                populateSpaces($dialog, $(this).val(), helper);
            }
            $("#search-results-table", $dialog).empty();

            // Any previous errors are not relevant to our new selection
            setSearchControlsEnabled(true, $dialog);
        });

        // Bind the search button
        $("#search-panel-button", $dialog).click(function () {
            $("#search-results-table", $dialog).empty();
            var searchText = $("#link-search-text", $dialog).val();
            searchText = $.trim(searchText);
            if (searchText) {
                doSearch(searchText, $dialog);
            } else {
                AJS.messages.info("#search-results-table", {
                    body: "Please enter search value.",
                    closeable: false
                });
            }

            return false;
        });
    }

    var spaceAjaxId = 0;
    function populateSpaces($context, appId, helper) {
        $("select#search-panel-space", $context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());
        var myAjaxId = ++spaceAjaxId;
        JIRA.SmartAjax.makeRequest({
            url: contextPath + "/rest/confluenceIssueLink/1/confluence/space?appId=" + appId,
            complete: function (xhr, textStatus, smartAjaxResult) {
                if (myAjaxId !== spaceAjaxId) {
                    return;
                }
                if (smartAjaxResult.successful) {
                    var spaces = smartAjaxResult.data.spaces;
                    $("select#search-panel-space", $context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces: spaces}));
                } else {
                    if (smartAjaxResult.status === 401) {
                        helper.setAuthenticationRequired(appId, true);
                    } else {
                        // Since we have an error, prevent the user from submitting a search
                        setSearchControlsEnabled(false, $context);

                        var msg;
                        if (smartAjaxResult.status === 403) {
                            msg = "Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content.";
                        } else {
                            msg = "Unable to gather information from the selected Confluence instance.";
                        }
                        AJS.messages.error("#search-results-table", {
                            body: msg,
                            closeable: false
                        });
                    }
                }
            }
        });
    }

    function setSearchControlsEnabled(enabled, $context) {
        if (enabled) {
            $("#link-search-text", $context).removeAttr("disabled");
            $("#search-panel-space", $context).removeAttr("disabled");
            $("#search-panel-button", $context).removeAttr("disabled");
        } else {
            $("#link-search-text", $context).attr("disabled", "disabled");
            $("#search-panel-space", $context).attr("disabled", "disabled");
            $("#search-panel-button", $context).attr("disabled", "disabled");
        }
    }

    function setLoadingIconVisible(visible, $context) {
        $("#link-search-loading", $context).toggleClass("hidden", !visible);
    }

    function doSearch(searchText, $context) {
        setLoadingIconVisible(true, $context);
        var appLinkId = $("#confluence-app-link", $context).val();
        var spaceKey = $("#search-panel-space option:selected", $context).val();
        JIRA.SmartAjax.makeRequest({
            url: contextPath + "/rest/confluenceIssueLink/1/confluence/search?query=" + searchText + "&appId=" + appLinkId + "&spaceKey=" + spaceKey + "&maxResults=10",
            complete: function (xhr, textStatus, smartAjaxResult) {
                setLoadingIconVisible(false, $context);
                if (smartAjaxResult.successful) {
                    var results = smartAjaxResult.data.result;
                    var resultHtml = JIRA.Templates.ConfluencePageSearch.resultsTable({results: results});
                    $("#search-results-table", $context).html(resultHtml);
                } else {
                    // This replicates the JIRA.SmartAjax.buildSimpleErrorContent method, but we can't use that because
                    // it mentions a JIRA instance.
                    var msg;
                    if (smartAjaxResult.hasData) {
                        msg = "The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation.";
                    } else {
                        msg = "The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.";
                    }
                    AJS.messages.error("#search-results-table", {
                        body: msg,
                        closeable: false
                    });
                }

                $("#confluence-searchresult tbody tr", $context).click(function () {
                    var linkUrl = $(this).children().first().data("url");
                    $("#confluence-page-url").val(linkUrl);

        ////        If we want to display the title in the 'description' area on the main dialog
        ////        var linkTitle = $(this).children().first().text();
        ////        $("#confluence-page-url").siblings(".description").text(linkTitle);

                    // Clear all error messages on the parent dialog, as we now have a newly selected URL
                    $("#link-issue-dialog .error").hide();

                    confluenceSearchDialog.hide();
                    $("#link-issue-dialog").show();
                    $("#confluence-page-url").focus().select();
                });
            }
        });
    }

    function initAppLinks($dialog) {
        var settings = {
            getCurrentAppId: function (context) {
                return $("#confluence-app-link", context).val();
            },
            shouldExecute: function (context) {
                return $("#confluence-app-link", context).length !== 0;
            },
            onAuthenticationSuccessCallback: function (context, currentAppId, helper) {
                populateSpaces(context, currentAppId, helper);
            }
        };

        return IssueLinkAppLinks.init(settings, $dialog).done(function (context, helper) {
            populateSpaces(context, settings.getCurrentAppId(context), helper);
        });
    }
});

/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'templates/whats-new.soy' */
// This file was automatically generated from whats-new.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WhatsNew == 'undefined') { JIRA.Templates.WhatsNew = {}; }


JIRA.Templates.WhatsNew.whatsNewDialogPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="whats-new-dialog-text"><div class="whats-new-throbber hidden"></div><div class="whats-new-timeout hidden"><div class="aui-message warning"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Oops."), '</strong></p><p>', AJS.format("We\u2019re having trouble downloading the \x3ca target\x3d\x22_blank\x22 href\x3d\x22{0}\x22\x3eWhat\u2019s New content\x3c/a\x3e from the Atlassian website. This may be because you have a slow internet connection or that no internet connection is available.",opt_data.whatsNewFullLink), '</p></div></div></div><iframe id="whats-new-iframe" class="hidden" scrolling="no" frameborder="0" src="', soy.$$escapeHtml(opt_data.whatsNewHelpLink), '"></iframe>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WhatsNew.whatsNewDialogTipPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-tip"><input id="dont-show-whats-new" type="checkbox" name="dontshow"', (opt_data.dontShowAgain) ? ' checked="checked"' : '', '><label for="dont-show-whats-new" type="checkbox"><span class="checkbox-label">', (opt_data.isOnDemand) ? soy.$$escapeHtml("Don\u2019t show again") : soy.$$escapeHtml("Don\u2019t show again. You will still be able to access this dialog through the \u2018Help\u2019 Menu in the application header."), '</span></label></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'js/whats-new.js' */
Raphael.spinner=function(J,F,H){var N=H||"#fff",M=F*13/60,Q=F*35/60,O=F,D=O+M,C=O+M,L=Raphael(J,O*2+M*2,O*2+M*2),K=[],E=[],S=2*Math.PI/12,I={stroke:N,"stroke-width":M,"stroke-linecap":"round"};
for(var P=0;
P<12;
P++){var G=S*P-Math.PI/2,B=Math.cos(G),A=Math.sin(G);
E[P]=P/12;
K[P]=L.path([["M",D+Q*B,C+Q*A],["L",D+O*B,C+O*A]]).attr(I)
}var R;
(function T(){E.unshift(E.pop());
for(var U=0;
U<12;
U++){K[U].attr("opacity",E[U])
}L.safari();
R=setTimeout(T,80)
})();
return function(){clearTimeout(R);
L.remove()
}
};
var dim=AJS.dim;
AJS.dim=function(){try{dim.apply(this,arguments)
}catch(A){}};
AJS.toInit(function(L){var I=L("#whats-new-menu-link"),E,C,A,M,H,G,K=function(P){var O=!L(this).attr("checked");
var N=contextPath+"/rest/whatsnew/1.0/show";
L.ajax({url:N,data:{},type:O?"POST":"DELETE",success:function(){AJS.log("whatsnew > toggleDontShow > isWelcomeDialogShownForUser set to: "+O)
}})
},D=function(){if(!C){return 
}G&&clearTimeout(G);
F();
AJS.setVisible(C,true)
},J=function(P){var O=new AJS.Dialog({width:855,height:545,id:"whats-new-dialog",onCancel:function(){O.hide().remove();
G&&clearTimeout(G)
}});
var S=AJS.Meta.get("whats-new-iframe-src-override");
if(typeof (S)=="undefined"||S===""){S=AJS.Meta.get("whatsnew-full-link")
}var R="What\u2019s New in JIRA {0}";
var Q=AJS.Meta.get("version-number").match(/^\d+\.\d+/);
var T=AJS.format(R,Q);
O.addHeader(T);
var N=JIRA.Templates.WhatsNew.whatsNewDialogPanel({whatsNewHelpLink:S,whatsNewFullLink:AJS.Meta.get("whatsnew-full-link")});
O.addPanel("default",N);
O.addCancel("Close",function(){O.hide().remove();
G&&clearTimeout(G);
return false
});
A=O.popup.element;
if(AJS.Meta.get("remote-user")){O.page[O.curpage].buttonpanel.append(JIRA.Templates.WhatsNew.whatsNewDialogTipPanel({isOnDemand:AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND"),dontShowAgain:(!P)}));
A.find("#dont-show-whats-new").change(K)
}C=A.find("iframe");
C.load(D);
M=A.find(".whats-new-timeout");
return O
},F=function(){if(H){H();
H=null
}E.addClass("hidden")
},B=function(){var N=contextPath+"/rest/whatsnew/1.0/show";
L.getJSON(N,function(O){J(O.isShownForUser).show();
E=A.find(".whats-new-throbber.hidden");
E.removeClass("hidden");
H=Raphael.spinner(E[0],80,"#666");
G=setTimeout(function(){C=null;
F();
AJS.setVisible(M,true)
},10000)
})
};
I.click(function(N){N.preventDefault();
B()
});
if(AJS.Meta.getBoolean("show-whats-new")){AJS.Popups.DisplayController.request({name:"jira-whats-new-dialog",weight:100,show:function(){B()
}})
}});
/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'templates/welcome.soy' */
// This file was automatically generated from welcome.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WelcomeScreen == 'undefined') { JIRA.Templates.WelcomeScreen = {}; }


JIRA.Templates.WelcomeScreen.welcomeScreenPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="welcome-screen-splash aui-item"><h1><span class="assistive">JIRA</span></h1></div><div class="welcome-screen-content-container aui-item"><div class="welcome-screen-content">', (opt_data.theirName) ? '<h1>' + soy.$$escapeHtml(AJS.format("Welcome, {0}!",opt_data.theirName)) + '</h1>' : '<h1>' + soy.$$escapeHtml("Welcome!") + '</h1>', '<p>', soy.$$escapeHtml("To begin working with JIRA, you need to create a project."), '</p><ul class="welcome-screen-options aui-group"><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'demoproject', href: '/secure/CreateDemoProject.jspa?atl_token=' + opt_data.atl_token, title: "Start with a demo project", description: "Get started with a pre-populated project to get an idea of what you can do in JIRA.", cssClass: ''}, output);
  output.append('</li><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'blankproject', href: '/secure/admin/AddProject!default.jspa?nextAction=browseprojects', title: "Create a blank project", description: "Start with an empty project to begin managing your issues.", cssClass: 'add-project-trigger'}, output);
  output.append('</li></ul></div><div class="welcome-screen-alternate-options"><p>', AJS.format("{0}I\x27\x27ll skip this{1}, I know what I\x27\x27m doing.",opt_data.cancelLinkHtml,'</a>'), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WelcomeScreen.welcomeScreenAction = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="welcome-screen-action ', soy.$$escapeHtml(opt_data.cssClass), '" data-type="', soy.$$escapeHtml(opt_data.type), '" href="', soy.$$escapeHtml("/jira"), soy.$$escapeHtml(opt_data.href), '"><h3>', soy.$$escapeHtml(opt_data.title), '</h3>', (opt_data.description) ? '<p>' + soy.$$escapeHtml(opt_data.description) + '</p>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'js/welcome.js' */
(function(D){var C=contextPath+"/rest/welcome/1.0/show/welcome",B=contextPath+"/rest/welcome/1.0/show/browseprojects",E="welcome-screen-cancel-trigger";
function A(){return JIRA.Templates.WelcomeScreen.welcomeScreenPanel({theirName:AJS.Meta.get("remote-user-fullname")||"",cancelLinkHtml:'<a class="'+E+'" href="'+contextPath+'/">',atl_token:atl_token()})
}JIRA.Dialogs.demoProject=new JIRA.FormDialog({id:"demo-project-dialog",trigger:"a.welcome-screen-action[data-type='demoproject']",stayVisibleOnRedirect:true,onContentRefresh:function(){jQuery(".overflow-ellipsis").textOverflow()
}});
D(document).bind("focusShifterTip.show",function(F){if(AJS.Meta.getBoolean("suppress-focus-shifter-tip")){F.preventDefault()
}});
AJS.toInit(function(J){var G;
var F=function(){var K=new AJS.Dialog({width:860,height:500,id:"welcome-dialog",onCancel:function(){}});
K.addPanel("default",A());
JIRA.bind("Dialog.beforeHide",I);
J("a",K.popup.element).click(function(L){JIRA.unbind("Dialog.beforeHide",I)
});
J("."+E,K.popup.element).click(H);
J(".welcome-screen-action",K.popup.element).click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.action",properties:{type:this.getAttribute("data-type")}});
J.ajax({url:C,type:"DELETE",success:function(){AJS.log("welcome dialog > action clicked > don't show dialog anymore")
}});
K.hide().remove()
});
return K
},I=function(K){if(JIRA.Dialog&&JIRA.Dialog.current&&G&&JIRA.Dialog.current.$popup==G.popup.element){K.preventDefault()
}},H=function(K){K.preventDefault();
G.hide().remove();
AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.dismiss"});
J.ajax({url:C,type:"DELETE",success:function(){AJS.log("welcome dialog > don't show dialog anymore")
}})
};
if(AJS.Meta.getBoolean("show-welcome-screen")){}J(".browse-projects-info-dismiss").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.dismisstext"});
J.ajax({url:B,type:"DELETE",success:function(){AJS.log("browse projects > dismiss clicked > don't show info panel anymore")
}});
J("#browse-projects-info").fadeOut()
});
AJS.bind("messageClose",function(L,K){if(K.attr("id")=="browse-projects-info"){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.closebutton"});
J.ajax({url:B,type:"DELETE",success:function(){AJS.log("browse projects > close button clicked > don't show info panel anymore")
}})
}})
})
})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'lib/brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View);if(typeof JIRA==="undefined"){JIRA={}}if(!JIRA.Issues){JIRA.Issues={}}JIRA.Issues.Brace=k}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'namespaces.js' */
JIRA.Components=JIRA.Components||{};JIRA.Issues=JIRA.Issues||{};JIRA.Events=JIRA.Events||{};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'lib/jquery.hoverIntent.min.js' */
/**
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'util/TipsyView.js' */
if(!jQuery.fn.tooltip){jQuery.fn.tooltip=jQuery.noop;jQuery.fn.tipsy=jQuery.noop}JIRA.Issues.Tipsy=JIRA.Issues.Brace.View.extend({events:{click:"hide"},initialize:function(a){if(_.isFunction(a.showCondition)){this.shouldShow=a.showCondition}else{if(a.showCondition){this.shouldShow=_.bind(function(){return this.$el.filter(a.showCondition).length>0},this)}else{this.shouldShow=function(){return true}}}this.tipsy=this.$el.tooltip(_.extend({trigger:"manual"},a.tipsy));this.hoverIntent(a.intents)},hoverIntent:function(a){if(this.tipsy){this.tipsy.hoverIntent(_.extend({interval:200,over:_.bind(this.show,this),out:_.bind(this.hide,this)},a))}return this},show:function(){if(this.shouldShow()&&this.tipsy){this.$el.tipsy("show")}},hide:function(){if(this.tipsy){this.$el.tipsy("hide")}},remove:function(){this.hide();this.$el.removeData("tipsy")}});JIRA.Issues.Tipsy.revalidate=function(){return jQuery.fn.tipsy.revalidate()};JIRA.Issues.Tipsy.autoBounds=function(){return jQuery.fn.tipsy.autoBounds.apply(jQuery.fn.tipsy,arguments)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/CatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/RecurringPromise.js' */
jQuery.RecurringPromise=function(a){if(!(this instanceof jQuery.RecurringPromise)){return new jQuery.RecurringPromise()}this._parent=a;this._doneCallbacks=jQuery.Callbacks();this._failCallbacks=jQuery.Callbacks();this._alwaysCallbacks=jQuery.Callbacks()};jQuery.RecurringPromise.prototype={add:function(b){var a=jQuery.Deferred();a.original=b;var c=this._getPending();this._abortIfPending(c);this._setPending(a);b.done(_.bind(function(){if(a===this._getPending()){a.resolveWith(this,arguments);this._doneCallbacks.fireWith(this,arguments)}},this));b.fail(_.bind(function(){if(a===this._getPending()){a.rejectWith(this,arguments);this._failCallbacks.fireWith(this,arguments)}},this));b.always(_.bind(function(){if(a===this._getPending()){this._alwaysCallbacks.fireWith(this,arguments)}},this));return a.promise()},done:function(a){this._doneCallbacks.add(a);return this},fail:function(a){this._failCallbacks.add(a);return this},always:function(a){this._alwaysCallbacks.add(a);return this},reset:function(){this._abortIfPending(this._getPending());this._setPending(null)},sub:function(){return new jQuery.RecurringPromise(this)},_getPending:function(){return this._parent?this._parent._getPending():this._pending},_setPending:function(a){if(this._parent){this._parent._setPending(a)}else{this._pending=a}},_abortIfPending:function(a){if(a&&a.state()==="pending"){a.reject("abort");if(jQuery.isFunction(a.original.abort)){a.original.abort()}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ConcurrentDeferred.js' */
jQuery.ConcurrentDeferred=function(c){var b=jQuery.Deferred();var d;var a=function(e){d=e;e.done(function(){if(d===e){b.resolve.apply(b,arguments)}}).fail(function(){if(d===e){b.reject.apply(b,arguments)}})};a(c);jQuery.extend(b,{update:function(e){if(!this.isPending()){throw"Cannot update non-pending ConcurrentDeferred"}var f=d;a(e);if(jQuery.isFunction(f.abort)){f.abort()}return this},isPending:function(){return this.state()==="pending"}});return b};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-events-patch.js' */
(function(){var a=[Backbone.View.prototype,Backbone.Events,Backbone.Model.prototype];if(!Backbone.Events.listenTo){b("listenTo","on")}if(!Backbone.Events.listenToOnce){b("listenToOnce","once")}function b(d,c){_.each(a,function(e){e[d]=function(h,f,j){var g=this._listeners||(this._listeners={});var i=h._listenerId||(h._listenerId=_.uniqueId("l"));g[i]=h;if(typeof f==="object"){j=this}h[c](f,j,this);return this}})}_.each(a,function(c){c.stopListening=function(g,d,i){var e=this._listeners;if(!e){return this}var f=!d&&!i;if(typeof d==="object"){i=this}if(g){(e={})[g._listenerId]=g}for(var h in e){e[h].off(d,i,this);if(f){delete this._listeners[h]}}return this}})}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-misc-patch.js' */
(function(){Backbone.View.prototype.remove=_.compose(function(a){this.stopListening();return a},Backbone.View.prototype.remove);Backbone.$=AJS.$}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/backbone.marionette-noconflict-1.1.0.js' */
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
(function(){var b=this;var a=b.Marionette;Backbone.ChildViewContainer=(function(g,f){var d=function(h){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();f.each(h,this.add,this)};f.extend(d.prototype,{add:function(h,j){var i=h.cid;this._views[i]=h;if(h.model){this._indexByModel[h.model.cid]=i}if(j){this._indexByCustom[j]=i}this._updateLength()},findByModel:function(h){return this.findByModelCid(h.cid)},findByModelCid:function(h){var i=this._indexByModel[h];return this.findByCid(i)},findByCustom:function(i){var h=this._indexByCustom[i];return this.findByCid(h)},findByIndex:function(h){return f.values(this._views)[h]},findByCid:function(h){return this._views[h]},remove:function(h){var i=h.cid;if(h.model){delete this._indexByModel[h.model.cid]}f.any(this._indexByCustom,function(k,j){if(k===i){delete this._indexByCustom[j];return true}},this);delete this._views[i];this._updateLength()},call:function(h){this.apply(h,f.tail(arguments))},apply:function(i,h){f.each(this._views,function(j){if(f.isFunction(j[i])){j[i].apply(j,h||[])}})},_updateLength:function(){this.length=f.size(this._views)}});var e=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];f.each(e,function(h){d.prototype[h]=function(){var i=f.values(this._views);var j=[i].concat(f.toArray(arguments));return f[h].apply(f,j)}});return d})(Backbone,_);Backbone.Wreqr=(function(g,f,d){var e={};e.Handlers=(function(j,i){var h=function(k){this.options=k;this._wreqrHandlers={};if(i.isFunction(this.initialize)){this.initialize(k)}};h.extend=j.Model.extend;i.extend(h.prototype,j.Events,{setHandlers:function(k){i.each(k,function(n,l){var m=null;if(i.isObject(n)&&!i.isFunction(n)){m=n.context;n=n.callback}this.setHandler(l,n,m)},this)},setHandler:function(l,n,m){var k={callback:n,context:m};this._wreqrHandlers[l]=k;this.trigger("handler:add",l,n,m)},hasHandler:function(k){return !!this._wreqrHandlers[k]},getHandler:function(l){var k=this._wreqrHandlers[l];if(!k){throw new Error("Handler not found for '"+l+"'")}return function(){var m=Array.prototype.slice.apply(arguments);return k.callback.apply(k.context,m)}},removeHandler:function(k){delete this._wreqrHandlers[k]},removeAllHandlers:function(){this._wreqrHandlers={}}});return h})(g,d);e.CommandStorage=(function(){var h=function(i){this.options=i;this._commands={};if(d.isFunction(this.initialize)){this.initialize(i)}};d.extend(h.prototype,g.Events,{getCommands:function(j){var i=this._commands[j];if(!i){i={command:j,instances:[]};this._commands[j]=i}return i},addCommand:function(j,i){var k=this.getCommands(j);k.instances.push(i)},clearCommands:function(i){var j=this.getCommands(i);j.instances=[]}});return h})();e.Commands=(function(h){return h.Handlers.extend({storageType:h.CommandStorage,constructor:function(j){this.options=j||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);h.Handlers.prototype.constructor.apply(this,i)},execute:function(j,i){j=arguments[0];i=Array.prototype.slice.call(arguments,1);if(this.hasHandler(j)){this.getHandler(j).apply(this,i)}else{this.storage.addCommand(j,i)}},_executeCommands:function(i,k,j){var l=this.storage.getCommands(i);d.each(l.instances,function(m){k.apply(j,m)});this.storage.clearCommands(i)},_initializeStorage:function(i){var k;var j=i.storageType||this.storageType;if(d.isFunction(j)){k=new j()}else{k=j}this.storage=k}})})(e);e.RequestResponse=(function(h){return h.Handlers.extend({request:function(){var j=arguments[0];var i=Array.prototype.slice.call(arguments,1);return this.getHandler(j).apply(this,i)}})})(e);e.EventAggregator=(function(j,h){var i=function(){};i.extend=j.Model.extend;h.extend(i.prototype,j.Events);return i})(g,d);return e})(Backbone,Backbone.Marionette,_);var c=(function(e,j,d){var i={};j.Marionette=i;i.$=j.$;var f=Array.prototype.slice;function g(k){return f.call(k)}function h(m,l){var k=new Error(m);k.name=l||"Error";throw k}i.extend=j.Model.extend;i.getOption=function(m,k){if(!m||!k){return}var l;if(m.options&&(k in m.options)&&(m.options[k]!==undefined)){l=m.options[k]}else{l=m[k]}return l};i.triggerMethod=(function(){var l=/(^|:)(\w)/gi;function m(o,p,n){return n.toUpperCase()}var k=function(o){var n="on"+o.replace(l,m);var p=this[n];if(d.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(d.isFunction(p)){return p.apply(this,d.tail(arguments))}};return k})();i.MonitorDOMRefresh=(function(){function m(n){n._isShown=true;k(n)}function l(n){n._isRendered=true;k(n)}function k(n){if(n._isShown&&n._isRendered){if(d.isFunction(n.triggerMethod)){n.triggerMethod("dom:refresh")}}}return function(n){n.listenTo(n,"show",function(){m(n)});n.listenTo(n,"render",function(){l(n)})}})();(function(p){function o(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];if(!w){h("Method '"+v+"' was configured as an event handler, but does not exist.")}u.listenTo(s,q,w,u)})}function k(s,r,q,t){s.listenTo(r,q,t,s)}function m(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];u.stopListening(s,q,w,u)})}function l(s,r,q,t){s.stopListening(r,q,t,s)}function n(t,q,u,s,r){if(!q||!u){return}if(d.isFunction(u)){u=u.call(t)}d.each(u,function(w,v){if(d.isFunction(w)){s(t,q,v,w)}else{r(t,q,v,w)}})}p.bindEntityEvents=function(r,q,s){n(r,q,s,k,o)};p.unbindEntityEvents=function(r,q,s){n(r,q,s,l,m)}})(i);i.Callbacks=function(){this._deferred=i.$.Deferred();this._callbacks=[]};d.extend(i.Callbacks.prototype,{add:function(l,k){this._callbacks.push({cb:l,ctx:k});this._deferred.done(function(n,m){if(k){n=k}l.call(n,m)})},run:function(k,l){this._deferred.resolve(l,k)},reset:function(){var k=this._callbacks;this._deferred=i.$.Deferred();this._callbacks=[];d.each(k,function(l){this.add(l.cb,l.ctx)},this)}});i.Controller=function(k){this.triggerMethod=i.triggerMethod;this.options=k||{};if(d.isFunction(this.initialize)){this.initialize(this.options)}};i.Controller.extend=i.extend;d.extend(i.Controller.prototype,j.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});i.Region=function(l){this.options=l||{};this.el=i.getOption(this,"el");if(!this.el){var m=new Error("An 'el' must be specified for a region.");m.name="NoElError";throw m}if(this.initialize){var k=Array.prototype.slice.apply(arguments);this.initialize.apply(this,k)}};d.extend(i.Region,{buildRegion:function(l,r){var p=(typeof l==="string");var o=(typeof l.selector==="string");var s=(typeof l.regionType==="undefined");var m=(typeof l==="function");if(!m&&!p&&!o){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var k,n;if(p){k=l}if(l.selector){k=l.selector}if(m){n=l}if(!m&&s){n=r}if(l.regionType){n=l.regionType}var q=new n({el:k});if(l.parentEl){q.getEl=function(t){var u=l.parentEl;if(d.isFunction(u)){u=u()}return u.find(t)}}return q}});d.extend(i.Region.prototype,j.Events,{show:function(m){this.ensureEl();var k=m.isClosed||d.isUndefined(m.$el);var l=m!==this.currentView;if(l){this.close()}m.render();if(l||k){this.open(m)}this.currentView=m;i.triggerMethod.call(this,"show",m);i.triggerMethod.call(m,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(k){return i.$(k)},open:function(k){this.$el.empty().append(k.el)},close:function(){var k=this.currentView;if(!k||k.isClosed){return}if(k.close){k.close()}else{if(k.remove){k.remove()}}i.triggerMethod.call(this,"close");delete this.currentView},attachView:function(k){this.currentView=k},reset:function(){this.close();delete this.$el}});i.Region.extend=i.extend;i.RegionManager=(function(m){var l=m.Controller.extend({constructor:function(n){this._regions={};m.Controller.prototype.constructor.call(this,n)},addRegions:function(n,o){var p={};d.each(n,function(r,q){if(typeof r==="string"){r={selector:r}}if(r.selector){r=d.defaults({},r,o)}var s=this.addRegion(q,r);p[q]=s},this);return p},addRegion:function(p,q){var s;var o=d.isObject(q);var n=d.isString(q);var r=!!q.selector;if(n||(o&&r)){s=m.Region.buildRegion(q,m.Region)}else{if(d.isFunction(q)){s=m.Region.buildRegion(q,m.Region)}else{s=q}}this._store(p,s);this.triggerMethod("region:add",p,s);return s},get:function(n){return this._regions[n]},removeRegion:function(n){var o=this._regions[n];this._remove(n,o)},removeRegions:function(){d.each(this._regions,function(o,n){this._remove(n,o)},this)},closeRegions:function(){d.each(this._regions,function(o,n){o.close()},this)},close:function(){this.removeRegions();var n=Array.prototype.slice.call(arguments);m.Controller.prototype.close.apply(this,n)},_store:function(n,o){this._regions[n]=o;this._setLength()},_remove:function(n,o){o.close();delete this._regions[n];this._setLength();this.triggerMethod("region:remove",n,o)},_setLength:function(){this.length=d.size(this._regions)}});var k=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];d.each(k,function(n){l.prototype[n]=function(){var p=d.values(this._regions);var o=[p].concat(d.toArray(arguments));return d[n].apply(d,o)}});return l})(i);i.TemplateCache=function(k){this.templateId=k};d.extend(i.TemplateCache,{templateCaches:{},get:function(k){var l=this.templateCaches[k];if(!l){l=new i.TemplateCache(k);this.templateCaches[k]=l}return l.load()},clear:function(){var l;var k=g(arguments);var m=k.length;if(m>0){for(l=0;l<m;l++){delete this.templateCaches[k[l]]}}else{this.templateCaches={}}}});d.extend(i.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var k=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(k);return this.compiledTemplate},loadTemplate:function(k){var l=i.$(k).html();if(!l||l.length===0){h("Could not find template: '"+k+"'","NoTemplateError")}return l},compileTemplate:function(k){return d.template(k)}});i.Renderer={render:function(m,n){if(!m){var k=new Error("Cannot render the template since it's false, null or undefined.");k.name="TemplateNotFoundError";throw k}var l;if(typeof m==="function"){l=m}else{l=i.TemplateCache.get(m)}return l(n)}};i.View=j.View.extend({constructor:function(){d.bindAll(this,"render");var k=Array.prototype.slice.apply(arguments);j.View.prototype.constructor.apply(this,k);i.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:i.triggerMethod,getTemplate:function(){return i.getOption(this,"template")},mixinTemplateHelpers:function(k){k=k||{};var l=i.getOption(this,"templateHelpers");if(d.isFunction(l)){l=l.call(this)}return d.extend(k,l)},configureTriggers:function(){if(!this.triggers){return}var l={};var k=d.result(this,"triggers");d.each(k,function(n,m){l[m]=function(p){if(p&&p.preventDefault){p.preventDefault()}if(p&&p.stopPropagation){p.stopPropagation()}var o={view:this,model:this.model,collection:this.collection};this.triggerMethod(n,o)}},this);return l},delegateEvents:function(k){this._delegateDOMEvents(k);i.bindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.bindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(k){k=k||this.events;if(d.isFunction(k)){k=k.call(this)}var m={};var l=this.configureTriggers();d.extend(m,k,l);j.View.prototype.delegateEvents.call(this,m)},undelegateEvents:function(){var k=Array.prototype.slice.call(arguments);j.View.prototype.undelegateEvents.apply(this,k);i.unbindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.unbindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return}var k=this.triggerMethod("before:close");if(k===false){return}this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return}if(!this._uiBindings){this._uiBindings=this.ui}var k=d.result(this,"_uiBindings");this.ui={};d.each(d.keys(k),function(m){var l=k[m];this.ui[m]=this.$(l)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return}d.each(this.ui,function(l,k){delete this.ui[k]},this);this.ui=this._uiBindings;delete this._uiBindings}});i.ItemView=i.View.extend({constructor:function(){i.View.prototype.constructor.apply(this,g(arguments))},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}else{if(this.collection){k={items:this.collection.toJSON()}}}return k},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var m=this.serializeData();m=this.mixinTemplateHelpers(m);var l=this.getTemplate();var k=i.Renderer.render(l,m);this.$el.html(k);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return}this.triggerMethod("item:before:close");i.View.prototype.close.apply(this,g(arguments));this.triggerMethod("item:closed")}});i.CollectionView=i.View.extend({itemViewEventPrefix:"itemview",constructor:function(k){this._initChildViewStorage();i.View.prototype.constructor.apply(this,g(arguments));this._initialEvents()},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(n,o,l){this.closeEmptyView();var m=this.getItemView(n);var k=this.collection.indexOf(n);this.addItemView(n,m,k)},onShowCalled:function(){this.children.each(function(k){i.triggerMethod.call(k,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}},showCollection:function(){var k;this.collection.each(function(m,l){k=this.getItemView(m);this.addItemView(m,k,l)},this)},showEmptyView:function(){var l=i.getOption(this,"emptyView");if(l&&!this._showingEmptyView){this._showingEmptyView=true;var k=new j.Model();this.addItemView(k,l,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getItemView:function(l){var k=i.getOption(this,"itemView");if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},addItemView:function(n,m,l){var o=i.getOption(this,"itemViewOptions");if(d.isFunction(o)){o=o.call(this,n,l)}var k=this.buildItemView(n,m,o);this.addChildViewEventForwarding(k);this.triggerMethod("before:item:added",k);this.children.add(k);this.renderItemView(k,l);if(this._isShown){i.triggerMethod.call(k,"show")}this.triggerMethod("after:item:added",k)},addChildViewEventForwarding:function(k){var l=i.getOption(this,"itemViewEventPrefix");this.listenTo(k,"all",function(){var m=g(arguments);m[0]=l+":"+m[0];m.splice(1,0,k);i.triggerMethod.apply(this,m)},this)},renderItemView:function(k,l){k.render();this.appendHtml(this,k,l)},buildItemView:function(m,k,n){var l=d.extend({model:m},n);return new k(l)},removeItemView:function(l){var k=this.children.findByModel(l);this.removeChildView(k);this.checkEmpty()},removeChildView:function(k){if(k){this.stopListening(k);if(k.close){k.close()}else{if(k.remove){k.remove()}}this.children.remove(k)}this.triggerMethod("item:removed",k)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendHtml:function(k,m,l){k.$el.append(m.el)},_initChildViewStorage:function(){this.children=new j.ChildViewContainer()},close:function(){if(this.isClosed){return}this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");i.View.prototype.close.apply(this,g(arguments))},closeChildren:function(){this.children.each(function(k){this.removeChildView(k)},this);this.checkEmpty()}});i.CompositeView=i.CollectionView.extend({constructor:function(){i.CollectionView.prototype.constructor.apply(this,g(arguments))},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}},getItemView:function(l){var k=i.getOption(this,"itemView")||this.constructor;if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}return k},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var k=this.renderModel();this.$el.html(k);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){i.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var l={};l=this.serializeData();l=this.mixinTemplateHelpers(l);var k=this.getTemplate();return i.Renderer.render(k,l)},appendHtml:function(k,m,l){var n=this.getItemViewContainer(k);n.append(m.el)},getItemViewContainer:function(n){if("$itemViewContainer" in n){return n.$itemViewContainer}var l;var m=i.getOption(n,"itemViewContainer");if(m){var k=d.isFunction(m)?m():m;l=n.$(k);if(l.length<=0){h("The specified `itemViewContainer` was not found: "+n.itemViewContainer,"ItemViewContainerMissingError")}}else{l=n.$el}n.$itemViewContainer=l;return l},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});i.Layout=i.ItemView.extend({regionType:i.Region,constructor:function(k){k=k||{};this._firstRender=true;this._initializeRegions(k);i.ItemView.prototype.constructor.call(this,k)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var l=Array.prototype.slice.apply(arguments);var k=i.ItemView.prototype.render.apply(this,l);return k},close:function(){if(this.isClosed){return}this.regionManager.close();var k=Array.prototype.slice.apply(arguments);i.ItemView.prototype.close.apply(this,k)},addRegion:function(k,l){var m={};m[k]=l;return this._buildRegions(m)[k]},addRegions:function(k){this.regions=d.extend({},this.regions,k);return this._buildRegions(k)},removeRegion:function(k){delete this.regions[k];return this.regionManager.removeRegion(k)},_buildRegions:function(m){var k=this;var l={regionType:i.getOption(this,"regionType"),parentEl:function(){return k.$el}};return this.regionManager.addRegions(m,l)},_initializeRegions:function(k){var l;this._initRegionManager();if(d.isFunction(this.regions)){l=this.regions(k)}else{l=this.regions||{}}this.addRegions(l)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(k){k.reset()})},_initRegionManager:function(){this.regionManager=new i.RegionManager();this.listenTo(this.regionManager,"region:add",function(k,l){this[k]=l;this.trigger("region:add",k,l)});this.listenTo(this.regionManager,"region:remove",function(k,l){delete this[k];this.trigger("region:remove",k,l)})}});i.AppRouter=j.Router.extend({constructor:function(l){j.Router.prototype.constructor.apply(this,g(arguments));this.options=l||{};var m=i.getOption(this,"appRoutes");var k=this._getController();this.processAppRoutes(k,m)},appRoute:function(m,l){var k=this._getController();this._addAppRoute(k,m,l)},processAppRoutes:function(k,m){if(!m){return}var l=d.keys(m).reverse();d.each(l,function(n){this._addAppRoute(k,n,m[n])},this)},_getController:function(){return i.getOption(this,"controller")},_addAppRoute:function(k,m,l){var n=k[l];if(!n){throw new Error("Method '"+l+"' was not found on the controller")}this.route(m,l,d.bind(n,k))}});i.Application=function(k){this._initRegionManager();this._initCallbacks=new i.Callbacks();this.vent=new j.Wreqr.EventAggregator();this.commands=new j.Wreqr.Commands();this.reqres=new j.Wreqr.RequestResponse();this.submodules={};d.extend(this,k);this.triggerMethod=i.triggerMethod};d.extend(i.Application.prototype,j.Events,{execute:function(){var k=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,k)},request:function(){var k=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,k)},addInitializer:function(k){this._initCallbacks.add(k)},start:function(k){this.triggerMethod("initialize:before",k);this._initCallbacks.run(k,this);this.triggerMethod("initialize:after",k);this.triggerMethod("start",k)},addRegions:function(k){return this._regionManager.addRegions(k)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(k){this._regionManager.removeRegion(k)},getRegion:function(k){return this._regionManager.get(k)},module:function(k,m){var l=g(arguments);l.unshift(this);return i.Module.create.apply(i.Module,l)},_initRegionManager:function(){this._regionManager=new i.RegionManager();this.listenTo(this._regionManager,"region:add",function(k,l){this[k]=l});this.listenTo(this._regionManager,"region:remove",function(k,l){delete this[k]})}});i.Application.extend=i.extend;i.Module=function(k,l){this.moduleName=k;this.submodules={};this._setupInitializersAndFinalizers();this.app=l;this.startWithParent=true;this.triggerMethod=i.triggerMethod};d.extend(i.Module.prototype,j.Events,{addInitializer:function(k){this._initializerCallbacks.add(k)},addFinalizer:function(k){this._finalizerCallbacks.add(k)},start:function(k){if(this._isInitialized){return}d.each(this.submodules,function(l){if(l.startWithParent){l.start(k)}});this.triggerMethod("before:start",k);this._initializerCallbacks.run(k,this);this._isInitialized=true;this.triggerMethod("start",k)},stop:function(){if(!this._isInitialized){return}this._isInitialized=false;i.triggerMethod.call(this,"before:stop");d.each(this.submodules,function(k){k.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();i.triggerMethod.call(this,"stop")},addDefinition:function(k,l){this._runModuleDefinition(k,l)},_runModuleDefinition:function(l,m){if(!l){return}var k=d.flatten([this,this.app,j,i,i.$,d,m]);l.apply(this,k)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new i.Callbacks();this._finalizerCallbacks=new i.Callbacks()}});d.extend(i.Module,{create:function(q,k,l){var m=q;var o=g(arguments);o.splice(0,3);k=k.split(".");var n=k.length;var p=[];p[n-1]=l;d.each(k,function(r,s){var t=m;m=this._getModule(t,r,q);this._addModuleDefinition(t,m,p[s],o)},this);return m},_getModule:function(o,l,p,n,k){var m=o[l];if(!m){m=new i.Module(l,p);o[l]=m;o.submodules[l]=m}return m},_addModuleDefinition:function(p,l,o,k){var n;var m;if(d.isFunction(o)){n=o;m=true}else{if(d.isObject(o)){n=o.define;m=o.startWithParent}else{m=true}}if(n){l.addDefinition(n,k)}l.startWithParent=l.startWithParent&&m;if(l.startWithParent&&!l.startWithParentIsConfigured){l.startWithParentIsConfigured=true;p.addInitializer(function(q){if(l.startWithParent){l.start(q)}})}}});return i})(this,Backbone,_);c.noConflict=function(){b.Marionette=a;return this};b.Marionette=c})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/marionette.adapter.js' */
AJS.namespace("JIRA.Libs.Marionette");JIRA.Libs.Marionette=Marionette.noConflict();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Mixins.js' */
AJS.namespace("JIRA.Marionette.Mixins");JIRA.Marionette.Mixins={listenAndRethrow:function(b,a){a=[].concat(a);_.each(a,function(c){this.listenTo(b,c,function(){this.trigger.apply(this,[c].concat(_.toArray(arguments)))},this)},this)}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/LinkRegion.js' */
AJS.namespace("JIRA.Marionette.LinkRegion");JIRA.Marionette.LinkRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.append(a.$el.children());a.setElement(this.$el)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ReplaceRegion.js' */
AJS.namespace("JIRA.Marionette.ReplaceRegion");JIRA.Marionette.ReplaceRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.replaceWith(a.el)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Controller.js' */
AJS.namespace("JIRA.Marionette.Controller");JIRA.Marionette.Controller=JIRA.Libs.Marionette.Controller.extend({});_.extend(JIRA.Marionette.Controller.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ItemView.js' */
AJS.namespace("JIRA.Marionette.ItemView");JIRA.Marionette.ItemView=JIRA.Libs.Marionette.ItemView.extend({renderTemplate:function(){var c=this.serializeData();c=this.mixinTemplateHelpers(c);var b=this.getTemplate();var a=JIRA.Libs.Marionette.Renderer.render(b,c);return JIRA.Libs.Marionette.$(a)},applyToDom:function(){this.delegateEvents();this.bindUIElements();this.triggerMethod("applyToDom")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/CollectionView.js' */
AJS.namespace("JIRA.Marionette.CollectionView");JIRA.Marionette.CollectionView=JIRA.Libs.Marionette.CollectionView;
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Layout.js' */
AJS.namespace("JIRA.Marionette.Layout");JIRA.Marionette.Layout=JIRA.Libs.Marionette.Layout.extend({applyToDom:function(){this.delegateEvents();this.bindUIElements();this._reInitializeRegions();this.triggerMethod("applyToDom")}});_.extend(JIRA.Marionette.Layout.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Application.js' */
AJS.namespace("JIRA.Marionette.Application");JIRA.Marionette.Application=JIRA.Libs.Marionette.Application.extend({constructor:function(a){JIRA.Libs.Marionette.Application.call(this,a)},start:function(a){if(!a||a.forceStop!==false){this.stop()}JIRA.Libs.Marionette.Application.prototype.start.call(this,a)},stop:function(){_.invoke(this.submodules,"stop")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/AppModule.js' */
AJS.namespace("JIRA.Marionette.AppModule");JIRA.Marionette.AppModule=function(){this.definition=_.bind(this.definition,this)};JIRA.Marionette.AppModule.extend=JIRA.Libs.Marionette.extend;_.extend(JIRA.Marionette.AppModule.prototype,{create:function(){throw new Error("create() must be implemented by AppModules")},generateMasterRequest:false,name:"",commands:{},requests:{},events:[],definition:function(b,d){var c=this.name;var a=this;if(!c){throw new Error("'name' must be defined by AppModules")}b.addInitializer(function(g){var f=a.create.apply(a,_.toArray(arguments));function i(k){if(_.isFunction(k)){k=k(f)}var l={};_.each(k,function(n,m){if(n===true){n=_.bind(f[m],f)}if(m&&c){m=c+":"+m}else{m=c}l[m]=n});return l}function h(l,k){if(_.isFunction(k)){k=k(f)}_.each(k,function(n){var m=c+":"+n;l.listenTo(f,n,function(){this.trigger.apply(this,[m].concat(_.toArray(arguments)))})})}var e=i(a.commands);var j=i(a.requests);if(a.generateMasterRequest){_.extend(j,i({"":function(){return f}}))}d.commands.setHandlers(e);d.reqres.setHandlers(j);h(d,a.events)})}});_.extend(JIRA.Marionette.AppModule.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'analytics/Analytics.js' */
AJS.namespace("JIRA.Components.Analytics");JIRA.Components.Analytics=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=new JIRA.Components.Analytics.Services.Trigger(a);this.trackerService=new JIRA.Components.Analytics.Services.DomTracker(this.triggerService)},trigger:function(a,b){this.triggerService.trigger(a,b)},registerEvent:function(b){var a=[].concat(b);_.each(a,function(c){this.triggerService.registerEvent(c)},this)},registerTracker:function(a){var b=[].concat(a);_.each(b,function(c){this.trackerService.registerTracker(c)},this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'analytics/AnalyticsAppModule.js' */
AJS.namespace("JIRA.Components.Analytics.AppModule");JIRA.Components.Analytics.AppModule=JIRA.Marionette.AppModule.extend({name:"analytics",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{useLog:false});return new JIRA.Components.Analytics(a)},commands:{trigger:true,registerEvent:true,registerTracker:true}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'analytics/services/Trigger.js' */
AJS.namespace("JIRA.Components.Analytics.Services.Trigger");JIRA.Components.Analytics.Services.Trigger=JIRA.Marionette.Controller.extend({initialize:function(a){this.useLog=a.useLog;this.allowedEvents=[];this.startTime=new Date().getTime();this.pageSessionGuid=Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)},trigger:function(b,c){if(!AJS.EventQueue){return}if(!_.contains(this.allowedEvents,b)){return}c=c||{};c.context_pageSession=this.pageSessionGuid;c.context_pageTime=new Date().getTime()-this.startTime;AJS.EventQueue.push({name:b,properties:c});if(this.useLog){var a="***** Analytics log ["+b+"]";a+="["+JSON.stringify(c)+"]";AJS.log(a)}},registerEvent:function(a){this.allowedEvents.push(a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'analytics/services/DomTracker.js' */
AJS.namespace("JIRA.Components.Analytics.Services.DomTracker");JIRA.Components.Analytics.Services.DomTracker=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=a;this.trackers=[]},registerTracker:function(a){var b=this.triggerService;_.defaults(a,{type:"click",handler:function(d,c){b.trigger(this.name,c)},context:document});b.registerEvent(a.name);a.domHandler=function(c){if(!c.preventFurtherAnalytics){a.handler.apply(a,Array.prototype.slice.call(arguments))}};AJS.$(a.context).on(a.type,a.selector,a.domHandler);this.trackers.push(a)},clear:function(){_.each(this.trackers,function(a){AJS.$(a.context).off(a.type,a.selector,a.domHandler)})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/AttributesMixinCreator.js' */
AJS.namespace("JIRA.Issues.AttributesMixinCreator");(function(){JIRA.Issues.AttributesMixinCreator={create:function(b){var a={};if(_.indexOf(b,"id")===-1){b.unshift("id")}_.each(b,function(d){var e=JIRA.Issues.Mixins.createMethodName("set",d);a[e]=function(h,f){var g={};g[d]=h;this.set(g,f);return this};var c=JIRA.Issues.Mixins.createMethodName("get",d);a[c]=function(){return this.get(d)}});return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/EventsMixinCreator.js' */
(function(){JIRA.Issues.EventsMixinCreator={create:function(b){var a={};var c=function(e){var d=JIRA.Issues.Mixins.createMethodName("bind",e);a[d]=function(){return this.bind.apply(this,[e].concat(_.toArray(arguments)))};var g=JIRA.Issues.Mixins.createMethodName("unbind",e);a[g]=function(){return this.unbind.apply(this,[e].concat(_.toArray(arguments)))};var f=JIRA.Issues.Mixins.createMethodName("trigger",e);a[f]=function(){return this.trigger.apply(this,[e].concat(_.toArray(arguments)))};var h=JIRA.Issues.Mixins.createMethodName("one",e);a[h]=function(){var i=this;var j=arguments[0];var l=function(){i.unbind(e,l);j(arguments)};var k=_.toArray(arguments).slice(1);return this.bind.apply(this,[e,l].concat(k))}};_.each(b,_.bind(c,this));return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Extensions.js' */
AJS.namespace("JIRA.Issues.BaseModel");AJS.namespace("JIRA.Issues.BaseCollection");AJS.namespace("JIRA.Issues.BaseView");AJS.namespace("JIRA.Issues.BaseRouter");(function(){function applyMixin(ctor,mixin){_.forEach(_.keys(mixin),function(key){var proto=ctor.prototype;if("initialize"===key){var oldInitialize=proto.initialize;proto.initialize=function(){mixin.initialize.apply(this,arguments);if(oldInitialize){oldInitialize.apply(this,arguments)}};return}if("validate"===key){var oldValidate=proto.validate;proto.validate=function(){var errors=mixin.validate.apply(this,arguments);if(errors){return errors}if(oldValidate){return oldValidate.apply(this,arguments)}};return}if("defaults"===key){var defaults=proto.defaults||(proto.defaults={});var mixinDefaults=mixin[key];for(var id in mixinDefaults){if(defaults.hasOwnProperty(id)){throw"Mixin error: object "+ctor+" already has default "+id+" defined for mixin "+mixin}defaults[id]=mixinDefaults[id]}return}if("properties"===key){if(!_.isArray(mixin[key])){throw"Expects properties member on mixin to be an array"}if(!proto.properties){proto.properties=[]}proto.properties=proto.properties.concat(mixin[key]);return}if("namedEvents"===key){if(!_.isArray(mixin[key])){throw"Expects events member on mixin to be an array"}if(!proto.namedEvents){proto.namedEvents=[]}proto.namedEvents=proto.namedEvents.concat(mixin[key]);return}if(proto.hasOwnProperty(key)){throw"Mixin error: object "+ctor+" already has property "+key+" for mixin "+mixin}proto[key]=mixin[key]},this)}function generateMixinExtend(oldExtend){return function(protoProps,classProps){var child;var cleanProtoProps=_.extend({},protoProps);var mixins;if(protoProps&&protoProps.mixins){mixins=protoProps.mixins;delete cleanProtoProps.mixins}child=oldExtend.call(this,cleanProtoProps,classProps);if(mixins){_.each(protoProps.mixins,function(mixin){applyMixin(child,mixin)})}if(child.prototype.namedEvents){applyMixin(child,JIRA.Issues.EventsMixinCreator.create(child.prototype.namedEvents))}if(child.prototype.properties){applyMixin(child,JIRA.Issues.AttributesMixinCreator.create(child.prototype.properties))}child.extend=arguments.callee;return child}}function overrideSetGet(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.set=function(key,value,options){var attrs,properties=this.properties;if(properties){if(_.isObject(key)||key==null){attrs=key}else{attrs={};attrs[key]=value}for(var attr in attrs){if(_.indexOf(properties,attr)<0){throw"Property '"+attr+"' does not exist"}}}return proto.set.apply(this,arguments)};childProto.get=function(attr){if(this.properties&&_.indexOf(this.properties,attr)<0){throw"Property '"+attr+"' does not exist"}return proto.get.apply(this,arguments)}}function addListenMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.addListener=function(other,event,callback,context){if(arguments.length<3){throw"The 'other', 'event', and 'callback' arguments are mandatory"}var capitalisedEvent=event.charAt(0).toUpperCase()+event.slice(1);var registerMethodName="on"+capitalisedEvent;var unregisterMethodName="off"+capitalisedEvent;var braceRegisterMethodName="bind"+capitalisedEvent;var braceUnregisterMethodName="unbind"+capitalisedEvent;var finalRegisterName;var finalUnRegisterName;if(other[registerMethodName]){finalRegisterName=registerMethodName;finalUnRegisterName=unregisterMethodName||braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have method "+registerMethodName+"'"}if(typeof other[finalUnRegisterName]!=="function"){throw"object does not have method "+unregisterMethodName+"'"}}else{finalRegisterName=braceRegisterMethodName;finalUnRegisterName=braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have event ["+event+"] registered'"}}other[finalRegisterName](callback,context);this._cleanerUppers=this._cleanerUppers||[];this._cleanerUppers.push(function(){other[finalUnRegisterName](callback,context)})};childProto.removeListeners=function(){if(this._cleanerUppers){_.each(this._cleanerUppers,function(cleanerUpper){cleanerUpper()})}}}function addViewCleanupMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;var superRemove=proto.remove;childProto.remove=function(){this.removeListeners();return superRemove.apply(this,arguments)};proto.deactivate=function(){this.undelegateEvents();this.removeListeners()}}function applyExtensions(ctor){var child=ctor.extend();var oldExtend=ctor.extend;child.extend=generateMixinExtend(oldExtend);return child}function applyModelExtensions(ctor){var child=applyExtensions(ctor);overrideSetGet(ctor,child);return child}function applyViewExtensions(ctor){var child=applyExtensions(ctor);addListenMethods(ctor,child);addViewCleanupMethods(ctor,child);return child}JIRA.Issues.BaseModel=applyModelExtensions(Backbone.Model);JIRA.Issues.BaseCollection=applyExtensions(Backbone.Collection);JIRA.Issues.BaseView=applyViewExtensions(Backbone.View);JIRA.Issues.BaseRouter=applyExtensions(Backbone.Router);var Evented=function(){this.initialize.apply(this,arguments)};_.extend(Evented.prototype,Backbone.Events,{initialize:function(){}});Evented.extend=Backbone.Model.extend;JIRA.Issues.BaseEvented=applyExtensions(Evented);_.mixin({lambda:function(x){return function(){return x}},isNotBlank:function(object){return !!object},bindObjectTo:function(obj,context){_.map(obj,function(value,key){if(_.isFunction(value)){obj[key]=_.bind(value,context)}})}});Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Mixins.js' */
(function(){JIRA.Issues.Mixins={createMethodName:function(a,b){return a+b.charAt(0).toUpperCase()+b.substr(1)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/ModelUtils.js' */
(function(){var d;function c(){this.modelEvents={}}c.prototype.captureEvent=function(g,f){var e=f[0];this.modelEvents[g.cid]||(this.modelEvents[g.cid]={model:g,events:{}});this.modelEvents[g.cid].events[e]=f};c.prototype.replayEvents=function(){_.each(this.modelEvents,function(e){_.each(e.events,function(g,f){Backbone.Events.trigger.apply(e.model,g)})})};function a(f){var e=this;if(f==="change"||f.indexOf("change:")===0){d.log.captureEvent(e,_.toArray(arguments))}else{Backbone.Events.trigger.apply(e,arguments)}}var b=function(){if(d){return{commit:function(){}}}d={log:new c()};var e=JIRA.Issues.Utils.patch(Backbone.Model.prototype,"trigger",a);return{commit:function(){e();d.log.replayEvents();d=null}}};JIRA=JIRA||{};JIRA.Issues=JIRA.Issues||{};JIRA.Issues.ModelUtils=JIRA.Issues.ModelUtils||{};JIRA.Issues.ModelUtils.transaction=function(g,f){var e=b();try{return g.apply(f)}finally{e.commit()}};JIRA.Issues.ModelUtils.makeTransactional=function(f){var g=function(h){return function(){var i=arguments;return JIRA.Issues.ModelUtils.transaction(function(){return h.apply(this,i)},this)}};var e=Array.prototype.slice.call(arguments,1);if(e.length===0){e=_.functions(f)}_.each(e,function(h){if(h.indexOf("_")!==0){f[h]=g(f[h])}})}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.queryparams.js' */
/*! THIS FILE HAS BEEN MODIFIED BY ATLASSIAN, SEE https://github.com/jhudson8/backbone-query-parameters/pull/63/files */
(function(a,b){if(typeof exports==="object"&&a.require){module.exports=b(require("underscore"),require("backbone"))}else{if(typeof define==="function"&&define.amd){define(["underscore","backbone"],function(c,d){return b(c||a._,d||a.Backbone)})}else{b(_,Backbone)}}}(this,function(q,b){var i=/^\?(.*)/,g=/\((.*?)\)/g,e=/(\(\?)?:\w+/g,o=/\*\w+/g,d=/[\-{}\[\]+?.,\\\^$|#\s]/g,h=/^([^\?]*)/,k=/[\:\*]([^\:\?\/]+)/g,j=/^[#\/]|\s+$/g,c=/\/$/;b.Router.arrayValueSplit="|";var f=function(u,t){if(u==null){if(this._hasPushState||!this._wantsHashChange||t){u=this.location.pathname;var s=this.root.replace(c,"");var v=this.location.search;if(!u.indexOf(s)){u=u.substr(s.length)}if(v){u+=v}}else{u=this.getHash()}}return u.replace(j,"")};function l(u,t,s){q.each(Array.prototype.slice.call(arguments,2),function(v){Object.defineProperty(t,v,{get:function(){return u[v]},set:function(w){u[v]=w}})})}l.isSupported=(function(){try{Object.defineProperty({},"x",{});return true}catch(s){return false}})();function a(u){var s=u.location,t={};l(s,t,"assign","ancestorOrigins","origin","hash","search","pathname","port","hostname","host","protocol","href","reload");t.replace=function(){s.replace(u.root+"#"+u.fragment)};t.unPatch=function(){return u.location=s};u.location=t}function r(u){var s=u.history,t={};l(s,t,"length","state","back","forward","go","pushState");t.replaceState=function(w,x,v){v=u.root+u.fragment;return s.replaceState(w,x,v)};t.unPatch=function(){u.history=s};u.history=t}var m=b.History.prototype.start,n=b.History.prototype.loadUrl;q.extend(b.History.prototype,{getFragment:f,getQueryParameters:function(u,s){u=f.apply(this,arguments);var w=u.replace(h,"");var t=w.match(i);if(t){w=t[1];var v={};p(w,function(x,y){y=y.replace(/\+/g,"%20");y=decodeURIComponent(y);if(!v[x]){v[x]=y}else{if(q.isString(v[x])){v[x]=[v[x],y]}else{v[x].push(y)}}});return v}else{return{}}},start:function(){if(l.isSupported){a(this);r(this)}try{return m.apply(this,arguments)}finally{this.location.unPatch&&this.location.unPatch();this.history.unPatch&&this.history.unPatch()}},loadUrl:function(){this.location&&this.location.unPatch&&this.location.unPatch();this.history&&this.history.unPatch&&this.history.unPatch();return n.apply(this,arguments)}});q.extend(b.Router.prototype,{initialize:function(s){this.encodedSplatParts=s&&s.encodedSplatParts},getFragment:f,_routeToRegExp:function(t){var u=(o.exec(t)||{index:-1}),s=(e.exec(t)||{index:-1}),w=t.match(k)||[];t=t.replace(d,"\\$&").replace(g,"(?:$1)?").replace(e,function(y,x){return x?y:"([^\\/\\?]+)"}).replace(o,"([^??]*?)");t+="(\\?.*)?";var v=new RegExp("^"+t+"$");if(u.index>=0){if(s>=0){v.splatMatch=u.index-s.index}else{v.splatMatch=-1}}v.paramNames=q.map(w,function(x){return x.substring(1)});v.namedParameters=this.namedParameters;return v},_extractParameters:function(A,y){var u=A.exec(y).slice(1),z={};if(u.length>0&&q.isUndefined(u[u.length-1])){u.splice(u.length-1,1)}var x=u.length&&u[u.length-1]&&u[u.length-1].match(i);if(x){var s=x[1];var w={};if(s){var B=this;p(s,function(C,D){B._setParamValue(C,D,w)})}u[u.length-1]=w;q.extend(z,w)}var t=u.length;if(A.splatMatch&&this.encodedSplatParts){if(A.splatMatch<0){return u}else{t=t-1}}for(var v=0;v<t;v++){if(q.isString(u[v])){u[v]=decodeURIComponent(u[v]);if(A.paramNames&&A.paramNames.length>=v-1){z[A.paramNames[v]]=u[v]}}}return(b.Router.namedParameters||A.namedParameters)?[z]:u},_setParamValue:function(u,x,w){u=u.replace("[]","");var y=u.split(".");var v=w;for(var t=0;t<y.length;t++){var s=y[t];if(t===y.length-1){v[s]=this._decodeParamValue(x,v[s])}else{v=v[s]=v[s]||{}}}},_decodeParamValue:function(v,u){v=v.replace(/\+/g,"%20");var w=b.Router.arrayValueSplit;if(w&&v.indexOf(w)>=0){var s=v.split(w);for(var t=s.length-1;t>=0;t--){if(!s[t]){s.splice(t,1)}else{s[t]=decodeURIComponent(s[t])}}return s}v=decodeURIComponent(v);if(!u){return v}else{if(q.isArray(u)){u.push(v);return u}else{return[u,v]}}},toFragment:function(t,s){if(s){if(!q.isString(s)){s=this._toQueryString(s)}if(s){t+="?"+s}}return t},_toQueryString:function(u,s){var B=b.Router.arrayValueSplit;function w(D){return String(D).replace(B,encodeURIComponent(B))}if(!u){return""}s=s||"";var z="";for(var t in u){var y=u[t];if(q.isString(y)||q.isNumber(y)||q.isBoolean(y)||q.isDate(y)){y=this._toQueryParam(y);if(q.isBoolean(y)||q.isNumber(y)||q.isString(y)||y){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+w(encodeURIComponent(y))}}else{if(q.isArray(y)){var A="";for(var x=0;x<y.length;x++){var v=this._toQueryParam(y[x]);if(q.isBoolean(v)||v!==null){A+=B+w(v)}}if(A){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+A}}else{var C=this._toQueryString(y,this._toQueryParamName(t,s,true));if(C){z+=(z?"&":"")+C}}}}return z},_toQueryParamName:function(s,u,t){return(u+s+(t?".":""))},_toQueryParam:function(s){if(q.isNull(s)||q.isUndefined(s)){return null}return s}});function p(u,t){var s=u.split("&");q.each(s,function(w){var v=w.split("=");t(v.shift(),v.join("="))})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k=i.Brace={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.define.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Utils.js' */
JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.DELETE="delete";JIRA.Issues.Actions.UPDATE="update";JIRA.Issues.Actions.INLINE_EDIT="inlineEdit";JIRA.Issues.Actions.ROW_UPDATE="rowUpdate";JIRA.Issues.XsrfTokenHeader={"X-Atlassian-Token":"nocheck"};JIRA.Issues.Utils={isIssueDialog:function(a){return !!a.issueId||_.include(JIRA.Dialogs,a)},isDeleteDialog:function(a){return a.options.id==="delete-issue-dialog"},isEditCommentDialog:function(a){return a.options.id==="edit-comment"},getEffectiveIssueKeyForDialog:function(a){var b=a&&a.$activeTrigger&&a.$activeTrigger.data("issuekey");if(b){return b}else{return JIRA.Issues.Api.getSelectedIssue().getKey()}},getEffectiveIssueIdForDialog:function(a){if(a.issueId){return a.issueId}else{return JIRA.Issues.Api.getSelectedIssue().getId()}},getAction:function(a){if(this.isDeleteDialog(a)){return JIRA.Issues.Actions.DELETE}else{if(this.isEditCommentDialog(a)){return JIRA.Issues.Actions.EDIT_COMMENT}else{return JIRA.Issues.Actions.UPDATE}}},getMessage:function(a){if(!this.isEditCommentDialog(a)){return a.options.issueMsg||"thanks_issue_updated"}},getMeta:function(a){if(this.isEditCommentDialog(a)){return{commentId:a.$activeTrigger.attr("id").replace("edit_comment_","")}}else{return{}}},getUpdateCommandForDialog:function(b){var a=this;if(this.isIssueDialog(b)){return{key:a.getEffectiveIssueKeyForDialog(b),id:a.getEffectiveIssueIdForDialog(b),action:a.getAction(b),message:a.getMessage(b),meta:a.getMeta(b)}}},debounce:function(a,c){var b=Array.prototype.slice.call(arguments,2);if(!a){console.error("JIRA.Issues.Utils.debounce: ctx must be defined")}clearTimeout(a[c+"DebounceTimeout"]);a[c].apply(a,b);if(!a[c+"DebounceTimeout"]){a[c+"Original"]=a[c];a[c]=_.debounce(function(){return a[c+"Original"].apply(a,arguments)},300)}a[c+"DebounceTimeout"]=setTimeout(function(){a[c]=a[c+"Original"];a[c+"DebounceTimeout"]=null},500)},waitForDeferreds:function(e,d,a){a=a||window;var c=[];var b=jQuery.Deferred();_.each(e,function(){var f=d.apply(a,arguments);if(f&&f.promise){c.push(f)}});if(c.length){jQuery.when.apply(jQuery,c).then(function(){b.resolveWith(a)})}else{b.resolveWith(a)}return b.promise()},resolvedPromise:function(){return jQuery.Deferred().resolve().promise()},patch:function(b,a,e){var f=b.hasOwnProperty(a),c=b[a];b[a]=e;return function d(){if(f){b[a]=c}else{delete b[a]}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/AuiOverrides.js' */
AJS.undim=function(){if(AJS.dim.$dim){AJS.dim.$dim.remove();AJS.dim.$dim=null;if(AJS.dim.shim){AJS.dim.shim.remove()}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.$("html").removeAttr("style")}else{AJS.$("body").removeAttr("style")}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollIntoView.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(g){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var f=/^(?:html)$/i;var h=function(l,k){k=k||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var j=document.defaultView&&document.defaultView.getComputedStyle?true:false;var i={top:(parseFloat(j?k.borderTopWidth:g.css(l,"borderTopWidth"))||0),left:(parseFloat(j?k.borderLeftWidth:g.css(l,"borderLeftWidth"))||0),bottom:(parseFloat(j?k.borderBottomWidth:g.css(l,"borderBottomWidth"))||0),right:(parseFloat(j?k.borderRightWidth:g.css(l,"borderRightWidth"))||0)};return{top:i.top,left:i.left,bottom:i.bottom,right:i.right,vertical:i.top+i.bottom,horizontal:i.left+i.right}};var d=function(i){var k=g(window);var j=f.test(i[0].nodeName);return{border:j?{top:0,left:0,bottom:0,right:0}:h(i[0]),scroll:{top:(j?k:i).scrollTop(),left:(j?k:i).scrollLeft()},scrollbar:{right:j?0:i.innerWidth()-i[0].clientWidth,bottom:j?0:i.innerHeight()-i[0].clientHeight},rect:(function(){var l=i[0].getBoundingClientRect();return{top:j?0:l.top,left:j?0:l.left,bottom:j?i[0].clientHeight:l.bottom,right:j?i[0].clientWidth:l.right}})()}};g.fn.extend({scrollIntoViewForAuto:function(k){k=g.extend({},b,k);k.direction=c[typeof(k.direction)==="string"&&k.direction.toLowerCase()]||c.both;var o="";if(k.direction.x===true){o="horizontal"}if(k.direction.y===true){o=o?"both":"vertical"}var m=this.eq(0);var j=m.closest(":scrollable("+o+")");if(j.length>0){j=j.eq(0);var n={e:d(m),s:d(j)};var i={top:n.e.rect.top-(n.s.rect.top+n.s.border.top),bottom:n.s.rect.bottom-n.s.border.bottom-n.s.scrollbar.bottom-n.e.rect.bottom,left:n.e.rect.left-(n.s.rect.left+n.s.border.left),right:n.s.rect.right-n.s.border.right-n.s.scrollbar.right-n.e.rect.right};var l={};if(k.direction.y===true){if(i.top<0){l.scrollTop=n.s.scroll.top+i.top-30}else{if(i.top>0&&i.bottom<0){l.scrollTop=n.s.scroll.top+Math.min(i.top,-i.bottom)+30}}}if(k.direction.x===true){if(i.left<0){l.scrollLeft=n.s.scroll.left+i.left}else{if(i.left>0&&i.right<0){l.scrollLeft=n.s.scroll.left+Math.min(i.left,-i.right)}}}if(!g.isEmptyObject(l)){if(f.test(j[0].nodeName)){j=g("html,body")}j.animate(l,k.duration).eq(0).queue(function(p){g.isFunction(k.complete)&&k.complete.call(j[0]);p()})}else{g.isFunction(k.complete)&&k.complete.call(j[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};g.extend(g.expr[":"],{scrollable:function(l,j,o,i){var n=c[typeof(o[3])==="string"&&o[3].toLowerCase()]||c.both;var m=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var p={x:a[m.overflowX.toLowerCase()]||false,y:a[m.overflowY.toLowerCase()]||false,isRoot:f.test(l.nodeName)};if(!p.x&&!p.y&&!p.isRoot){return false}var k={height:{scroll:l.scrollHeight,client:l.clientHeight},width:{scroll:l.scrollWidth,client:l.clientWidth},scrollableX:function(){return(p.x||p.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(p.y||p.isRoot)&&this.height.scroll>this.height.client}};return n.y&&k.scrollableY()||n.x&&k.scrollableX()}});var e=jQuery.fn.scrollIntoView;JIRA.Issues.overrideScrollIntoViewForSplit=function(){jQuery.fn.scrollIntoView=jQuery.fn.scrollIntoViewForAuto};JIRA.Issues.restoreScrollIntoViewForNormal=function(){jQuery.fn.scrollIntoView=e}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/IssueNavFeatures.js' */
AJS.namespace("JIRA.Issues.Feature");JIRA.Issues.Feature=Class.extend({init:function(a){this.featureKey=a},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});AJS.namespace("JIRA.Issues.GhettoFeature");JIRA.Issues.GhettoFeature=JIRA.Issues.Feature.extend({enabled:function(){return this._super()&&(!this._ieGhetto.enabled()||history.pushState)},_ieGhetto:new JIRA.Issues.Feature("ka.ghetto")});JIRA.Issues.KillSwitchFeature=JIRA.Issues.Feature.extend({enabled:function(){var a=AJS.DarkFeatures.isEnabled("ka.ghetto")&&!history.pushState;return this._super()||a}});AJS.namespace("JIRA.Issues.DarkFeatures");JIRA.Issues.DarkFeatures={KILL_SWITCH:new JIRA.Issues.KillSwitchFeature("ka.KILL_SWITCH"),NO_PREFETCH:new JIRA.Issues.GhettoFeature("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new JIRA.Issues.Feature("rotp.project.shortcuts")};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/analytics.js' */
AJS.namespace("JIRA.Issues.AnalyticsLoader");JIRA.Issues.AnalyticsLoader=function(){JIRA.Issues.Application.execute("analytics:registerEvent",["kickass.search","kickass.switchtobasic","kickass.switchtoadvanced","kickass.returntosearch","kickass.editField","kickass.editMultipleFields","kickass.editClientDuration","kickass.editClientCancelledDuration","kickass.editSaveonserverDuration","kickass.issueLoadDuration","kickass.openIssueFromTable","kickass.issueTotalSaveDuration","kickass.focusshifteropened","kickass.queryTooComplexSwitchToAdvanced","kickass.basicModeCriteriaCountWhenSearching","kickass.criteriaAutoUpdateEnabled","kickass.issueTableRefresh","kickass.conditionalLoading","kickass.viewIssue","kickass.inlineEdit"]);JIRA.Issues.Application.execute("analytics:trigger","kickass.criteriaAutoUpdateEnabled",{enabled:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.Issues.Application.execute("analytics:registerTracker",[{name:"kickass.clickedOnSystemFilter",selector:".system-filters a",handler:a},{name:"kickass.clickedOnFavouriteFilter",selector:".favourite-filters a.filter-link"},{name:"kickass.clickedOnFavouriteFilterActionsMenu",selector:".favourite-filters a.filter-actions"},{name:"kickass.renamedFilterFromActionsMenu",selector:"#rename-filter-form",type:"submit"},{name:"kickass.deletedFilterFromActionsMenu",selector:"#delete-filter-form",type:"submit"},{name:"kickass.copiedFilterFromActionsMenu",selector:"#copy-filter-dialog form",type:"submit"},{name:"kickass.removeFilterFromFavouritesViaActionsMenu",selector:".unfavourite-filter"},{name:"kickass.saveACopyOfFilterFromSearchHeader",selector:"#save-filter-dialog form",type:"submit"},{name:"kickass.filterChangesSaved",selector:".header-section-primary .save-changes"},{name:"kickass.clickedOnShowFiltersDetailsDropDown",selector:".show-filter-details",type:"mousedown"},{name:"kickass.clickedOnChangePermissions",selector:".filter-permissions .change-permissions"},{name:"kickass.clickedOnUnfavouriteStar",selector:".filter-operations .fav-link.off"},{name:"kickass.clickedOnSaveFilterAs",selector:".save-as-new-filter",handler:f},{name:"kickass.clickedOnPagniationLink",selector:".pagination a",handler:e},{name:"kickass.inbrowsersearch",type:"keydown",handler:c},{name:"kickass.reloadPage",type:"keydown",handler:g},{name:"kickass.moreCriteriaNewlySelectedCount",type:AJS.InlineLayer.EVENTS.beforeHide,handler:d},{name:"kickass.createdNewSearch",selector:".new-search"},{name:"kickass.sortByColumn",selector:".sortable",handler:b},{name:"kickass.findFiltersClicked",selector:".find-filters"}]);function a(j){var i=AJS.$(j.target);JIRA.Issues.Application.execute("analytics:trigger",this.name,{name:h(i.attr("href"))})}function f(){var j=AJS.$(".system-filters a.active").length===1,i=AJS.$(".favourite-filters a.active").length===1;JIRA.Issues.Application.execute("analytics:trigger",this.name,{systemFilterSelected:j,favouriteFilterSelected:i})}function h(i){var j=parseUri(i);return j.queryKey.filter}function e(k){var j=AJS.$(k.target),i=j.text();JIRA.Issues.Application.execute("analytics:trigger",this.name,{page:i})}function c(i){if(i.keyCode===70&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function g(i){if(i.keyCode===82&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function d(l,j){if(j&&j.find("#criteria-multi-select").length){var k=AJS.$("#criteria-multi-select");var i=k.find("input[checked]").length-k.find(".selected-group input[checked]").length;JIRA.Issues.Application.execute("analytics:trigger",this.name,{count:i})}}function b(i){var j=jQuery(i.target);if(!j.is("th")){j=j.parent("th")}if(j.length){JIRA.Issues.Application.execute("analytics:trigger",this.name,{direction:j.hasClass("ascending")?"descending":"ascending",column:j.data("id")})}}JIRA.Issues.Application.on("issueEditor:loadComplete",function(i,j){if(!j.fromCache){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.getId(),loadReason:j.loadReason,duration:j.duration,loadedFromDom:false})}JIRA.Issues.Application.execute("analytics:trigger","kickass.issueLoadDuration",{issueId:j.issueId,duration:j.duration,loadReason:j.loadReason,fromCache:j.fromCache})});JIRA.Issues.Application.on("issueEditor:render",function(j,i){if(i.loadedFromDom){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.issueId,loadedFromDom:true})}});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(i){JIRA.Issues.Application.execute("analytics:trigger","kickass.inlineEdit",{issueId:i.issueId,savedFieldIds:i.savedFieldIds,duration:i.duration})})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Stalker.js' */
(function(b){var a;b.fn.stalker=function(d){var e=this,h;if(!e.length||e.data("stalker-applied")){return}e.data("stalker-applied",true);d=d||{};d.offsetTop=d.offsetTop||0;function g(){if(a){e.css({position:"",top:"",left:"",right:"",height:""}).removeClass("detached");e.unbind("stalkerHeightUpdated",j);a.remove();a=null}}function f(){if(!a){a=jQuery("<div class='stalker-placeholder' />").css("visibility","hidden").addClass(e[0].className).height(e.outerHeight()).width(e.outerWidth()).insertBefore(e);e.bind("stalkerHeightUpdated",j);e.css({position:"fixed",top:d.offsetTop,left:h.left,right:h.right}).addClass("detached");if(typeof c.timeout==="undefined"){c()}}}function j(){a.height(e.height())}function i(){if(!e.is(":visible")){return}if(!h){h=e.offset()}if(b(window).scrollTop()+d.offsetTop>=h.top){f()}else{g()}}function c(){if(a){i();c.timeout=setTimeout(c,250)}else{delete c.timeout}}b(window).bind("resize scroll",i);i();return{unstalk:function(){g();b(window).unbind("resize scroll",i)}}}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Sidebar.js' */
/*!
 * jQuery UI Sidebar
 * http://jqueryui.com
 *
 * Depends:
 *   jquery.ui.widget.js
 */
(function(a){a.widget("ui.sidebar",{version:"0.1",options:{minWidth:function(b){return 50},maxWidth:function(b){return jQuery(window).width()},resize:a.noop,easeOff:(jQuery.browser.msie&&jQuery.browser.version<=8)?500:0},_create:function(){_.bindAll(this,"_handleDrag","_persist","_setContainment","_setHandlePosition","updatePosition");if(this.options.easeOff){this.updatePosition=_.debounce(this.updatePosition,this.options.easeOff)}if(!this.options.id){console.error("ui.sidebar: You must specify an id")}this._addHandle();this._restore();this.handle.mousedown(this._setContainment);this.handle.draggable({axis:"x",drag:this._handleDrag,stop:this._persist});a(window).resize(_.debounce(this.updatePosition,30))},_restore:function(){if(window.localStorage){var b=localStorage.getItem("ui.sidebar."+this.options.id);if(b){this._setWidth(b)}}},_persist:function(){if(window.localStorage){localStorage.setItem("ui.sidebar."+this.options.id,this.element.outerWidth())}},_setContainment:function(){var b=jQuery(window).height();this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth(this);this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth(this));this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]})},_handleDrag:function(d,b){var c=b.position.left-this._elementLeft;this._setWidth(c,true)},_setWidth:function(e,d){if(!d){var c=this.options.maxWidth(this);var b=this.options.minWidth(this);if(e>c){e=c}else{if(e<b){e=b}}}e-=this.element.outerWidth()-this.element.width();this.element.width(e);this.options.resize(e)},_addHandle:function(){this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);_.defer(this._setHandlePosition)},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var c=this.element.offset();var b=c.left+this.element.outerWidth();this.handle.css({top:c.top,left:b,height:this.element.outerHeight()}).show()}},updatePosition:function(){this._setHandlePosition();this._setWidth(this.handle.offset().left-this._elementLeft);this._persist()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/PopoutSidebar.js' */
(function(a){a.widget("ui.popoutSidebar",{version:"0.1",options:{renderExpanded:a.noop,renderCollapsed:a.noop,persist:a.noop,collapsedWidth:30,expandedWidth:200,minWidth:function(){return 200},maxWidth:function(){return 500},resize:a.noop,dockText:"Dock",undockText:"Undock",dockTitle:"Dock the filter panel so you can always see the list of filters",undockTitle:"Undock the filter panel so it is hidden when not being focused"},CLASS_NAMES:{popout:"ui-popout",placeholder:"ui-popout-placeholder",detached:"ui-popout-detached",expanding:"ui-popout-expanding",expanded:"ui-popout-expanded",collapsed:"ui-popout-collapsed",collapsing:"ui-popout-collapsing"},_create:function(){_.bindAll(this,"_handleDropdown","_registerMousePos","collapse","expand","updateOffsets");if(!this.element.data("popoutsidebar")){this.element.data("popoutsidebar",true);var b=!!jQuery.browser.msie&&jQuery.browser.version<=8;this.element.bind("updateOffsets.popout",b?_.debounce(this.updateOffsets,200):this.updateOffsets);this.element.delegate(".ui-dock","click",_.bind(function(c){this.dock(true);c.preventDefault()},this));this.element.delegate(".ui-undock","click",_.bind(function(c){this.undock(true);c.preventDefault()},this));this.isDocked=this.options.isDocked;this.expandedWidth=this.options.expandedWidth;this.useTransitions=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)>8;if(this.options.isDocked){this._renderUnDock()}else{this._enableUndockedMode()}this.updateOffsets()}},_init:function(){if(this.options.isDocked){this._setupHandle()}},_persistState:function(){this.expandedWidth=this.element.outerWidth();this.options.persist(this.isDocked,this.expandedWidth)},_setContainment:function(){var b=jQuery(window).height();this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth();this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth());this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]});this.handle.css("position","absolute")},_setWidth:function(b){b=Math.min(Math.max(this.options.minWidth(),b),this.options.maxWidth());this.element.width(b)},_setupHandle:function(){this._getContents();this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);this._setWidth(this.expandedWidth);this._setHandlePosition();this.handle.mousedown(_.bind(this._setContainment,this));this.handle.draggable({axis:"x",drag:_.bind(this._handleDrag,this),stop:_.bind(this._persistState,this)})},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var b=this.element.offset();var c=b.left+this.element.outerWidth();this.handle.css({left:c}).show()}},_handleDrag:function(d,b){var c=b.position.left;this._setWidth(c);this.options.resize()},_getUndockedClasses:function(){return[this.CLASS_NAMES.detached].join(" ")},_getUndockedStates:function(){return[this.CLASS_NAMES.collapsed,this.CLASS_NAMES.collapsing,this.CLASS_NAMES.expanding,this.CLASS_NAMES.expanded].join(" ")},_setUndockedState:function(b){this.element.removeClass(this._getUndockedStates());this.element.addClass(b)},unbindHoverIntent:function(){this.element.off("mouseleave mouseenter mousemove");this.element[0].hoverIntent_s=0},bindHoverIntent:function(){this.element.hoverIntent({interval:40,over:this.expand,out:this.collapse,sensitivity:8})},_unbindUnDockedEvents:function(){this.unbindHoverIntent();JIRA.unbind(AJS.InlineLayer.EVENTS.show,this._handleDropdown);a(window).unbind("scroll",this.updateOffsets)},_bindUnDockedEvents:function(b){this.bindHoverIntent();a(window).scroll(this.updateOffsets);this.element[0].hoverIntent_s=b?1:0},isUndocked:function(){return this.element.hasClass(this.CLASS_NAMES.detached)},_registerMousePos:function(b){this._clientX=b.clientX;this._clientY=b.clientY},_handleDropdown:function(){a(document).mousemove(this._registerMousePos);if(this.isUndocked()&&AJS.InlineLayer.current.offsetTarget().closest(this.element).size()){this.unbindHoverIntent();JIRA.one(AJS.InlineLayer.EVENTS.hide,_.bind(function(){_.defer(_.bind(function(){if(!AJS.InlineLayer.current){if(JIRA.Dialog.current||this._clientX>this.element.offset().left+this.element.outerWidth()){this.collapse(JIRA.Dialog.current?false:true);this.bindHoverIntent()}else{this.bindHoverIntent();this.element[0].hoverIntent_s=1}a(document).unbind("mousemove",this._registerMousePos)}},this))},this))}},updateOffsets:function(f){if(this.element.is(":visible")){var d=a("body").height()>a(window).height();if(d){this.element.addClass("ui-sidebar-scrollable")}else{this.element.removeClass("ui-sidebar-scrollable")}if(this.isUndocked()){var c=this._getPlaceholder().offset().top;var g=jQuery(window).scrollTop();var h=Math.max(c-g,0);var b=d?a(window).height()-h:Math.min(this._getPlaceholder().outerHeight(),a(window).height()-this._getPlaceholder().offset().top);var e={top:h,height:b};if(f){e.width=f}this.element.css(e)}}},_renderUnDock:function(){if(this.isDocked&&!this.element.find(".ui-undock").size()){this.element.find(".ui-dock").remove();this._renderDockingLink(this.options.undockText,this.options.undockTitle,"ui-undock")}},_renderDock:function(){if(this.isUndocked()&&!this.element.find(".ui-dock").size()){this.element.find(".ui-undock").remove();this._renderDockingLink(this.options.dockText,this.options.dockTitle,"ui-dock")}},_renderDockingLink:function(e,d,b){var c=a("<a class='aui-button aui-button-subtle' href='#'/>").addClass(b).append(a("<span class='icon'/>").text(e)).attr("title",d);this.dockTipsy=new JIRA.Issues.Tipsy({el:c});this._getContents().find(this.options.toggleTarget).append(c)},renderDockState:function(){if(this.isDocked){this._renderUnDock()}else{this._renderDock()}},_enableUndockedMode:function(b){this.element.addClass(this.CLASS_NAMES.popout);if(!this.isUndocked()){this._getPlaceholder().insertBefore(this.element);this.element.addClass(this.CLASS_NAMES.detached).addClass(this.CLASS_NAMES.collapsed).appendTo("body")}this.updateOffsets();this._bindUnDockedEvents(b);JIRA.bind(AJS.InlineLayer.EVENTS.show,this._handleDropdown)},_getPlaceholder:function(){if(!this.placeholder){this.placeholder=a("<div class='navigator-sidebar collapsed' />")}return this.placeholder},toggle:function(){if(!this.isExpanding()&&!this.isCollapsing()){if(this.isDocked){this.undock(false)}else{this.dock(false)}}},undock:function(b){if(!this.isUndocked()){this.isDocked=false;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._persistState();this._getPlaceholder().insertBefore(this.element);this.element.addClass(this._getUndockedClasses()+" "+this.CLASS_NAMES.expanded).appendTo("body");if(b!==false&&this.useTransitions){this._getPlaceholder().width(this.expandedWidth).animate({width:this.options.collapsedWidth},200)}else{this._getPlaceholder().width(this.options.collapsedWidth)}this.updateOffsets(this.expandedWidth);this.collapse(b,_.bind(function(){this._enableUndockedMode(false)},this))}},dock:function(b){if(this.isUndocked()){this.isDocked=true;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._unbindUnDockedEvents();this._persistState();if(b!==false&&this.useTransitions){this._getPlaceholder().animate({width:this.expandedWidth},200,_.bind(this._dockingComplete,this))}else{this._dockingComplete()}}},_dockingComplete:function(){this.element.removeClass(this._getUndockedClasses());this.element.removeClass(this._getUndockedStates());this.element.css({height:"",width:"",top:""}).insertBefore(this._getPlaceholder());this._getPlaceholder().remove();this.options.renderExpanded(this.element);this._setupHandle();this._renderUnDock();JIRA.Issues.triggerHorizontalResize()},_getContents:function(){if(!this.element.find(".ui-sidebar-content").size()){this.element.wrapInner("<div class='ui-sidebar-content' />")}return this.element.find(".ui-sidebar-content")},expand:function(b){if(this.isCollapsed()){this.updateOffsets();if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.expanding);this.element.animate({width:this.expandedWidth},150,_.bind(function(){this._setUndockedState(this.CLASS_NAMES.expanded);this.options.renderExpanded(this.element);this._renderDock();this._getContents().css("opacity",0).animate({opacity:1},200,_.bind(this._expandingComplete,this))},this))}else{this.element.css("width",this.expandedWidth);this.options.renderExpanded(this.element);this._renderDock();this._expandingComplete()}}else{if(this.isCollapsing()){this.activityAfterTransition="expand"}else{if(this.isExpanding()){this.activityAfterTransition=null}}}},_expandingComplete:function(){JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(true);this._setUndockedState(this.CLASS_NAMES.expanded);if(this.activityAfterTransition==="collapse"){this.activityAfterTransition=null;this.collapse(true)}},collapse:function(b,c){if(this.isExpanded()){if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.collapsing);this._getContents().animate({opacity:0},150,_.bind(function(){this.options.renderCollapsed(this.element);this.element.width(this.expandedWidth);this.element.animate({width:this.options.collapsedWidth},150,_.bind(function(){this._collapsingComplete(c)},this))},this))}else{this.options.renderCollapsed(this.element);this.element.width("");this._collapsingComplete(c)}}else{if(this.isExpanding()){this.activityAfterTransition="collapse"}else{if(this.isCollapsing()){this.activityAfterTransition=null}}}},_collapsingComplete:function(b){this._setUndockedState(this.CLASS_NAMES.collapsed);JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(false);if(this.activityAfterTransition==="expand"){this.activityAfterTransition=null;this.expand(true)}if(typeof b==="function"){b()}},isCollapsed:function(){return this.element.hasClass(this.CLASS_NAMES.collapsed)},isCollapsing:function(){return this.element.hasClass(this.CLASS_NAMES.collapsing)},isExpanded:function(){return this.element.hasClass(this.CLASS_NAMES.expanded)},isExpanding:function(){return this.element.hasClass(this.CLASS_NAMES.expanding)}})}(jQuery));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/HtmlCatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){if(console&&console.error&&typeof d==="string"){console.error("Error while evaluating HTML: "+f.message+", in: ",d)}}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/SingleSelect.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={properties:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/LoadingClass.js' */
AJS.namespace("JIRA.Issues.Mixin.LoadingClass");JIRA.Issues.Mixin.LoadingClass={addLoadingClass:function(){this.$el.addClass("loading")},removeLoadingClass:function(){this.$el.removeClass("loading")}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/DefaultMessageOptions.js' */
AJS.namespace("JIRA.Issues.getDefaultMessageOptions",window,function(){return{closeable:true,timeout:5}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/SessionTimedOutDialog.js' */
AJS.namespace("JIRA.Issues.SessionTimedOutDialog");JIRA.Issues.SessionTimedOutDialog={dialogHasShown:false,whiteList:["/secure/Search!Jql.jspa","/secure/SearchRendererEdit!Default.jspa","/rest/issueNav/1/issueTable","/rest/issueNav/latest","/rest/api/2/filter"],onRequestResponse:function(f,g,d){if(!this.dialogHasShown&&this.urlIsInWhiteList(d.url)){var b=JIRA.Issues.LoginUtils.loggedInUserName(),a=g.getResponseHeader("X-AUSERNAME");if(this.userHasChanged(b,a)){this.dialogHasShown=true;var c=new JIRA.FormDialog({content:AJS.$(JIRA.Templates.Issues.Util.anonymousErrorDialog({modifierKey:AJS.Navigator.modifierKey(),redirect:window.location.href.substring(window.location.href.indexOf(contextPath)+contextPath.length)}))});c.show()}}},userHasChanged:function(b,a){if(b===""&&a==="anonymous"){return false}if(b===""&&a&&a!=="anonymous"&&a!==""){return false}if(b!==""&&a==="anonymous"){return true}return false},urlIsInWhiteList:function(b){for(var c=0;c<this.whiteList.length;c++){var a=this.whiteList[c];if(b.indexOf(a)>-1){return true}}return false}};(function(a){a(document).ajaxComplete(function(c,d,b){JIRA.Issues.SessionTimedOutDialog.onRequestResponse(c,d,b)})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/LoginUtils.js' */
JIRA.Issues.LoginUtils={isLoggedIn:function(){return !!this.loggedInUserName()},loggedInUserName:function(){return AJS.Meta.get("remote-user")},currentContextRelativePath:function(){var b=this._getWindowLocation();var c=b.protocol+"//"+b.host+(contextPath||"");var a=b.href;if(a.indexOf(c)===0){return a.substr(c.length)}return a},redirectUrlToCurrent:function(){var a=this.currentContextRelativePath();return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},redirectUrl:function(a){return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},_getWindowLocation:function(){return window.location}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/cache/IssueCacheManager.js' */
(function(){Backbone.define("JIRA.Issues.Cache.IssueCacheManager",JIRA.Issues.BaseEvented.extend({initialize:function(a){this.searchResults=a.searchResults;this.viewIssueData=a.viewIssueData;this.searchResults.bind("issueDeleted",this._onIssueDeleted,this);this.searchResults.bind("nextIssueSelected",this._onNextIssueSelected,this);this.searchResults.bind("prevIssueSelected",this._onPrevIssueSelected,this);this._prefetchCandidate=null},prefetchIssues:function(){if(this._prefetchCandidate&&this._prefetchCandidate.key){this._prefetchIssue(this._prefetchCandidate.key);this._prefetchCandidate=null}},scheduleIssueToBePrefetched:function(a){this._prefetchCandidate=a},_onIssueDeleted:function(a){this.viewIssueData.remove(a.key)},_onNextIssueSelected:function(a){this._prefetchCandidate=a.nextNextIssue},_onPrevIssueSelected:function(a){this._prefetchCandidate=a.prevPrevIssue},_prefetchIssue:function(a){if(!JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled()){this.viewIssueData.get(a,false,{prefetch:true})}}}))})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/SimpleIssue.js' */
Backbone.define("JIRA.Issues.SimpleIssue",JIRA.Issues.BaseModel.extend({properties:["id","key"],defaults:{id:null,key:null},hasIssue:function(){return !!this.getId()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/FullScreenIssue.js' */
Backbone.define("JIRA.Issues.FullScreenIssue",JIRA.Issues.BaseView.extend({namedEvents:["issueHidden"],initialize:function(a){_.extend(this,a);_.bindAll(this,"onLoadComplete","showError");if(this.issueContainer.hasClass("hidden")){this.issueContainer.detach();this.issueContainer.removeClass("hidden")}if(this.searchContainer.hasClass("hidden")){this.searchContainer.detach();this.searchContainer.removeClass("hidden")}},deactivate:function(){if(this.active){if(this.stalker){this.stalker.unstalk()}JIRA.Issues.Application.off("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.off("issueEditor:loadError",this.showError);JIRA.Issues.Application.execute("issueEditor:abortPending");this.active=false}},activate:function(){if(!this.active){JIRA.Issues.Application.on("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.on("issueEditor:loadError",this.showError);this.active=true}},onLoadComplete:function(a,b){this.stalker=AJS.$(".js-stalker",this.issueContainer).stalker();this._makeIssueVisible();if(b.isNewIssue){this._scrollToTop()}},_makeIssueVisible:function(){JIRA.Issues.Application.execute("issueEditor:beforeShow");this._setBodyClasses({error:false,issue:true,search:true});if(!this.isVisible()){this.issueContainer.insertBefore(this.searchContainer);this.searchContainer.detach();JIRA.trace("jira.psycho.issue.refreshed",{id:JIRA.Issues.Application.request("issueEditor:getIssueId")});JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.issueContainer,JIRA.CONTENT_ADDED_REASON.pageLoad])}},updateIssue:function(c){var a,b;b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(this.isVisible()){a=JIRA.Issues.Application.request("issueEditor:refreshIssue",c);a.done(function(){if(!b&&c.message){JIRA.Issues.showNotification(c.message,c.key)}})}else{a=jQuery.Deferred().resolve().promise()}return a},showError:function(a){if(!this.isVisible()){JIRA.Messages.showErrorMsg(AJS.format("{0} can not be opened. The issue may have been deleted or you might not have permission to see the issue.",a.issueKey),{closeable:true})}else{this._setBodyClasses({error:true,issue:false,search:false})}},isVisible:function(){return this.issueContainer.closest("body").length>0},_scrollToTop:function(){AJS.$(window).scrollTop(0)},_setBodyClasses:function(a){AJS.$("body").toggleClass("page-type-message",a.error).toggleClass("navigator-issue-only",a.issue).toggleClass("page-type-navigator",a.search)},hide:function(){this._setBodyClasses({error:false,issue:false,search:true});if(this.isVisible()){this.searchContainer.insertBefore(this.issueContainer);this.issueContainer.detach()}this.trigger("issueHidden")},updatePager:function(a){JIRA.Issues.Application.execute("pager:update",a)},show:function(a){this.activate();if(!AJS.Meta.get("serverRenderedViewIssue")){this.issueContainer.find("#issue-content").remove()}JIRA.Issues.Application.execute("issueEditor:setContainer",this.issueContainer);return JIRA.Issues.Application.request("issueEditor:loadIssue",a).always(_.bind(function(){AJS.$(".js-stalker",this.issueContainer).stalker();this.updatePager(a.pager);this.issueCacheManager.prefetchIssues()},this))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Resize.js' */
(function(){var a="horizontalResize",b="verticalResize";JIRA.Issues.offHorizontalResize=function(c){AJS.$(document).off(a,c)};JIRA.Issues.onHorizontalResize=function(c){AJS.$(document).on(a,c)};JIRA.Issues.triggerHorizontalResize=_.throttle(function(){AJS.$(document).trigger(a)},100);JIRA.Issues.offVerticalResize=function(c){AJS.$(document).off(b,c)};JIRA.Issues.onVerticalResize=function(c){AJS.$(document).on(b,c)};JIRA.Issues.triggerVerticalResize=_.throttle(function(){AJS.$(document).trigger(b)},100);jQuery(window).resize(JIRA.Issues.triggerVerticalResize)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/UserParms.js' */
JIRA.Issues.UserParms={createSharedObjects:function(){return this.get().createSharedObjects},get:function(){if(!this.data){this.data=AJS.$("#user-parms").data("user-parms")||{}}return this.data}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/QueryStringParser.js' */
AJS.namespace("JIRA.Issues.QueryStringParser");JIRA.Issues.QueryStringParser={parser:/(?:^|&)([^&=]*)=?([^&]*)/g,parse:function(b){if(!b&&b!==0){return{}}b=""+b;if("?"===b.charAt(0)){b=b.substring(1)}var a={};b.replace(this.parser,function(d,c,f){var e=decodeURIComponent((f||"").replace(/\+/g," "));a[decodeURIComponent(c)]=e});return a}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/templates/issuenav-searchheader.soy' */
// This file was automatically generated from issuenav-searchheader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavSearchHeader == 'undefined') { JIRA.Templates.IssueNavSearchHeader = {}; }


JIRA.Templates.IssueNavSearchHeader.searchHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.primarySection(opt_data, output);
  if (opt_data.owner) {
    JIRA.Templates.IssueNavSearchHeader.secondarySection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.primarySection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="header-section-primary"><h1 class="search-title" title="', soy.$$escapeHtmlAttribute(opt_data.title), '">', soy.$$escapeHtml(opt_data.title), '</h1><ul class="filter-operations">', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<li class="filter-edited-item"><span>' + soy.$$escapeHtml("Edited") + '</span></li>' : '');
  if (opt_data.primaryButton) {
    output.append('<li>', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<div class="aui-buttons">' : '', '<a href="', (opt_data.primaryButton.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.primaryButton.href)) : '#', '" class="aui-button ', soy.$$escapeHtmlAttribute(opt_data.primaryButton.styleClass), '">', soy.$$escapeHtml(opt_data.primaryButton.label), '</a>');
    if (opt_data.primaryOps && opt_data.primaryOps.length) {
      output.append('<button class="aui-button aui-dropdown2-trigger js-edited-trigger" aria-owns="js-edited-content" aria-haspopup="true" data-container=".aui-buttons"></button></div><div id="js-edited-content" class="aui-dropdown2 aui-style-default"><ul>');
      var opList38 = opt_data.primaryOps;
      var opListLen38 = opList38.length;
      for (var opIndex38 = 0; opIndex38 < opListLen38; opIndex38++) {
        var opData38 = opList38[opIndex38];
        output.append('<li><a href="', (opData38.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData38.href)) : '#', '" ', (opData38.styleClass) ? 'class="' + soy.$$escapeHtmlAttribute(opData38.styleClass) + '"' : '', '>', soy.$$escapeHtml(opData38.label), '</a></li>');
      }
      output.append('</ul></div>');
    }
    output.append('</li>');
  }
  if (opt_data.owner) {
    var opList59 = opt_data.secondaryOps;
    var opListLen59 = opList59.length;
    for (var opIndex59 = 0; opIndex59 < opListLen59; opIndex59++) {
      var opData59 = opList59[opIndex59];
      output.append('<li><a href="', (opData59.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData59.href)) : '#', '" ', (opData59.title) ? 'title="' + soy.$$escapeHtmlAttribute(opData59.title) + '"' : '', ' class="', soy.$$escapeHtmlAttribute(opData59.styleClass), '">', (opData59.label) ? soy.$$escapeHtml(opData59.label) : '', '</a></li>');
    }
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.secondarySection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.owner) {
    output.append('<div class="header-section-secondary"><div class="search-owner">');
    JIRA.Templates.IssueNavSearchHeader.filterOwner(opt_data, output);
    output.append('</div></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterOwner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-owner">', (opt_data.avatarUrl) ? '<span class="aui-avatar aui-avatar-large search-owner-avatar"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.avatarUrl)) + '" /></span></span>' : '', '<span class="search-owner-name">');
  var ownerLink__soy95 = new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.ownerLink(opt_data, ownerLink__soy95);
  ownerLink__soy95 = ownerLink__soy95.toString();
  output.append(AJS.format("Owned by {0}",ownerLink__soy95), '</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.ownerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.ownerUrl)), '" class="user-hover" rel="', soy.$$escapeHtmlAttribute(opt_data.ownerUserName), '">', soy.$$escapeHtml(opt_data.owner), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterDetails = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavSearchHeader.filterDescription(opt_data, output);
  JIRA.Templates.IssueNavSearchHeader.filterPermissions(opt_data, output);
  if (opt_data.userIsLoggedIn) {
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptions(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section">');
  if (opt_data.owner) {
    JIRA.Templates.IssueNavSearchHeader.filterOwner(opt_data, output);
  }
  output.append((opt_data.filter.description) ? '<p class="filter-name">' + soy.$$escapeHtml(opt_data.filter.description) + ((opt_data.permissions.userHasEditPermission) ? ' <a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">(' + soy.$$escapeHtml("Edit") + ')</a>' : '') + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterPermissions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section"><h4 class="section-header">', soy.$$escapeHtml("Permissions"), '</h4>');
  if (opt_data.sharePermissions && opt_data.sharePermissions.length > 0) {
    output.append('<p>', soy.$$escapeHtml("This filter is visible to:"), '</p><ul class="shared-filters">');
    var shareList155 = opt_data.sharePermissions;
    var shareListLen155 = shareList155.length;
    for (var shareIndex155 = 0; shareIndex155 < shareListLen155; shareIndex155++) {
      var shareData155 = shareList155[shareIndex155];
      JIRA.Templates.IssueNavSearchHeader.filterSharePermissionItem({type: shareData155.type, project: (shareData155.project) ? '<a href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(shareData155.project.key) + '">' + soy.$$escapeHtml(shareData155.project.name) + '</a>' : '', projectRole: (shareData155.role) ? soy.$$escapeHtml(shareData155.role.name) : '', group: (shareData155.group) ? soy.$$escapeHtml(shareData155.group.name) : ''}, output);
    }
    output.append('</ul>');
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter is only visible to you."), '</p>');
  }
  output.append((opt_data.permissions.userHasEditSharingPermission) ? '<p><a class="edit-permissions" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Edit permissions") + '</a></p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSubscriptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section full-section"><h4>', soy.$$escapeHtml("Subscriptions"), '</h4>');
  if (opt_data.subscriptions.items.length) {
    output.append('<p>', soy.$$escapeHtml("This filter has the following subscriptions:"), '</p>');
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList(opt_data, output);
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter has no subscriptions."), '</p>');
  }
  output.append('<ul class="manage-links"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")), '/secure/FilterSubscription!default.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '&returnUrl=', soy.$$escapeUri(opt_data.returnUrl), '">', soy.$$escapeHtml("New subscription"), '</a></li>', (opt_data.subscriptions.items.length) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Manage subscriptions") + '</a></li>' : '', '</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul>');
  var subList235 = opt_data.filter.subscriptions.items;
  var subListLen235 = subList235.length;
  for (var subIndex235 = 0; subIndex235 < subListLen235; subIndex235++) {
    var subData235 = subList235[subIndex235];
    output.append((subData235.group) ? '<li>' + soy.$$escapeHtml(subData235.group.name) + '</li>' : '<li>' + soy.$$escapeHtml(subData235.user.displayName) + '</li>');
  }
  output.append((opt_data.filter.subscriptions.additionalLength) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml(AJS.format("{0} more",opt_data.filter.subscriptions.additionalLength)) + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.filterSharePermissionItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type == 'global') ? '<li>' + soy.$$escapeHtml("Everyone") + '</li>' : (opt_data.type == 'group') ? '<li>' + AJS.format("{0}Group{1}: {2}",'<strong>','</strong>',opt_data.group) + '</li>' : (opt_data.projectRole) ? '<li>' + AJS.format("{0}Project{1}: {2} {3}Role{4}: {5}",'<strong>','</strong>',opt_data.project,'<strong>','</strong>',opt_data.projectRole) + '</li>' : '<li>' + AJS.format("{0}Project{1}: {2}",'<strong>','</strong>',opt_data.project) + '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.saveFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/rest/api/2/filter/" class="aui" id="save-filter-form" method="post"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.headerText), '</h2>', (opt_data.copyFromAnotherUser) ? '<p class="form-description">' + ((opt_data.filterOwnerName) ? soy.$$escapeHtml(AJS.format("This filter was created by {0}. You can save a copy of this filter but you cannot modify the original.",opt_data.filterOwnerName)) : soy.$$escapeHtml("You can save a copy of this filter but you cannot modify the original.")) + '</p>' : '', '<div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name"', (opt_data.prefilledFilterName) ? ' value="' + soy.$$escapeHtmlAttribute(opt_data.prefilledFilterName) + '"' : '', 'class="text long-field"><div class="description">', soy.$$escapeHtml("Enter a name for this Filter"), '</div>');
  var fieldList305 = opt_data.hiddenFields;
  var fieldListLen305 = fieldList305.length;
  for (var fieldIndex305 = 0; fieldIndex305 < fieldListLen305; fieldIndex305++) {
    var fieldData305 = fieldList305[fieldIndex305];
    output.append('<input type="hidden" name="', soy.$$escapeHtmlAttribute(fieldData305.name), '" value="', (fieldData305.value) ? soy.$$escapeHtmlAttribute(fieldData305.value) : '', '" />');
  }
  output.append('</div>', (opt_data.isDefaultShareScopeGlobal) ? '<div class="aui-message info shadowed"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml("By default your filters are shared with everyone.") + '</strong></p><input type="checkbox" id="setSharingPrivate" class="checkbox"><label for="setSharingPrivate">' + soy.$$escapeHtml("My filters should be private by default.") + '</label></div>' : '', '</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavSearchHeader.layoutSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-buttons"><button id="layout-switcher-button" class="aui-button drop-arrow js-default-dropdown" type="button"><span class="aui-icon aui-icon-small ', soy.$$escapeHtmlAttribute(opt_data.activeLayout.iconClass), '"></span></button><div class="aui-list hidden"><h5>', soy.$$escapeHtml("Views"), '</h5><ul class="aui-list-section aui-first aui-last">');
  var layoutList341 = opt_data.layouts;
  var layoutListLen341 = layoutList341.length;
  for (var layoutIndex341 = 0; layoutIndex341 < layoutListLen341; layoutIndex341++) {
    var layoutData341 = layoutList341[layoutIndex341];
    output.append('<li class="aui-list-item layout-switcher-item"><a href="#" class="aui-list-item-link" data-layout-key="', soy.$$escapeHtmlAttribute(layoutData341.id), '"><span class="aui-icon aui-icon-small ', (opt_data.activeLayout.id == layoutData341.id) ? 'aui-iconfont-success' : '', '"></span>', soy.$$escapeHtml(layoutData341.label), '</a>');
  }
  output.append('</ul></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderView.js' */
Backbone.define("JIRA.Issues.SearchHeaderView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.searchHeader,filterDetailsTemplate:JIRA.Templates.IssueNavSearchHeader.filterDetails,primarySectionTemplate:JIRA.Templates.IssueNavSearchHeader.primarySection,secondarySectionTemplate:JIRA.Templates.IssueNavSearchHeader.secondaySection,filterFavouriteButton:".fav-link",events:{"click .fav-link":"_onToggleFavourite"},initialize:function(a){_.bindAll(this,"_getFilterDetailsDialogCSS","_onDiscardChanges","_onShowFilterDetailsDialog","_onSaveAsNew","_onSaveChanges");this._searchPageModule=a.searchPageModule;this._searchPageModule.on("change changeFilterProps",this.render,this);this.pageTitle=document.title},render:function(){var d=!this.$el.closest("body").length,h={},b={isDirty:this._searchPageModule.isDirty()},c=this._searchPageModule.getFilter();if(!c){h.title="Search";h.primaryButton=JIRA.Issues.FilterModel.getOpById("saveAs");this.$el.removeClass("is-filter-with-owner")}else{if(!c.getIsValid()){h.title="Search";this.$el.removeClass("is-filter-with-owner")}else{var g=c.getOperationsJson(b);var e=g.primary.reverse().pop();var f=g.primary.reverse();h.title=c.getName();this._addOwnerData(c,h);h.primaryButton=e;h.primaryOps=f;h.secondaryOps=g.secondary;this.$el.toggleClass("is-filter-with-owner",!!c.getOwner())}}var a=this.$(".filter-edited-item").length===1;this.$el.html(this.template(h));if(a){this.$(".filter-edited-item").show().css("opacity",1)}else{if(!d){this.$(".filter-edited-item").hide().fadeIn(1000)}}this._createFilterFavouriteTipsy();this.updateJqlError(false);this.updateWindowTitle();this.bindDetailsDialog();this.bindDropdown();return this},updateJqlError:function(a){var b="";if(this.isError=a){b="search.save.error"}else{if(!this.queryIsSaveable()){b="search.operation.anonymous"}}this.$(".save-as-new-filter, .save-changes").attr("title",b).toggleClass("disabled",!this.queryIsSaveable())},update:function(){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.returnToSearch]);this.updateWindowTitle()},updateWindowTitle:function(){if(this._searchPageModule.isFullScreenIssueVisible()){return}var a=this._searchPageModule.getFilter(),b=AJS.format("{0} - {1}","Issue Navigator",JIRA.Settings.ApplicationTitle.get());if(a&&a.getIsValid()){document.title="["+a.getName()+"] "+b}else{document.title=b}},userIsLoggedIn:function(){return JIRA.Issues.LoginUtils.isLoggedIn()},queryIsSaveable:function(){return this.userIsLoggedIn()&&!this.isError},_onToggleFavourite:function(b){b.preventDefault();var a=this.$(".fav-link").hasClass("on");this._searchPageModule.getFilter().saveFavourite(!a);if(!a){this._searchPageModule.filterModuleSaved(this._searchPageModule.getFilter())}},_onSaveAsNew:function(a){a.preventDefault();this._searchPageModule.getJqlDeferred().done(_.bind(function(c){if(this.queryIsSaveable()){var b=new JIRA.Issues.FilterSaveDialogView({id:"save-filter-dialog",model:this._searchPageModule.getFilter(),type:JIRA.Issues.FilterSaveDialogView.Types.SAVE_AS,jql:c});b.on("filterSaved",function(d){this._searchPageModule.filterModuleSaved(d,true);this._searchPageModule.setSessionSearch(d)},this);b.show()}},this))},_createFilterFavouriteTipsy:function(){new JIRA.Issues.Tipsy({el:this.filterFavouriteButton})},_onSaveChanges:function(f){f.preventDefault();if(!this.queryIsSaveable()){return}var d=this._searchPageModule.getFilter();var b=AJS.escapeHtml(d.getName());var c=d.saveFilter(this._searchPageModule.getEffectiveJql());var a=this;c.done(function(){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been successfully saved.",b),JIRA.Issues.getDefaultMessageOptions());a._searchPageModule.setSessionSearch(d)});c.fail(function(){JIRA.Messages.showErrorMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> could not be saved.",b),JIRA.Issues.getDefaultMessageOptions())})},_onDiscardChanges:function(a){a.preventDefault();this._searchPageModule.discardFilterChanges()},_getFilterDetailsDialogCSS:function(a,d,e,c){var b=AJS.InlineDialog.opts.calculatePositions(a,d,e,c);b.arrowCss.left-=7;return b},bindDetailsDialog:function(){var b="filter-details-overlay";AJS.$("#inline-dialog-"+b).remove();var a=this.$(".show-filter-details");var c=AJS.InlineDialog(a,b,this._onShowFilterDetailsDialog,{addActiveClass:true,calculatePositions:this._getFilterDetailsDialogCSS,hideDelay:3600000,offsetX:-36,width:400});a.click(function(){if(a.hasClass("active")){setTimeout(c.hide,0)}})},bindDropdown:function(){this.$(".save-changes").on("click",this._onSaveChanges);this.$(".discard-filter-changes").on("click",this._onDiscardChanges);this.$(".save-as-new-filter").on("click",this._onSaveAsNew)},_onShowFilterDetailsDialog:function(d,f,h){var b=this._searchPageModule.getFilter(),c=_.sortBy(b.getSharePermissions(),function(i){var j=[i.type];i.group&&j.push(i.group.name);i.project&&j.push(i.project.name);i.role&&j.push(i.role.name);return j}),g=_.clone(b.getSubscriptions()),a=JIRA.Issues.LoginUtils.loggedInUserName()===b.getOwnerUserName();g.additionalLength=b.getNumberOfAdditionalSubscriptions();var e={filter:b.toJSON(),sharePermissions:c,subscriptions:g,permissions:{userHasEditSharingPermission:a&&(!!JIRA.Issues.UserParms.createSharedObjects()||c.length>0),userHasEditPermission:a},userIsLoggedIn:this.userIsLoggedIn(),returnUrl:window.location};this._addOwnerData(b,e);d.html(this.filterDetailsTemplate(e));d.bind("click",function(i){i.stopPropagation()});h()},_addOwnerData:function(a,b){if(a.getOwner()){_.extend(b,{owner:a.getOwner()||"",ownerUserName:a.getOwnerUserName()||"",avatarUrl:a.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(a.getOwnerUserName())})}},_appendErrorContent:function(a,d){var b=a.find(".aui-messages");var f=JSON.parse(d.responseText);a.find(".error").remove();b.empty();try{if(f&&f.errors){jQuery.each(f.errors,function(g,e){a.find("#"+g).after("<div class='error'>"+AJS.escapeHTML(e)+"</div>")})}if(f&&f.errorMessages){jQuery.each(f.errorMessages,function(g,h){var e=JIRA.Issues.getDefaultMessageOptions();e.body=AJS.escapeHTML(h);e.shadowed=false;AJS.messages.error(b,e)})}else{b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}catch(c){b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/LayoutSwitcherView.js' */
Backbone.define("JIRA.Issues.LayoutSwitcherView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.layoutSwitcher,initialize:function(a){_.bindAll(this,"_onLayoutSwitchClick");this.searchPageModule=a.searchPageModule;this.searchPageModule.on("change:currentLayout",this.render,this)},render:function(){this.$el.html(this.template({layouts:this.searchPageModule.getSortedLayouts(),activeLayout:this.searchPageModule.getActiveLayout()}));this._addLayoutSwitcherTooltip();this.$el.find(".aui-list-item-link").click(this._onLayoutSwitchClick);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.layoutSwitcherReady]);return this},enableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").removeClass("disabled").removeAttr("disabled");return this},disableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").addClass("disabled").attr("disabled","");return this},_addLayoutSwitcherTooltip:function(){function a(){var b=AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts");if(b){return AJS.format("Change view (Type \'\'{0}\'\')",AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts"))}else{return "Change view"}}new JIRA.Issues.Tipsy({el:this.$el.find("#layout-switcher-button"),showCondition:":not(.active)",tipsy:{title:a,gravity:"ne"}})},_onLayoutSwitchClick:function(c,a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){var b=AJS.$(c.target).closest("[data-layout-key]").data("layout-key");c.preventDefault();this.searchPageModule.changeLayout(b,a)}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderModule.js' */
Backbone.define("JIRA.Issues.SearchHeaderModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule},registerSearch:function(a){this._search=a},createView:function(a){this.searchHeaderView=new JIRA.Issues.SearchHeaderView({el:a.searchHeaderEl,searchPageModule:this._searchPageModule});return this.searchHeaderView},createToolsView:function(a){new JIRA.Issues.IssueTableHeaderOperationsView({el:a,search:this._search,searchPageModule:this._searchPageModule})},handleIssueSearchAppeared:function(){this.searchHeaderView.update()},handleJqlError:function(){this.searchHeaderView&&this.searchHeaderView.updateJqlError(true)},handleJqlSuccess:function(){this.searchHeaderView&&this.searchHeaderView.updateJqlError(false)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/templates/issuenav-filter.soy' */
// This file was automatically generated from issuenav-filter.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavFilter == 'undefined') { JIRA.Templates.IssueNavFilter = {}; }


JIRA.Templates.IssueNavFilter.collapsedFiltersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="toggle-filter-panel" href="#" title="', soy.$$escapeHtmlAttribute(AJS.format("Dock the filters panel ({0})",'[')), '"></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filtersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filters-content"><h4 class="filter-title">', soy.$$escapeHtml("Filters"), '</h4><ul class="filter-options"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/issues/?jql=" class="new-search aui-button" title="', soy.$$escapeHtmlAttribute("Create a new search filter"), '">', soy.$$escapeHtml("New filter"), '</a></li><li><a class="find-filters" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/secure/ManageFilters.jspa?filterView=search">', soy.$$escapeHtml("Find filters"), '</a></li></ul><div class="filter-panel-section">');
  JIRA.Templates.IssueNavFilter.filterList({filters: opt_data.systemFilters, fallbackMessage: 'Warning: No system filters!', name: 'system-filters'}, output);
  output.append('</div><div class="filter-panel-section"><h4 class="filter-title">', soy.$$escapeHtml("Favourite Filters"), '</h4>');
  JIRA.Templates.IssueNavFilter.filterList({filters: opt_data.favouriteFilters, fallbackMessage: opt_data.favouriteFiltersFallback ? opt_data.favouriteFiltersFallback : opt_data.isAnonymous ? AJS.format("You must be {0}logged in{1} to view favourite filters.",'<a class="login-link" href="' + opt_data.loginUrl + '">','</a>') : "You don\x27t have any favourite filters.", name: 'favourite-filters'}, output);
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filterDropDown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list"><ul class="aui-list-section">', (opt_data.canEdit) ? '<li class="aui-list-item"><a href="" class="aui-list-item-link rename-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Rename") + '</a></li>' : '', '<li class="aui-list-item"><a href="" class="aui-list-item-link copy-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Copy"), '</a></li></ul><ul class="aui-list-section', (! opt_data.canEdit) ? ' aui-last' : '', '"><li class="aui-list-item"><a href="" class="aui-list-item-link unfavourite-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Remove from favourites"), '</a></li></ul>', (opt_data.canEdit) ? '<ul class="aui-list-section aui-last"><li class="aui-list-item"><a href="" class="aui-list-item-link delete-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Delete") + '</a></li></ul>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.renameFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="rename-filter-form" method="put"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Rename Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2><div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name" value="', soy.$$escapeHtmlAttribute(opt_data.filter.name), '" class="text long-field"></div></div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.deleteFilterDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="delete-filter-form" method="delete"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Delete Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2>');
  if (opt_data.filter.subscriptions.items.length) {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("The filter {0} has the following subscriptions. Are you sure you want to delete it?",opt_data.filter.name)), '</p>');
    JIRA.Templates.IssueNavSearchHeader.filterSubscriptionList(opt_data, output);
    output.append('<p class="form-description"><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")), '/secure/ViewSubscriptions.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '">', soy.$$escapeHtml("Manage subscriptions"), '</a></p>');
  } else {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the filter {0}?",opt_data.filter.name)), '</p>');
  }
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Delete"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filterList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.filters.length > 0) {
    output.append('<ul class="saved-filter filter-list ', soy.$$escapeHtmlAttribute(opt_data.name), '">');
    var filterList135 = opt_data.filters;
    var filterListLen135 = filterList135.length;
    for (var filterIndex135 = 0; filterIndex135 < filterListLen135; filterIndex135++) {
      var filterData135 = filterList135[filterIndex135];
      output.append((opt_data.name == 'favourite-filters') ? '<li><a class="filter-link" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("/jira")) + '/issues/?filter=' + soy.$$escapeUri(filterData135.id) + '" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '" title="' + soy.$$escapeHtmlAttribute(filterData135.name) + '">' + soy.$$escapeHtml(filterData135.name) + '</a><a href="#" class="filter-actions" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '"><span>' + soy.$$escapeHtml("Filter Actions") + '</span></a></li>' : '<li><a class="filter-link' + ((filterData135.requiresLoginForUser) ? ' requires-login' : '') + '" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(filterData135.navUrl)) + '" data-id="' + soy.$$escapeHtmlAttribute(filterData135.id) + '" title="' + soy.$$escapeHtmlAttribute(filterData135.name) + '">' + soy.$$escapeHtml(filterData135.name) + '</a></li>');
    }
    output.append('</ul>');
  } else {
    output.append('<p class="filter-info ', soy.$$escapeHtmlAttribute(opt_data.name), '">', opt_data.fallbackMessage, '</p>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModel.js' */
Backbone.define("JIRA.Issues.FilterModel",JIRA.Issues.BaseModel.extend({properties:["id","name","description","jql","favourite","isSystem","sharePermissions","subscriptions","ownerUserName","ownerDisplayName","avatarUrl","requiresLogin","isValid"],defaults:{isSystem:false,isValid:true},urlRoot:contextPath+"/rest/api/2/filter/",getOwner:function(){return this.getOwnerDisplayName()||this.getOwnerUserName()},isFavouriteFilter:function(){return !this.getIsSystem()&&!!this.getFavourite()},url:function(){return this.urlRoot+encodeURIComponent(this.id)+"?expand="+JIRA.Issues.FilterModel.getExpandValue()},isMyFilter:function(){return !this.getIsSystem()&&this.getOwnerUserName()===JIRA.Issues.LoginUtils.loggedInUserName()},parse:function(b,a){return JIRA.Issues.FilterModel.transformToModel(b)},getOperationsJson:function(a){var c={};var b=JIRA.Issues.FilterModel.operations;c.primary=_.filter(b.primary,_.bind(function(d){return d.validate.call(this,a)},this));c.secondary=_.filter(b.secondary,_.bind(function(d){return d.validate.call(this,a)},this));c.primary=_.map(c.primary,_.bind(function(d){return this._opAsJSON(d)},this));c.secondary=_.map(c.secondary,_.bind(function(d){return this._opAsJSON(d)},this));return c},_opAsJSON:function(b){var a={};jQuery.each(b,_.bind(function(c,d){if(c!=="validate"){a[c]=jQuery.isFunction(d)?d.call(this):d}},this));return a},getNumberOfAdditionalSubscriptions:function(){var a=this.getSubscriptions();return a.size>a.items.length?a.size-a.items.length:0},saveFavourite:function(b){var a=this;var c=this.getFavourite();this.setFavourite(b);if(this.pendingRequest){this.pendingRequest.abort()}this.pendingRequest=JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/1.0/filters/"+encodeURIComponent(this.getId())+"/favourite",type:b?"PUT":"DELETE"}).done(function(d){var e=AJS.$(d).text().match(/favourite state: (\w+)/)[1]==="true";delete a.pendingRequest;a.setFavourite(e)}).fail(function(){a.setFavourite(c)});return this.pendingRequest},saveFilter:function(b){if(this.pendingRequest){this.pendingRequest.abort()}var c=JIRA.Issues.FilterModel.transformFromModel(this.toJSON());c.jql=b;var a=this;this.pendingRequest=JIRA.SmartAjax.makeRequest({url:this.url(),type:"PUT",contentType:"application/json",data:JSON.stringify(c)}).done(function(d){a.set(JIRA.Issues.FilterModel.transformToModel(d))}).then(function(){delete a.pendingRequest;JIRA.trace("jira.filter.saved")});return this.pendingRequest},toJSONForTemplate:function(){var a=this.toJSON();_.extend(a,{requiresLoginForUser:this._requiresLoginForUser(this.getRequiresLogin()),navUrl:this._constructNavUrl(this.getId(),this.getRequiresLogin())});return a},_requiresLoginForUser:function(a){return !JIRA.Issues.LoginUtils.isLoggedIn()&&a},_constructNavUrl:function(a,b){var c="/issues/?filter="+a;if(this._requiresLoginForUser(b)){return JIRA.Issues.LoginUtils.redirectUrl(c)}else{return contextPath+c}},_getFavouriteText:function(){if(this.isFavouriteFilter()){return "Remove this filter from your Favourite Filters"}else{return "Add this filter to your Favourite Filters"}}},{maxSubscriptions:5,getExpandValue:function(){return"subscriptions[-"+JIRA.Issues.FilterModel.maxSubscriptions+":]"},transformToModel:function(a){if(a.subscriptions&&a.subscriptions.items){a.subscriptions.items.reverse()}return{id:a.id,name:a.name,description:a.description,jql:a.jql,favourite:a.favourite,sharePermissions:a.sharePermissions||[],subscriptions:a.subscriptions,ownerUserName:a.owner&&a.owner.name,ownerDisplayName:a.owner&&a.owner.displayName,avatarUrl:a.owner&&a.owner.avatarUrls["48x48"],requiresLogin:a.requiresLogin}},transformFromModel:function(a){return{id:a.id,name:a.name,jql:a.jql,favourite:a.favourite}},operations:{primary:[{id:"save",styleClass:"save-changes",label:"Save",validate:function(a){return a.isDirty&&this.isMyFilter()}},{id:"saveAs",styleClass:"save-as-new-filter",label:"Save as",href:AJS.contextPath()+"/secure/SaveAsFilter!default.jspa",validate:function(){return !!JIRA.Issues.LoginUtils.loggedInUserName()}},{id:"discardChanges",styleClass:"discard-filter-changes",label:"Discard changes",validate:function(a){return a.isDirty}}],secondary:[{id:"details",styleClass:"show-filter-details",title:"View information about this filter",validate:function(){return !this.getIsSystem()},label:"Details"},{id:"favourite",title:function(){return this._getFavouriteText()},label:function(){return this._getFavouriteText()},styleClass:function(){return"fav-link icon"+(this.isFavouriteFilter()?" on":" off")},href:function(){return AJS.contextPath()+"/secure/EditFilter!default.jspa?filterId="+this.id},validate:function(){return !!JIRA.Issues.LoginUtils.loggedInUserName()&&!this.getIsSystem()}}]},getOpById:function(a){return _.find(this.operations.primary.concat(this.operations.secondary),function(b){if(b.id===a){return true}})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterCollection.js' */
Backbone.define("JIRA.Issues.FilterCollection",JIRA.Issues.BaseCollection.extend({model:JIRA.Issues.FilterModel,fetch:function(){this.trigger("fetch",this);return JIRA.Issues.BaseCollection.prototype.fetch.apply(this,arguments)},initialize:function(b,a){this.url=a&&a.url},toJSONForTemplate:function(){return this.invoke("toJSONForTemplate")}}));Backbone.define("JIRA.Issues.SortedFilterCollection",JIRA.Issues.FilterCollection.extend({comparator:function(b,a){return b.getName().toLowerCase().localeCompare(a.getName().toLowerCase())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterDialogView.js' */
Backbone.define("JIRA.Issues.FilterDialogView",JIRA.Issues.BaseView.extend({createDialog:function(a){this.filterDialog=this.filterDialog||new JIRA.FormDialog({content:_.bind(this._createDialogContent,this),id:a,submitHandler:_.bind(this._onSubmitFilterDialog,this)})},show:function(){this.filterDialog.show()},hide:function(){this.filterDialog.hide(true);this.filterDialog.destroy()},_createDialogContent:function(a){a()},_serializeForm:function(a){return JSON.stringify({name:a.find("[name=name]").val(),jql:a.find("[name=jql]").val()})},_getFormUrl:function(a){return a.attr("action")},_getFormRequestType:function(a){return a.attr("method")},_onSubmitFilterDialog:function(d,a){d.preventDefault();var c=this.filterDialog.$form,b=JIRA.SmartAjax.makeRequest({type:this._getFormRequestType(c),url:this._getFormUrl(c),contentType:"application/json",dataType:"json",processData:false,data:this._serializeForm(c)});b.fail(_.bind(this._onSubmitError,this));b.done(a);b.done(_.bind(this._onSubmitSuccess,this));b.done(_.bind(this.hide,this));b.always(function(){JIRA.trace("jira.filter.saved")});return b},_onSubmitError:function(a){this.filterDialog.getButtonsContainer().find("input").removeAttr("disabled");this.filterDialog.hideFooterLoadingIndicator();this.filterDialog.$form.removeClass("submitting");this._appendErrorContent(this.filterDialog.$popup,a);this.filterDialog.$form.find("#filterName").focus()},_onSubmitSuccess:jQuery.noop,_appendErrorContent:function(a,d){var b=a.find(".aui-messages");var f=JSON.parse(d.responseText);a.find(".error").remove();b.empty();try{if(f&&f.errors){jQuery.each(f.errors,function(g,e){a.find("#"+g).after("<div class='error'>"+AJS.escapeHTML(e)+"</div>")})}if(f&&f.errorMessages){jQuery.each(f.errorMessages,function(g,h){var e=JIRA.Issues.getDefaultMessageOptions();e.body=AJS.escapeHTML(h);e.shadowed=false;AJS.messages.error(b,e)})}else{b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}catch(c){b.append(JIRA.SmartAjax.buildDialogErrorContent(d,true))}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterRenameDialogView.js' */
Backbone.define("JIRA.Issues.FilterRenameDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavFilter.renameFilterDialog,initialize:function(a){this.filterId=a.filterId;this.createDialog(a.id)},_createDialogContent:function(c){var a=this;var b=this.model.getFilterById(this.filterId);b.done(function(d){c(a.template({modifierKey:AJS.Navigator.modifierKey(),filter:d.toJSON()}))})},_onSubmitSuccess:function(a){this.filterDialog.hide(true);this.filterDialog.destroy();a=this.model.setRenamedFilterName(a);JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been renamed.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterDeleteDialogView.js' */
Backbone.define("JIRA.Issues.FilterDeleteDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavFilter.deleteFilterDialog,initialize:function(a){this.filterId=a.filterId;this.createDialog(a.id)},_createDialogContent:function(b){var a=this.model.getFilterById(this.filterId);a.done(_.bind(function(c){this.filter=c;b(this.template({modifierKey:AJS.Navigator.modifierKey(),filter:c.toJSON()}))},this))},_onSubmitSuccess:function(){this.filterDialog.hide(true);this.filterDialog.destroy();var a=this.filter.getName();this.model.removeFavouriteFilter(this.filter);JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong>{0}\u003c\/strong> has been deleted.",AJS.escapeHtml(a)),JIRA.Issues.getDefaultMessageOptions())}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterSaveDialogView.js' */
Backbone.define("JIRA.Issues.FilterSaveDialogView",JIRA.Issues.FilterDialogView.extend({template:JIRA.Templates.IssueNavSearchHeader.saveFilterDialog,initialize:function(a){this.type=a.type;this.jql=a.jql;this.createDialog(a.id)},_createDialogContent:function(b){var a=this;JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a._createSaveAsDialogHtml(c&&c.scope==="GLOBAL"))})},_onSubmitFilterDialog:function(c,b){c.preventDefault();var a=this;if(AJS.$("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})}).done(function(){a._sendFormAsFilter(b)})}else{this._sendFormAsFilter(b)}},_sendFormAsFilter:function(a){var c=this.filterDialog.$form;var b=JIRA.SmartAjax.makeRequest({type:"POST",url:c.attr("action")+"?expand="+JIRA.Issues.FilterModel.getExpandValue(),contentType:"application/json",processData:false,data:JSON.stringify({jql:c.find("[name=jql]").val(),name:c.find("[name=name]").val(),id:c.find("[name=filterId]").val(),favourite:true})});b.fail(_.bind(this._onSubmitError,this));b.done(a);b.done(_.bind(this._onSubmitSuccess,this));b.always(function(){JIRA.trace("jira.filter.saved")})},_createSaveAsDialogHtml:function(d){var b=this.model;var a;var e;var c=[];if(this.type===JIRA.Issues.FilterSaveDialogView.Types.COPY){a="Copy Filter"+" : "+this.model.getName();c.push({name:"filterId",value:this.model.getId()});e=AJS.format("Copy of {0}",this.model.getName())}else{a="Save Filter";if(b&&!b.getIsSystem()){c.push({name:"filterId",value:b.getId()})}c.push({name:"jql",value:this.jql||""})}return this.template({hiddenFields:c,headerText:a,prefilledFilterName:e,contextPath:AJS.contextPath(),modifierKey:AJS.Navigator.modifierKey(),copyFromAnotherUser:b&&b.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:b&&b.getOwnerDisplayName(),isDefaultShareScopeGlobal:d,filter:(this.model)?this.model.toJSON():null})},_getFormUrl:function(a){return a.attr("action")+a.find("[name=id]").val()},_onSubmitSuccess:function(b){var a=new JIRA.Issues.FilterModel(JIRA.Issues.FilterModel.transformToModel(b));this.trigger("filterSaved",a);this.filterDialog.hide(true);this.filterDialog.destroy()}}));JIRA.Issues.FilterSaveDialogView.Types={SAVE_AS:"saveAs",COPY:"copy"};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelView.js' */
Backbone.define("JIRA.Issues.FilterPanelView",JIRA.Issues.BaseView.extend({events:{"click .filter-actions":"_showActionsDropdown","simpleClick .filter-list a.filter-link:not(.requires-login)":"_onClickFilter","simpleClick .new-search":"_onClickNewSearch","click .ui-dock":"_onDockFilterPanelClick","click .ui-undock":"_onUndockFilterPanelClick"},collapsedTemplate:JIRA.Templates.IssueNavFilter.collapsedFiltersPanel,template:JIRA.Templates.IssueNavFilter.filtersPanel,initialize:function(a){_.bindAll(this,"_adjustFavouriteFiltersHeight");if(a.easeOff){this._adjustFavouriteFiltersHeight=_.debounce(this._adjustFavouriteFiltersHeight,a.easeOff)}JIRA.Issues.onVerticalResize(this._adjustFavouriteFiltersHeight);this.filterActionsDialogView=new JIRA.Issues.FilterActionsDialogView({el:this.$el,model:this.model});this.filterActionsDialogView.on("filterSaved",function(b){this.trigger("filterSaved",b)},this);this.model.favouriteFiltersCollection.bind("change add remove reset sync",function(){delete this.favouriteFiltersFallback;this.render()},this);this.model.favouriteFiltersCollection.bind("fetch",function(){this.favouriteFiltersFallback="Loading favourite filters...";this.render()},this);this.model.favouriteFiltersCollection.bind("error",function(){this.favouriteFiltersFallback="Failed to retrieve favourite filters from server.";this.render()},this);this.model.systemFiltersCollection.bind("change",this.render,this);this.panelReady=jQuery.Deferred();this.model.bind("change:activeFilter",this._renderSelectedFilter,this);JIRA.bind(JIRA.Events.LAYOUT_RENDERED,_.bind(function(c,b){if(b){delete this._splitViewSidebarElement}else{this._splitViewSidebarElement=AJS.$(".list-results-panel:first")}},this));if(this.model.initialFavouritesFetch&&this.model.initialFavouritesFetch.state()==="pending"){this.model.favouriteFiltersCollection.trigger("fetch")}},_adjustFavouriteFiltersHeight:function(){var e=AJS.$(".jira-feedback-link-container.subtle-style").outerHeight(true),c=e?e+10:0,b=this.$(".favourite-filters"),a=b.length&&b.offset().top,d=jQuery(window).outerHeight();b.css("height",d-a-c)},_onDockFilterPanelClick:function(){AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed")},_onUndockFilterPanelClick:function(){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed")},toggleDockState:function(){this.$el.popoutSidebar("toggle")},_onClickFilter:function(b){b.preventDefault();var a=jQuery(b.target).data("id");this.trigger("filterSelected",a)},_onClickNewSearch:function(a){a.preventDefault();this.trigger("filterSelected",null)},render:function(){if(!this.model.isDocked()){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed");this._renderCollapsed()}else{AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed");this._renderOpen()}var a=AJS.KeyboardShortcut.getKeyboardShortcutKeys("toggle.filter.panel");this.$el.popoutSidebar({isDocked:this.model.isDocked(),expandedWidth:this.model.getWidth(),renderExpanded:_.bind(this._renderOpen,this),renderCollapsed:_.bind(this._renderCollapsed,this),undockText:"Undock",undockTitle:AJS.format("Undock the filter panel so it is hidden when not being focused (Type \'\'{0}\'\')",a),dockText:"Dock",dockTitle:AJS.format("Dock the filter panel so you can always see the list of filters (Type \'\'{0}\'\')",a),toggleTarget:".filter-title:first",persist:_.bind(function(c,b){this.model.setDocked(c);this.model.setWidth(b)},this),resize:_.bind(function(){this._splitViewSidebarElement&&this._splitViewSidebarElement.sidebar("updatePosition")},this)});if(this.model.shouldShowDockIntro()){this.$el.popoutSidebar("collapse",false)}if(this.model.isDocked()){this.$el.popoutSidebar("renderDockState")}this._fireDockAnalytics();this.panelReady.resolve();return this.$el},_fireDockAnalytics:function(){if(localStorage.getItem("dockStatesAnalyticsEnabled")){var a=this.model.isDocked();if(localStorage.getItem("dockStateAnalytic")!==""+a){localStorage.setItem("dockStateAnalytic",a);JIRA.Issues.Application.execute("analytics:trigger","kickass.filters.docked",{isDocked:this.model.isDocked()})}}},_renderCollapsed:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().addClass("left noborder");this.$el.addClass("collapsed").html(this.collapsedTemplate({isDocked:this.model.isDocked()}));JIRA.Issues.triggerHorizontalResize();a.appendTo("body");return this},_renderOpen:function(){var b=jQuery(".jira-feedback-link-container.subtle-style").detach().removeClass("left noborder");this.$el.removeClass("collapsed");this.model.favouriteFiltersCollection.sort({silent:true});this.$el.width(this.model.getWidth());this.$el.html(this.template({contextPath:window.contextPath,favouriteFilters:this.model.favouriteFiltersCollection.toJSONForTemplate(),favouriteFiltersFallback:this.favouriteFiltersFallback,isAnonymous:!JIRA.Issues.LoginUtils.isLoggedIn(),loginUrl:JIRA.Issues.LoginUtils.redirectUrlToCurrent(),systemFilters:this.model.systemFiltersCollection.toJSONForTemplate()}));this._renderSelectedFilter();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.filterPanelOpened]);var a=this;this.$el.find("a.filter-actions").each(function(e,c){var g=new AJS.Dropdown({alignment:AJS.LEFT,styleClass:"filter-actions-dropdown",content:function(){return a.filterActionsDialogView.getDropdownContents(AJS.$(c))},positioningController:new JIRA.Issues.WindowPositioning(),trigger:AJS.$(c)});var f=AJS.$(c).find("span"),d=AJS.$(c).closest("li");g.bind("hideLayer",function(){f.removeClass("active");d.removeClass("hover")});g.bind("showLayer",function(){f.addClass("active");d.addClass("hover");a.filterActionsDialogView.setElement(this.layerController.$layer)})});b.appendTo(this.$el);JIRA.Issues.triggerHorizontalResize();this._adjustFavouriteFiltersHeight();return this},_clearCurrentSelectedFilter:function(){this.$el.find(".filter-list a").removeClass("active")},_renderSelectedFilter:function(){this._clearCurrentSelectedFilter();var a=this.model.get("activeFilter");if(a){this.$el.find(".filter-list a.filter-link[data-id="+a.getId()+"]").addClass("active").focus().blur()}},_showActionsDropdown:function(b){b.preventDefault();var a=AJS.$(b.target).parents("li").addClass("open");AJS.$(document).one("hideLayer",function(){a.removeClass("open")})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/Browser.js' */
(function(a){AJS.namespace("JIRA.Issues.Browser");JIRA.Issues.Browser={getWindowWidth:function(){return a(window).width()}}}(AJS.$));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelModel.js' */
(function(){var b="issues.sidebar.docked";var a="issues.sidebar.width";Backbone.define("JIRA.Issues.FilterPanelModel",JIRA.Issues.BaseModel.extend({properties:["activeFilter"],defaults:{activeFilter:null},initialize:function(c,d){_.extend(this,_.defaults(d,{storage:window.localStorage}));this.favouriteFiltersCollection=new JIRA.Issues.SortedFilterCollection([],{url:JIRA.Issues.FilterPanelModel.favouriteFiltersURL()});this.systemFiltersCollection=new JIRA.Issues.FilterCollection(d.systemFilters);this.favouriteFiltersCollection.on("change:favourite",this._removeUnfavouritedFilters,this);this.favouriteFiltersCollection.on("remove",function(e){this.trigger("filterRemoved",{filterId:e.getId()})},this);this.initialFavouritesFetch=this.favouriteFiltersCollection.fetch({reset:true})},addFavouriteFilter:function(c){if(!this.favouriteFiltersCollection.get(c.getId())){this.favouriteFiltersCollection.add(c)}return this.favouriteFiltersCollection.get(c.getId())},addSystemFilters:function(c){this.systemFiltersCollection.add(c);this.systemFiltersCollection.trigger("change")},removeFavouriteFilter:function(c){this.favouriteFiltersCollection.remove(c)},getFilterById:function(d){var c=jQuery.Deferred();var e=this.systemFiltersCollection.get(d)||this.favouriteFiltersCollection.get(d);if(e){c.resolve(e)}else{e=new JIRA.Issues.FilterModel({id:d});e.fetch({success:_.bind(function(h,g){var f=this.favouriteFiltersCollection;if(e.getFavourite()){this.initialFavouritesFetch.done(function(){c.resolve(f.get(d)||e)});this.initialFavouritesFetch.fail(function(){c.resolve(h)})}else{c.resolve(e)}},this),error:function(f){f.setIsValid(false);c.reject.apply(this,arguments)}})}return c.promise()},setDocked:function(c){this._getStorage().setItem("dockStatesAnalyticsEnabled",true);return this._getStorage().setItem(b,c)},setWidth:function(c){return this._getStorage().setItem(a,c)},getWidth:function(){var c=parseInt(this._getStorage().getItem(a),10);return((c>0)?c:200)},_removeUnfavouritedFilters:function(){var c=this.favouriteFiltersCollection;c.remove(c.filter(function(d){return !d.getFavourite()}))},setRenamedFilterName:function(c){var d=this.favouriteFiltersCollection.get(c.id);if(d){d.setName(c.name)}return d},_getStorage:function(){return this.storage||window.localStorage},isDockedPrefGiven:function(){return this._getStorage().getItem(b)!==null},shouldShowDockIntro:function(){return !this.isDocked()&&!this.isDockedPrefGiven()},isExpanded:function(){return this.shouldShowDockIntro()?false:this.isDocked()},isDocked:function(){var c=this._getStorage();if(c.getItem(b)==null){return JIRA.Issues.Browser.getWindowWidth()>1200}else{return c.getItem(b)!=="false"}}},{favouriteFiltersURL:function(){return contextPath+"/rest/api/2/filter/favourite?expand="+JIRA.Issues.FilterModel.getExpandValue()}}))}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModule.js' */
Backbone.define("JIRA.Issues.FilterModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule;this.newSearchFilter=new JIRA.Issues.FilterModel({name:"Search"});this.filterPanelModel=a.filterPanelModel||new JIRA.Issues.FilterPanelModel({},{searchPageModule:a.searchPageModule,systemFilters:a.systemFilters});this.filterPanelModel.on("filterRemoved",function(b){this.trigger("filterRemoved",b)},this);this.filterPanelModel.set("activeFilter",this._searchPageModule.getFilter());this._searchPageModule.bind("change:filter",function(b,c){this.filterPanelModel.set("activeFilter",c)},this)},canEditColumns:function(){var a=this._searchPageModule.getFilter();return a&&a.isMyFilter()},initSystemFilters:function(){var a=jQuery.Deferred(),b=!!this.filterPanelModel.systemFiltersCollection.size();if(b){a.resolve()}else{AJS.$.ajax({context:this,url:AJS.contextPath()+"/rest/issueNav/latest/systemFilters"}).done(function(c){var d=this._searchPageModule.addOwnerToSystemFilters(JSON.parse(c));this.filterPanelModel.addSystemFilters(d);a.resolve()}).fail(function(){a.reject()})}return a.promise()},addFavouriteFilter:function(a){return this.filterPanelModel.addFavouriteFilter(a)},getNewSearchFilter:function(){return this.newSearchFilter},getFilterById:function(a){return this.filterPanelModel.getFilterById(a)},createView:function(a){this.filterPanelView=new JIRA.Issues.FilterPanelView({el:a.$filterPanelEl,model:this.filterPanelModel,searchPageModule:this._searchPageModule,easeOff:(!!jQuery.browser.msie&&jQuery.browser.version<=8)?500:0});this.filterPanelView.on("filterSelected",function(b){if(b===null){this._searchPageModule.resetToBlank({isNewSearch:true})}else{this._searchPageModule.resetToFilter(b)}},this);this.filterPanelView.on("filterSaved",function(b){this._searchPageModule.filterModuleSaved(b,true);if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._searchPageModule.setSessionSearch(b)}},this);return this.filterPanelView},toggleFilterPanel:function(){this.filterPanelView.toggleDockState()},createHelptipForFilterPanelDocking:function(){var d="filters-dock-intro";var c=this.filterPanelModel;var b=this.filterPanelView;if(c.shouldShowDockIntro()&&b.$el.is(":visible")){var a=new AJS.HelpTip({id:d,title:"Did you notice?",bodyHtml:"You can dock the filter bar to always show your list of filters.",anchor:".ui-dock",isSequence:true,weight:2,callbacks:{beforeShow:function(){b.$el.popoutSidebar("expand",false)},init:function(){if(b.$el.popoutSidebar("isUndocked")){b.$el.popoutSidebar("unbindHoverIntent")}},hide:function(){if(b.$el.popoutSidebar("isUndocked")){b.$el.popoutSidebar("bindHoverIntent");b.$el.popoutSidebar("collapse")}}}});return a}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterActionsDialogView.js' */
Backbone.define("JIRA.Issues.FilterActionsDialogView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavFilter.filterDropDown,events:{"click .rename-filter":"_renameFilter","click .copy-filter":"_copyFilter","click .unfavourite-filter":"_unFavouriteFilter","click .delete-filter":"_deleteFilter"},getDropdownContents:function(c){var d=this.model.getFilterById(c.data("id")),a=this,b=jQuery.Deferred();d.done(function(e){b.resolve(AJS.$(a.template({filter:e,canEdit:JIRA.Issues.LoginUtils.loggedInUserName()===e.getOwnerUserName()})))});return b},_renameFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");new JIRA.Issues.FilterRenameDialogView({id:"rename-filter-dialog",model:this.model,filterId:b}).show()},_copyFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");this._getFilter(b,_.bind(function(d){var c=new JIRA.Issues.FilterSaveDialogView({id:"copy-filter-dialog",type:JIRA.Issues.FilterSaveDialogView.Types.COPY,model:d});c.on("filterSaved",function(){this.trigger.apply(this,["filterSaved"].concat(_.toArray(arguments)))},this);c.show()},this))},_unFavouriteFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");this._getFilter(b,function(c){c.saveFavourite(false)})},_deleteFilter:function(a){a.preventDefault();var b=AJS.$(a.target).data("id");new JIRA.Issues.FilterDeleteDialogView({id:"delete-filter-dialog",model:this.model,filterId:b}).show()},_getFilter:function(c,b){var a=this.model.getFilterById(c);a.done(b)}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/util/WindowPositioning.js' */
JIRA.Issues.WindowPositioning=AJS.InlineLayer.StandardPositioning.extend({_calculateOverflow:function(c){var b=this.layer().css("position")==="fixed",a=c.top+this.layer().outerHeight(true),e=jQuery(window).outerHeight(),d=jQuery(window).scrollTop();if(b){return Math.max(0,a-e)}else{return Math.max(0,a-d-e)}},left:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left+=this.offsetTarget().outerWidth();a.top-=b}return a},right:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left-=this.offsetTarget().outerWidth();a.top-=b}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/orderby.soy' */
// This file was automatically generated from orderby.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.OrderBy == 'undefined') { JIRA.Templates.OrderBy = {}; }


JIRA.Templates.OrderBy.orderBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.sortBy && opt_data.sortBy.fieldId) ? '<a class="order-by ' + ((opt_data.sortBy.order == 'ASC') ? 'ascending' : 'descending') + '" data-field-id="' + soy.$$escapeHtml(opt_data.sortBy.fieldId) + '" data-direction="' + soy.$$escapeHtml(opt_data.sortBy.order) + '" href="#" title="' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '"><span>' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '</span></a>' : '<a class="order-by" title="' + soy.$$escapeHtml("Order by") + '"><span>' + soy.$$escapeHtml("Order by") + '</span></a>', '<a class="order-options" title="', soy.$$escapeHtml("Select the field that issues are ordered by."), '">', soy.$$escapeHtml("Select the field that issues are ordered by."), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.OrderBy.orderByOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="order-by-options" multiple="multiple" class="hidden"><optgroup data-footer-text="', soy.$$escapeHtml(opt_data.footer), '">');
  var optionList35 = opt_data.options;
  var optionListLen35 = optionList35.length;
  for (var optionIndex35 = 0; optionIndex35 < optionListLen35; optionIndex35++) {
    var optionData35 = optionList35[optionIndex35];
    output.append('<option title="', soy.$$escapeHtml(optionData35.fieldName), '" value="', soy.$$escapeHtml(optionData35.fieldId), '" data-meta="', soy.$$escapeHtml(optionData35.meta), '">', soy.$$escapeHtml(optionData35.fieldName), '</option>');
  }
  output.append('</optgroup></select>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByModel.js' */
JIRA.Issues.OrderByModel=JIRA.Issues.Brace.Model.extend({namedEvents:["sort"],namedAttributes:["sortBy","jql"],initialize:function(){this.on("change:jql",this.updateSelectedSort,this)},updateSelectedSort:function(){jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions/primary",data:JSON.stringify({jql:this.getJql()}),contentType:"application/json",success:_.bind(function(a){this.setSortBy(a)},this)})},toggleSort:function(){this.setJql(this.getSortBy().toggleJql);this.triggerSort(this.getJql())},doSort:function(a){this.setJql(a);this.triggerSort(this.getJql())}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByView.js' */
JIRA.Issues.OrderByView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.OrderBy.orderBy,events:{"click a.order-by":"_onClickOrderBy","click a.order-options":"_toggleShowDropDown"},initialize:function(){this.model.on("change:sortBy",this.render,this)},render:function(){this.$el.html(this.template(this.model.toJSON()));return this},deactivate:function(){this.orderByDropDown&&this.orderByDropDown.deactivate();this.undelegateEvents()},_onClickOrderBy:function(c){var b=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(b);if(!b.isDefaultPrevented()){var a=AJS.$(c.currentTarget).data("field-id");if(a){this.model.toggleSort()}}c.preventDefault()},_toggleShowDropDown:function(a){if(!this.orderByDropDown){this.orderByDropDown=new JIRA.Issues.OrderByDropDownView({model:this.model,offsetTarget:this.$("a.order-by"),onHideCallback:_.bind(function(){this.orderByDropDown=null},this)})}this.orderByDropDown.toggle();a.preventDefault()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByDropDownView.js' */
JIRA.Issues.OrderByDropDownView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.bindAll(this,"_onDropdownHidden","_onDropdownShown");this.offsetTarget=a.offsetTarget;this._onHideCallback=a.onHideCallback;this._pending=null;this._inlineLayer=null},deactivate:function(){this._inlineLayer&&this._inlineLayer.hide();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},toggle:function(){if(!this._inlineLayer){this._pending=AJS.$.ajax(this._ajaxDefaults());this._inlineLayer=this._createInlineLayer(this._pending);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.show,this._onDropdownShown);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.hide,this._onDropdownHidden);this._inlineLayer.show()}else{this._inlineLayer.hide()}},_createInlineLayer:function(a){var b=_.bind(function(d){this._deferredAddTipsyToFooter(d);return this._renderInitialContent(d)},this);var c=new AJS.InlineLayer({offsetTarget:this.offsetTarget,content:function(){return a.pipe(b)},width:218});if(this._onHideCallback){c.bind(AJS.InlineLayer.EVENTS.hide,this._onHideCallback)}return c},_initSingleSelect:function(b){var c=b.find("select");c.bind("selected",_.bind(this._onFieldSelected,this));this.selectControl=new AJS.CheckboxMultiSelect({element:c,itemAttrDisplayed:"label",suggestionsHandler:AJS.SelectSuggestHandler,ajaxOptions:this._ajaxDefaults({data:_.bind(function(d){return JSON.stringify(this._ajaxOptionsData(d))},this),query:true,minQueryLength:0,formatResponse:_.bind(function(d){this._removeTipsy();var f=new AJS.GroupDescriptor();_.each(d.fields,function(g){f.addItem(new AJS.ItemDescriptor({title:g.fieldName,value:g.fieldId,label:g.fieldName,meta:{sortJql:g.sortJql}}))});var e=this._getFooterText(d);if(e){f.footerText(e);this._deferredAddTipsyToFooter(d)}return[f]},this)})});var a=b.find("#order-by-options-input");a.focus()},_ajaxDefaults:function(b){var a={url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions",type:"POST",contentType:"application/json",data:JSON.stringify(this._ajaxOptionsData())};return _.extend(a,b)},_ajaxOptionsData:function(b){var a=this.model.getJql();var c=this.model.getSortBy();return{query:b,jql:a?a:undefined,sortBy:c?c.fieldId:undefined}},_renderInitialContent:function(a){var b=_.map(a.fields,function(c){return _.extend({},c,{meta:JSON.stringify({sortJql:c.sortJql})})});return AJS.$("<div></div>").addClass("order-dropdown").html(JIRA.Templates.OrderBy.orderByOptions({options:b,footer:this._getFooterText(a)}))},_onDropdownShown:function(b,a,c){this._initSingleSelect(a)},_onDropdownHidden:function(b,a,c){this._removeTipsy();AJS.$("div.order-dropdown").remove();this._inlineLayer=null},_onFieldSelected:function(c,b){var a=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(a);if(!a.isDefaultPrevented()){_.defer(_.bind(function(){if(this.selectControl.outstandingRequest){this.selectControl.outstandingRequest.reject()}AJS.InlineLayer.current.hide();var d=b.meta();this.model.doSort(d.sortJql)},this))}},_getFooterText:function(a){if(typeof a.matchesCount==="number"&&typeof a.maxResults==="number"){var b=a.matchesCount-a.maxResults;if(b>0){return AJS.format("{0} more fields...",b)}}return""},_deferredAddTipsyToFooter:function(d){if(this._inlineLayer){var b=d.matchesCount;var e=Math.min(d.matchesCount,d.maxResults);var c=AJS.format("Showing {0} of {1} matching fields. Find more fields by typing in the search box.",e,b);var a=this;_.defer(function(){a._tipsyTrigger=new JIRA.Issues.Tipsy({el:a._inlineLayer.$layer.find(".aui-list-section-footer"),tipsy:{title:function(){return c},className:"tipsy-front"}})})}},_removeTipsy:function(){if(this._tipsyTrigger){this._tipsyTrigger.hide();this._tipsyTrigger=null}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderBy.js' */
JIRA.Events.ISSUE_TABLE_REORDER="issueTableReorder";JIRA.Components.OrderBy={create:function(c){var b,a;c=c||{};b=new JIRA.Issues.OrderByModel({sortBy:c.sortBy,jql:c.jql});a=new JIRA.Issues.OrderByView({model:b});return{onSort:function(){b.onSort.apply(b,arguments);return this},offSort:function(d){b.off("sort",d);return this},render:function(){a.render();return this},setElement:function(d){a.setElement(d);return this},setJql:function(d){b.setJql(d);return this},setSortBy:function(d){b.setSortBy(d);return this}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.soy' */
// This file was automatically generated from ColumnPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.ColumnPicker == 'undefined') { JIRA.Templates.Dialogs.ColumnPicker = {}; }


JIRA.Templates.Dialogs.ColumnPicker.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><form action="#" method="post"  class="aui top-label column-picker"><div class="check-list-top-panel"><h3>', soy.$$escapeHtml("Columns"), '</h3>');
  if (opt_data.columns.length > 1) {
    output.append('<p class="aui-buttons">');
    var columnList9 = opt_data.columns;
    var columnListLen9 = columnList9.length;
    for (var columnIndex9 = 0; columnIndex9 < columnListLen9; columnIndex9++) {
      var columnData9 = columnList9[columnIndex9];
      output.append('<button type="button" class="config-chooser aui-button ', (columnData9.isActive) ? ' active' : '', '" id="columns-chooser-', soy.$$escapeHtml(columnData9.name), '" data-value="', soy.$$escapeHtml(columnData9.name), '"', (columnData9.isDisabled) ? 'aria-disabled="true"' : '', '>', soy.$$escapeHtml(columnData9.description), '</button>');
    }
    output.append('</p>');
  }
  output.append('</div>');
  var columnList28 = opt_data.columns;
  var columnListLen28 = columnList28.length;
  for (var columnIndex28 = 0; columnIndex28 < columnListLen28; columnIndex28++) {
    var columnData28 = columnList28[columnIndex28];
    output.append('<div class="', soy.$$escapeHtml(columnData28.name), '-column-sparkler hidden"></div>');
  }
  output.append((! opt_data.isAutoUpdate) ? '<div class="button-panel"><input accesskey="' + soy.$$escapeHtml("s") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)) + '" class="aui-button submit" type="submit" value="' + soy.$$escapeHtml("Done") + '"/> <a accesskey="' + soy.$$escapeHtml("`") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)) + '" class="aui-button aui-button-link close-dialog" href="javascript:">' + soy.$$escapeHtml("Cancel") + '</a></div>' : '', '</form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle column-picker-trigger" title="', soy.$$escapeHtml("Columns"), '">', soy.$$escapeHtml("Columns"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-link restore-defaults">', soy.$$escapeHtml(opt_data.linkText), '</button>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.js' */
if(!JIRA.Components){JIRA.Components={}}JIRA.Components.ColumnPicker=JIRA.Issues.Brace.Model.extend({initialize:function(a,b){this.columnPickerModel=new JIRA.Issues.ColumnPickerModel({autoUpdate:b.autoUpdate});this.columnPickerView=new JIRA.Issues.ColumnPickerView({columnPickerModel:this.columnPickerModel});_.each(b.providers,_.bind(function(c){if(c instanceof JIRA.Issues.ColumnConfigModel){this.columnPickerModel.addColumnProvider(c.getName(),c)}else{this.columnPickerModel.addColumnProvider(c.id,this._createProviderModel(c));if(c.columns){this.columnPickerModel.syncColumns(c.id,c.columns)}}},this));this.setCurrentColumnConfig(b.providers[0].id);if(b.el){this.columnPickerView.setElement(b.el).render()}},_createProviderModel:function(a){return JIRA.Issues.ColumnConfigModel.create(a.id,a.label,_.omit(a,"id","label","columns"))},getCurrentColumnConfig:function(){return this.columnPickerModel.getCurrentColumnConfig()},setElement:function(a){this.columnPickerView.setElement(a);return this},render:function(){this.columnPickerView.render();return this},clearFilterConfiguration:function(){this.columnPickerModel.clearFilterConfiguration();return this},adjustHeight:function(){this.columnPickerView.adjustHeight();return this},setCurrentColumnConfig:function(a){this.columnPickerModel.setCurrentColumnConfig(a);return this},saveColumns:function(a){this.columnPickerModel.saveColumns(a);return this},syncColumns:function(a,b){this.columnPickerModel.syncColumns(a,b);return this},getColumnConfig:function(){this.columnPickerModel.getColumnConfig()},onColumnsSync:function(b,a){this.columnPickerModel.onColumnsSync(b,a);return this},on:function(b,c,a){this.columnPickerModel.on(b,c,a);return this},off:function(a,b){this.columnPickerModel.off(a,b);return this}});JIRA.Components.ColumnPicker.create=function(a){return new JIRA.Components.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerModel.js' */
JIRA.Issues.ColumnPickerModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["columnConfig","savedColumnConfig","search","availableColumns","autoUpdate"],namedEvents:["columnsSync","changeColumnConfigDisabled","destroyColumnConfig"],allColumnsUrl:AJS.contextPath()+"/rest/gadget/1.0/availableColumns",shouldRefreshSearchOnActivation:function(){return this.getCurrentColumnConfig().shouldRefreshSearchOnActivation()},shouldCloseOnActivation:function(){return this.getCurrentColumnConfig().shouldCloseOnActivation()},shouldLoadDefaultsOnActivation:function(){return this.getCurrentColumnConfig().shouldLoadDefaultsOnActivation()},shouldRevertOnHide:function(){return this.getCurrentColumnConfig().shouldRevertOnHide()},loadDefaultColumns:function(){this.getCurrentColumnConfig().loadDefaultColumns()},initialize:function(){this.columnsData={}},refreshSearchWithColumns:function(a){a=a||this.getCurrentColumnConfig();this.triggerColumnsSync(a.getName(),a.getColumns())},fetchAvailableColumnsIfNeeded:function(){if(!this.has("availableColumns")){jQuery.ajax(this.allColumnsUrl).done(_.bind(function(a){this.setAvailableColumns(a.availableColumns)},this))}},getCurrentColumnConfig:function(a){if(!a){a=this.getColumnConfig()}return this.columnsData[a]},revertColumnConfig:function(){if(this.shouldRevertOnHide()&&this.getSavedColumnConfig()!=this.getColumnConfig()){this._previousAttributes.columnConfig=this.getSavedColumnConfig();this.setColumnConfig(this.getSavedColumnConfig(),{silent:true})}},setCurrentColumnConfig:function(a){this.setColumnConfig(a);this.setSavedColumnConfig(a)},syncColumns:function(a,b){_.each(this.columnsData,function(c){if(c.getName()==a){c.setColumns(b);c.setSavedColumns(b)}})},saveColumns:function(a){this.getCurrentColumnConfig().setColumns(a);this.getCurrentColumnConfig().save();this.getCurrentColumnConfig().triggerColumnsSync()},addColumnProvider:function(b,a){this.columnsData[b]=a;a.on("columnsSync sync destroy",_.bind(function(){this.refreshSearchWithColumns(a)},this));a.on("change:isDisabled",_.bind(function(d,c){this.triggerChangeColumnConfigDisabled(d,c)},this));a.on("destroy",_.bind(function(c){this.triggerDestroyColumnConfig(c)},this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerView.js' */
JIRA.Issues.ColumnPickerView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_generateInlineDialogContent","_onDOMCloseDialogClick","_onDOMConfigChooserClick","_onDOMDialogHide","_onDOMFormSubmit","_onDOMTriggerClick","_onModelChangeAvailableColumns","_onModelChangeColumnConfig","_onModelChangeColumnConfigDisabled","_onModelDestroyColumnConfig");this.subViews={}},dialog:null,activeSubview:null,_onDOMConfigChooserClick:function(b){var a=jQuery(b.target);if(a.attr("aria-disabled")){return}this.columnPickerModel.setColumnConfig(a.data("value")||"user")},_activateNewSubView:function(a){a.activate();if(this.columnPickerModel.shouldCloseOnActivation()){this.dialog.hide()}else{this.activeSubview=a;this.activeSubview.show();this.adjustHeight()}if(this.columnPickerModel.shouldRefreshSearchOnActivation()){this.columnPickerModel.refreshSearchWithColumns()}if(this.columnPickerModel.shouldLoadDefaultsOnActivation()){this.columnPickerModel.loadDefaultColumns()}},_onDOMFormSubmit:function(a){a.preventDefault();this.activeSubview.saveColumns();this.dialog.hide()},_onDOMCloseDialogClick:function(a){this.dialog.hide()},_onDOMTriggerClick:function(a){this.dialog.show();this.activeSubview=this.subViews[this.columnPickerModel.getCurrentColumnConfig().getName()];this.activeSubview.show();this._activateConfigChooserButton(this.columnPickerModel.getCurrentColumnConfig().getName());this.columnPickerModel.fetchAvailableColumnsIfNeeded()},_activateConfigChooserButton:function(a){this.dialog.find(".config-chooser.active").removeClass("active");this.dialog.find("#columns-chooser-"+a).addClass("active")},_onDOMDialogHide:function(a){this.columnPickerModel.revertColumnConfig();this.activeSubview.hide()},_onModelChangeColumnConfig:function(d,b){var a=this.subViews[b];this._activateConfigChooserButton(a.model.getName());var c=this.subViews[d.previous("columnConfig")];if(c!=a){c.hide();c.deactivate();this._activateNewSubView(a)}},_onModelChangeAvailableColumns:function(b,a){_.each(this.subViews,function(c){c.createSparklerControl(a)})},_onModelDestroyColumnConfig:function(){this.dialog.hide()},_onModelChangeColumnConfigDisabled:function(b,a){var c=this.dialog.find("#columns-chooser-"+b.getName());if(a){c.attr("aria-disabled",true)}else{c.removeAttr("aria-disabled")}},render:function(){if(!this.$trigger){this.$trigger=jQuery(JIRA.Templates.Dialogs.ColumnPicker.trigger())}this.$el.append(this.$trigger);this.$trigger.click(this._onDOMTriggerClick);this._renderInlineDialog()},adjustHeight:function(){if(AJS.InlineDialog.current&&AJS.InlineDialog.current.id==="column-picker-dialog"&&this.activeSubview){var c=jQuery(this.activeSubview.el).find(".aui-list-scroll");var d=((jQuery(window).height()-this.$trigger.offset().top)-90);var b=d-this.dialog.height();var a=Math.max(Math.min(c.height()+b,270),80);c.css("height",a);return true}return false},_generateInlineDialogContent:function(c,a,b){if(!this.dialogContent){c.html(JIRA.Templates.Dialogs.ColumnPicker.popup({modifierKey:AJS.Navigator.modifierKey(),isAutoUpdate:this.columnPickerModel.getAutoUpdate(),columns:_.map(this.columnPickerModel.columnsData,_.bind(function(d){return{name:d.getName(),description:d.getDescription(),selected:false,isDisabled:d.isDisabled(),isActive:this.columnPickerModel.getCurrentColumnConfig()==d}},this))}));c.find(".config-chooser").click(this._onDOMConfigChooserClick);c.find("form").submit(this._onDOMFormSubmit);c.find(".close-dialog").click(this._onDOMCloseDialogClick);c.click(function(d){d.stopPropagation()});this._createSubViews(c);this.dialogContent=c.children()}else{c.append(this.dialogContent)}b()},_renderInlineDialog:function(){if(this.dialog){return}this.dialog=AJS.InlineDialog(this.$trigger,"column-picker-dialog",this._generateInlineDialogContent,{offsetY:15,addActiveClass:true,hideDelay:null,noBind:true,initCallback:_.bind(function(){var a=this;var b=function(){if(!a.adjustHeight()){setTimeout(b,100)}};b()},this),hideCallback:this._onDOMDialogHide})},_createSubViews:function(a){_.each(this.columnPickerModel.columnsData,_.bind(function(b){this.subViews[b.getName()]=new JIRA.Issues.ColumnPickerSparklerView({el:a.find("."+b.getName()+"-column-sparkler"),model:b,autoUpdate:this.columnPickerModel.getAutoUpdate()})},this));if(this.columnPickerModel.has("availableColumns")){this._onModelChangeAvailableColumns(this.columnPickerModel,this.columnPickerModel.getAvailableColumns())}this.columnPickerModel.on("change:availableColumns",this._onModelChangeAvailableColumns);this.columnPickerModel.on("change:columnConfig",this._onModelChangeColumnConfig);this.columnPickerModel.onChangeColumnConfigDisabled(this._onModelChangeColumnConfigDisabled);this.columnPickerModel.onDestroyColumnConfig(this._onModelDestroyColumnConfig)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnConfigModel.js' */
JIRA.Issues.ColumnConfigModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["name","columns","autoUpdate","savedColumns","description","previousColumns","actionBarText","isActive"],namedEvents:["columnsSync"],defaults:{actionBarText:"Restore Defaults",isActive:false},idAttribute:"name",initialize:function(a,b){_.extend(this,b)},getDefaultColumns:function(){var a=jQuery.Deferred();this.defaultColumns().done(_.bind(function(b){var c=this.parse(b);if(c&&c.columns){a.resolve(c.columns)}else{a.reject(null)}},this));return a.promise()},parse:function(a){if(!a){return{}}return{columns:_.compact(_.pluck(a,"value"))}},isDisabled:function(){return false},isEditDisabled:function(){return false},defaultColumns:function(){var a=jQuery.Deferred();a.resolve([]);return a.promise()},_sortColumnsUsingOriginalOrder:function(a,b){return _.intersection(a,b).concat(_.difference(b,a))},setUnsortedColumns:function(a){a=this._sortColumnsUsingOriginalOrder(this.getColumns(),a);this.setPreviousColumns(this.getColumns(),{silent:true});this.setColumns(a)},toJSON:function(){return{columns:this.getColumns()}},revertUnsavedColumns:function(a){if(this.getSavedColumns()!=this.getColumns()){this.setColumns(this.getSavedColumns(),a)}},loadDefaultColumns:function(){this.getDefaultColumns().done(_.bind(function(a){this.setColumns(a)},this))},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return true},shouldLoadDefaultsOnActivation:function(){return false},shouldRevertOnHide:function(){return true}});JIRA.Issues.ColumnConfigModel.create=function(b,d,c,a){return new JIRA.Issues.ColumnConfigModel({autoUpdate:a,name:b,description:d},c)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSparklerView.js' */
JIRA.Issues.ColumnPickerSparklerView=JIRA.Issues.Brace.View.extend({initialize:function(a){this._maxResults=(typeof a.maxResults=="number")?a.maxResults:this.MAX_DISPLAYED_ITEMS;this._autoUpdate=!!a.autoUpdate;this.$el.scrollLock(".aui-list-scroll");if(!this._autoUpdate){this.model.on("change:columns",_.bind(this._setSelectedColumns,this))}},MAX_DISPLAYED_ITEMS:25,_sparkler:null,activate:function(){this.model.setIsActive(true)},deactivate:function(){this.model.setIsActive(false)},hide:function(){this.model.revertUnsavedColumns({silent:true});this.$el.addClass("hidden");var a=this.$el.find("input[id *= column-sparkler-input]");a.val("")},show:function(){this.$el.removeClass("hidden");this._setSelectedColumns();var a=this.$el.find("input[id *= column-sparkler-input]");if(!a.is(":disabled")){a.focus()}},addMessage:function(a){if(this.$el.find(".aui-message."+a.type).length===0){AJS.messages[a.type](this.$el,{body:a.content,closeable:false,insert:"prepend",id:a.id})}},_disableEditIfNeeded:function(){if(this.model.isEditDisabled()){this._disableEdit()}else{this._enableEdit()}},_showEditDisabledMessage:function(){this.addMessage({content:"You cannot update the columns for a filter owned by another user.",type:"warning",id:this.model.getName()+"-edit-disabled-message"})},_hideEditDisabledMessage:function(){this.$el.find("#"+this.model.getName()+"-edit-disabled-message").remove()},_disableEdit:function(){this._sparkler.disable();this.$el.find("input[type='checkbox']").attr("disabled","disabled");this.$el.find(".check-list-item").addClass("disabled");this.$el.find(".no-suggestions").addClass("disabled");this.$el.find(".restore-defaults").attr("aria-disabled","true");this._showEditDisabledMessage()},_enableEdit:function(){this._sparkler.enable();this.$el.find("input[type='checkbox']").removeAttr("disabled");this.$el.find(".check-list-item").removeClass("disabled");this.$el.find(".no-suggestions").removeClass("disabled");this.$el.find(".restore-defaults").removeAttr("aria-disabled");this._hideEditDisabledMessage()},createSparklerControl:function(a){if(this._sparkler){this._sparkler.remove()}var b=this._buildQueryableSelect(a);this.$el.append(b);this._sparkler=new AJS.CheckboxMultiSelect({element:b,maxInlineResultsDisplayed:this._maxResults,suggestionsHandler:JIRA.Issues.ColumnPickerSuggestHandler,actionBar:this.model.getActionBarText()});this._setSelectedColumns();if(this._autoUpdate){b.bind("selected",_.bind(this.saveColumns,this));b.bind("unselect",_.bind(this.saveColumns,this))}this._sparkler.$field.focus();this.$el.on("actionclick",_.bind(function(c){c.preventDefault();this.model.unset("columns");this.model.destroy()},this));this.model.on("change:editDisabled",_.bind(this._disableEditIfNeeded,this))},saveColumns:function(){this.model.setUnsortedColumns(this._sparkler.model.getSelectedValues());this.model.save(null,{wait:false})},_setSelectedColumns:function(){var a=this.model.getColumns();var b=this._sparkler;if(b&&a&&a.length){_.each(b.model.getDisplayableUnSelectedDescriptors(),function(c){if(_.contains(a,c.value())){b.selectItem(c)}});_.each(b.model.getDisplayableSelectedDescriptors(),function(c){if(!_.contains(a,c.value())){b.unselectItem(c)}});b.render();this._disableEditIfNeeded()}},_buildQueryableSelect:function(c){var a=this;var b=_.map(c,function(d){return new AJS.ItemDescriptor(_.extend(d,{title:d.label}))});return jQuery(AJS.Templates.queryableSelect({id:a.model.getName()+"-column-sparkler",descriptors:[new AJS.GroupDescriptor({items:b})]}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSuggestHandler.js' */
JIRA.Issues.ColumnPickerSuggestHandler=AJS.SelectSuggestHandler.extend({createActionBar:function(b){if(!b){return null}var a=jQuery(JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink({linkText:b}));a.click(function(c){if(jQuery(c.target).attr("aria-disabled")!=="true"){a.trigger("actionclick")}c.preventDefault()});return jQuery("<li class='check-list-group-actions'></li>").append(a)},formatSuggestions:function(d,e){var f=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());var c=new AJS.GroupDescriptor({styleClass:"selected-group",items:f});d.splice(0,0,c);var a=_.find(d,function(g){return g.items().length});if(a){a.actionBarHtml(this.createActionBar(this.options.actionBar))}if(e.length>0){d=AJS.SuggestHelper.removeDuplicates(d);var b=AJS.SuggestHelper.extractItems(d).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});d=[new AJS.GroupDescriptor({items:b})]}return d}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/splitview.soy' */
// This file was automatically generated from splitview.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.SplitView == 'undefined') { JIRA.Templates.SplitView = {}; }


JIRA.Templates.SplitView.fullSplitView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group split-view"><div class="aui-item list-results-panel"><div class="list-panel"><div class="list-ordering"></div><div class="list-content">');
  if (opt_data.issuePanelData) {
    JIRA.Templates.SplitView.issueList(opt_data.issuePanelData, output);
  }
  output.append('</div></div><div class="end-of-stable-message"></div><div class="aui-group pagination-view count-pagination"><a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '">', soy.$$escapeHtml("Refresh"), '</a><div class="pagination">');
  if (opt_data.pagination) {
    JIRA.Templates.IssueNavTable.pagination(opt_data.pagination, output);
  }
  output.append('</div></div></div><div class="aui-item detail-panel navigator-issue-only"><div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.SplitView.fullSplitView({issuePanelData: null, pagination: null}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="issue-list">');
  var iLimit22 = opt_data.issues.length;
  for (var i22 = 0; i22 < iLimit22; i22++) {
    var issue__soy23 = opt_data.issues[i22];
    var issueID__soy24 = opt_data.issueIDs[i22];
    var isHighlighted__soy25 = issueID__soy24 == opt_data.highlightedID;
    if (issue__soy23) {
      output.append('<li ', (isHighlighted__soy25) ? 'class="focused"' : '', ' data-id="', soy.$$escapeHtml(issueID__soy24), '" data-key="', soy.$$escapeHtml(issue__soy23.key), '" title="', soy.$$escapeHtml(issue__soy23.summary), '">');
      JIRA.Templates.SplitView.issueRow(issue__soy23, output);
      output.append('</li>');
    } else {
      JIRA.Templates.SplitView.inaccessibleIssueRow({isHighlighted: isHighlighted__soy25, issueID: issueID__soy24}, output);
    }
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img height="16" width="16" alt="', soy.$$escapeHtml(opt_data.type.name), '" title="', soy.$$escapeHtml(opt_data.type.name), ' - ', soy.$$escapeHtml(opt_data.type.description), '" src="', soy.$$escapeHtml(opt_data.type.iconUrl), '" /><a class="splitview-issue-link issue-link-key" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.key), '"> ', soy.$$escapeHtml(opt_data.key), ' </a><a class="splitview-issue-link issue-link-summary" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.key), '"> ', soy.$$escapeHtml(opt_data.summary), ' </a><div class="aui-group"><div class="aui-item"><span>', soy.$$escapeHtml(opt_data.status), '</span></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="inaccessible-issue ', (opt_data.isHighlighted) ? 'focused' : '', '" data-id="', soy.$$escapeHtml(opt_data.issueID), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueDetailsNoSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/issuenav-table.soy' */
// This file was automatically generated from issuenav-table.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-adbox jira-adbox-medium no-results ', soy.$$escapeHtml(opt_data.cssClass), '"><h3>', opt_data.message, '</h3>', (opt_data.hint) ? '<p class="no-results-hint">' + opt_data.hint + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.resultsCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.resultsCountHelper({start: '<span class="results-count-start">' + soy.$$escapeHtml(opt_data.start) + '</span>', end: '<span class="results-count-end">' + soy.$$escapeHtml(opt_data.end) + '</span>', total: '<span class="results-count-total results-count-link">' + soy.$$escapeHtml(opt_data.total) + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.TopResultsCountBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-table-info-bar"><div class="results-count"></div><div class="column-picker-trigger-container"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.resultsCountHelper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="results-count aui-item"><span class="results-count-text">', AJS.format("{0}\x26ndash;{1} of {2}",opt_data.start,opt_data.end,opt_data.total), '</span><a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '">', soy.$$escapeHtml("Refresh"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.listOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list">');
  var groupList43 = opt_data.groups;
  var groupListLen43 = groupList43.length;
  for (var groupIndex43 = 0; groupIndex43 < groupListLen43; groupIndex43++) {
    var groupData43 = groupList43[groupIndex43];
    output.append((groupData43.label) ? '<h5>' + soy.$$escapeHtml(groupData43.label) + '</h5>' : '', '<ul ', (groupData43.id) ? 'id="' + soy.$$escapeHtml(groupData43.id) + '"' : '', ' class="aui-list-section', (groupIndex43 == 0) ? ' aui-first' : '', (groupIndex43 == groupListLen43 - 1) ? ' aui-last' : '', '">');
    var itemList63 = groupData43.items;
    var itemListLen63 = itemList63.length;
    for (var itemIndex63 = 0; itemIndex63 < itemListLen63; itemIndex63++) {
      var itemData63 = itemList63[itemIndex63];
      output.append('<li class="aui-list-item"><a class="aui-list-item-link" ', (itemData63.id) ? 'id="' + soy.$$escapeHtml(itemData63.id) + '"' : '', ' ', (itemData63.rel) ? 'rel="' + soy.$$escapeHtml(itemData63.rel) + '"' : '', ' href="', (! itemData63.relativeLink) ? soy.$$escapeHtml("/jira") : '', soy.$$escapeHtml(itemData63.link), '" ', (itemData63.title) ? 'title="' + soy.$$escapeHtml(itemData63.title) + '"' : '', '>', soy.$$escapeHtml(itemData63.label), '</a></li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.views = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.sections.issue && opt_data.sections.issue.length > 0) {
    output.append('<div class="issue-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.issue}, output);
    output.append('</div>');
  }
  if (opt_data.sections.filter && opt_data.sections.filter.length > 0) {
    output.append('<div class="filter-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.filter}, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.tools = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.listOptions(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.endOfStableMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml("Too many search results to display. Refine your search criteria and try again."), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="issuerow inaccessible-issue" rel="', soy.$$escapeHtml(opt_data.issueID), '"><td class="nav" colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/templates/issuenav-pagination.soy' */
// This file was automatically generated from issuenav-pagination.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.pagination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="pagination aui-item" data-displayable-total="', soy.$$escapeHtml(opt_data.displayableTotal), '">');
  var MAX_PAGES_DISPLAYED__soy6 = 5;
  var lastPage__soy7 = Math.floor((opt_data.displayableTotal - 1) / opt_data.pageSize);
  var pageNumber__soy8 = Math.floor(opt_data.startIndex / opt_data.pageSize);
  var urlFragment__soy9 = new soy.StringBuilder(soy.$$escapeHtml("/jira"), '/', opt_data.searchQuery, '&startIndex=');
  urlFragment__soy9 = urlFragment__soy9.toString();
  var prevStartIndex__soy15 = opt_data.startIndex - opt_data.pageSize;
  output.append((prevStartIndex__soy15 >= 0) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(prevStartIndex__soy15) + '" data-start-index="' + soy.$$escapeHtml(prevStartIndex__soy15) + '" class="icon icon-previous" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8,lastPage__soy7 + 1)) + '"><span>&lt;&lt; ' + soy.$$escapeHtml("Previous") + '</span></a>' : '');
  JIRA.Templates.IssueNavTable.numberLinksLogicBranch({startPage: pageNumber__soy8 - Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), endPage: pageNumber__soy8 + Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), lastPage: lastPage__soy7, urlFragment: urlFragment__soy9, currentPage: pageNumber__soy8 + 1, maxPagesDisplayed: MAX_PAGES_DISPLAYED__soy6, pageSize: opt_data.pageSize, displayableTotal: opt_data.displayableTotal}, output);
  var nextStartIndex__soy37 = Math.min(opt_data.startIndex + opt_data.pageSize, opt_data.displayableTotal);
  output.append((nextStartIndex__soy37 < opt_data.displayableTotal) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(nextStartIndex__soy37) + '" data-start-index="' + soy.$$escapeHtml(nextStartIndex__soy37) + '" class="icon icon-next" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8 + 2,lastPage__soy7 + 1)) + '"><span>' + soy.$$escapeHtml("Next") + ' &gt;&gt;</span></a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinksLogicBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastPage < opt_data.maxPagesDisplayed) {
    JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.lastPage}), output);
  } else {
    if (opt_data.startPage < 0) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.endPage - opt_data.startPage}), output);
    } else if (opt_data.endPage > opt_data.lastPage) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: opt_data.startPage - (opt_data.endPage - opt_data.lastPage), endPage: opt_data.lastPage}), output);
    } else {
      JIRA.Templates.IssueNavTable.numberLinks(opt_data, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinks = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var size__soy72 = opt_data.endPage - opt_data.startPage + 1;
  if (size__soy72 > 1) {
    var iLimit75 = Math.round(size__soy72);
    for (var i75 = 0; i75 < iLimit75; i75++) {
      var pageIndex__soy76 = i75 + opt_data.startPage;
      var pageNumber__soy77 = pageIndex__soy76 + 1;
      var pageStartIndex__soy78 = pageIndex__soy76 * opt_data.pageSize;
      var pageEndIndex__soy79 = Math.min(pageStartIndex__soy78 + opt_data.pageSize, opt_data.displayableTotal);
      var pageBoundaries__soy80 = new soy.StringBuilder(soy.$$escapeHtml(AJS.format("Issues {0} - {1}",pageStartIndex__soy78 + 1,pageEndIndex__soy79)));
      pageBoundaries__soy80 = pageBoundaries__soy80.toString();
      output.append(' ', (pageNumber__soy77 == opt_data.currentPage) ? '<strong title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</strong>' : '<a href="' + soy.$$escapeHtml(opt_data.urlFragment) + soy.$$escapeHtml(pageStartIndex__soy78) + '" data-start-index="' + soy.$$escapeHtml(pageStartIndex__soy78) + '" title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</a>');
    }
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/ColumnPicker.js' */
JIRA.Issues.ColumnPicker=JIRA.Components.ColumnPicker.extend({initialize:function(a,b){var c=[this._getUserColumnProvider(),this._getFilterColumnProvider()];if(JIRA.isAdmin()){c.push(this._getSystemColumnProvider())}JIRA.Components.ColumnPicker.prototype.initialize.call(this,null,{providers:c});this.search=b.search;this.search.on("change:filter",function(){var d=this.filterColumn;var f=d.isEditDisabled();var e=d.isDisabled();d.trigger("change:isDisabled",d,e);d.trigger("change:editDisabled",d,e||f)},this)},isSystemMode:function(){return this.columnPickerModel.getColumnConfig()==="system"},sanitizeColumnConfig:function(a){a=a.toLowerCase();var b=a=="system"&&!this.isSystemMode();return b?"user":a},syncColumns:function(a,b){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.syncColumns.call(this,a,b)},clearFilterConfiguration:function(){this.filterColumn.unset("columns");this.filterColumn.unset("savedColumns")},setCurrentColumnConfig:function(a){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.setCurrentColumnConfig.call(this,a)},_getFilterColumnProvider:function(){var a=this;return this.filterColumn=JIRA.Issues.ColumnConfigModel.create("filter","Filter",{url:function(){return AJS.contextPath()+"/rest/api/2/filter/"+a.search.getState().filter+"/columns"},isDisabled:function(){return !a.search.getFilter()||a.search.getFilter().getIsSystem()},isEditDisabled:function(){return !a.search.filterModule.canEditColumns()},shouldRefreshSearchOnActivation:function(){return this.has("savedColumns")},shouldCloseOnActivation:function(){return this.has("savedColumns")},shouldLoadDefaultsOnActivation:function(){return !this.has("savedColumns")},defaultColumns:_.bind(function(){if(this.userColumns.has("columns")){var b=jQuery.Deferred();b.resolve(_.map(this.userColumns.getColumns(),function(c){return{value:c}}));return b.promise()}else{return jQuery.ajax(this.userColumns.url()).promise()}},this)})},_getSystemColumnProvider:function(){return JIRA.Issues.ColumnConfigModel.create("system","System",{url:_.lambda(AJS.contextPath()+"/rest/api/2/settings/columns"),defaultColumns:function(){return jQuery.ajax(this.url()).promise()},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return false},shouldLoadDefaultsOnActivation:function(){return true},shouldRevertOnHide:function(){return false}})},_getUserColumnProvider:function(){this.userColumns=JIRA.Issues.ColumnConfigModel.create("user","My Defaults",{url:_.lambda(AJS.contextPath()+"/rest/api/2/user/columns")});return this.userColumns}});JIRA.Issues.ColumnPicker.create=function(a){return new JIRA.Issues.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueSearchManager.js' */
Backbone.define("JIRA.Issues.IssueSearchManager",JIRA.Issues.BaseEvented.extend({namedEvents:["beforeSearch","searchError"],initialize:function(a){_.extend(this,a);this.issueKeys=new JIRA.Components.IssueViewer.Legacy.AsyncData()},hasInitialSearch:function(){return !!this.initialIssueTableState},search:function(c){var b,a;c=_.extend({},c);if(_.isNumber(c.startIndex)===false){c.startIndex=0}if(this.activeResultsReq){if(JSON.stringify(this.activeRequestData)===JSON.stringify(c)){return jQuery.Deferred().reject().promise()}else{this.activeResultsReq.abort()}}this.activeRequestData=c;this.triggerBeforeSearch();if(this.hasInitialSearch()){b=jQuery.Deferred().resolve(this.initialIssueTableState);a="jira.search.finished.initial";this.initialIssueTableState=null;this.initialIssueIds=null}else{b=this.activeResultsReq=this._doSearch(c);a="jira.search.finished.secondary"}b.always(_.bind(function(){this.activeResultsReq=null;this.activeRequestData=null;JIRA.trace(a)},this));b.done(_.bind(this._updateIssueKeysOnSearchSuccess,this));b.fail(_.bind(function(){this.issueKeys.reset();this.triggerSearchError();_.defer(JIRA.trace,"jira.search.finished")},this));return b.pipe(function(d){if(d.issueTable){delete d.issueTable.issueKeys}return d}).promise()},_doSearch:function(c){var b=/^-?\d+$/;if(c.filterId&&!b.test(c.filterId)){var a={status:400,responseText:JSON.stringify({errors:[AJS.format("Invalid filter id \'\'{0}\'\'. Filter id must be a number.",c.filterId)]})};return jQuery.Deferred().reject(a).promise()}return jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/issueNav/1/issueTable",headers:JIRA.Issues.XsrfTokenHeader,data:_.extend(c,{layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()})})},_updateIssueKeysOnSearchSuccess:function(a){var c=a.issueTable.issueIds;var b=a.issueTable.issueKeys;if(c&&b){var d={};_.each(c,function(f,e){d[f]={value:b[e],error:false}});this.issueKeys.reset(d)}else{var d=JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(a.issueTable.table);this.issueKeys.reset(d)}},getRowsForIds:function(b,a){if(!b.length){return jQuery.Deferred().resolve({}).promise()}var c=jQuery.ajax({data:_.extend({id:b,layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()},a),type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/1/issueTable/stable"});c.fail(_.bind(function(){this.triggerSearchError()},this));return c.pipe(function(d){return d.issueTable}).done(_.bind(function(d){this.issueKeys.setMultiple(JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(d.table,b));_.defer(JIRA.trace,"jira.search.finished")},this)).promise()},setAsInaccessible:function(a){return this.issueKeys.setError(a)}},{_extractIssueKeysFromTable:function(a,b){var c={};AJS.$(a).find(".issuerow").each(function(f){var d=AJS.$(this);var g=b?b[f]:d.attr("rel");var e=d.data("issuekey")||null;if(g){c[g]=e?{value:e,error:false}:{error:true}}});return c}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableDecorator.js' */
(function(a){AJS.namespace("JIRA.Issues.IssueTableDecorator",window,{decorate:function(d){var c=d.$table;var b=d.issueIDs;var e=d.sortByField;var f=d.sortByOrder;this._decorateTableWithWrap(c);this._decorateTableResultsWithClasses(c);this._decorateTableWithIssueIDs(c,b);this._decorateTableHeaderWithSortOptions(c,e,f);if(this._isIE9()){this._removeEmptyTextNodes(c)}return c},_isIE9:function(){return(a.browser.msie&&parseInt(a.browser.version,10)===9)},_decorateTableWithWrap:function(b){b.find("#issuetable").wrap('<div class="issue-table-container"/>')},_decorateTableResultsWithClasses:function(b){b.children().addClass("navigator-results")},_decorateTableWithIssueIDs:function(c,b){c.find(".issuerow").attr("rel",function(d){return b[d]})},_decorateTableHeaderWithSortOptions:function(d,c,b){d.find(".sortable").each(function(){this.onclick=null});if(c){var g=d.find(".rowHeader .sortable").filter('[data-id="'+c+'"]');if(g.size()&&!g.hasClass("descending")&&!g.hasClass("ascending")){var e=d.find(".rowHeader .sortable");e.filter(".descending").removeClass("descending active").addClass("colHeaderLink");e.filter(".ascending").removeClass("ascending active").addClass("colHeaderLink");var f=b=="DESC"?"descending":"ascending";g.removeClass("colHeaderLink").addClass("active "+f)}}},_removeEmptyTextNodes:function(b){b.find("table, tbody, thead, tr").contents().filter(function(){return this.nodeType===3}).remove()}})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueTableView",JIRA.Issues.BaseView.extend({events:{"blur .hidden-link":"_onHiddenLinkBlur","click .sortable":"_onSort","click tr.issuerow":"_onClickRow"},inaccessibleIssueRowTemplate:JIRA.Templates.IssueNavTable.inaccessibleIssueRow,syncSystemModeMessage:function(){var c=a("#system-mode-warning-msg");var d=this.columnConfig.isSystemMode();if(d&&!c.length){var b=JIRA.Messages.showWarningMsg("You are on System Mode. The column changes might affect all users. \u003ca href=# class=exit>Exit System Mode\u003c\/a>.",{id:"system-mode-warning-msg",closeable:false,timeout:0});b.find(".exit").click(_.bind(function(f){f.preventDefault();this.columnConfig.setCurrentColumnConfig("user")},this))}else{c.remove()}},initialize:function(b){_.bindAll(this,"adjustColumnConfigHeight");this.search=b.search;this.searchPromise=this._createSearchPromise({done:_.bind(this._onSearchDone,this),fail:_.bind(this._onSearchFail,this)});this.columnConfig=b.columnConfig;this.searchResults=b.searchResults;this.addListener(this.searchResults,"issueDeleted",this.handleIssueDeleted,this);this.addListener(this.searchResults,"issueUpdated",this.handleIssueUpdated,this);this.addListener(this.searchResults,"highlightedIssueChange",this.focusHighlightedIssue,this);this.addListener(this.searchResults,"newPayload",this.renderNewSearch,this);this.addListener(this.searchResults,"startIndexChange",this.renderNewSearch,this);this.addListener(this.searchResults,"stableUpdate",this.renderNewSearch,this);this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.$el});this.columnConfig.on("change:columnConfig",this.syncSystemModeMessage,this);this.lastRenderedState={requestId:null,startIndex:null};this.topResultsCountView=new JIRA.Issues.ResultsCountView({model:this.searchResults,search:this.search});this.paginationView=new JIRA.Issues.ResultsCountView({el:this.$(".count-pagination"),model:this.searchResults,search:this.search});this.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));JIRA.Issues.onVerticalResize(this.adjustColumnConfigHeight)},deactivate:function(){this.searchPromise.reset();this.paginationView.deactivate();JIRA.Issues.offVerticalResize(this.adjustColumnConfigHeight);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},getIssueRowById:function(c,b){b=b?jQuery(b):this.$el;return b.find("#issuerow"+c)},handleIssueDeleted:function(b){this.getIssueRowById(b.id).hide();this._showPending();this.render({force:true})},handleIssueInaccessible:function(b){this.getIssueRowById(b).replaceWith(this.inaccessibleIssueRowTemplate({columnCount:this.$el.find("thead > tr > th").length,issueID:b}))},handleIssueUpdated:function(d,b){var c=this.getIssueRowById(d,b.table);this.getIssueRowById(d).replaceWith(c);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[c,JIRA.CONTENT_ADDED_REASON.issueTableRowRefreshed]);this.focusIssue(d);JIRA.trace("jira.search.finished")},show:function(){this.focusHighlightedIssue()},_onSort:function(c){c.preventDefault();if(!this._isPending()){this._killDragtable();var d=this.searchResults.getColumnSortJql();var b=d[a(c.currentTarget).data("id")];if(b){this.search.doSort(b)}}},selectNext:function(){var b=this.getSelectedRow().next();if(b.length===1&&b.hasClass("issuerow")){this.selectInModel(b)}else{this.searchResults.nextPage().done(_.bind(function(){this.selectInModel(this.$(".issuerow:first"));jQuery(window).scrollTop(0)},this))}},selectPrev:function(){var b=this.getSelectedRow().prev();if(b.length===1&&b.hasClass("issuerow")){this.selectInModel(b)}else{this.searchResults.previousPage().done(_.bind(function(){this.selectInModel(this.$(".issuerow:last"))},this))}},getSelectedRow:function(){return this.$(".issuerow").eq(this.searchResults.getSelectedIssueIndex())},selectIssueById:function(c){var b=this.$(".issuerow[rel='"+c+"']");if(b.length){this.selectInModel(b)}else{this.searchResults.clearSelectedIssue()}},focusHighlightedIssue:function(){var b=this.searchResults.getHighlightedIssue();b&&this.focusIssue(b.getId(),true)},focusIssue:function(e,d){var c=this.$(".issuerow.focused"),b;if(e!=null){c.removeClass("focused");b=this.$(".issuerow[rel='"+e+"']");b.addClass("focused");this._postFocusRenderActions(b,d)}},_postFocusRenderActions:function(b,c){if(b.is(":visible")){_.defer(function(){b.scrollIntoView({marginBottom:50});if(!c){b.find(".hidden-link").removeAttr("tabIndex").focus()}})}},render:function(c){c=_.defaults({},c,{force:false});if(this._updateLastRenderedState()||c.force){var b=this.getFilterId();return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql(),filterId:b}))}else{return jQuery.Deferred().resolve().promise()}},renderNewSearch:function(b){if(this._updateLastRenderedState()||b.force){this._killDragtable();this._showPending();this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql(),filterId:this.getFilterId(),columnConfig:b.columnConfig}))}},_postRenderActions:function(){var c=this.$el;var b=this;_.defer(_.bind(function(){jQuery("#issuetable").dragtable({maxMovingRows:1,containment:"body",axis:false,revert:false,clickDelay:250,tolerance:"intersect",dragaccept:":not(.headerrow-actions)",persistState:_.bind(function(d){var e=[];d.el.find("th").each(function(f){var g=jQuery(this).data("id");if(_.isNotBlank(g)){e.push(g)}});this.columnConfig.saveColumns(e)},this)});this._triggerTableUpdatedEvent()},this))},_triggerTableUpdatedEvent:function(){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed])},_handleRowSelection:function(){if(this.searchResults.initialSelectedIssueId){this.selectIssueById(this.searchResults.initialSelectedIssueId);this.searchResults.initialSelectedIssueId=null}},_handleError:function(){this._hidePending()},_handleAndRenderError:function(b){this._handleError();JIRA.Messages.showMessageAtTarget(b,{closeable:true,target:this.$el.empty(),type:JIRA.Templates.Issues.ComponentUtil.errorMessage})},_onClickRow:function(c){var b=a(c.target).closest("tr.issuerow");if(b.length){this.searchResults.highlightIssueById(b.attr("rel"),{preventFocus:true})}},_onHiddenLinkBlur:function(b){a(b.target).attr("tabIndex",-1)},_createSearchPromise:function(b){var c=jQuery.RecurringPromise();b=b||{};b.done&&c.done(_.bind(b.done,this));b.fail&&c.fail(_.bind(b.fail,this));return c},_onSearchDone:function(c){var c=a(c),b=a("<div/>").addClass("list-view").append(JIRA.Templates.IssueNavTable.TopResultsCountBar()).append(c);this.topResultsCountView.setElement(b.find(".issue-table-info-bar"));if(!this.searchResults.hasIssues()){this.emptyResultsView.render()}else{this.topResultsCountView.render();if(c.length>0){var d=this.searchResults.getSortBy()||{};this.$el.empty().append(JIRA.Issues.IssueTableDecorator.decorate({$table:b,issueIDs:this.searchResults.getPageIssueIds(),sortByField:d.fieldId,sortByOrder:d.order}))}this.paginationView.setElement(this.$(".count-pagination"));this.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));this.paginationView.render();this.columnConfig.setElement(this.$(".column-picker-trigger-container")).render();if(!this.searchResults.hasHighlightedIssue()){this.searchResults.highlightFirstInPage()}this.focusHighlightedIssue()}this._hidePending();this._postRenderActions();JIRA.trace("jira.search.stable.update")},adjustColumnConfigHeight:function(){this.columnConfig.adjustHeight()},_onSearchFail:function(){this.$el.removeClass("pending");this.emptyResultsView.render()},_updateLastRenderedState:function(){var c,b=this.lastRenderedState;c=this.lastRenderedState={resultsId:this.searchResults.getResultsId(),startIndex:this.searchResults.getStartIndex()};return !_.isEqual(b,c)},_isPending:function(){return this.$el.hasClass("pending")},_hidePending:function(){this.$el.removeClass("pending empty-results")},_showPending:function(){this.$el.addClass("pending")},_killDragtable:function(){jQuery("#issuetable").dragtable("destroy")},isSystemFilter:function(){return this.search.getFilterId()<0},getFilterId:function(){var b=this.search.getFilterId();return(this.isSystemFilter()||_.isNull(b))?undefined:b}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/HeaderOperationsView.js' */
JIRA.Issues.IssueTableHeaderOperationsView=JIRA.Issues.BaseView.extend({initialize:function(a){_.bindAll(this,"_onSearchSuccess","_updateFilterPageResources");_.extend(this,a);this.initTools();this.initViews();this.initShare();this._results=this.search.getResults();this._results.onNewPayload(this._onSearchSuccess)},initViews:function(){var a=this.searchPageModule;a.on("change",this._updateFilterPageResources);this._updateFilterPageResources();new JIRA.Issues.Tipsy({el:this.$el.find(".header-views"),showCondition:":not(.active)"});var b=this._spinnerTimeoutKeeper(".header-views");AJS.Dropdown.create({styleClass:"header-views-menu aui-style-default",trigger:AJS.$(".header-views",this.$el),ajaxOptions:function(){var d={jql:a.getEffectiveJql()},c=a.getFilter();if(c&&!c.getIsSystem()){d.filterId=c.getId();if(a.isDirty()){d.jql=a.getJql();d.modified=true}}b.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/views",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:d,dataType:"json",cache:false,formatSuccess:function(e){b.end();return AJS.$(JIRA.Templates.IssueNavTable.views({sections:e,contextPath:contextPath}))}}}})},initTools:function(){var a=this,b=this.searchPageModule;AJS.$("body").delegate("#use-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("user");a.searchPageModule.columnConfig.refreshSearchWithColumns()});AJS.$("body").delegate("#use-filter-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("filter");a.searchPageModule.columnConfig.refreshSearchWithColumns()});new JIRA.Issues.Tipsy({el:this.$el.find(".header-tools"),showCondition:":not(.active)",tipsy:{gravity:"ne"}});var c=this._spinnerTimeoutKeeper(".header-tools");AJS.Dropdown.create({styleClass:"header-tools-menu",trigger:AJS.$(".header-tools",a.$el),ajaxOptions:function(){var e,d=b.getFilter();e={jql:b.getEffectiveJql(),searchResultsTotal:a._results.getTotal(),searchResultsPages:a._results.getNumberOfPages(),useColumns:a.searchPageModule.columnConfig.getCurrentColumnConfig().getName()!="user",skipColumns:b.getActiveLayout().id==="split-view"};if(d&&!d.getIsSystem()){e.filterId=d.getId();if(b.isDirty()){e.jql=b.getJql()}}c.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/tools",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:e,dataType:"json",cache:false,formatSuccess:function(f){c.end();if(f&&f.length==0){return AJS.$('<div class="menu-empty-content"></span>'+"No Available Option(s)"+"<div>")}else{return AJS.$(JIRA.Templates.IssueNavTable.tools({groups:f,contextPath:contextPath}))}}}}})},initShare:function(){new JIRA.Issues.Tipsy({el:this.$el.find(".issuenav-share"),showCondition:":not(.active)"})},_onSearchSuccess:function(){AJS.$(".header-tools").toggle(this.search.getResults().getDisplayableTotal()>0)},_updateFilterPageResources:function(){var d=this.$el.find(".operations-view-data > fieldset"),b=this.searchPageModule;d.empty();if(b.getFilter()&&!b.isDirty()){AJS.$('<input type="hidden" id="filterId" />').val(b.getFilter().getId()).appendTo(d);AJS.$('<input type="hidden" id="jql" />').val("").appendTo(d)}else{AJS.$('<input type="hidden" id="filterId" />').val("");AJS.$('<input type="hidden" id="jql" />').val(b.getJql()).appendTo(d)}var c=b.getFilter(),a=c&&c.getId();if(a&&!c.getIsSystem()&&!b.isDirty()){AJS.Meta.set("filter-id",a);AJS.Meta.set("filter-jql",undefined)}else{AJS.Meta.set("filter-id",undefined);AJS.Meta.set("filter-jql",b.getEffectiveJql())}},_spinnerTimeoutKeeper:function(a){var b=undefined;return{start:function(){if(b){b=clearTimeout(b)}b=setTimeout(function(){b=undefined;AJS.$(a).addClass("spinner")},1000)},end:function(){b=clearTimeout(b);AJS.$(a).removeClass("spinner")}}}});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/datePicker.soy' */
// This file was automatically generated from datePicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DateSearcher == 'undefined') { JIRA.Templates.DateSearcher = {}; }


JIRA.Templates.DateSearcher.dateMeasurement = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select class="js-measurement"><option value="m">', soy.$$escapeHtml("minutes"), '</option><option value="h">', soy.$$escapeHtml("hours"), '</option><option value="d">', soy.$$escapeHtml("days"), '</option><option value="w">', soy.$$escapeHtml("weeks"), '</option></select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderWithinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Within the last {0} {1}",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.withinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" class="js-dp-type-toggle" id="withinTheLastRadio"/>');
  var param19 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param19);
  JIRA.Templates.DateSearcher.renderWithinTheLast({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param19.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.nowOverdue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label><input type="radio" class="js-dp-type-toggle" />', soy.$$escapeHtml("Now overdue"), '</label>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} ago",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.moreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param33 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param33);
  JIRA.Templates.DateSearcher.renderMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param33.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} overdue",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param43 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param43);
  JIRA.Templates.DateSearcher.renderDueMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param43.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Due in next {0} {1} {2} overdue",opt_data.inputField,opt_data.dateMeasurementField,opt_data.clauseField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dueInNextRadio"/>');
  var param53 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param53);
  JIRA.Templates.DateSearcher.renderDueInNext({inputField: '<input class="js-val" maxlength="15" type="text" />', dateMeasurementField: param53.toString(), clauseField: '<select class="js-clause"><option value="orIs">' + soy.$$escapeHtml("or is") + '</option><option value="andNot">' + soy.$$escapeHtml("and not") + '</option></select>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Between {0} and {1}",opt_data.startField,opt_data.endField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dateBetweenRadio"/>');
  JIRA.Templates.DateSearcher.renderDateBetween({startField: '<input class="js-start-date" maxlength="15" placeholder="11-Jan-2012" type="text" /><span class="js-start-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>', endField: '<input class="js-end-date" maxlength="12" placeholder="30-Jan-2012" type="text" /><span class="js-end-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderInRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("In range {0} to {1}",opt_data.startInput,opt_data.endInput));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.inRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" maxlength="15" class="js-dp-type-toggle" id="inRangeRadio"/>');
  JIRA.Templates.DateSearcher.renderInRange({startInput: '<input class="js-start-range" placeholder="-3w 4d 12h" type="text" />', endInput: '<input class="js-end-range" maxlength="15" placeholder="3w 4d 12h" type="text" />'}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/DateSearcher.js' */
(function($){var _excludeList=["js-dp-type-toggle","js-val","js-measurement","js-clause","js-start-date","js-end-date","js-start-range","js-end-range"];var _labelfyContent=function(content,radioKey){var $content=jQuery("<div></div>").html(content).contents();var transformed=[];$content.each(function(index,element){var $element=jQuery(element);var value=jQuery("<div/>").html(element).html();if(!_.contains(_excludeList,$element.attr("class"))){value=value.replace(/^\s+|\s+$/g,"&nbsp;");transformed.push("<label for='"+radioKey+"'>"+value+"</label>")}else{transformed.push(value)}});return transformed.join("")};var _generateSearcherAndBindHandler=function(data){var radioKey=data.radioKey+"Radio";var outputContent=data.$el.html(_labelfyContent(data.rawTemplate,radioKey));outputContent.find(":not(.js-dp-type-toggle):not(select):input").mousedown(function(){var $label=outputContent.find("label");if($label.length>0){$label[0].click()}});return outputContent};var NowOverdue=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"nowOverdue"},template:JIRA.Templates.DateSearcher.nowOverdue,getValues:function(){return{to:0}},updateFromValues:function(values){if(!values.from&&values.to==="0"){return true}},render:function(){return this.$el.html(this.template())}});var WithinTheLast=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"withinTheLast"},template:JIRA.Templates.DateSearcher.withinTheLast,getValues:function(){var val=this.$(".js-val").val();if(val){return{from:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.to&&values.from&&values.from.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.from);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var MoreThan=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"moreThan"},template:JIRA.Templates.DateSearcher.moreThan,getValues:function(){var val=this.$(".js-val").val();if(val){return{to:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.from&&values.to&&values.to.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.to);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DueMoreThan=MoreThan.extend({className:"field-group",template:JIRA.Templates.DateSearcher.dueMoreThan});var DueInNext=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dueInNext"},template:JIRA.Templates.DateSearcher.dueInNext,getValues:function(){var val=this.$el.find(".js-val").val();if(val){return{from:this.$el.find(".js-clause").val()==="andNot"?"0":null,to:val+this.$(".js-measurement").val()}}},updateFromValues:function(values){if((!values.from||values.from==="0")&&values.to){var vals=this.model.parseRelativeStr(values.to);var clause=values.from==="0"?"andNot":"orIs";this.$(".js-val").val(vals.val);this.$(".js-clause").val(clause);if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DatesBetween=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dateBetween"},template:JIRA.Templates.DateSearcher.dateBetween,getValues:function(){return{startDate:this.$el.find(".js-start-date").val(),endDate:this.$el.find(".js-end-date").val()}},updateFromValues:function(values){if(values.startDate||values.endDate){this.$el.find(".js-start-date").val(values.startDate);this.$el.find(".js-end-date").val(values.endDate);return true}},bindCalendar:function(inputClass,triggerClass){var trigger=this.$el.find("."+triggerClass)[0];var input=this.$el.find("."+inputClass)[0];var calendarParams=_.extend({},this.model.calendarConfig,{inputField:input,button:trigger});Calendar.setup(calendarParams)},render:function(){_generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]});this.bindCalendar("js-end-date","js-end-date-trigger");this.bindCalendar("js-start-date","js-start-date-trigger");return this.$el}});var InRange=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"inRange"},template:JIRA.Templates.DateSearcher.inRange,getValues:function(){return{from:this.$el.find(".js-start-range").val(),to:this.$el.find(".js-end-range").val()}},updateFromValues:function(values){if(values.from||values.to){this.$el.find(".js-start-range").val(values.from);this.$el.find(".js-end-range").val(values.to);return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DateSeacherModel=Backbone.Model.extend({initialize:function(options){this.from$El=options.$el.find(".js-date-picker-from").hide();this.to$El=options.$el.find(".js-date-picker-to").hide();this.startDate$El=options.$el.find(".js-date-picker-start-date").hide();this.endDate$El=options.$el.find(".js-date-picker-end-date").hide();this.errors=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.js-date-picker-errors"));this.calendarConfig=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.datepicker-params"))},parseRelativeStr:function(str){var measurement=str.slice(str.length-1);var val=str.slice(0,str.length-1);return{val:val,measurement:measurement}},update:function(updateParams){this.clear();if(updateParams){if(typeof updateParams.from!=="undefined"){this.from$El.val(updateParams.from)}if(typeof updateParams.to!=="undefined"){this.to$El.val(updateParams.to)}if(typeof updateParams.startDate!=="undefined"){this.startDate$El.val(updateParams.startDate)}if(typeof updateParams.endDate!=="undefined"){this.endDate$El.val(updateParams.endDate)}}},toJSON:function(){return{from:this.from$El.val(),to:this.to$El.val(),startDate:this.startDate$El.val(),endDate:this.endDate$El.val(),errors:this.errors}},clear:function(){this.from$El.val("");this.to$El.val("");this.startDate$El.val("");this.endDate$El.val("")}});JIRA.DateSearcher=Backbone.View.extend({initialize:function(options){var instance=this;this.verb=options.verb;this.model=new DateSeacherModel({$el:this.$el});this.setElement($("<div />").addClass("js-picker-ui").appendTo(this.$el));this.views=[];var useInputEvent=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)<10;_.each(options.dateTypes,function(dateType){var view=new dateType({model:instance.model});instance.views.push(view);if(useInputEvent){view.$el.delegate(":text","input",function(){instance.update(view)})}else{view.$el.delegate(":text","keydown",function(){var $this=jQuery(this);var currentVal=$this.val();$this.one("keyup",function(){if($this.val()!==currentVal){instance.update(view)}})});view.$el.delegate(":text","change",function(){instance.update(view)})}view.$el.delegate(":radio,select,input","change",function(){instance.update(view)}).delegate(".icon-date","click",function(){instance.update(view)})})},update:function(selectedView,error){this.model.update(selectedView.getValues());_.each(this.views,function(view){if(view===selectedView){view.$(":radio").prop("checked",true)}else{view.$(":radio").prop("checked",false)}})},render:function(){var instance=this;var values=this.model.toJSON();_.each(this.views,function(view){instance.$el.append(view.render(instance.verb))});$.each(this.views,function(i,view){if(this.updateFromValues(values)){instance.update(this);if(values.errors){$.each(values.errors,function(i,error){$("<div />").addClass("error").text(error).appendTo(view.$el);return false})}return false}});window.setTimeout(function(){instance.$el.find(":radio:checked").focus()},30)}});JIRA.DateSearcher.createDueDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[NowOverdue,DueMoreThan,DueInNext,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createResolvedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCreatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createUpdatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCustomDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()}})(AJS.$);
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initDateSearchers.js' */
jQuery(function(){function initDueDateSearcher($ctx){$ctx.find(".js-duedate-searcher").each(function(){JIRA.DateSearcher.createDueDateSearcher(this)})}function initResolvedDateSearcher($ctx){$ctx.find(".js-resolutiondate-searcher").each(function(){JIRA.DateSearcher.createResolvedDateSearcher(this)})}function initCreatedDateSearcher($ctx){$ctx.find(".js-created-searcher").each(function(){JIRA.DateSearcher.createCreatedDateSearcher(this)})}function initUpdatedDateSearcher($ctx){$ctx.find(".js-updated-searcher").each(function(){JIRA.DateSearcher.createUpdatedDateSearcher(this)})}function initCustomFieldDateSearcher($ctx){$ctx.find(".js-customdate-searcher").each(function(){JIRA.DateSearcher.createCustomDateSearcher(this)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initDueDateSearcher(context);initResolvedDateSearcher(context);initCreatedDateSearcher(context);initUpdatedDateSearcher(context);initCustomFieldDateSearcher(context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initSparklers.js' */
jQuery(function(){function initSparklers($ctx){$ctx.find(".js-default-checkboxmultiselect").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselect")){$select.data("checkboxmultiselect",new AJS.CheckboxMultiSelect({element:this}))}else{$select.data("checkboxmultiselect").render()}})}function initStatusLozengeSparklers($ctx){$ctx.find(".js-default-checkboxmultiselectstatuslozenge").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselectstatuslozenge")){$select.data("checkboxmultiselectstatuslozenge",new AJS.CheckboxMultiSelectStatusLozenge({element:this}))}else{$select.data("checkboxmultiselectstatuslozenge").render()}})}function initLabelSparkler($ctx){$ctx.find(".js-label-checkboxmultiselect").each(function(){var cms=new AJS.CheckboxMultiSelect({element:this,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels/suggest",query:true,minQueryLength:0,formatResponse:function(response){var selectedValues=cms.model.getSelectedValues();return[new AJS.GroupDescriptor({items:_.map(_.sortBy(_.reject(response.suggestions,function(suggestion){return _.contains(selectedValues,suggestion.label)}),"label"),function(suggestion){return new AJS.ItemDescriptor({highlighted:true,html:suggestion.html,label:suggestion.label,value:suggestion.label,title:suggestion.label})})})]}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initSparklers($context);initStatusLozengeSparklers($context);initLabelSparkler($context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initUserSparkler.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){function _formatUserGroupResponse(response){var users=_formatUserResponse(response.users,true);var groups=_formatGroupResponse(response.groups,true);var items=[].concat(users).concat(groups);return[new AJS.GroupDescriptor({items:items})]}function _formatUserResponse(response,prefix){return _.map(response.users,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:item.avatarUrl,label:item.displayName,value:(prefix?"user:":"")+item.name})})}function _formatGroupResponse(response,prefix){return _.map(response.groups,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:AJS.contextPath()+"/images/icons/icon_groups_16.png",label:item.name,value:(prefix?"group:":"")+item.name})})}jQuery(".js-usergroup-checkboxmultiselect",$ctx).each(function(){var ajaxData={};AJS.$("fieldset.user-group-searcher-params",$ctx).each(function(){ajaxData=JIRA.parseOptionsFromFieldset(AJS.$(this))});ajaxData.showAvatar=true;new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:10,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groupuserpicker",data:ajaxData,query:true,formatResponse:_formatUserGroupResponse}})});jQuery(".js-user-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/user/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatUserResponse(items,false)}}})});jQuery(".js-group-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groups/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatGroupResponse(items,false)}}})})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/utils.js' */
_.mixin({lambda:function(a){return function(){return a}},isNotBlank:function(a){return !!a}});if(!JIRA.Issues){JIRA.Issues={}}JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.ComponentUtil == 'undefined') { JIRA.Templates.Issues.ComponentUtil = {}; }


JIRA.Templates.Issues.ComponentUtil.throbber = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="icon throbber" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueNotFound = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("issues.components.query.search.selected.issue.nonexistent.html",opt_data.issueAnchor));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.buildMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList52 = opt_data.messages;
    var messageListLen52 = messageList52.length;
    for (var messageIndex52 = 0; messageIndex52 < messageListLen52; messageIndex52++) {
      var messageData52 = messageList52[messageIndex52];
      output.append('<li>', soy.$$escapeHtml(messageData52), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.auiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length > 0) {
    output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.typeClass), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.typeClass), '"></span>');
    JIRA.Templates.Issues.ComponentUtil.buildMessage(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'error', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.warningMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml("/jira"), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SingleSelectMixin.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={namedAttributes:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-basic.soy' */
// This file was automatically generated from query-basic.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryBasic == 'undefined') { JIRA.Templates.IssueNavQueryBasic = {}; }


JIRA.Templates.IssueNavQueryBasic.basicQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container">', (opt_data.hasOrderBy) ? '<div class="list-ordering-container"><div class="list-ordering"></div></div>' : '', '<div class="search-criteria-container"><div class="search-criteria"><ul class="criteria-list"><li class="text-query hidden"><div class="text-query-container"><input class="search-entry text ajs-dirty-warning-exempt" id="searcher-query" type="text" name="text" placeholder="', soy.$$escapeHtmlAttribute("Contains text"), '" /></div></li><li class="criteria-actions"></li>', (opt_data.hasSearchButton) ? '<li><button class="aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtmlAttribute("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button></li>' : '', '</ul></div><div class="search-criteria-extended"><ul class="criteria-list"></ul></div></div></div><div class="search-options-container"><div class="mode-switcher"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" class="criteria-selector aui-button aui-button-subtle drop-arrow" /><a href="#" class="remove-filter" title="', soy.$$escapeHtmlAttribute("Remove criterion"), '" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-remove"></span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="criteria-wrap">', (opt_data.extended || ! opt_data.viewHtml) ? '<span class="fieldLabel">' + soy.$$escapeHtml(opt_data.name) + ':</span> ' : '', (opt_data.viewHtml) ? opt_data.viewHtml : soy.$$escapeHtml("All"), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="issue-filter" action="#" class="searchfilter aui top-label aui-popup-content"><div class="form-body"></div>', (opt_data.displayBackButton) ? '<a href="#" class="back">' + soy.$$escapeHtml("Back") + '</a>' : '', (opt_data.displayUpdateCancel) ? '<div class="buttons-container form-footer"><div class="buttons"><input type="submit" name="filter" class="aui-button filter" value="' + soy.$$escapeHtmlAttribute("Update") + '" /><a href="#" class="aui-button aui-button-link cancel-update">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '', '</form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-no-edit-content">');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'info', messages: [AJS.format("To search by {0} please switch to advanced.",opt_data.fieldName)]}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.clauseButtonView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" class="add-criteria aui-button ', (opt_data.isSubtle) ? 'aui-button-subtle' : '', ' drop-arrow" title="', soy.$$escapeHtmlAttribute("Add more fields to search with"), '">', soy.$$escapeHtml("More"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-groups available"><ul>');
  var groupList71 = opt_data.searcherGroups;
  var groupListLen71 = groupList71.length;
  for (var groupIndex71 = 0; groupIndex71 < groupListLen71; groupIndex71++) {
    var groupData71 = groupList71[groupIndex71];
    output.append('<li class="twixi-block ', (groupIndex71 == 0) ? 'expanded' : 'collapsed', '" data-id="', soy.$$escapeHtmlAttribute(groupData71.id), '"><div class="twixi-trigger">', soy.$$escapeHtml(groupData71.name), '</div><ul class="twixi-content">');
    var searcherList83 = groupData71.searchers;
    var searcherListLen83 = searcherList83.length;
    for (var searcherIndex83 = 0; searcherIndex83 < searcherListLen83; searcherIndex83++) {
      var searcherData83 = searcherList83[searcherIndex83];
      output.append('<li><a href="#" data-id="', soy.$$escapeHtmlAttribute(searcherData83.id), '" class="searcher-option" >', soy.$$escapeHtml(searcherData83.name), '</a></li>');
    }
    output.append('</ul></li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><a href="#" class="aui-button aui-button-link">', soy.$$escapeHtml("Close"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextQueryBuilder.js' */
AJS.namespace("JIRA.Issues.TextQueryBuilder");JIRA.Issues.TextQueryBuilder={BACKSLASH_PATTERN:/\\/g,MULTIPLE_WHITESPACE_PATTERN:/\s+/g,QUOTE_PATTERN:/\"/g,DOUBLE_BACKSLASH:"\\\\",buildJql:function(a){if(!a){return""}a=""+a;a=AJS.$.trim(a);a=a.replace(this.BACKSLASH_PATTERN,this.DOUBLE_BACKSLASH);a=a.replace(this.MULTIPLE_WHITESPACE_PATTERN," ");a=a.replace(this.QUOTE_PATTERN,'\\"');return this.createQueryClause(a)},createQueryClause:function(a){return'text ~ "'+a+'"'}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryModule.js' */
JIRA.Issues.BasicQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlTooComplex","searchRequested","basicModeCriteriaCountWhenSearching","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.searcherCollection=new JIRA.Issues.SearcherCollection([],{fixedLozenges:a.primaryClauses,queryStateModel:a.queryStateModel,initData:a.initialSearcherCollectionState});this.view=new JIRA.Issues.BasicQueryView({queryStateModel:a.queryStateModel,searcherCollection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this);this.searcherCollection.onSearchRequested(_.bind(function(b){this.triggerBasicModeCriteriaCountWhenSearching({count:this.searcherCollection.getAllSelectedCriteriaCount()});var c=this._attachOrderByClause(b);this.triggerSearchRequested(c)},this));this.searcherCollection.onJqlTooComplex(_.bind(function(b){this.triggerJqlTooComplex(b)},this))},hasErrors:function(){var a=this.searcherCollection.any(function(b){return b.hasErrorInEditHtml()});return a},clear:function(){this.searcherCollection.clear()},queryChanged:function(){this.searcherCollection.restoreFromQuery(this._queryStateModel.getJql())},queryReset:function(a){this.searcherCollection.setInteractive(false);return this.searcherCollection.restoreFromQuery(a,true).always(_.bind(function(){this.searcherCollection.setInteractive(true)},this))},searchersReady:function(){return this.searcherCollection.searchersReady()},createView:function(){return this.view},getSelectedCriteria:function(){return this.searcherCollection.getAllSelectedCriteria()},_attachOrderByClause:function(a){var b=/\bORDER\s+BY\b.*$/i;var c=b.exec(this._queryStateModel.getJql());if(c&&b.exec(a)===null){a=a?a+" "+c[0]:c[0]}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaView.js' */
JIRA.Issues.CriteriaView=JIRA.Issues.Brace.View.extend({tagName:"li",template:JIRA.Templates.IssueNavQueryBasic.criteriaButton,contentTemplate:JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent,events:{click:"hideTipsy","click .criteria-selector":"_onClickCriteriaSelector","click .remove-filter":"_onClickRemoveCriteria","mousedown .remove-filter":"_preventFocusWhileDisabled",keydown:"_onKeydown"},initialize:function(a){this.extended=a.extended;this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this.update,this);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.bind("change:isSelected",this._onCriteriaSelectionChanged,this);JIRA.Issues.SearcherDialog.instance.onHide(_.bind(this._addTooltip,this));JIRA.Issues.SearcherDialog.instance.onShow(_.bind(this._onCriteriaDialogShow,this))},render:function(){this.$el.html(this.template({id:this.model.getId()}));this.$el.attr("data-id",this.model.getId());if(this.extended){this.$el.addClass("extended-searcher")}this.update();this.prepareForDisplay()},prepareForDisplay:function(){this._addTooltip();this.delegateEvents()},hideTipsy:function(){if(this.tipsy){this.tipsy.hide()}},update:function(){var g=this.searcherCollection.length===0;var f=this._getSearcher();var b=this._isValidSearcher();var e=!g&&!f;var a=g||!b;var d=this.$("button");var c=this.$(".remove-filter");this.$el.toggleClass("hidden",e);d.attr("aria-disabled",a?"true":null).html(this.contentTemplate({name:f&&f.getName()||this.model.getName(),viewHtml:f&&f.getViewHtml(),extended:this.extended}));this.$el.toggleClass("invalid-searcher",!b).toggleClass("partial-invalid-searcher",(b&&d.find(".invalid_sel").length!==0));c.toggle(!b||!!this.extended);return this},destroy:function(){this.hideTipsy();this.$el.remove()},_getSearcher:function(){return this.searcherCollection.get(this.model.getId())},_isValidSearcher:function(){var a=this._getSearcher();return !a||!(a.getValidSearcher()===false)},_containsInvalidValue:function(a){return(AJS.$(a.getViewHtml()).find(".invalid_sel").length>0)},_showDialog:function(){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.show(this._getSearcher())}},_removeCriteria:function(b){var a=this.extended||!this._isValidSearcher();if(this.searcherCollection.isInteractive()&&a){this.searcherCollection.triggerBeforeCriteriaRemoved(this.model.getId(),b);_.defer(_.bind(function(){this.searcherCollection.clearClause(this.model.getId())},this))}},_getTooltipText:function(){var b=this.searcherCollection.get(this.model.getId());var a;if(!this._isValidSearcher()){a="This criteria is not valid for the project and\/or issue type"}else{if(this._containsInvalidValue(b)){a="This criteria contains invalid value(s)"}else{a=b.getTooltipText()}}return b&&a||""},_addTooltip:function(){this.tipsy=new JIRA.Issues.Tipsy({el:this.$el,showCondition:this.searcherCollection.isInteractive,tipsy:{title:_.bind(this._getTooltipText,this)}})},_handleInteractiveChanged:function(a){this.$("button, .remove-filter").attr("aria-disabled",(a)?null:"true")},_onClickCriteriaSelector:function(a){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.toggle(this._getSearcher())}a.preventDefault()},_onClickRemoveCriteria:function(a){this._removeCriteria();a.preventDefault()},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog();break;case AJS.$.ui.keyCode.ESCAPE:this.$("button:focus").blur();break;case AJS.$.ui.keyCode.BACKSPACE:this._removeCriteria(-1);break;case AJS.$.ui.keyCode.DELETE:this._removeCriteria(1);break;default:return}a.preventDefault()},_onCriteriaDialogShow:function(){var a=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher();if(a==this._getSearcher()){this.tipsy&&this.tipsy.remove()}},_preventFocusWhileDisabled:function(a){if(jQuery(a.target).closest("[aria-disabled=true]").length>0){a.preventDefault()}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherModel.js' */
JIRA.Issues.SearcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","isShown","viewHtml","editHtml","groupId","groupName","initParams","isSelected","jql","position","serializedParams","validSearcher","key","lastViewed"],namedEvents:["readyForDisplay"],initialize:function(){this._onEditHtmlUpdated();this.bind("change:editHtml",this._onEditHtmlUpdated,this)},parse:function(a){if(a.viewHtml){a.viewHtml=this._cleanViewHtml(a.viewHtml)}return a},_cleanViewHtml:function(b){var a=AJS.$("<div/>").appendCatchExceptions(b);a.find(".fieldLabel").remove();a.find("a").replaceWith(function(){return AJS.$(this).html()});a.find(".searcherValue").slice(0,-1).each(function(){AJS.$(this).after("-")});a.find("*").removeAttr("title");return a.html()},createOrUpdateClauseWithQueryString:function(a){return this.collection.createOrUpdateClauseWithQueryString(this.id,a)},getQueryString:function(){var a={};if(this.collection.QUERY_ID===this.getId()){if(this.getViewHtml()){a[this.collection.QUERY_PARAM]=this.getDisplayText();return AJS.$.param(a)}return null}if((!this.getValidSearcher()||/^\s*$/.test(this.getEditHtml()))&&this.getJql()){a={};a[this.collection.JQL_INVALID_QUERY_PREFIX+this.getId()]=this.getJql();return AJS.$.param(a)}return this.getSerializedParams()},getDisplayText:function(){var a=this.getViewHtml();var c="";if(a){var b=AJS.$("<div>").appendCatchExceptions(a);c=AJS.$.trim(b.text()).replace(/[\n\r\s]+/g," ")}return c},hasClause:function(){if(this.collection.QUERY_ID===this.getId()){return !!this.getViewHtml()}else{if(!this.getValidSearcher()){return !!this.getJql()}else{return !!this.getQueryString()}}},clearSearchState:function(){this.set({viewHtml:null,editHtml:null,jql:null,validSearcher:null,isSelected:false})},_now:Date.now||function(){return new Date().getTime()},select:function(){this.set({isSelected:true,position:this.collection.getNextPosition(),validSearcher:true,lastViewed:this._now()})},retrieveEditHtml:function(){var a=this.collection.createJql();if(this.getEditHtml()){return jQuery.Deferred().resolve(this.getEditHtml())}return JIRA.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/QueryComponentRendererEdit!Default.jspa",success:_.bind(this.setEditHtml,this),dataType:"html",error:JIRA.Issues.displayFailSearchMessage,data:{fieldId:this.getId(),decorator:"none",jqlContext:a}})},hasErrorInEditHtml:function(){var a=jQuery("<div>").htmlCatchExceptions(this.getEditHtml());if(!a){return false}else{return a.find(".error, .has-errors").length>0}},clearEditHtml:function(){this.setEditHtml(null)},_onEditHtmlUpdated:function(){this.setSerializedParams(jQuery("<form/>").appendCatchExceptions(this.getEditHtml()).serialize())},getTooltipText:function(){if(this.getValidSearcher!==false){var a=this.getDisplayText()||"All";return this.getName()+": "+a}else{return "This criteria is not valid for the project and\/or issue type"}},searchersReady:function(){return this.collection.searchersReady()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherCollection.js' */
JIRA.Issues.SearcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SearcherModel,namedEvents:["searchRequested","collectionChanged","jqlTooComplex","textFieldChanged","requestUpdateFromView","interactiveChanged","beforeCriteriaRemoved"],QUERY_PARAM:"text",QUERY_ID:"text",JQL_INVALID_QUERY_PREFIX:"__jql_",initialize:function(b,a){if(b&&b.length){this._searcherCache=b}this.fixedLozenges=a&&a.fixedLozenges?a.fixedLozenges:[];this.queryStateModel=a&&a.queryStateModel;this.initData=a&&a.initData;this._interactive=true},_createItemDescriptors:function(a){return _.map(a,function(b){return new AJS.ItemDescriptor({meta:{isShown:b.isShown},label:b.name,title:b.isShown?b.name:b.name+" "+"is not applicable for the current project and\/or issue type.",selected:b.isSelected||b.jql,value:b.id})})},getAddMenuGroupDescriptors:function(){this._updateSearcherCache();var d=this.fixedLozengeIds().concat(this.QUERY_ID);var a=_.filter(this._searcherCache,function(e){var g=_.contains(d,e.id);var f=!!e.groupName;return !g&&f});if(a.length){var b=new AJS.GroupDescriptor({label:"All Criteria",items:this._createItemDescriptors(_.sortBy(a,function(e){return e.name.toLowerCase()}))});var c=new AJS.GroupDescriptor({label:"Recent Criteria",items:this._createItemDescriptors(_.first(_.sortBy(_.filter(a,function(e){return e.lastViewed}),function(e){return -e.lastViewed}),AJS.Meta.getNumber("max-recent-searchers")))});return[c,b]}else{return[]}},getSearcher:function(b){var a=this.get(b);if(!a){this.add(this._searcherCache[b]);a=this.get(b)}return a},setJql:function(b,a){this._addOrSet(b,{jql:a})},createJql:function(){var a=this.pluck("jql");return _.filter(a,_.isNotBlank).join(" AND ")||""},isDirty:function(){return this.any(function(a){return a.getJql()!==undefined&&a.getJql()!==""})},clearSearchState:function(){this.each(function(a){a.clearSearchState()});this._querySearchersAndValues("")},clearClause:function(c){var b=this.get(c);var a=b&&b.hasClause();if(b){b.clearSearchState()}this.triggerCollectionChanged();this.triggerRequestUpdateFromView();if(a){this.triggerSearchRequested(this.createJql())}},getTextQuery:function(){var a=this.get(this.QUERY_ID);return a?a.getViewHtml():""},setInteractive:function(a){if(a!==this._interactive){this._interactive=a;this.triggerInteractiveChanged(a)}},isInteractive:function(){return this._interactive},handleBasicViewSubmit:function(){this.triggerRequestUpdateFromView();this.triggerSearchRequested(this.createJql())},updateTextQuery:function(a){if(a){var b=AJS.escapeHtml(a);this._addOrSet(this.QUERY_ID,{viewHtml:b,editHtml:b,jql:JIRA.Issues.TextQueryBuilder.buildJql(a)})}else{this.remove(this.QUERY_ID)}this.triggerTextFieldChanged()},getQueryString:function(){var a=[];this.each(function(c){var b=c.getQueryString();if(b){a.push(b)}});return a.join("&")},_addOrSet:function(e,d,b){var a=this.get(e);if(a){if(b&&b.parse&&a.parse){d=a.parse(d);delete b.parse}if(d.jql){d.isSelected=true}a.set(d,b)}else{var c=_.clone(d);c.id=e;c.isSelected=!!d.jql;this.add(c,b);a=this.get(e)}return a},restoreFromQuery:function(a,d){this.queryStateModel.setJql(a);var c={jql:this.queryStateModel.getJql()||"",decorator:"none"};if(this.initData){if(!this.initData.errorMessages){this._onQuerySearchersAndValues(this.initData);this.initData=null;return jQuery.Deferred().resolve()}else{this._handleSearcherError(c.jql,this.initData);this.initData=null;return jQuery.Deferred().reject()}}else{var b=AJS.$.ajax({url:AJS.contextPath()+"/secure/QueryComponent!Jql.jspa",headers:{"X-SITEMESH-OFF":true},data:c,type:"POST"});b.success(_.bind(function(e){if(d){this.clearExpectingUpdate(d)}this._onQuerySearchersAndValues(e)},this));b.error(_.bind(function(h){if(d){this.clearExpectingUpdate()}try{var f=JSON.parse(h.responseText);if(f){this._handleSearcherError(c.jql,f)}}catch(g){console.log("search response error - not JSON?")}},this));b.always(function(){JIRA.trace("jira.search.searchers.updated")});return b}},clearExpectingUpdate:function(){this.reset();this.updateTextQuery("")},_handleSearcherError:function(a,b){if(_.include(b.errorMessages,"jqlTooComplex")||_.include(b.errorMessages,"jqlInvalid")){window.setTimeout(_.bind(function(){this.triggerJqlTooComplex(a)},this),0)}},searcherAffectsContext:function(a){return"project"===a||"issuetype"===a},createOrUpdateClauseWithQueryString:function(c,b){this.triggerRequestUpdateFromView();var a;if(this.searcherAffectsContext(c)){a=this._querySearchersAndValues(this.getQueryString())}else{a=this._querySearchersByValue(c)}a.done(_.bind(function(){if((this.queryStateModel.getBasicAutoUpdate()||b)&&!this.containsInvalidSearchers()){this.triggerSearchRequested(this.createJql())}},this));return a},containsInvalidSearchers:function(){return this.any(function(a){return a.hasErrorInEditHtml()})},_querySearchersByValue:function(d){var a=this.get(d);var c=AJS.$.param({decorator:"none",jqlContext:this.queryStateModel.getJql()});if(a){var b=a.getQueryString();if(b){c=c+"&"+b}}if(this._activeSearcherReq){this._activeSearcherReq.abort()}return this._activeSearcherReq=JIRA.SmartAjax.makeRequest({type:"POST",data:c,processData:false,url:contextPath+"/secure/QueryComponentRendererValue!Default.jspa",success:_.bind(function(f){var e=this.get(d);if(e){if(f[d]){f[d].groupName=e.getGroupName();f[d].groupId=e.getGroupId()}else{f[d]=_.extend(e.toJSON(),{editHtml:null,jql:null,viewHtml:null})}}this._setSearchersFromData(f,true)},this),dataType:"json",error:function(e){JIRA.Issues.displayFailSearchMessage(e)}}).always(_.bind(function(){this._activeSearcherReq=null},this))},_parseSearcherGroups:function(c){var a={};var b=this.queryStateModel.getWithout();_.each(c.groups,function(d){_.each(d.searchers,function(e){if(!_.contains(b,e.id)){e.groupId=d.type;e.groupName=d.title;a[e.id]=e}})});return a},_querySearchersAndValues:function(b){var a="decorator=none";if(this._activeSearcherReq){if(this._activeSearcherQuery===b){return jQuery.Deferred().reject()}this._activeSearcherReq.abort()}this._activeSearcherQuery=b;if(b){a+="&"+b}this._activeSearcherReq=AJS.$.ajax({url:contextPath+"/secure/QueryComponent!Default.jspa",headers:{"X-SITEMESH-OFF":true},type:"POST",data:a,processData:false});this._activeSearcherReq.done(_.bind(function(c){this._onQuerySearchersAndValues(c)},this));this._activeSearcherReq.fail(_.bind(function(c){JIRA.Issues.displayFailSearchMessage(c)},this));this._activeSearcherReq.always(_.bind(function(){this._activeSearcherReq=null},this));return this._activeSearcherReq},clear:function(){this.reset([],{silent:true});this.updateTextQuery("");this.triggerCollectionChanged()},searchersReady:function(){if(this._activeSearcherReq){return this._activeSearcherReq}else{return jQuery.Deferred().resolve()}},_onQuerySearchersAndValues:function(c){var d=this,a=this._parseSearcherGroups(c.searchers);_.each(c.values,_.bind(function(f,g){var e=a[g];if(!e){a[g]=f}else{_.extend(e,f)}},this));var b=[];this.each(function(f){var e=f.id;if(!_.any(a,function(g){return g.id===e})){if(f.getIsSelected()){f.setValidSearcher(false)}else{b.push(f)}}});if(b.length){this.remove(b)}this._setSearchersFromData(a)},_updateSearcherCache:function(){if(this._searcherCache){this.each(_.bind(function(a){this._searcherCache[a.id]=a.toJSON();this._searcherCache[a.id].id=a.id},this))}},_setSearchersFromData:function(a,b){_.each(a,_.bind(function(c,d){this._addOrSet(d,{groupId:c.groupId,groupName:c.groupName,isShown:c.isShown,name:c.name,viewHtml:c.viewHtml,jql:c.jql,editHtml:c.editHtml,validSearcher:c.validSearcher,key:c.key,lastViewed:c.lastViewed},{parse:true})},this));if(b){this._updateSearcherCache()}else{this._searcherCache=a}this.triggerCollectionChanged();JIRA.trace("jira.search.searchers.updated")},getVariableClauses:function(){var a=[];this.each(_.bind(function(b){if(!this.isFixed(b)&&b.hasClause()){a.push(b)}},this));return a},getSelectedCriteria:function(){var a=this;var b=function(c){return !a.isFixed(c)&&(c.hasClause()||c.getIsSelected())};return this.chain().filter(b).sortBy(function(c){return c.getPosition()}).value()},getAllSelectedCriteriaCount:function(){return this.getAllSelectedCriteria().length},getAllSelectedCriteria:function(){var a=[];this.each(_.bind(function(b){if(b.hasClause()||b.getIsSelected()){a.push(b)}},this));return a},isFixed:function(a){return _.contains(this.fixedLozengeIds(),a.getId())||a.getId()===this.QUERY_ID},fixedLozengeIds:function(){return _.pluck(this.fixedLozenges,"id")},getNextPosition:function(){return this.reduce(function(b,c){var a=Math.max(b,c.getPosition());return isNaN(a)?b:a},-1)+1}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaModel.js' */
JIRA.Issues.CriteriaModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CardView.js' */
AJS.namespace("JIRA.Issues.CardView");JIRA.Issues.CardView=JIRA.Issues.Brace.View.extend({namedEvents:["viewChanged"],initialize:function(a){this.views=a.views;if(a.activeView){this.activeView=a.activeView}else{var b=_.keys(this.views);if(b.length>0){this.activeView=b[0]}}},render:function(){this._renderActiveView()},changeToView:function(a){if(a===this.activeView){return}this.activeView=a;if(this.$el){this._renderActiveView(a)}this.triggerViewChanged(a)},_renderActiveView:function(){var a=this.views[this.activeView];a.setElement(this.$el);a.render()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryView.js' */
JIRA.Issues.BasicQueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize","searchRequested"],template:JIRA.Templates.IssueNavQueryBasic.basicQueryView,initialize:function(a){this.searcherCollection=a.searcherCollection;this.queryStateModel=a.queryStateModel;this.textFieldView=new JIRA.Issues.TextFieldView({collection:this.searcherCollection});this.primaryCriteriaContainerView=new JIRA.Issues.PrimaryCriteriaContainerView({collection:this.searcherCollection});this.extendedCriteriaContainerView=new JIRA.Issues.ExtendedCriteriaContainerView({collection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this);if(this.queryStateModel.getBasicOrderBy()){this.basicOrderByView=JIRA.Components.OrderBy.create();this.queryStateModel.on("change:jql",function(){this.basicOrderByView.setJql(this.queryStateModel.getJql())},this);this.basicOrderByView.onSort(this.triggerSearchRequested,this)}this.clauseButtonView=new JIRA.Issues.ClauseButtonView({searcherCollection:this.searcherCollection,queryStateModel:this.queryStateModel});this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.onBeforeCriteriaRemoved(this._handleBeforeCriteriaRemoved,this)},_handleInteractiveChanged:function(a){this.$el.toggleClass("loading",!a)},_handleBeforeCriteriaRemoved:function(b,a){if(a){this._shiftFocus(b,a)}},hasPdl:function(){var a=AJS.Meta.get("version-number");if(a){return parseInt(a.charAt(0),10)>=6}},render:function(){this.$el.html(this.template({hasPdl:this.hasPdl(),hasOrderBy:this.queryStateModel.getBasicOrderBy(),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.primaryCriteriaContainerView.setElement(this.$el.find(".search-criteria .criteria-list"));this.textFieldView.setElement(this.$el.find("input.search-entry"));this.clauseButtonView.setElement(this.$el.find(".criteria-actions"));this.extendedCriteriaContainerView.setElement(this.$el.find(".search-criteria-extended .criteria-list"));if(this.basicOrderByView){this.basicOrderByView.setElement(this.$el.find(".list-ordering")).render();this.basicOrderByView.setJql(this.queryStateModel.getJql())}this.primaryCriteriaContainerView.render();this.$el.find(".text-query").removeClass("hidden");this.textFieldView.render();this.clauseButtonView.render();this.extendedCriteriaContainerView.render();this._handleInteractiveChanged(this.searcherCollection.isInteractive());this.triggerVerticalResize();new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});return this},search:function(){this.searcherCollection.handleBasicViewSubmit()},_shiftFocus:function(b,f){var e=this.primaryCriteriaContainerView.getFocusableForCriteria(b);if(!e.length){e=this.extendedCriteriaContainerView.getFocusableForCriteria(b)}var d=this.primaryCriteriaContainerView.getFocusables().add(this.extendedCriteriaContainerView.getFocusables());var c=d.index(e);var a;if(c===0){a=1}else{if(c===d.length-1){a=d.length-2}else{a=c+f}}d.eq(a).focus()},focus:function(){this.primaryCriteriaContainerView.getFocusables().first().focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextFieldView.js' */
AJS.namespace("JIRA.Issues.TextFieldView");JIRA.Issues.TextFieldView=JIRA.Issues.Brace.View.extend({namedEvents:["searchRequested"],events:{keypress:"handleKeypress"},initialize:function(){_.bindAll(this,"_updateSearcherCollectionTextField","_handleInteractiveChanged","render");this.collection.on("remove change add",_.bind(function(a){if(a.getId()===this.collection.QUERY_ID){this.render()}},this));this.collection.onTextFieldChanged(this.render);this.collection.onRequestUpdateFromView(this._updateSearcherCollectionTextField);this.collection.onInteractiveChanged(this._handleInteractiveChanged)},handleKeypress:function(a){if(a.keyCode===13){this.collection.handleBasicViewSubmit();a.preventDefault()}},render:function(){var a=this.collection.get(this.collection.QUERY_ID);if(a){var c=a.getEditHtml();var b=AJS.$("<div></div>").html(c||"").text();this.setQuery(b)}else{this.setQuery("")}},setQuery:function(a){this.$el.val(a)},_updateSearcherCollectionTextField:function(){if(this.$el.is("input")){var a=AJS.$.trim(this.$el.val());this.collection.updateTextQuery(a)}},_handleInteractiveChanged:function(a){this.$el.prop("disabled",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/PrimaryCriteriaContainerView.js' */
JIRA.Issues.PrimaryCriteriaContainerView=JIRA.Issues.Brace.View.extend({initialize:function(){this._criteriaViews=_.map(this.collection.fixedLozenges,function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel(a),searcherCollection:this.collection})},this)},render:function(){_.each(this._criteriaViews,function(a){a.render()});this.$el.prepend(_.pluck(this._criteriaViews,"el"))},getCriteriaViews:function(){return this._criteriaViews},getFocusables:function(){return this.$(".criteria-selector, #searcher-query, .add-criteria, .search-button")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ExtendedCriteriaContainerView.js' */
JIRA.Issues.ExtendedCriteriaContainerView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],initialize:function(a){this.collection.on("change:isSelected",this._onCriteriaSelectionChanged,this);this.collection.on("add",this._onCriteriaSelectionChanged,this);this.collection.on("remove",this._removeViewForSearcher,this);this.collection.on("reset",this._onReset,this);this._criteriaViews=_.map(this.collection.getSelectedCriteria(),_.bind(function(b){if(b.getPosition()==null){b.setPosition(this.collection.getNextPosition())}return this._buildCriteriaViewForSearcher(b)},this))},render:function(){_.each(this._criteriaViews,_.bind(function(a){a.render();this.$el.append(a.$el)},this))},getFocusables:function(){return this.$(".criteria-selector")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')},_buildCriteriaViewForSearcher:function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel({id:a.get("id"),name:a.get("name")}),searcherCollection:this.collection,extended:true})},_onCriteriaSelectionChanged:function(a){if(a.getIsSelected()&&!this.collection.isFixed(a)){this._addViewForSearcher(a)}else{this._removeViewForSearcher(a)}},_addViewForSearcher:function(b){var a=this._buildCriteriaViewForSearcher(b);a.render();this.$el.append(a.$el);this._criteriaViews.push(a);this.triggerVerticalResize()},_removeViewForSearcher:function(a){this._criteriaViews=_.reject(this._criteriaViews,function(b){if(b.model.getId()===a.getId()){b.destroy();return true}return false});this.triggerVerticalResize()},_onReset:function(){_.each(this._criteriaViews,function(a){a.destroy()});this._criteriaViews=[]}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherGroupListDialogView.js' */
(function(){var a;JIRA.Issues.SearcherGroupListDialogView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent,namedEvents:["searcherSelected","hideRequested"],events:{keydown:"_keyPressed"},initialize:function(b){this.searcherCollection=b.searcherCollection;this.$el.scrollLock(".aui-list-scroll")},render:function(){var f=this.searcherCollection.getAddMenuGroupDescriptors(),e=f.length&&f[0].properties.items.length>JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;var c=jQuery(AJS.Templates.queryableSelect({descriptors:f,id:"criteria"}));this.$el.empty().append(c);var d={element:c,suggestionsHandler:JIRA.Issues.SearcherGroupListDialogView.SuggestHandler,hideFooterButtons:true};var h="...excluding \u003cspan class=hidden-no>\u003c\/span> hidden",g="These criteria are hidden because they are not applicable to the current project and\/or issue type";if(e){d.maxInlineResultsDisplayed=JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;h="...excluding \u003cspan class=hidden-no>\u003c\/span> hidden. Please enter a keyword to refine.";g="These criteria are hidden because there are either too many to display or they are not applicable to the current project and\/or issue type"}var b=new AJS.CheckboxMultiSelect(d);a=jQuery("<div class='more-criteria-footer' />").html(h);this.$el.append(a);new JIRA.Issues.Tipsy({el:a,tipsy:{title:function(){return g},className:"tipsy-front"}});this.$el.unbind("selected").bind("selected",_.bind(this._searcherSelected,this));this.$el.unbind("unselect").bind("unselect",_.bind(this._searcherUnselected,this));return this.$el},_searcherUnselected:function(c,b){this.searcherCollection.clearClause(b.properties.value)},_searcherSelected:function(d,c){var b=this.searcherCollection.getSearcher(c.properties.value);b.select();JIRA.Issues.SearcherDialog.instance.hide();JIRA.Issues.SearcherDialog.instance.show(b)},_keyPressed:function(f){if(f.keyCode===AJS.$.ui.keyCode.TAB){var b=AJS.$(":tabbable",this.$el);var c=(b.length===0);var e=(f.shiftKey&&(document.activeElement===b.first()[0]));var d=(!f.shiftKey&&(document.activeElement===b.last()[0]));if(c||e||d){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);f.preventDefault()}}}},{CRITERIA_DISPLAY_LIMIT:100});JIRA.Issues.SearcherGroupListDialogView.SuggestHandler=AJS.CheckboxMultiSelectSuggestHandler.extend({formatSuggestions:function(b,c){var e=0,d=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());b.splice(0,0,new AJS.GroupDescriptor({actionBarHtml:d.length>1?this.createClearAll():null,items:d,styleClass:"selected-group"}));_.each(b,function(g){if(c.length===0){var f=_.filter(g.items(),function(i,h){var j=i.meta();return j&&j.isShown&&h<JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT});e+=g.items().length-f.length;g.items(f)}else{_.each(g.items(),function(h){var i=h.meta();h.disabled(!(i&&i.isShown))})}});_.defer(function(){if(a){if(e){a.show().find(".hidden-no").text(e)}else{a.hide()}}});return b}})})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherEditDialogView.js' */
JIRA.Issues.SearcherEditDialogView=JIRA.Issues.Brace.View.extend({namedEvents:["backRequested","hideRequested"],autoUpdate:[".js-default-checkboxmultiselect",".js-default-checkboxmultiselectstatuslozenge",".js-user-checkboxmultiselect",".js-usergroup-checkboxmultiselect",".js-group-checkboxmultiselect",".js-label-checkboxmultiselect"],events:function(){var a={"click .cancel-update":"_onCancelClicked",click:"_stopPropagation",submit:"_onSubmit",keydown:"_keyPressed"};if(this.queryStateModel.getBasicAutoUpdate()){a["selected "+this.autoUpdate.join(",")]="applyChanges";a["unselect "+this.autoUpdate.join(",")]="applyChanges"}return a},template:JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent,initialize:function(a){this._formData="";this.queryStateModel=a.queryStateModel;this.$el.scrollLock(".aui-list-scroll")},renderDeferred:function(){var a=jQuery.Deferred();this.model.retrieveEditHtml().done(_.bind(function(b){a.resolve(this.render(b))},this));return a.promise()},hasAutoUpdate:function(a){return this.queryStateModel.getBasicAutoUpdate()&&jQuery(a).find(this.autoUpdate.join(",")).length!==0},render:function(b){var a=!(/^\s*$/.test(b));var c;if(a){c=AJS.$(this.template({displayBackButton:this.displayBackButton,displayUpdateCancel:!this.hasAutoUpdate(b)&&!jQuery(b).hasClass("searchfilter-not-found")}))}else{c=AJS.$(JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit({fieldName:this.model.getName()}))}this.$el.html(c);this.$el.find(".form-body").appendCatchExceptions(b);this.$el.find("form").addClass(this.model.id+"-criteria");this.$el.find("label:first").remove();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed]);this._formData=this.$el.find("form").serialize();this.model.setInitParams(this._formData);return this.$el},_stopPropagation:function(a){a.stopPropagation()},_preventDefault:function(a){a.preventDefault()},applyFilter:function(){var b=this.$el.find("form").serialize();var a=(b!==this._formData);this._formData=b;this.model.setSerializedParams(this._formData);return a},applyChanges:function(){if(this.applyFilter()){this.model.createOrUpdateClauseWithQueryString()}},_onCancelClicked:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.cancelClicked)},_onSubmit:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.submit)},_keyPressed:function(e){if(e.keyCode===AJS.$.ui.keyCode.TAB){var a=AJS.$(":tabbable",this.$el);var b=(a.length===0);var d=(e.shiftKey&&(document.activeElement===a.first()[0]));var c=(!e.shiftKey&&(document.activeElement===a.last()[0]));if(b||d||c){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);e.preventDefault()}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseListDialogView.js' */
AJS.namespace("JIRA.Issues.ClauseListDialogView");JIRA.Issues.ClauseListDialogView=JIRA.Issues.Brace.View.extend({events:{"click .clauses .searcherValue":"_clauseSelected","click .remove-filter":"_removeFilterRequested"},template:JIRA.Templates.IssueNavQueryBasic.enabledClauses,namedEvents:["clauseSelected","hideRequested"],initialize:function(a){this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this._renderAndCheckForClose,this)},render:function(){this.$el.html(this.template({clauses:this._getClauses()}))},_renderAndCheckForClose:function(){this.render();if(!this._getClauses().length){this.triggerHideRequested()}},_clauseSelected:function(b){b.preventDefault();var a=AJS.$(b.target),c=a.parents("li").first().data("id");this.triggerClauseSelected(c)},_removeFilterRequested:function(b){b.preventDefault();var a=this;_.defer(function(){var c=AJS.$(b.target),e=c.parents("li").first();var d=e.data("id");a.searcherCollection.clearClause(d);e.remove();a.triggerHideRequested()})},_getClauses:function(){var b=this.searcherCollection.getVariableClauses();var a=_.invoke(b,"toJSON");_.each(a,this._formatForTemplate);return a},_formatForTemplate:function(a){if(a.validSearcher){a.invalidMessage=""}else{a.invalidMessage="This criteria is not valid for the project and\/or issue type"}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseButtonView.js' */
JIRA.Issues.ClauseButtonView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.clauseButtonView,addCriteriaButton:".add-criteria",events:{"click .add-criteria":"_showDialog","keydown .add-criteria":"_onKeydown"},initialize:function(c){_.bindAll(this,"_handleInteractiveChanged","_showOrHideClauseButtons");var a=this;this.queryStateModel=c.queryStateModel;this.searcherCollection=c.searcherCollection;this.searcherCollection.onCollectionChanged(this._showOrHideClauseButtons);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged);var d=this.dialog=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return a.$el.find(a.addCriteriaButton)},content:function(){return b.render()}});d.bind(AJS.InlineLayer.EVENTS.hide,function(h,f,g){if(g===AJS.HIDE_REASON.escPressed||g===AJS.HIDE_REASON.toggle||g==AJS.HIDE_REASON.tabbedOut){a.$(a.addCriteriaButton).focus()}});var b=new JIRA.Issues.SearcherGroupListDialogView({searcherCollection:this.searcherCollection,dialog:d});b.onHideRequested(function(e){d.hide(e)});d.bind(AJS.InlineLayer.EVENTS.show,function(f,e){jQuery("#criteria-input").focus();e.find(".aui-list-scroll").scrollTop(0)})},render:function(){this.$el.html(this.template({isSubtle:this.queryStateModel.hasSubtleMoreCriteria()}));this._showOrHideClauseButtons();this._addToolTip();return this.$el},_addToolTip:function(){new JIRA.Issues.Tipsy({el:this.$el.find(this.addCriteriaButton),showCondition:":not(.active)"})},_showOrHideClauseButtons:function(){var a=this.$(this.addCriteriaButton);if(this.searcherCollection.getAddMenuGroupDescriptors().length>0){a.show()}else{a.hide()}},_showDialog:function(a){if(this.searcherCollection.isInteractive()){this.dialog.toggle()}a.preventDefault()},_handleInteractiveChanged:function(a){this.$(this.addCriteriaButton).attr("aria-disabled",(a)?null:"true")},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog(a);break;case AJS.$.ui.keyCode.ESCAPE:jQuery(a.target).blur();break;case AJS.$.ui.keyCode.BACKSPACE:break;default:return}a.preventDefault()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherDialog.js' */
JIRA.Issues.SearcherDialog=function(){return{initialize:function(b){if(!this.instance){this.instance=a(b)}}};function a(b){AJS.HIDE_REASON.switchLozenge="switchLozenge";var f=[AJS.HIDE_REASON.escPressed,AJS.HIDE_REASON.toggle,AJS.HIDE_REASON.cancelClicked,AJS.HIDE_REASON.submit,AJS.HIDE_REASON.tabbedOut];function e(i){return i?jQuery(".criteria-selector[data-id='"+i.getId()+"']"):jQuery()}var h;var d;var c;var g=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return e(d)},content:function(){c=new JIRA.Issues.SearcherEditDialogView({model:d,queryStateModel:b.queryStateModel});c.onHideRequested(function(i){g.hide(i)});return c.renderDeferred()}});g.bind(AJS.InlineLayer.EVENTS.show,function(k,i){var j=i.find(":input:not(submit):visible:first");j.focus();if((AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<9)){j.focus()}i.find(".aui-list-scroll").scrollTop(0)});g.bind(AJS.InlineLayer.EVENTS.beforeHide,function(l,j,k,m,i){if(k===AJS.HIDE_REASON.clickOutside&&i&&jQuery(i).closest(".calendar").length){l.preventDefault()}});g.bind(AJS.InlineLayer.EVENTS.hide,function(m,j,l){var k=d;if(_.contains(f,l)){e(k).focus()}function i(){h=d.createOrUpdateClauseWithQueryString(l===AJS.HIDE_REASON.submit);h.done(function(){if(k.hasErrorInEditHtml()){if(b.queryStateModel.getSearchMode()==="basic"){JIRA.Issues.SearcherDialog.instance.show(k)}}if(AJS.InlineLayer.current){AJS.InlineLayer.current.setPosition()}});h.always(function(){h=null});k.clearEditHtml()}if(l===AJS.HIDE_REASON.submit){c.applyFilter();i()}else{if(l!==AJS.HIDE_REASON.cancelClicked&&l!==AJS.HIDE_REASON.escPressed&&l!==AJS.HIDE_REASON.tabbedOut){if(c.applyFilter()){i()}}else{JIRA.trace("jira.search.searchers.hiddenWithoutUpdate")}}c.$el.remove();c=null;d=null});b.queryStateModel.on("change:searchMode",function(){g.hide()});return{getCurrentSearcher:function(){return d},toggle:function(i){if(d!=null){if(d!==i){g.hide(AJS.HIDE_REASON.switchLozenge);this.show(i)}else{g.hide(AJS.HIDE_REASON.toggle)}}else{this.show(i)}},_show:function(i){_.defer(function(){d=i;g.show();g.setPosition()})},show:function(k){var j;if(JIRA.Issues.SearcherDialog.waitingToShow){j=true}var i=this;JIRA.Issues.SearcherDialog.waitingToShow=function(){i._show(k);JIRA.Issues.SearcherDialog.waitingToShow=null};if(!j){k.searchersReady().done(function(){if(h){h.done(function(){JIRA.Issues.SearcherDialog.waitingToShow()})}else{JIRA.Issues.SearcherDialog.waitingToShow()}})}},onShow:function(i){g.bind(AJS.InlineLayer.EVENTS.show,i)},hide:function(){g.hide()},onHide:function(i){g.bind(AJS.InlineLayer.EVENTS.hide,i)}}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-jql.soy' */
// This file was automatically generated from query-jql.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryJql == 'undefined') { JIRA.Templates.IssueNavQueryJql = {}; }


JIRA.Templates.IssueNavQueryJql.jqlQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container"><div class="atlassian-autocomplete"><label for="advanced-search"><span id="jqlerrormsg" class="icon jqlgood"><span>', soy.$$escapeHtml("parse"), '</span></span> <span class="jql-label">', soy.$$escapeHtml("Query"), ' <span id="jqlcolrowcount">', soy.$$escapeHtml("line"), ':<span id="jqlrownum">0</span>', soy.$$escapeHtml("character"), ':<span id="jqlcolumnnum">0</span></span></span></label><textarea id="advanced-search" class="search-entry advanced-search ajs-dirty-warning-exempt" name="jql" maxlength="2000"></textarea><a class="syntax-help" href="', soy.$$escapeHtml(opt_data.helpUrl), '" title="', soy.$$escapeHtml("Syntax Help"), '" target="_jirahelp" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-help">', soy.$$escapeHtml("Syntax Help"), '</span></a></div></div><div class="search-options-container">', (opt_data.hasSearchButton) ? '<button class="aui-item aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtml("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button>' : '', '<span class="mode-switcher"></span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlAutoCompleteView.js' */
JIRA.Issues.JQLAutoCompleteView=JIRA.Issues.Brace.View.extend({namedEvents:["jqlValid","jqlInvalid","searchRequested"],events:{focus:"_onFocus"},getJqlAutoCompleteData:function(){var b=jQuery.Deferred();if(this.jqlFieldNames==null||this.jqlFunctionNames==null||this.jqlReservedWords==null){var c=jQuery("#jqlFieldz");var d=jQuery("#jqlFunctionNamez");var a=jQuery("#jqlReservedWordz");if(c.length>0&&d.length>0&&a.length>0){this.jqlFieldNames=JSON.parse(c.text());this.jqlFunctionNames=JSON.parse(d.text());this.jqlReservedWords=JSON.parse(a.text())}else{AJS.$.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/jqlAutoComplete"}).done(_.bind(function(f){var e=JSON.parse(f);this.jqlFieldNames=_.reject(JSON.parse(e.jqlFieldz),_.bind(function(g){return _.contains(this.model.getWithout(),g.value)},this));this.jqlFunctionNames=JSON.parse(e.jqlFunctionNamez);this.jqlReservedWords=JSON.parse(e.jqlReservedWordz);b.resolve()},this));return b.promise()}}return b.resolve().promise()},_initJQLAutoComplete:function(){var d=this.$el;var b=JIRA.JQLAutoComplete({fieldID:d.attr("id"),parser:JIRA.JQLAutoComplete.MyParser(this.jqlReservedWords),queryDelay:0.65,jqlFieldNames:this.jqlFieldNames,jqlFunctionNames:this.jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var a=this;d.keypress(function(e){if(b.dropdownController===null||!b.dropdownController.displayed||b.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){e.preventDefault();b.dropdownController.hideDropdown();a.triggerSearchRequested(d.val())}}});var a=this;var c=b.updateParseIndicator;b.updateParseIndicator=function(e){c.apply(this,arguments);if(!e.getParseError()){a.triggerJqlValid(d.val())}else{a.triggerJqlInvalid(d.val())}};b.buildResponseContainer();b.parse(d.val());b.updateColumnLineCount();d.bind("expandedOnInput",function(){b.positionResponseContainer()}).bind("updateParseIndicator",function(){b.parse(d.val())}).click(function(){b.dropdownController.hideDropdown()})},_onFocus:function(){if(!this.model.getAutocompleteEnabled()||this.$el.data("JQLAutoComplete_init")){return}this.$el.data("JQLAutoComplete_init",true);this.getJqlAutoCompleteData().done(_.bind(this._initJQLAutoComplete,this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryModule.js' */
JIRA.Issues.JqlQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["searchRequested","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.view=new JIRA.Issues.JqlQueryView({queryStateModel:a.queryStateModel}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,_.bind(function(d,b,c){if(c===JIRA.CONTENT_ADDED_REASON.returnToSearch){this.setQuery()}},this))},search:function(){var a=this.view.readJql();this.triggerSearchRequested(a)},setQuery:function(){this.view.setQuery()},createView:function(){return this.view}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryView.js' */
JIRA.Issues.JqlQueryView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryJql.jqlQueryView,namedEvents:["verticalResize","searchRequested"],events:{expandedOnInput:"_handleExpandOnInput"},initialize:function(a){this.queryStateModel=a.queryStateModel;this.queryStateModel.on("change:jql",this.setQuery,this);AJS.$(document).bind("issueNavWidthChanged",_.bind(this._resizeHeight,this));if(JIRA.Issues.JQLAutoCompleteView){this.JQLAutoCompleteView=new JIRA.Issues.JQLAutoCompleteView({model:this.queryStateModel});this.JQLAutoCompleteView.onJqlValid(function(b){if(this.queryStateModel.getAdvancedAutoUpdate()){this.triggerSearchRequested(b)}},this);this.JQLAutoCompleteView.onSearchRequested(this.triggerSearchRequested,this)}},render:function(){this.$el.html(this.template({helpUrl:AJS.Meta.get("advanced-search-help-url"),helpTitle:AJS.Meta.get("advanced-search-help-title"),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.$el.addClass("loading");if(this.JQLAutoCompleteView){this.JQLAutoCompleteView.setElement(this.$el.find(".advanced-search"));this.JQLAutoCompleteView.getJqlAutoCompleteData()}new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});this.setQuery();return this},readJql:function(){var a=this._getInputField();var b=a.val()||"";var c=AJS.$.trim(b);if(b!==c){a.val(c)}this._resizeHeight();return c},_handleExpandOnInput:function(){this.triggerVerticalResize()},_resizeHeight:function(){var a=this._getInputField();if(a.val()){a.height(0).expandOnInput()}else{a.expandOnInput().height(0).trigger("refreshInputHeight")}},setQuery:function(){this.$el.removeClass("loading");this._getInputField().val(this.queryStateModel.getJql());this._getInputField().trigger("updateParseIndicator");this._resizeHeight()},focus:function(){this._getInputField().focus()},_getInputField:function(){return this.$el?this.$el.find("textarea"):AJS.$()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query.soy' */
// This file was automatically generated from query.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQuery == 'undefined') { JIRA.Templates.IssueNavQuery = {}; }


JIRA.Templates.IssueNavQuery.searchSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var itemList3 = opt_data.items;
  var itemListLen3 = itemList3.length;
  for (var itemIndex3 = 0; itemIndex3 < itemListLen3; itemIndex3++) {
    var itemData3 = itemList3[itemIndex3];
    JIRA.Templates.IssueNavQuery.searchSwitcherItem({id: itemData3.id, isActive: itemData3.id == opt_data.selectedId}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.searchSwitcherItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="switcher-item', soy.$$escapeHtml(opt_data.isActive ? ' active' : ''), ' " data-id=\'', soy.$$escapeHtml(opt_data.id), '\' title="', (opt_data.id == 'basic') ? soy.$$escapeHtml("Switch to advanced search using JQL") : soy.$$escapeHtml("Switch to basic search"), '">', (opt_data.id == 'basic') ? soy.$$escapeHtml("Advanced") : soy.$$escapeHtml("Basic"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.queryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="aui-item search-wrap"><div class="search-container"></div><div class="save-filter-controls"></div></div>', (opt_data.layoutSwitcher) ? '<div class="aui-item view-selector" id="layout-switcher-toggle"></div>' : '', '</div><div class="notifications"></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryModule.js' */
JIRA.Issues.QueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlChanged","jqlTooComplex","jqlError","jqlSuccess","searchRequested","queryTooComplexSwitchToAdvanced","changedPreferredSearchMode","basicModeCriteriaCountWhenSearching","verticalResize","initialized"],initialize:function(a){this._queryStateModel=a.queryStateModel;this._queryStateModel.on("change:preferredSearchMode",_.bind(function(){this.triggerChangedPreferredSearchMode(this._queryStateModel.getPreferredSearchMode())},this));JIRA.Issues.SearcherDialog.initialize({queryStateModel:this._queryStateModel});this._jqlQueryModule=new JIRA.Issues.JqlQueryModule({queryStateModel:this._queryStateModel}).onSearchRequested(this.handleAdvancedSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this);this._errors={};this._errors[this._queryStateModel.BASIC_SEARCH]=[];this._errors[this._queryStateModel.ADVANCED_SEARCH]=[];this._queryStateModel.on("change:searchMode",this.showSearchErrors,this);this._basicQueryModule=new JIRA.Issues.BasicQueryModule({queryStateModel:this._queryStateModel,primaryClauses:a.primaryClauses,initialSearcherCollectionState:a.searchers}).onSearchRequested(this.clearSearchErrors,this).onJqlTooComplex(this.handleJqlTooComplex,this).onSearchRequested(this.handleSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this).onBasicModeCriteriaCountWhenSearching(this.triggerBasicModeCriteriaCountWhenSearching,this)},refreshLayout:function(){this._jqlQueryModule.setQuery()},handleAdvancedSearchRequested:function(a){this.handleSearchRequested(a);this._basicQueryModule.queryChanged()},handleSearchRequested:function(a){this._queryStateModel.setJql(a);this.clearSearchErrors()},handleJqlTooComplex:function(a){if(this.getSearchMode()!==this._queryStateModel.ADVANCED_SEARCH){this.triggerQueryTooComplexSwitchToAdvanced()}this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH);this.triggerJqlTooComplex(a);if(this._queryView){this._queryView.switcherViewModel.disableSwitching()}},getJql:function(){return this._queryStateModel.getJql()},getSearcherCollection:function(){return this._basicQueryModule.searcherCollection},isBasicMode:function(){return this._queryStateModel.getSearchMode()===this._queryStateModel.BASIC_SEARCH},resetToQuery:function(a,b){this.clearSearchErrors();return this._basicQueryModule.queryReset(a).always(_.bind(function(){this._queryStateModel.switchToPreferredSearchMode();this._jqlQueryModule.setQuery();if(b&&b.focusQuery===true){this._queryView.getView().focus()}this._basicQueryModule.off("searchRequested",this.publishJqlChanges);this._jqlQueryModule.off("searchRequested",this.publishJqlChanges);this._basicQueryModule.onSearchRequested(this.publishJqlChanges,this);this._jqlQueryModule.onSearchRequested(this.publishJqlChanges,this)},this))},publishJqlChanges:function(a){this.triggerJqlChanged(a)},setVisible:function(a){this._queryView.setVisible(a)},queryChanged:function(){this.clearSearchErrors();this._basicQueryModule.queryChanged()},onSearchSuccess:function(a){if(this._queryView){this._queryView.showWarnings(a)}this.triggerJqlSuccess()},searchersReady:function(){return this._basicQueryModule.searchersReady()},onSearchError:function(b){this._errors.renderFunction="showErrors";var c=(b.errorMessages)?b.errorMessages.concat():[];var a=[];_.each(b.errors,function(e,d){if(d==="jql"){a.push(e)}else{c.push(e)}});if(this.getSearchMode()===this._queryStateModel.BASIC_SEARCH&&!this._basicQueryModule.hasErrors()&&a.length>0){this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH)}this._errors[this._queryStateModel.BASIC_SEARCH]=c;this._errors[this._queryStateModel.ADVANCED_SEARCH]=a.concat(c);this.showSearchErrors();this.triggerJqlError()},showSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();var a=this._errors.renderFunction||"showErrors";this._queryView[a](this._errors[this.getSearchMode()])}},clearSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();this._queryView.switcherViewModel.enableSwitching()}this._errors[this._queryStateModel.BASIC_SEARCH].length=0;this._errors[this._queryStateModel.ADVANCED_SEARCH].length=0},getSearchMode:function(){return this._queryStateModel.getSearchMode()},getActiveBasicModeSearchers:function(){return this._basicQueryModule.getSelectedCriteria()},setSearchMode:function(a){if(this.getSearchMode()!==a){this._queryStateModel.switchToSearchMode(a);return true}return false},createAndRenderView:function(a){this._queryView=new JIRA.Issues.QueryView({el:a,queryStateModel:this._queryStateModel,basicQueryModule:this._basicQueryModule,jqlQueryModule:this._jqlQueryModule}).onVerticalResize(this.triggerVerticalResize,this);this._queryView.render()},isQueryValid:function(){return(this._errors&&this._errors[this._queryStateModel.BASIC_SEARCH].length===0&&this._errors[this._queryStateModel.ADVANCED_SEARCH].length===0)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryStateModel.js' */
JIRA.Issues.QueryStateModel=JIRA.Issues.Brace.Model.extend({BASIC_SEARCH:"basic",ADVANCED_SEARCH:"advanced",namedAttributes:["style","searchMode","preferredSearchMode","jql","without","layoutSwitcher","autocompleteEnabled","advancedAutoUpdate","basicAutoUpdate","basicOrderBy"],defaults:{searchMode:"basic",preferredSearchMode:"basic"},switchToSearchMode:function(a){this.setSearchMode(a)},switchPreferredSearchMode:function(a){this.switchToSearchMode(a);this.setPreferredSearchMode(a);this._savePreferredSearchMode()},switchToPreferredSearchMode:function(){this.switchToSearchMode(this.getPreferredSearchMode())},hasSearchButton:function(){return this.getStyle()!=="field"},hasSubtleMoreCriteria:function(){return this.getStyle()!=="field"},_savePreferredSearchMode:function(){jQuery.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/userSearchMode",type:"POST",headers:{"X-Atlassian-Token":"nocheck"},data:{searchMode:this.getPreferredSearchMode()},error:_.bind(function(a){if(JIRA.Issues.displayFailSearchMessage){JIRA.Issues.displayFailSearchMessage(a)}},this),success:function(){JIRA.trace("jira.search.mode.changed")}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherModel.js' */
JIRA.Issues.SwitcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","view","text"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherCollection.js' */
JIRA.Issues.SwitcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SwitcherModel});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QuerySwitcherViewModel.js' */
JIRA.Issues.QuerySwitcherViewModel=JIRA.Issues.Brace.Model.extend({mixins:[JIRA.Issues.Mixin.SingleSelect],namedAttributes:["disabled"],namedEvents:["selectionChanged"],initialize:function(a,b){this.queryStateModel=b.queryStateModel;this.queryStateModel.on("change:searchMode",_.bind(function(){this.triggerSelectionChanged.apply(this,arguments)},this))},getSelected:function(){var a=this.queryStateModel.getSearchMode();return a?this.getCollection().get(a):null},setSelected:function(a){this.queryStateModel.switchPreferredSearchMode(a?a.id:null)},enableSwitching:function(){this.setDisabled(false)},disableSwitching:function(){this.setDisabled(true)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryView.js' */
JIRA.Issues.QueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],template:JIRA.Templates.IssueNavQuery.queryView,events:{"click .search-button":"search",submit:"preventDefault"},initialize:function(a){this.queryStateModel=a.queryStateModel;var b=new JIRA.Issues.SwitcherCollection([{id:this.queryStateModel.BASIC_SEARCH,name:"Basic",view:a.basicQueryModule.createView()},{id:this.queryStateModel.ADVANCED_SEARCH,name:"Advanced",view:a.jqlQueryModule.createView()}]);this.jqlQueryModule=a.jqlQueryModule;this.switcherViewModel=new JIRA.Issues.QuerySwitcherViewModel({collection:b},{queryStateModel:this.queryStateModel});this.switcherView=new JIRA.Issues.SwitcherView({template:JIRA.Templates.IssueNavQuery.searchSwitcher,model:this.switcherViewModel,containerClass:".search-container"}).onVerticalResize(this.triggerVerticalResize,this)},render:function(){this.$el.html(this.template(this.queryStateModel.toJSON()));this.switcherView.setElement(this.$el).render();return this},preventDefault:function(a){a.preventDefault()},clearNotifications:function(){this.$(".notifications").empty()},search:function(){if(this.queryStateModel.ADVANCED_SEARCH===this.switcherViewModel.getSelected().getId()){this.jqlQueryModule.search()}else{this.getView().search()}},getView:function(){return this.switcherViewModel.getSelected().getView()},showErrors:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.errorMessage({messages:a}))},showWarnings:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.warningMessage({messages:a}))},setVisible:function(a){this.$(".search-container").toggle(a);this.switcherView.setVisible(a)}});jQuery(function(){if(jQuery.browser.msie&&jQuery.browser.version<=8){JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(){jQuery(".text-query-container").parent().append(jQuery(".text-query-container").detach())})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherView.js' */
JIRA.Issues.SwitcherView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],tagName:"div",events:{"click .switcher-item":"_onSwitcherClick"},initialize:function(a){this.containerClass=a.containerClass;this.model=a.model;this.template=a.template;this.model.onSelectionChanged(this._onSelect,this);this.switchEl=AJS.$();this.model.on("change:disabled",_.bind(this._setSwitching,this))},render:function(){this._onSelect();this._render()},_render:function(){var a=this.model.getSelected();this.switchEl=this.$el.find(".mode-switcher");this.switchEl.html(this.template({items:this.model.getCollection().toJSON(),selectedId:a&&a.id}));new JIRA.Issues.Tipsy({el:this.$el.find(".switcher-item.active")})},getSwitcherTrigger:function(){return this.switchEl.find(".switcher-item.active")},_onSelect:function(){var a=this.$el.find(this.containerClass).empty(),b=this.model.getSelected();if(b){a.attr("data-mode",b.id);b.getView().setElement(a).render()}this._render();this.triggerVerticalResize()},_onSwitcherClick:function(b){b.preventDefault();if(!this.model.getDisabled()){this.model.next();var a=this.model.getSelected().getView();a.focus&&a.focus()}},_setSwitching:function(){if(this.model.getDisabled()){this.disableSwitching()}else{this.enableSwitching()}},disableSwitching:function(){this.switchEl.addClass("disabled");this.getSwitcherTrigger().attr("original-title","This query is too complex to display in Simple mode.")},enableSwitching:function(){this.switchEl.removeClass("disabled");var a=this.model.getSelected();if(a&&a.id==="advanced"){this.getSwitcherTrigger().attr("original-title","Switch to basic search")}},setVisible:function(a){this.switchEl.toggleClass("hidden",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/Query.js' */
JIRA.Components.Query=function(){var a={project:"Project",issuetype:"Type",status:"Status",assignee:"Assignee",reporter:"Reporter",labels:"Labels",resolution:"Resolution",created:"Created Date",updated:"Updated Date",resolutiondate:"Resolution Date",description:"Description",duedate:"Due Date",comment:"Comment",fixfor:"Fix Version",version:"Affects Version",component:"Component"};return{DEFAULT_CLAUSES:["project","issuetype","status","assignee"],create:function(c){c=_.defaults(c,{primaryClauses:this.DEFAULT_CLAUSES,without:[],style:"generic",layoutSwitcher:true,autocompleteEnabled:true,advancedAutoUpdate:false,basicOrderBy:false,basicAutoUpdate:true,preferredSearchMode:"basic"});c.primaryClauses=_.reject(c.primaryClauses,function(d){return _.contains(c.without,d.id)});_.each(c.primaryClauses,function(e,d){if(typeof e==="string"){if(a[e]){c.primaryClauses[d]={id:e,name:a[e]}}else{console.error("JIRA.Components.Query: You have specified clause ["+e+"]. But we do not have the i18n string for it, probably a custom field. Instead use {id:"+e+", name: '[NAME_HERE]'}")}}});var b=new JIRA.Issues.QueryModule({queryStateModel:new JIRA.Issues.QueryStateModel({jql:c.jql,without:c.without,style:c.style,layoutSwitcher:c.layoutSwitcher,autocompleteEnabled:c.autocompleteEnabled,advancedAutoUpdate:c.advancedAutoUpdate,basicAutoUpdate:c.basicAutoUpdate,preferredSearchMode:c.preferredSearchMode,basicOrderBy:c.basicOrderBy}),primaryClauses:c.primaryClauses,searchers:c.searchers});jQuery(c.el).addClass("query-component "+c.style+"-styled");b.createAndRenderView(c.el);if(c.jql||c.jql===""){b.resetToQuery(c.jql).always(function(){jQuery(c.el).addClass("ready");b.triggerInitialized(c.jql)})}return b}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-query', location = 'content/js/search/query/SearchShifter.js' */
JIRA.Issues.SearchShifter=function(d){var b,c,a,e;b=function(){var f=d.searcherCollection.chain().filter(a).map(e).value();return function(){return jQuery.Deferred().resolve(f).promise()}};c=function(h){var f=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher(),g=d.searcherCollection.get(h);if(!g.getIsSelected()){g.select()}if(!f||f.getId()!==g.getId()){JIRA.Issues.SearcherDialog.instance.toggle(g)}};a=function(f){return f.getIsShown()};e=function(f){return{label:f.getName(),value:f.getId()}};return function(){if(!d.isBasicMode()||d.isFullScreenIssue()){return null}return{getSuggestions:b(),name:"Search Criteria",onSelection:c,weight:150}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/enhanceIssueLinks.js' */
JIRA.Issues.enhanceLinks={withPushState:function(a){a=_.defaults(a,{selector:".push-state"});AJS.$(document).delegate(a.selector,"simpleClick",function(d){if(this.href){d.preventDefault();var b=parseUri(this.href);var c=b.path;if(b.query){c+="?"+b.query}c=c.replace(Backbone.history.options.root,"");if(Backbone.history.fragment==c||Backbone.history.fragment==decodeURIComponent(c)){Backbone.history.loadUrl(c)}else{a.router.navigate(c,{trigger:true})}}})},toIssueNav:function(a){var c="a.filter-link[data-filter-id], a.filter-link[data-jql]",b="#issues_new_search_link_lnk";AJS.$(document).on("simpleClick",c,function(h){h.preventDefault();var g=AJS.$(h.target).closest("a"),f=g.data("filter-id"),d=g.data("jql");a.searchPageModule.reset({filter:f,jql:d})});AJS.$(document).on("simpleClick",b,function(d){d.preventDefault();a.searchPageModule.resetToBlank()})},isIssueTableDropdown:function(a){if(AJS.InlineLayer.current){var b=jQuery(AJS.InlineLayer.current.offsetTarget());if(b.closest(".list-view table#issuetable").size()){return true}}},toIssue:function(b){AJS.$(document).on("simpleClick",["#attachment-sorting-options a","#attachment-sorting-order-options a","#subtasks-show-all","#subtasks-show-open"].join(","),function(g){if(this.href){g.preventDefault();g.stopPropagation();var f=parseUri(this.href);if(f.queryKey){JIRA.Issues.Application.execute("issueEditor:updateIssueWithQuery",f.queryKey);AJS.$(this).parents("ul").find("a.aui-checked").removeClass("aui-checked");AJS.$(this).addClass("aui-checked")}}});var d="a.issue-link[data-issue-key]",c=".parentIssue",a=".list-view table#issuetable a.issue-link[data-issue-key]";AJS.$(document).on("simpleClick",d,function(k){k.preventDefault();k.stopPropagation();var i=b.searchPageModule.searchResults;var f=AJS.$(k.target).closest("a").data("issue-key");var g=i._getIssueIdForKey(f);var l=parseInt(g,10);var j=AJS.$(k.target).is(a);var m=AJS.$(k.target).is(c);var h=JIRA.Issues.enhanceLinks.isIssueTableDropdown(a);if((j&&!m)||h){JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:g,absolutePosition:i.getPositionOfIssueInSearchResults(l)+1,relativePosition:i.getPositionOfIssueInPage(l)+1});b.searchPageModule.update({selectedIssueKey:f})}else{b.searchPageModule.reset({selectedIssueKey:f})}})},transformToAjax:function(){AJS.$(document).on("simpleClick",".subtask-reorder a",function(a){if(this.href){a.preventDefault();a.stopPropagation();AJS.$.ajax({type:"GET",data:{disableRedirect:true},url:this.href}).done(function(){JIRA.Issues.Api.refreshSelectedIssue({reason:JIRA.Issues.Actions.UPDATE})}).fail(function(b){JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(b),{closeable:true})})}})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/components/table/ResultsCountView.js' */
(function(a){Backbone.define("JIRA.Issues.ResultsCountView",JIRA.Issues.BaseView.extend({events:{"simpleClick .pagination a[data-start-index]":"_onPaginationClick","click .refresh-table":"_onRefreshTable"},initialize:function(b){this.model.bindIssueDeleted(this.render,this);this.search=b.search},setEndOfStableSearchMessage:function(b){this.$endOfStableSearchMessage=b},render:function(){JIRA.Issues.Tipsy.revalidate();this._renderResultsCount();this._renderPaginationLinks();this._renderEndOfStableMessage();this.$("[title]").each(function(b,c){new JIRA.Issues.Tipsy({el:AJS.$(c),showCondition:":not(.active)",tipsy:{gravity:JIRA.Issues.Tipsy.autoBounds(60,["s"])}})})},_onRefreshTable:function(b){b.preventDefault();if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");this.search.refresh()}},_onPaginationClick:function(b){b.preventDefault();if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){var c=AJS.$(b.target).closest("a").data("start-index");this.model.goToPage(c)}},_renderResultsCount:function(){var b=this.$(".results-count");var c=this.model.getTotal();if(c===0){b.empty()}else{b.replaceWith(JIRA.Templates.IssueNavTable.resultsCount({start:JIRA.NumberFormatter.format(this.model.getStartIndex()+1),end:JIRA.NumberFormatter.format(this.model.getPositionOfLastIssueInPage()),total:JIRA.NumberFormatter.format(c)}))}},_renderPaginationLinks:function(){var d=this.$(".pagination");var b=this.model.getDisplayableTotal();if(b===0){d.empty();return}var c=JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,jql:this.search.getJql(),filter:this.search.getFilterId()});d.replaceWith(JIRA.Templates.IssueNavTable.pagination({startIndex:this.model.getStartIndex(),pageSize:this.model.getPageSize(),searchQuery:c,displayableTotal:b}))},_renderEndOfStableMessage:function(){if(!this.$endOfStableSearchMessage){return}var c=!!(this.model.getTotal()-this.model.getDisplayableTotal()),b=this.model.getPageNumber()===this.model.getNumberOfPages();if(c&&b){this.$endOfStableSearchMessage.addClass("visible");this.$endOfStableSearchMessage.html(JIRA.Templates.IssueNavTable.endOfStableMessage())}else{this.$endOfStableSearchMessage.empty();this.$endOfStableSearchMessage.removeClass("visible")}},_getPagingUri:function(b){return AJS.contextPath()+"/"+JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,startIndex:b,jql:this.search.getJql(),filter:this.search.getFilterId()})}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenDetailView.js' */
Backbone.define("JIRA.Issues.SplitScreenDetailView",JIRA.Issues.BaseView.extend({events:{"focus #addcomment textarea":"scrollToBottom"},issueDetailsNoSelectionTemplate:JIRA.Templates.SplitView.issueDetailsNoSelection,initialize:function(a){_.bindAll(this,"adjustHeight","_renderIssue");this.issueCacheManager=a.issueCacheManager;this.search=a.search;this.searchResults=a.search.getResults();JIRA.Issues.Application.on("issueEditor:fieldSubmitted",this.focus,this);JIRA.Issues.Application.on("issueEditor:replacedFocusedPanel",this.focus,this);this.adjustHeight=_.debounce(this.adjustHeight,a.easeOff)},adjustHeight:function(){_.defer(_.bind(function(){var b=this.getIssueContainer(),a,c;if(b.length){a=b.length&&b.offset().top;c=jQuery(window).height();b.css("height",c-a)}},this))},getIssueContainer:function(){return this.$el.find(".issue-container")},scrollToTop:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(0)}},scrollToBottom:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(a.prop("scrollHeight"))}},activate:function(){if(this.isActive){return this}var a=this;this.$el.focusin(function(){a.focused=true});this.$el.focusout(function(){a.focused=false});this.addListener(this.searchResults,"selectedIssueChange",this.render,this);this.addListener(this.searchResults,"issueUpdated",this.onIssueUpdated,this);this.addListener(this.searchResults,"issueDoesNotExist",this._onIssueDoesNotExist,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.onVerticalResize(this.adjustHeight);JIRA.Issues.Application.on("issueEditor:loadComplete",this.adjustHeight,this);this.isActive=true;return this},deactivate:function(){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.offVerticalResize(this.adjustHeight);JIRA.Issues.Application.off("issueEditor:loadComplete",this.adjustHeight);JIRA.unbind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);this.isActive=false},fixMentionsDropdownInMentionableFields:function(b,a,c){if(c===JIRA.CONTENT_ADDED_REASON.panelRefreshed||c===JIRA.CONTENT_ADDED_REASON.inlineEditStarted){a.find(".mentionable:not([data-follow-scroll])").attr("follow-scroll",".split-view .issue-container");a.find(".mentionable:not([data-push-scroll])").attr("push-scroll",".issue-body-content")}},onIssueUpdated:function(c,a,b){if(b.action!==JIRA.Issues.Actions.INLINE_EDIT&&b.action!==JIRA.Issues.Actions.ROW_UPDATE){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)}else{return jQuery.Deferred().resolve()}},render:function(b,a){a=a||{};if(this.searchResults.hasIssues()&&!this.search.isStandAloneIssue()&&a.reason!=="issueLoaded"){if(this.searchResults.hasSelectedIssue()){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.Utils.debounce(this,"_renderIssue",this.searchResults.getSelectedIssue())}else{this._renderNoIssue()}}this.adjustHeight();return this},_renderIssue:function(a){JIRA.Issues.Application.request("issueEditor:loadIssue",{id:a.get("id"),key:a.get("key")}).always(_.bind(function(){JIRA.Issues.Application.execute("pager:update",_.extend({},this.searchResults.getPager(),{isSplitView:true}));if(this.searchResults.isFirstIssueSelected()&&this.searchResults.getDisplayableTotal()>1){this.issueCacheManager.scheduleIssueToBePrefetched(this.searchResults.getNextIssueForSelectedIssue())}this.issueCacheManager.prefetchIssues();this.$el.addClass("active");this.scrollToTop()},this))},focus:function(){if(!this.hasFocus()){this.getIssueContainer().focus()}},blur:function(){this.getIssueContainer().blur()},_onIssueDoesNotExist:function(){this._renderNoIssue();JIRA.Issues.Application.execute("issueEditor:setContainer",this.$el);this.render()},_renderNoIssue:function(){this.$el.html(this.issueDetailsNoSelectionTemplate())},hasFocus:function(){return this.focused===true}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenListView.js' */
Backbone.define("JIRA.Issues.SplitScreenListView",JIRA.Issues.BaseView.extend({inaccessibleIssueRowTemplate:JIRA.Templates.SplitView.inaccessibleIssueRow,template:JIRA.Templates.SplitView.issueList,events:{"simpleClick .issue-list li":"_onClickIssue"},initialize:function(a){_.bindAll(this,"_adjustHeight","_onSearchDone","_onSearchFail");if(a.easeOff){this._adjustHeight=_.debounce(this._adjustHeight,a.easeOff)}this.search=a.search;this.searchContainer=a.searchContainer;this.searchPromise=this._createSearchPromise({done:this._onSearchDone,fail:this._onSearchFail});this.searchResults=a.search.getResults();this.serverRendered=!!a.serverRendered&&this._issuesRendered(a);this.paginationView=new JIRA.Issues.ResultsCountView({model:this.searchResults,search:this.search});JIRA.Issues.onVerticalResize(this._adjustHeight);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"issueUpdated",this._onIssueUpdated,this);this.addListener(this.searchResults,"startIndexChange",this.render,this)},_issuesRendered:function(a){return !!a.searchContainer.find(".issue-list").length},_adjustHeight:function(){var b=jQuery(".end-of-stable-message").outerHeight(),a=this.$el.offset().top+this.searchContainer.find(".list-panel").scrollTop(),d=jQuery(".pagination-view:last").outerHeight(),c=jQuery(window).height();this.$el.css("height",c-a-b-d)},scrollToFocused:function(){var b=this.searchContainer.find(".list-panel");var a=this.$el.find(".focused");if(b.size()&&a.size()){b.scrollTop(a.position().top)}},deactivate:function(){this.searchPromise.reset();JIRA.Issues.offVerticalResize(this._adjustHeight);this.paginationView.deactivate();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},_onClickIssue:function(c){var b=AJS.$(c.target).closest("[data-id]").data("id"),a=this.searchResults.getSelectedIssue().getId()==b;c.preventDefault();if(!a){this.searchResults.selectIssueById(b,{replace:true});JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:b,absolutePosition:this.searchResults.getPositionOfIssueInSearchResults(b)+1,relativePosition:this.searchResults.getPositionOfIssueInPage(b)+1})}},_createSearchPromise:function(a){var b=jQuery.RecurringPromise();a=a||{};a.done&&b.done(_.bind(a.done,this));a.fail&&b.fail(_.bind(a.fail,this));return b},getIssueById:function(a){return this.$el.find("[data-id="+a+"]")},_highlightIssue:function(a){this.$el.find(".focused").removeClass("focused");a&&this.getIssueById(a.getId()).addClass("focused").scrollIntoView()},markIssueInaccessible:function(a){this.getIssueById(a).replaceWith(this.inaccessibleIssueRowTemplate({isHighlighted:this.searchResults.getHighlightedIssue().getId()===a,issueID:a}))},_onHighlightedIssueChange:function(){this._highlightIssue(this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(b,a){if(a.table[0]===null){this.markIssueInaccessible(b)}else{this.getIssueById(b).html(JIRA.Templates.SplitView.issueRow(a.table[0]))}},_onSearchDone:function(a){if(a instanceof Array){if(this.searchResults.hasIssues()){if(!a.serverRendered){this.$el.html(this.template({highlightedID:this.searchResults.getHighlightedIssue().getId(),issueIDs:this.searchResults.getPageIssueIds(),issues:a}))}this.paginationView.render()}_.defer(_.bind(function(){this._adjustHeight();this.scrollToFocused()},this))}},_onSearchFail:function(){var a=this.searchContainer.find(".navigator-content");a.html(JIRA.Templates.Issues.ComponentUtil.errorMessage({msg:"Error occurred communicating with the server. Please reload the page and try again."}))},render:function(){var a=this.serverRendered;this.serverRendered=false;if(this.searchResults.hasIssues()){if(!this.searchResults.hasHighlightedIssue()&&!this.searchResults.hasSelectedIssue()){this.searchResults.highlightFirstInPage();return}return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql()}).then(function(b){return _.extend(b,{serverRendered:a})}))}else{return jQuery.Deferred().resolve()}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenLayout.js' */
(function(a){Backbone.define("JIRA.Issues.SplitScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(b,c){_.bindAll(this,"_adjustNoResultsMessageHeight","_updateSidebarPosition","applyResponsiveDesign");if(c.easeOff){this.applyResponsiveDesign=a.noop}c=_.extend(c,{serverRendered:this._consumeServerRenderedSplitView(c)});this.search=c.search;this.fullScreenIssue=c.fullScreenIssue;this.navigatorContent=c.searchContainer.find(".navigator-content");this.searchResults=c.search.getResults();this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.navigatorContent});this.detailsView=new JIRA.Issues.SplitScreenDetailView(c);this.listView=new JIRA.Issues.SplitScreenListView(c);this.orderBy=JIRA.Components.OrderBy.create();this.orderBy.onSort(this._handleSort,this);JIRA.Issues.onVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.onHorizontalResize(this._updateSidebarPosition);JIRA.Issues.onVerticalResize(this._updateSidebarPosition);this.addListener(c.search,"beforeSearch",this._showPending,this);this.addListener(this.searchResults,"issueDeleted",this._onIssueDeleted,this);this.addListener(this.searchResults,"newPayload",this._hidePending,this);this.addListener(this.searchResults,"newPayload",this._updateSortBy,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"startIndexChange",this._onStartIndexChange,this);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"selectedIssueChange",this._onSelectedIssueChange,this);this.search.onSearchError(this._onSearchFail,this);JIRA.Issues.Application.on("issueEditor:loadError",this._onIssueLoadError,this);this.listView.searchPromise.done(_.bind(function(){this._makeVisible()},this));this.fullScreenIssue.hide();JIRA.Issues.overrideScrollIntoViewForSplit();this.setElement(this.navigatorContent);if(c.serverRendered){this._activateSubviews()}this._scrollLayoutOnZoom=this._initScrollLayoutOnZoom();if(this._scrollLayoutOnZoom){jQuery(window).on("resize",this._scrollLayoutOnZoom)}this._updateSortBy()},_updateSortBy:function(){this.orderBy.setJql(this.search.getEffectiveJql())},_handleSort:function(b){this.search.doSort(b)},_adjustNoResultsMessageHeight:function(){var d=this.searchResults.hasIssues(),c=AJS.$(window).outerHeight(true);if(d){this.navigatorContent.css("height","")}else{var b=this.navigatorContent.offset().top;this.navigatorContent.css("height",c-b)}},_initScrollLayoutOnZoom:function(){if(jQuery.browser.msie){this.cachedDPI=screen.deviceXDPI;return _.bind(function(){if(this.cachedDPI!==screen.deviceXDPI){jQuery("body, html").scrollTop(0)}this.cachedDPI=screen.deviceXDPI},this)}return null},_consumeServerRenderedSplitView:function(c){var d=!!AJS.Meta.get("consumed-server-rendered-split-view"),b=!!c.searchContainer.find(".split-view").length;AJS.Meta.set("consumed-server-rendered-split-view",true);return !d&&b},deactivate:function(){JIRA.Issues.offVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.offHorizontalResize(this._updateSidebarPosition);JIRA.Issues.restoreScrollIntoViewForNormal();jQuery("body").removeClass("page-type-split");JIRA.Issues.Application.off("issueEditor:loadError",this._onIssueLoadError,this);this.navigatorContent.addClass("pending").css("height","");this.orderBy.offSort(this._handleSort,this);this.search.offSearchError(this._onSearchFail,this);if(this._isIOS()){this._deactivateIOSSpecificBehaviour()}this.detailsView.deactivate();this.listView.deactivate();jQuery(window).off("resize",this.applyResponsiveDesign);if(this._scrollLayoutOnZoom){jQuery(window).off("resize",this._scrollLayoutOnZoom);delete this._scrollLayoutOnZoom}JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);if(!this.searchResults.hasIssue(this.searchResults.getSelectedIssue().getId())){this.searchResults.selectFirstInPage()}},_handleInitialIssueSelection:function(){if(!this.searchResults.hasSelectedIssue()){if(this.searchResults.hasHighlightedIssue()){this.searchResults.selectIssueById(this.searchResults.getHighlightedIssue().getId(),{replace:true})}else{this.searchResults.selectFirstInPage({replace:true})}}},_hidePending:function(){this.navigatorContent.removeClass("pending")},_isInitialRender:function(){return !this.navigatorContent.find(".split-view").length},_makeVisible:function(){this.navigatorContent.removeClass("pending");if(this._isInitialRender()){this.navigatorContent.html(this.$el)}this.$el.find(".list-results-panel").sidebar({id:"splitview",minWidth:function(b){return 250},maxWidth:_.bind(function(){return this.$el.width()-500},this),resize:this.applyResponsiveDesign});jQuery(window).on("resize",this.applyResponsiveDesign);JIRA.trigger(JIRA.Events.LAYOUT_RENDERED);this.applyResponsiveDesign()},_updateSidebarPosition:function(){var b=this.$el.find(".list-results-panel");b.sidebar("updatePosition")},applyResponsiveDesign:function(){this.$el.toggleClass("skinny",this.detailsView.$el.width()<900);this.$el.toggleClass("very-skinny",this.detailsView.$el.width()<600)},nextIssue:function(){this.searchResults.selectNextIssue({replace:true})},_onHighlightedIssueChange:function(c,b){b=_.defaults({},b,{replace:true});var d=this.searchResults.getHighlightedIssue().getId();this.searchResults.selectIssueById(d,b)},_onIssueDeleted:function(b){this.listView.getIssueById(b.id).hide();this._showPending();if(this.searchResults.hasIssues()){this.listView.render()}else{this._renderEmptyResults()}},_onIssueLoadError:function(b){if(b.response.status===404){this.listView.markIssueInaccessible(b.issueId)}},_onSearchFail:function(){this._renderEmptyResults();this._hidePending()},_onSelectedIssueChange:function(){this._setIssueModuleContainer()},_onStartIndexChange:function(){if(this.searchResults.hasIssues()){this._showPending()}},prevIssue:function(){this.searchResults.selectPrevIssue({replace:true})},render:function(){var c=this.searchResults.hasIssues(),b=this._isInitialRender();jQuery("body").addClass("page-type-split");if(this._isIOS()){this._activateIOSSpecificBehaviour()}if(c){this._handleInitialIssueSelection();this.navigatorContent.removeClass("empty-results");if(b){this.$el.children().detach();this.$el.html(JIRA.Templates.SplitView.structure())}this._activateSubviews();this.detailsView.render();this.listView.render()}else{this._hidePending();this._renderEmptyResults()}this._adjustNoResultsMessageHeight();this.orderBy.render();return this},_renderEmptyResults:function(){this.emptyResultsView.render()},_setIssueModuleContainer:function(){JIRA.Issues.Application.execute("issueEditor:setContainer",this.$(".split-view .detail-panel > div"))},_showPending:function(){this.navigatorContent.addClass("pending")},_activateSubviews:function(){this.detailsView.setElement(this.$(".detail-panel")).activate();this.orderBy.setElement(this.$(".list-ordering"));this.listView.setElement(this.$(".list-content"));this.listView.paginationView.setElement(this.$(".pagination-view"));this.listView.paginationView.setEndOfStableSearchMessage(this.$(".end-of-stable-message"));this._setIssueModuleContainer()},handleLeft:function(){this.detailsView.blur()},handleRight:function(){this.detailsView.focus()},isIssueViewActive:function(){return this.detailsView.hasFocus()},_isIOS:function(){var b=navigator.platform;return b==="iPod"||b==="iPhone"||b==="iPad"},_activateIOSSpecificBehaviour:function(){jQuery(document).on("touchmove.iOSSpecific",function(b){b.preventDefault()});jQuery("body").on("touchstart.iOSSpecific",".issue-container, .list-panel",function(b){if(b.currentTarget.scrollTop===0){b.currentTarget.scrollTop=1}else{if(b.currentTarget.scrollHeight===b.currentTarget.scrollTop+b.currentTarget.offsetHeight){b.currentTarget.scrollTop-=1}}});jQuery("body").on("touchmove.iOSSpecific",".issue-container, .list-panel",function(b){b.stopPropagation()})},_deactivateIOSSpecificBehaviour:function(){jQuery(document).off("touchmove.iOSSpecific");jQuery("body").off("touchstart.iOSSpecific");jQuery("body").off("touchmove.iOSSpecific")}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/FullScreenLayout.js' */
Backbone.define("JIRA.Issues.FullScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(a,b){_.extend(this,b);this.$searchContainer=b.searchContainer;this.$navigatorContent=this.$searchContainer.find(".navigator-content");this.searchResults=this.search.getResults();this.columnConfig=b.columnConfig;this.issueTableView=new JIRA.Issues.IssueTableView({el:this.$navigatorContent,search:this.search,searchResults:this.searchResults,columnConfig:this.columnConfig});this.addListener(this.search,"beforeSearch",this._onBeforeSearch,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"selectedIssueChange",this.handleIssueSelectionChanged,this);this.addListener(this.searchResults,"issueUpdated",this.handleIssueUpdated,this);JIRA.Issues.Application.on("issueEditor:loadError",this.handleIssueLoadError,this)},handleIssueUpdated:function(c,a,b){if(b.action!=="inlineEdit"&&b.action!=="rowUpdate"){return this.fullScreenIssue.updateIssue(b)}},deactivate:function(){JIRA.Issues.Application.off("issueEditor:loadError",this.handleIssueLoadError,this);this.$navigatorContent.addClass("pending");this.fullScreenIssue.deactivate();this.issueTableView.deactivate();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},handleIssueSelectionChanged:function(a,b){if(a.hasIssue()){this.handleSelectedIssue(a,b)}else{this.handleIssueUnselected()}},render:function(){if(!this.searchResults.hasSelectedIssue()){this.fullScreenIssue.hide();this.issueTableView.render().done(_.bind(function(){this.$navigatorContent.removeClass("pending");JIRA.trigger(JIRA.Events.LAYOUT_RENDERED,["list-view"])},this))}return this},handleIssueLoadError:function(a){if(a.response.status===404){this.issueTableView.handleIssueInaccessible(a.issueId)}if(!this.fullScreenIssue.isVisible()){this.searchResults.selectIssueByKey(null)}this.fullScreenIssue.showError(a)},handleIssueUnselected:function(){if(this.fullScreenIssue.isVisible()){this.fullScreenIssue.hide();JIRA.trace("jira.returned.to.search");JIRA.trace("jira.psycho.returned.to.search");JIRA.Issues.Application.execute("analytics:trigger","kickass.returntosearch")}this.$navigatorContent.removeClass("pending");this.issueTableView.show()},_loadIssue:function(a){this.fullScreenIssue.show({id:a.getId(),key:a.getKey(),pager:this.searchResults.getPager()})},handleSelectedIssue:function(a,b){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.Utils.debounce(this,"_loadIssue",a);this.fullScreenIssue.updatePager(this.searchResults.getPager())},_onBeforeSearch:function(){this.$navigatorContent.addClass("pending")},nextIssue:function(){this.searchResults.highlightNextIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectNextIssue()}},prevIssue:function(){this.searchResults.highlightPrevIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectPrevIssue()}},returnToSearch:function(){this.searchResults.unselectIssue()},searchIsVisible:function(){return this.searchContainer.closest("body").length>0},handleLeft:function(){},handleRight:function(){},isIssueViewActive:function(){return this.fullScreenIssue.isVisible()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchResults.js' */
(function(a){Backbone.define("JIRA.Issues.SearchResults",JIRA.Issues.BaseModel.extend({defaults:{issueIds:[],selectedIssue:new JIRA.Issues.SimpleIssue(),highlightedIssue:new JIRA.Issues.SimpleIssue(),total:0},properties:["columnSortJql","highlightedIssue","issueIds","issueIdsForPage","jiraHasIssues","pageSize","resultsId","selectedIssue","startIndex","sortBy","columns","table","total","initialPayload","columnConfig"],namedEvents:["prevIssueSelected","nextIssueSelected","issueUpdated","issueDeleted","issueDoesNotExist","stableUpdate"],initialize:function(b,c){JIRA.Issues.ModelUtils.makeTransactional(this,"resetFromSearch","selectNextIssue","selectPrevIssue");this.issueUpdateCallbacks=[];this._issueSearchManager=c.issueSearchManager;this._initialHighlightedIssueId=c.initialHighlightedIssueId;this._initialSelectedIssue=c.initialSelectedIssue;this._columnConfig=c.columnConfig},getStartIndexForPage:function(b){return b*this.getPageSize()},hasIssue:function(b){return _.indexOf(this.getIssueIds(),b)!==-1},getPager:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var e=this.getIssueIds();var f=this.getSelectedIssue().getId();var c=_.indexOf(e,f);var g=this.getTotal();var h=e.length;var d={position:JIRA.NumberFormatter.format(c+1),resultCount:JIRA.NumberFormatter.format(g)};if(c>0){var i=this._getPrevIssueId(f);if(i){d.previousIssue={id:i,key:this._getIssueKeyForId(i)}}}if(c<g-1&&c<h-1){var b=this._getNextIssueId(f);if(b){d.nextIssue={id:b,key:this._getIssueKeyForId(b)}}}return d}},getNumberOfPages:function(){return this._getPageNumberForStartIndex(this.getDisplayableTotal()-1)},removeIssue:function(e){e=parseInt(e,10);var d=this.getIssueIds()[0]===e,c=this.getHighlightedIssue().getId()===e,b=_.last(this.getIssueIds())===e;if(c){if(!b){this.highlightNextIssue({replace:true})}else{if(!d){this.highlightPrevIssue({replace:true})}}}this.setIssueIds(_.without(this.getIssueIds(),e));this.setTotal(this.getTotal()-1);this.triggerIssueDeleted({id:e,key:this._getIssueKeyForId(e)})},isFirstIssueHighlighted:function(){if(!this.hasHighlightedIssue()){return false}return this.getHighlightedIssue().getId()===this.getIssueIds()[0]},updateIssueById:function(c,b){return this.updateIssue(c,b)},updateIssue:function(f,b){var d=f.action===JIRA.Issues.Actions.DELETE,e=f.id,c=[];b=_.defaults({},b,{showMessage:true,filter:null});if(d){this.removeIssue(e);b.showMessage&&this._notifyOfIssueUpdate(f);return jQuery.Deferred().resolve().promise()}else{return this.getResultForId(e,b.filter).done(_.bind(function(g){_.each(this.issueUpdateCallbacks,function(i){var h=i.handler.call(i.ctx||window,e,g,f);if(h&&h.promise){c.push(h)}});a.when(c).done(_.bind(function(){b.showMessage&&this._notifyOfIssueUpdate(f)},this))},this))}},_notifyOfIssueUpdate:function(b){b.message&&JIRA.Issues.showNotification(b.message,b.key);JIRA.trace("jira.search.stable.update")},getResultForId:function(d,c){var b={columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()};if(c&&!c.getIsSystem()){b=_.extend({filterId:c.getId()},b)}return this._issueSearchManager.getRowsForIds([d],b)},isHighlightedIssueAccessible:function(){if(!this.hasHighlightedIssue()){return null}return !this._issueSearchManager.issueKeys.hasError(this.getHighlightedIssue().getId())},getDisplayableTotal:function(){return this.getIssueIds().length},selectIssueByKey:function(c,b){if(!c){this.unselectIssue();return}var d=this._getIssueIdForKey(c);if(!d||d==-1){this._unhighlightIssue();this.getSelectedIssue().set({id:-1,key:c});this.triggerIssueDoesNotExist()}else{this._selectExistingIssueById(d,b)}},_unhighlightIssue:function(){this.getHighlightedIssue().set({id:null,key:null})},selectFirstInPage:function(b){this.selectIssueById(this.getIssueIds()[this.getStartIndex()],b)},getPrevPageStartIndex:function(){var b=(this.getStartIndex()||0)-this.getPageSize();return(b<0)?null:b},getNextPageStartIndex:function(){var b=this.getPositionOfLastIssueInPage();return(b>=this.getDisplayableTotal())?null:b},getPositionOfLastIssueInPage:function(){var c=this.getStartIndex();var b=this._pageSize();return Math.min(c+b,this.getDisplayableTotal())},highlightFirstInPage:function(){this.highlightIssueById(this.getIssueIds()[this.getStartIndex()])},selectIssueById:function(c,b){if(!c){this.unselectIssue()}else{this._selectExistingIssueById(c,b)}},_selectExistingIssueById:function(c,b){if(c!==this.getSelectedIssue().getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c=c?parseInt(c,10):null;this.getSelectedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this._postSelectionToServer(c)}this.highlightIssueById(c)}},_postSelectionToServer:function(d){var b=_.indexOf(this.getIssueIds(),d),c=this.getIssueIds[b+1];AJS.$.get(contextPath+"/secure/SetSelectedIssue.jspa",{atl_token:atl_token(),selectedIssueId:d,selectedIssueIndex:b,nextIssueId:c},function(){JIRA.trace("jira.search.set.selected.issue.complete")})},highlightIssueById:function(c,b){b=_.defaults({},b,{replace:false});if(c&&c!==this.getHighlightedIssue().getId()){c=c?parseInt(c,10):null;this.getHighlightedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(c){this.setStartIndex(this._getStartIndexForIssueId(c))}if(JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this._postSelectionToServer(c)}}},getState:function(){return{selectedIssueKey:this.getSelectedIssue().getKey(),startIndex:this.getStartIndex()}},resetFromSearch:function(b){b.resultsId=_.uniqueId();this.getSelectedIssue().set({id:null,key:null});this.set({sortBy:null});this.set(_.pick(b,this.properties));if(typeof b.selectedIssueKey==="string"){this.selectIssueByKey(b.selectedIssueKey)}else{if(this.isIssueOnPage(this._initialHighlightedIssueId)){this.highlightIssueById(this._initialHighlightedIssueId)}else{if(this.hasIssues()){this.highlightFirstInPage()}else{this.getHighlightedIssue().set({id:null,key:null})}}}this._initialHighlightedIssueId=null},hasIssues:function(){return !!this.getIssueIds().length},isIssueOnPage:function(b){return _.indexOf(this.getPageIssueIds(),b)!==-1},isFirstIssueSelected:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var c=this.getIssueIds();var d=this.getSelectedIssue().getId();var b=_.indexOf(c,d);return b===0}return false},getResultsForPage:function(c){if(this.getTable()){var b=this.getTable();this.setTable(null);_.defer(function(){JIRA.trace("jira.search.finished")});return a.Deferred().resolve(b).promise()}return this.getResultsForIds(this.getPageIssueIds(),c)},getResultsForIds:function(e,d){var b=this;var c=a.Deferred();this._issueSearchManager.getRowsForIds(e,d).done(function(f){b.setColumnConfig(f.columnConfig);b.setColumns(f.columns);b.setColumnSortJql(f.columnSortJql);c.resolve(f.table)}).fail(c.fail).always(function(){_.defer(function(){JIRA.trace("jira.search.finished")})});return c},applyState:function(b){this.set(_.pick(b,this.properties))},unselectIssue:function(b){var c=this.getSelectedIssue();if(c.getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c.set({id:null,key:null},b)}},hasSelectedIssue:function(){return !!this.getSelectedIssue().getId()},hasHighlightedIssue:function(){return !!this.getHighlightedIssue().getId()},getPageIssueIds:function(){var d=this.getStartIndex();var c=this._pageSize();var b=this.getIssueIds();return b?b.slice(d,Math.min(d+c,b.length)):[]},getPageIssues:function(){return _.map(this.getPageIssueIds(),function(b){return{id:b,key:this._getIssueKeyForId(b)}},this)},getPageNumber:function(){return Math.floor(this.getStartIndex()/this._pageSize())},getPositionOfIssueInPage:function(b){return this.getPositionOfIssueInSearchResults(b)%this._pageSize()},getPositionOfIssueInSearchResults:function(b){return _.indexOf(this.getIssueIds(),b)},selectNextIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getSelectedIssue().getId());this._triggerNextIssueSelectedEvent(c);return this._selectIssue(c,b)},selectPrevIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getSelectedIssue().getId());this._triggerPrevIssueSelectedEvent(c);return this._selectIssue(c,b)},_selectIssue:function(c,b){this.selectIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightNextIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightPrevIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},goToPage:function(d,c){c=_.defaults({},c,{replace:false});if(d===null||d===this.getStartIndex()){return a.Deferred().resolve().promise()}var b=this.getIssueIds()[d];this.highlightIssueById(b,c);return a.Deferred().resolve(b).promise()},onHighlightedIssueChange:function(c,b){this.getHighlightedIssue().on("change",c,b)},offHighlightedIssueChange:function(c,b){this.getHighlightedIssue().off("change",c,b)},onSelectedIssueChange:function(c,b){this.getSelectedIssue().on("change",c,b)},offSelectedIssueChange:function(c,b){this.getSelectedIssue().off("change",c,b)},onColumnConfigChange:function(c,b){this.on("change:columnConfig",c,b)},offColumnConfigChange:function(c,b){this.off("change:columnConfig",c,b)},onColumnsChange:function(c,b){this.on("change:columns",c,b)},offColumnsChange:function(c,b){this.off("change:columns",c,b)},onStartIndexChange:function(c,b){this.on("change:startIndex",c,b)},onNewIssueIds:function(c,b){this.on("change:issueIds",c,b)},offNewIssueIds:function(c,b){this.off("change:issueIds",c,b)},offStartIndexChange:function(c,b){this.off("change:startIndex",c,b)},onNewPayload:function(c,b){this.on("change:resultsId",c,b)},offNewPayload:function(c,b){this.off("change:resultsId",c,b)},onIssueUpdated:function(c,b){this.issueUpdateCallbacks.push({handler:c,ctx:b})},offIssueUpdated:function(c){var b=[];this.issueUpdateCallbacks=_.each(this.issueUpdateCallbacks,function(d){if(d.handler!==c){b.push(d)}});this.issueUpdateCallbacks=b},_getNextIssueId:function(c){var b=this.getIssueIds();return b[Math.min(_.indexOf(b,c)+1,this.getDisplayableTotal()-1)]},getNextIssueForId:function(c){var b=this._getNextIssueId(c);return{id:b,key:this._getIssueKeyForId(b)}},getNextIssueForSelectedIssue:function(){return this.getNextIssueForId(this.getSelectedIssue().getId())},_getPrevIssueId:function(c){var b=this.getIssueIds();return b[Math.max(0,_.indexOf(this.getIssueIds(),c)-1)]},_getStartIndexForIssueId:function(d){var c=_.indexOf(this.getIssueIds(),d),b=this._pageSize();return Math.max(0,Math.floor(c/b)*b)},_getIssueIdForKey:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.key){return this._initialSelectedIssue.id}return this._getIssueKeysToIds()[b]},_getIssueKeyForId:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.id){return this._initialSelectedIssue.key}return this._getIssueIdsToKeys()[b]},_getIssueIdsToKeys:function(){return this._issueSearchManager.issueKeys.getAllCached()},_getIssueKeysToIds:function(){var b={};var c=this._issueSearchManager.issueKeys.getAllCached();_.each(c,function(e,d){b[e]=d});return b},_getPageNumberForStartIndex:function(b){return Math.floor(b/this._pageSize())},_pageSize:function(){return this.getPageSize()},_triggerPrevIssueSelectedEvent:function(c){if(c!==this.getSelectedIssue().getId()){var b=this._getPrevIssueId(c);this.trigger("prevIssueSelected",{prevIssue:{id:c,key:this._getIssueKeyForId(c)},prevPrevIssue:{id:b,key:this._getIssueKeyForId(b)}})}},_triggerNextIssueSelectedEvent:function(b){if(b!==this.getSelectedIssue().getId()){var c=this._getNextIssueId(b);this.trigger("nextIssueSelected",{nextIssue:{id:b,key:this._getIssueKeyForId(b)},nextNextIssue:{id:c,key:this._getIssueKeyForId(c)}})}}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchModule.js' */
Backbone.define("JIRA.Issues.SearchModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._issueSearchManager=a.issueSearchManager;this._searchPageModule=a.searchPageModule;this._searchResults=new JIRA.Issues.SearchResults(null,{issueSearchManager:this._issueSearchManager,initialHighlightedIssueId:a.initialHighlightedIssueId,initialSelectedIssue:a.initialSelectedIssue,columnConfig:this._searchPageModule.columnConfig})},doSort:function(a){if(a){this._searchPageModule.update({jql:a,startIndex:null,selectedIssueKey:null},true)}},getFilterId:function(){var a=this._searchPageModule.getFilter();return a&&a.getId()},getJql:function(){return this._searchPageModule.getJql()},getEffectiveJql:function(){return this._searchPageModule.getEffectiveJql()},getResults:function(){return this._searchResults},getState:function(){return this._searchPageModule.getState()},isStandAloneIssue:function(a){a=a||this._searchPageModule.getState();return !!a.selectedIssueKey&&!_.isString(a.jql)&&!a.filter},onBeforeSearch:function(b,a){this._issueSearchManager.bindBeforeSearch(b,a)},offBeforeSearch:function(b,a){this._issueSearchManager.unbindBeforeSearch(b,a)},onSearchError:function(b,a){this._issueSearchManager.bindSearchError(b,a)},offSearchError:function(b,a){this._issueSearchManager.unbindSearchError(b,a)},refresh:function(){return this._searchPageModule.refreshSearch()},stableUpdate:function(a){this._searchResults.triggerStableUpdate(_.extend({force:true},a))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/IssueAPI.js' */
JIRA.Issues.IssueAPI=(function(){var a;var b={getIssueId:function(){return JIRA.Issues.Api.getSelectedIssueId()},getIssueKey:function(){return JIRA.Issues.Api.getSelectedIssueKey()}};return{override:function(c){c=_.defaults({},c,{target:JIRA.Issue});a=c.searchPageModule;_.extend(c.target,b)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/IssuesApi.js' */
JIRA.Issues.Api=(function(){var a;return{initialize:function(b){a=b.searchPageModule},editFieldOnSelectedIssue:function(c){var b=JIRA.Issues.Api.getFieldsOnSelectedIssue(),d=b&&b.get(c),e=d&&d.isEditable();if(e&&a){JIRA.Issues.Application.execute("issueEditor:editField",d)}return e},focusSearch:function(){AJS.$(".criteria-selector:first, #advanced-search").focus().select()},getSelectedIssue:function(){return a.getEffectiveIssue()},getSelectedIssueId:function(){return a.getEffectiveIssueId()},getSelectedIssueKey:function(){return a.getEffectiveIssueKey()},getFieldsOnSelectedIssue:function(){var b=JIRA.Issues.Application.request("issueEditor:fields");return b.length?b:undefined},hasSavesInProgress:function(){return JIRA.Issues.Application.request("issueEditor:hasSavesInProgress")},isCurrentlyLoadingIssue:function(){return a.isCurrentlyLoadingIssue()},isSelectedIssueAccessible:function(){return a.isHighlightedIssueAccessible()},issueIsVisible:function(){return a.isIssueVisible()},nextIssue:function(){a.nextIssue()},openFocusShifter:function(){if(a.isIssueVisible()){a.openFocusShifter()}},prevIssue:function(){a.prevIssue()},refreshSelectedIssue:function(b){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)},returnToSearch:function(b){a.returnToSearch({ignoreDirtiness:b})},showInlineIssueLoadError:function(b){a.showInlineIssueLoadError(b)},switchLayouts:function(c){var b=-1,d=a.getCurrentLayout(),f=a.getSortedLayouts(),e;_.find(f,function(h,g){if(d instanceof h.view){b=g;return true}});e=f[(b+1)%f.length];a.changeLayout(e.id,c)},isQueryValid:function(){return a.queryModule.isQueryValid()},isFullScreenIssueVisible:function(){return a.isFullScreenIssueVisible()},viewSelectedIssue:function(){if(!JIRA.Issues.Api.isSelectedIssueAccessible()){return}var b=JIRA.Issues.Api.getSelectedIssueKey();if(!a.isIssueVisible()){a.update({selectedIssueKey:b})}},toggleFilterPanel:function(){a.toggleFilterPanel()},waitForSavesToComplete:function(){var b=jQuery.Deferred();window.setTimeout(function(){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}else{JIRA.bind(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE,function(c){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}})}},10)},updateIssue:function(b,c){c=c||"thanks_issue_updated";return a.updateIssue({key:b.key,id:b.id,action:JIRA.Issues.Actions.UPDATE,message:c,meta:{}})}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/LayoutPreferenceManager.js' */
JIRA.Issues.LayoutPreferenceManager={PREFERRED_LAYOUT_KEY:"jira.issues.preferred.layout.key",getPreferredLayoutKey:function(){return AJS.Meta.get(this.PREFERRED_LAYOUT_KEY)},setPreferredLayoutKey:function(b,a){a=_.defaults({},a,{ajax:true});AJS.Meta.set(this.PREFERRED_LAYOUT_KEY,b);a.ajax&&AJS.$.ajax({data:{layoutKey:b},type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/latest/preferredSearchLayout"})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/SearchPageModule.js' */
Backbone.define("JIRA.Issues.SearchPageModule",JIRA.Issues.BaseModel.extend({namedEvents:["changeFilterProps"],properties:["currentLayout","layouts","filter","jql","searchId"],defaults:function(){return{filter:null,jql:null}},initialize:function(a,b){_.extend(this,b);this.registerColumnPicker();this.setLayouts({});this.registerLayout("list-view",{label:"List View",iconClass:"icon-view-list",view:JIRA.Issues.FullScreenLayout});this.registerLayout("split-view",{label:"Detail View",iconClass:"icon-view-split",view:JIRA.Issues.SplitScreenLayout});this._onFilterChanged();this.on("change:filter",this._onFilterChanged,this);JIRA.Issues.Application.on("issueEditor:close",this.returnToSearch,this);JIRA.Issues.Application.on("issueEditor:loadComplete",function(c,d){if(!this.standalone&&!d.reason){this.searchResults.selectIssueById(c.getId(),{reason:"issueLoaded"});this.searchResults.updateIssueById({id:c.getId(),action:"rowUpdate"},{filter:this.getFilter()});if(c.getKey()){var e=this._getUpdateState({selectedIssueKey:c.getKey()});if(this._validateNavigate(e)){this.issueNavRouter.replaceState(e)}}}},this);JIRA.Issues.Application.on("issueEditor:saveSuccess",function(c){this.searchResults.updateIssueById({id:c.issueId,action:"inlineEdit"},{filter:this.getFilter()})},this)},registerColumnPicker:function(){this.columnConfig=JIRA.Issues.ColumnPicker.create({search:this})},getInactiveLayouts:function(){var a=[];_.each(this.getLayouts(),function(c,b){if(b!==JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()){a.push(c)}},this);return a},getActiveLayout:function(){return this.getLayouts()[JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()]},changeLayout:function(c,b){var d=this.getLayout(c),e,a=this.getCurrentLayout();JIRA.Issues.changingLayout=true;jQuery("body, html").scrollTop(0);b=_.defaults({},b,{ajax:true,render:true});if(d){if(a instanceof d.view){return}if(a&&a.deactivate){a.deactivate();this.searchResults.unselectIssue({replace:true})}JIRA.Issues.LayoutPreferenceManager.setPreferredLayoutKey(c,b);e=new d.view({},{fullScreenIssue:this.fullScreenIssue,issueContainer:this.issueContainer,issueCacheManager:this.issueCacheManager,search:this.search,searchContainer:this.searchContainer,searchHeaderModule:this.searchHeaderModule,columnConfig:this.columnConfig});b.render&&e.render();this.setCurrentLayout(e);this.standalone=false}},createLayout:function(){if(!this.getCurrentLayout()){this.changeLayout(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey(),{render:false});this.fullScreenIssue.deactivate()}},_onFilterChanged:function(){var a=this.previous("filter");if(a){a.off("change",this.triggerChangeFilterProps,this)}var b=this.getFilter();if(b){b.on("change",this.triggerChangeFilterProps,this)}},getLayout:function(a){return this.getLayouts()[a]||null},getSortedLayouts:function(){return _.sortBy(this.getLayouts(),"label")},registerLayout:function(a,b){b.id=a;this.getLayouts()[a]=b},getJqlDeferred:function(){var b=jQuery.Deferred();var a=this;_.defer(function(){a.queryModule.searchersReady().always(function(){_.defer(function(){b.resolve(a.getEffectiveJql())})})});return b.promise()},registerIssueSearchManager:function(a){this.issueSearchManager=a},registerIssueCacheManager:function(a){this.issueCacheManager=a},registerQueryModule:function(a){this.queryModule=a;this.queryModule.onJqlChanged(this.queryModuleSearchRequested,this);this.queryModule.onJqlError(this.disableLayoutSwitcher,this);this.queryModule.onJqlSuccess(this.enableLayoutSwitcher,this);this.queryModule.onVerticalResize(JIRA.Issues.triggerVerticalResize);this.queryModule.onQueryTooComplexSwitchToAdvanced(function(){JIRA.Issues.Application.execute("analytics:trigger","kickass.queryTooComplexSwitchToAdvanced")});this.queryModule.onBasicModeCriteriaCountWhenSearching(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.basicModeCriteriaCountWhenSearching",b)});this.queryModule.onChangedPreferredSearchMode(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.switchto"+b)});JIRA.Shifter.register(JIRA.Issues.SearchShifter({isBasicMode:_.bind(this.queryModule.isBasicMode,this.queryModule),isFullScreenIssue:_.bind(this.isFullScreenIssueVisible,this),searcherCollection:this.queryModule.getSearcherCollection()}))},disableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.disableLayoutSwitcher()}},enableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.enableLayoutSwitcher()}},registerLayoutSwitcher:function(a){this.layoutSwitcher=a},registerFilterModule:function(a){if(this.filterModule){this.filterModule.off("filterRemoved");this.filterModule.off("filterSelected")}this.filterModule=a;this.filterModule.on("filterRemoved",function(c){var b=this.getFilter();if(b&&c.filterId===b.getId()){this.resetToBlank()}},this);this.filterModule.on("filterSelected",function(b){this.resetToFilter(b.filterId)},this)},registerSearch:function(b){this.search=b;this.searchResults=this.search.getResults();this.searchResults.onStartIndexChange(this._handleSearchResultsChange,this);this.searchResults.onSelectedIssueChange(this._handleSearchResultsChange,this);var a=this.columnConfig;this.on("change:filter",function(){a.clearFilterConfiguration()});this.searchResults.onColumnsChange(function(c){var d=c.getColumnConfig();if(d){a.syncColumns(d,c.getColumns())}});this.searchResults.onColumnConfigChange(function(c){var d=c.getColumnConfig();if(d){a.setCurrentColumnConfig(d);a.syncColumns(d,c.getColumns())}});a.onColumnsSync(function(c){b.stableUpdate({columnConfig:c})});this.searchResults.onSelectedIssueChange(_.bind(function(c){if(!c.hasIssue()){JIRA.Issues.Application.execute("issueEditor:removeIssueMetadata")}},this))},_handleSearchResultsChange:function(b,a){a=a||{};a.replace?this.issueNavRouter.replaceState(this.getState()):this.issueNavRouter.pushState(this.getState())},registerSearchHeaderModule:function(a){this.searchHeaderModule=a},registerFullScreenIssue:function(a){this.fullScreenIssue=a;this.fullScreenIssue.bindIssueHidden(function(){JIRA.Issues.Application.execute("issueEditor:dismiss");this.searchHeaderModule.handleIssueSearchAppeared()},this)},registerViewContainers:function(a){this.issueContainer=a.issueContainer;this.searchContainer=a.searchContainer},registerIssueNavRouter:function(a){this.issueNavRouter=a},prevIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().prevIssue();return true}return false},nextIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().nextIssue();return true}return false},isCurrentlyLoadingIssue:function(){return JIRA.Issues.Application.request("issueEditor:isCurrentlyLoading")},_overlayIsVisible:function(){return AJS.$(".aui-blanket:visible").length>0},getEffectiveIssueId:function(a){return this.getEffectiveIssue().getId()},updateIssue:function(c){var b=c.action===JIRA.Issues.Actions.DELETE,a=this.fullScreenIssue.isVisible();if(b){return this._deleteIssue(c)}else{if(a){return this.fullScreenIssue.updateIssue(c).done(_.bind(function(){!this.standalone&&this.searchResults.updateIssue(c,{showMessage:false,filter:this.getFilter()})},this))}else{return this.searchResults.updateIssue(c,{filter:this.getFilter()})}}},_deleteIssue:function(c){var a=this.fullScreenIssue.isVisible(),b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(!a){return this.searchResults.updateIssue(c)}else{if(!b){return this.fullScreenIssue.updateIssue(c)}else{if(this.standalone){this.resetToBlank();JIRA.Issues.showNotification(c.message,c.key);return jQuery.Deferred().resolve().promise()}else{this.returnToSearch();return this.searchResults.updateIssue(c)}}}},getEffectiveIssueKey:function(){return this.getEffectiveIssue().getKey()},getEffectiveIssue:function(){var b=this.searchResults.hasHighlightedIssue(),c=this.searchResults.hasSelectedIssue(),a;a=new JIRA.Issues.SimpleIssue({id:JIRA.Issues.Application.request("issueEditor:getIssueId"),key:JIRA.Issues.Application.request("issueEditor:getIssueKey")});if(this.standalone){return a}else{if(c){return this.searchResults.getSelectedIssue()}else{if(b){return this.searchResults.getHighlightedIssue()}else{return a}}}},isHighlightedIssueAccessible:function(){return this.search.getResults().isHighlightedIssueAccessible()},returnToSearch:function(){if(this.standalone){this.resetToBlank();JIRA.trace("jira.returned.to.search")}else{if(this.fullScreenIssue.isVisible()){this.searchResults.unselectIssue();JIRA.Issues.Application.execute("issueEditor:beforeHide");if(this.queryModule.refreshLayout){this.queryModule.refreshLayout()}}else{JIRA.trace("jira.returned.to.search")}}jQuery.event.trigger("updateOffsets.popout")},toggleFilterPanel:function(){return this.filterModule.toggleFilterPanel()},issueTableSortRequested:function(a,b){this.update({jql:a,startIndex:b})},issueTableSearchError:function(a){if(a.status!==0){this.searchHeaderModule.handleJqlError();var c;try{c=JSON.parse(a.responseText)}catch(b){c={errorMessages:["Error occurred communicating with the server. Please reload the page and try again."]}}this.queryModule.onSearchError(c)}},issueTableSearchSuccess:function(a){this.update({startIndex:a.startIndex});this.searchHeaderModule.handleJqlSuccess();this.queryModule.onSearchSuccess(a.warnings)},issueTableStableUpdate:function(a){this.update({startIndex:a})},confirmNavigation:function(a){a=_.defaults({},a,{confirm:function(c){return window.confirm(c)},ignoreDirtiness:false});var b=JIRA.DirtyForm.getDirtyWarning()||JIRA.Issue.getDirtyCommentWarning();return !!a.ignoreDirtiness||b===undefined||a.confirm(b)},isFullScreenIssueVisible:function(){return this.fullScreenIssue&&this.fullScreenIssue.isVisible()},isIssueVisible:function(){var a=JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey();if(this.isFullScreenIssueVisible()){return true}else{if(a==="list-view"){return this.fullScreenIssue.isVisible()}else{if(a==="split-view"){return this.search.getResults().hasIssues()}}}return false},queryModuleSearchRequested:function(a){this.update({jql:a,startIndex:0,selectedIssueKey:null,searchId:_.uniqueId()})},filterModuleSaved:function(b,a){if(a){this.reset({filter:b.getId()})}if(b.getFavourite()){this.filterModule.addFavouriteFilter(b)}},discardFilterChanges:function(){this.update({jql:null,selectedIssueKey:null},true)},getState:function(){var a=this.getFilter();var b={filter:a&&a.getId(),filterJql:a&&a.getJql(),jql:this.getJql()};if(this.standalone){b.selectedIssueKey=JIRA.Issues.Application.request("issueEditor:getIssueKey")}else{_.extend(b,this.search.getResults().getState())}return b},_doSearch:function(a){a=a||{};var b={};var d;var c=this.getFilter();b.startIndex=a.startIndex;if(c){b.filterId=c.getId()}if(a.columnConfig){b.columnConfig=a.columnConfig}b.jql=this.getEffectiveJql();d=this.issueSearchManager.search(b);d.done(_.bind(function(e){if(this.fullScreenIssue.isVisible()&&!AJS.Meta.get("serverRenderedViewIssue")){JIRA.Issues.Application.execute("issueEditor:beforeHide")}this.searchResults.resetFromSearch(_.extend(a,e.issueTable));this.queryModule.onSearchSuccess(e.warnings);jQuery.event.trigger("updateOffsets.popout")},this)).fail(_.bind(function(e){if(e.statusText!=="abort"){if(e.status==400&&a.selectedIssueKey){this.reset({selectedIssueKey:a.selectedIssueKey},{replace:true})}else{this.searchResults.resetFromSearch(_.extend(_.pick(a,"selectedIssueKey"),this.searchResults.defaults));this.issueTableSearchError(e)}}},this));return d},_applyState:function(d,g,c){c=c||{};var f=_.extend(this.toJSON(),this.search.getResults().toJSON());var b=_.pick(d,this.properties);this.set(b);var e=_.extend(this.toJSON(),d);if(g){var a=(d.filter&&d.jql==null)?d.filter.getJql():d.jql;this.queryModule.resetToQuery(a,{focusQuery:c.isNewSearch}).always(_.bind(function(){this.queryModule.setVisible(!d.filter||d.filter.getIsValid())},this))}if(this.shouldPerformNewSearch(f,e)){var h=this._doSearch(e)}else{var h=jQuery.Deferred().resolve();if("selectedIssueKey" in d){this.searchResults.selectIssueByKey(d.selectedIssueKey)}if("startIndex" in d&&!d.selectedIssueKey){this.searchResults.goToPage(d.startIndex)}}this._showIntroDialogs(h)},shouldPerformNewSearch:function(f,e){var g=f.filter&&f.filter.getId();var a=e.filter&&e.filter.getId();var c=g!==a;var d=e.jql!==f.jql;var b=e.searchId!==f.searchId;return c||d||b},refreshSearch:function(){return this._doSearch(_.extend({},this.getState(),{selectedIssueKey:undefined}))},_navigateToState:function(b,c,a){a=a||{};if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){this.queryModule.queryChanged();AJS.InlineLayer.current&&AJS.InlineLayer.current.hide();return null}if(this._validateNavigate(b)){a.replace?this.issueNavRouter.replaceState(b):this.issueNavRouter.pushState(b)}if(this.search.isStandAloneIssue(b)){this.resetToStandaloneIssue(b)}else{return this.applyState(b,c,a)}},_validateNavigate:function(b){var a=JIRA.Issues.URLSerializer.getURLFromState;return a(b)!==a(this.getState())},_getUpdateState:function(a){return _.extend({},this.getState(),a)},update:function(b,c,a){this._navigateToState(this._getUpdateState(b),c,a)},reset:function(c,b){var a=_.extend({},this.defaults(),c);a.searchId=_.uniqueId();this._navigateToState(a,true,b)},_deactivateCurrentLayout:function(){var a=this.getCurrentLayout();if(a){a.deactivate&&a.deactivate();this.setCurrentLayout(null)}},resetToStandaloneIssue:function(a){this._deactivateCurrentLayout();this.set(this.defaults());this.standalone=true;this.fullScreenIssue.show({key:a.selectedIssueKey,viewIssueQuery:a.viewIssueQuery})},applyState:function(d,f,c){var b,a=d.filter&&!(d.filter instanceof JIRA.Issues.FilterModel),e=this.initSystemFilters();JIRA.Issues.Application.execute("issueEditor:abortPending");this.createLayout();if(a){b=jQuery.Deferred();e.always(_.bind(function(){this.filterModule.getFilterById(d.filter).always(function(g){d.filter=g;b.resolve()})},this))}jQuery.when(b,e).always(_.bind(function(){this._applyState(d,f,c)},this))},updateFromRouter:function(a){if(this.search.isStandAloneIssue(a)){this.resetToStandaloneIssue(a)}else{this.applyState(a,!this._isSearchStateEqual(a))}},hasSelectedIssue:function(){return this.search.getResults().getSelectedIssue().getKey()},resetToFilter:function(a){this.reset({filter:a,searchId:_.uniqueId()})},resetToBlank:function(a){this.reset({jql:""},a)},isDirty:function(){var a=this.getFilter();return !!a&&a.getJql()!==this.getEffectiveJql()},getSearchMode:function(){return this.queryModule.getSearchMode()},getActiveBasicModeSearchers:function(){return this.queryModule.getActiveBasicModeSearchers()},setSessionSearch:function(a){AJS.$.ajax({data:{filterId:a.getId()},type:"PUT",url:AJS.contextPath()+"/rest/issueNav/1/issueTable/sessionSearch/"})},openFocusShifter:function(){JIRA.Issues.FocusShifter.show()},setAsInaccessible:function(a){this.issueTableModule.setAsInaccessible(a)},showInlineIssueLoadError:function(b){var a=JIRA.Templates.ViewIssue.Body.errorsLoading({});JIRA.Messages.showErrorMsg(a,{closeable:true})},getEffectiveJql:function(){var b=this.getFilter(),a=this.getJql();if(_.isString(a)){return a}else{if(b){return b.getJql()||""}else{return""}}},initSystemFilters:function(){return this.filterModule.initSystemFilters()},addOwnerToSystemFilters:function(c){var d=AJS.Meta.get("remote-user");if(!d){return c}var b=AJS.Meta.get("remote-user-fullname");var a=AJS.Meta.get("remote-user-avatar-url");return _.map(c,function(e){e.ownerUserName=d;e.ownerDisplayName=b;e.avatarUrl=a;return e})},handleLeft:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleLeft()}},handleRight:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleRight()}},handleUp:function(){if(!this._allowUpDownNavigation()){return false}if(this.searchResults.isFirstIssueHighlighted()){return false}return this.prevIssue()},handleDown:function(){if(!this._allowUpDownNavigation()){return false}return this.nextIssue()},_allowLeftRightNavigation:function(){return !AJS.keyboardShortcutsDisabled},_allowUpDownNavigation:function(){if(AJS.keyboardShortcutsDisabled){return false}if(AJS.InlineLayer.current||AJS.Dropdown.current||JIRA.Dialog.current||AJS.$(".aui-dropdown2:visible").length>0){return false}return this.getCurrentLayout()&&!this.getCurrentLayout().isIssueViewActive()},_isSearchStateEqual:function(a){var b=["filter","jql","startIndex"];return _.isEqual(_.pick(a,b),_.pick(this.getState(),b))},removeOpenTipsies:JIRA.Issues.Tipsy.revalidate,_showIntroDialogs:function(a){if(!this._shownIntroDialog&&this.layoutSwitcher){jQuery.when(a,this.filterModule.filterPanelView.panelReady).done(_.bind(function(){var b="split-view-intro";if(this.layoutSwitcher.$el.is(":visible")&&this.search.getResults().hasIssues()){new AJS.HelpTip({id:b,title:"Choose how you view issues",url:AJS.Meta.get("issue-search-help-url"),bodyHtml:"Switch between the details and list views to suit your preference.",anchor:".view-selector button",isSequence:true,weight:1})}this.filterModule.createHelptipForFilterPanelDocking();AJS.HelpTip.Manager.showSequences()},this));this._shownIntroDialog=true}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca>logging in\u003c\/a> to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca>create an issue\u003c\/a>":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca>creating a new issue\u003c\/a>":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/util/URLSerializer.js' */
(function(){var b="browse/",d="issues/";var c=function(e){return e};var a=function(e){if(typeof e==="string"){return parseInt(e,10)}return e};JIRA.Issues.URLSerializer={getURLFromState:function(g){g=g||{};var f=[];var e;if(g.selectedIssueKey){e=b+g.selectedIssueKey}else{e=d}if(g.filter!=null){f.push("filter="+g.filter)}if(g.jql!=null&&(g.filterJql==null||g.jql!==g.filterJql)){f.push("jql="+encodeURIComponent(g.jql))}if(g.startIndex&&!g.selectedIssueKey){f.push("startIndex="+g.startIndex)}return e+(f.length?"?"+f.join("&"):"")},getStateFromURL:function(e){var g={},i=e.split("?")[0],j,h;h={filter:null,jql:null,selectedIssueKey:null,startIndex:0};if(e.indexOf(b)==0){h.selectedIssueKey=i.split("/")[1]}if(e.indexOf("?")!==-1){j=e.substr(e.indexOf("?"));g=JIRA.Issues.QueryStringParser.parse(j);var f=_.pick(g,"focusedCommentId","attachmentSortBy","attachmentOrder");if(!_.isEmpty(f)){h.viewIssueQuery=f}}return _.inject(this.PARAMETER_TRANSFORM,function(n,k,l){var m=g[l];if(m!==undefined){n[l]=k(m)}return n},_.extend(h))},PARAMETER_TRANSFORM:{filter:c,jql:c,startIndex:a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewer.js' */
AJS.namespace("JIRA.Components.IssueViewer");JIRA.Components.IssueViewer=JIRA.Marionette.Controller.extend({namedEvents:["loadComplete","loadError","close","headerRender","replacedFocusedPanel"],initialize:function(a){a=a||{};this.model=new JIRA.Components.IssueViewer.Models.Issue();this.eventBus=new JIRA.Components.IssueViewer.Legacy.IssueEventBus();this.viewIssueData=new JIRA.Components.IssueViewer.Legacy.ViewIssueData();this._buildIssueLoader();this._buildErrorController({showReturnToSearchOnError:a.showReturnToSearchOnError});this._buildIssueController();JIRA.bind(JIRA.Events.REFRESH_ISSUE_PAGE,_.bind(function(c,d,b){if(this.model.isCurrentIssue(d)){this.refreshIssue(b)}},this))},_buildIssueLoader:function(){this.issueLoader=new JIRA.Components.IssueViewer.Services.IssueLoader();this.listenTo(this.issueLoader,"error",function(b,a){this.trigger("loadError",a);this.errorController.render(b,a.issueKey);this.removeIssueMetadata();JIRA.trace("jira.issue.refreshed",{id:a.issueId});JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[a.issueId])});this.listenTo(this.issueLoader,"issueLoaded",this._onIssueLoaded)},_buildErrorController:function(a){a=a||{};this.errorController=new JIRA.Components.IssueViewer.Controllers.Error({contextPath:AJS.contextPath(),showReturnToSearchOnError:a.showReturnToSearchOnError});this.listenTo(this.errorController,"before:render",function(){this.issueController.close()});this.listenTo(this.errorController,"returnToSearch",function(){this.trigger("close")});this.listenAndRethrow(this.errorController,"render");this.listenAndRethrow(this.errorController,"headerRender")},_buildIssueController:function(){this.issueController=new JIRA.Components.IssueViewer.Controllers.Issue({model:this.model});this.listenTo(this.issueController,"render",function(b,a){JIRA.Components.IssueViewer.Utils.hideDropdown();this.errorController.close();this.trigger("render",b,a);JIRA.trace("jira.psycho.issue.refreshed",{id:this.model.getId()})});this.listenAndRethrow(this.issueController,"headerRender");this.listenAndRethrow(this.issueController,"replacedFocusedPanel");this.listenTo(this.issueController,"panelRendered",function(a,b){this.eventBus.triggerPanelRendered(a,b)});this.listenTo(this.issueController,"close",function(){JIRA.Components.IssueViewer.Utils.hideDropdown()})},_updateModel:function(b,a){this.model.update(b,a)},_onIssueLoaded:function(g,h,d){var e=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();var c=d.issueEntity;var b=!h.mergeIntoCurrent&&d.initialize!==false;var a=!this.model.isCurrentIssue(c.id);if(!h.isUpdate||b){this.dismiss()}this._updateModel(g,{initialize:b,changed:h.changed,mergeIntoCurrent:h.mergeIntoCurrent});if(e&&h.fromCache){this.refreshIssue(c,{fromCache:true,mergeIntoCurrent:!h.error})}JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model);this.issueController.show();if(c.bringToFocus){c.bringToFocus()}this.trigger("loadComplete",this.model,{isNewIssue:a,issueId:c.id,duration:h.loadDuration,loadReason:h.fromCache?"issues-cache-refresh":undefined,fromCache:h.fromCache});var f={id:c.id};if(h.fromCache){JIRA.trace("jira.issue.loadFromCache",f)}else{JIRA.trace("jira.issue.loadFromServer",f)}JIRA.trace("jira.issue.refreshed",f);JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[c.id])},abortPending:function(){this.issueLoader.cancel()},canDismissComment:function(){return this.issueController.canDismissComment()},beforeHide:function(){JIRA.Components.IssueViewer.Utils.hideLightbox();JIRA.Components.IssueViewer.Utils.hideDropdown();this.abortPending();this.removeIssueMetadata()},beforeShow:function(){JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model)},getIssueId:function(){return this.model.getEntity().id||null},getIssueKey:function(){return this.model.getEntity().key||null},_loadIssueFromDom:function(a){if(!a.id||a.id==-1){this.errorController.applyToDom("notfound",a.key)}else{this.issueController.applyToDom({id:a.id||-1,key:a.key,viewIssueQuery:a.viewIssueQuery})}AJS.Meta.set("serverRenderedViewIssue",null);var b={id:this.getIssueId()};JIRA.trace("jira.issue.refreshed",b)},loadIssue:function(b){var a=AJS.$("#key-val"),c=AJS.Meta.get("serverRenderedViewIssue");if(c){b.id=a.attr("rel")||-1;this._loadIssueFromDom(b);return jQuery.Deferred().resolve().promise()}else{if(!this.canDismissComment()||!b.key){return jQuery.Deferred().reject()}this.issueController.showLoading();return this.issueLoader.load({issueEntity:b,viewIssueData:this.viewIssueData})}},refreshIssue:function(a){var b;a=_.defaults({},a,{mergeIntoCurrent:true});if(this.model.hasIssue()){b=this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:a.mergeIntoCurrent});if(a.complete){b=b.done(a.complete).fail(a.complete)}this.issueController.showLoading()}else{b=jQuery.Deferred().resolve().promise()}return b},removeIssueMetadata:function(){JIRA.Components.IssueViewer.Services.Metadata.removeIssueMetadata(this.model)},setContainer:function(a){this.errorController.setElement(a);this.issueController.setElement(a)},isCurrentlyLoading:function(){return this.issueLoader.isLoading()},updateIssueWithQuery:function(a){this.model.updateIssueQuery(a);this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:true})},dismiss:function(){this.model.resetToDefault();this.errorController.close();this.issueController.close()},close:function(){if(this.canDismissComment()){this.dismiss();this.trigger("close")}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewerAppModule.js' */
AJS.namespace("JIRA.Components.IssueViewer.AppModule");JIRA.Components.IssueViewer.AppModule=JIRA.Marionette.AppModule.extend({name:"issueViewer",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueViewer({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(a){return{abortPending:true,beforeHide:true,beforeShow:true,removeIssueMetadata:true,updateIssueWithQuery:true,close:true,setContainer:true,dismiss:true}},requests:function(a){return{loadIssue:true,canDismissComment:true,getIssueId:true,getIssueKey:true,refreshIssue:true,isCurrentlyLoading:true}},events:function(a){return["loadComplete","loadError","close","render","headerRender","replacedFocusedPanel"]}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/Issue.soy' */
// This file was automatically generated from Issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }


JIRA.Components.IssueViewer.Templates.layout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="issue-edit-form"><div class="issue-header-container"></div><div class="issue-body-container"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueHeader.soy' */
// This file was automatically generated from IssueHeader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Header == 'undefined') { JIRA.Components.IssueViewer.Templates.Header = {}; }


JIRA.Components.IssueViewer.Templates.Header.opsbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ops-cont"><div class="ops-menus aui-toolbar">');
  if (opt_data.issue.operations) {
    var linkGroupList6 = opt_data.issue.operations.linkGroups;
    var linkGroupListLen6 = linkGroupList6.length;
    for (var linkGroupIndex6 = 0; linkGroupIndex6 < linkGroupListLen6; linkGroupIndex6++) {
      var linkGroupData6 = linkGroupList6[linkGroupIndex6];
      if (linkGroupData6.id && linkGroupData6.id == 'view.issue.opsbar') {
        output.append('<div class="toolbar-split toolbar-split-left">');
        var subGroupList10 = linkGroupData6.groups;
        var subGroupListLen10 = subGroupList10.length;
        for (var subGroupIndex10 = 0; subGroupIndex10 < subGroupListLen10; subGroupIndex10++) {
          var subGroupData10 = subGroupList10[subGroupIndex10];
          JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData10, parentGroup: linkGroupData6}, output);
        }
        output.append('</div>');
      } else if (linkGroupData6.id && linkGroupData6.id == 'jira.issue.tools') {
        output.append('<div class="toolbar-split toolbar-split-right">');
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: linkGroupData6}, output);
        output.append('</div>');
      }
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.legacyIssueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content"><div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, output);
  }
  output.append('</div><div id="heading-avatar"><img id="project-avatar" alt="" class="project-avatar-48" height="48" src="', soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), '" width="48"></div><ul class="breadcrumbs"><li><a id="project-name-val" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.issue.project.key), '">', soy.$$escapeHtml(opt_data.issue.project.name), '</a> </li>', (opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a> </li>' : '', '<li><a class="issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.issue.key), '" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" id="key-val" rel="', soy.$$escapeHtml(opt_data.issue.id), '">', soy.$$escapeHtml(opt_data.issue.key), '</a></li></ul><h1 id="summary-val">', soy.$$escapeHtml(opt_data.issue.summary), '</h1><div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.issueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content">');
  var param72 = new soy.StringBuilder();
  if (opt_data.issue.project) {
    var param75 = new soy.StringBuilder();
    JIRA.Templates.Headers.projectAvatar({id: soy.$$escapeHtml(opt_data.issue.project.id), projectKey: soy.$$escapeHtml(opt_data.issue.project.key), projectName: soy.$$escapeHtml(opt_data.issue.project.name), avatarUrl: soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), avatarAlt: soy.$$escapeHtml(opt_data.issue.project.name), isSystemAvatar: opt_data.issue.project.systemAvatar, hasProjectShortcut: opt_data.hasProjectShortcut}, param75);
    aui.page.pageHeaderImage({content: param75.toString()}, param72);
    aui.page.pageHeaderMain({content: '<ol class="aui-nav aui-nav-breadcrumbs"><li><a id="project-name-val" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.issue.project.key) + '">' + soy.$$escapeHtml(opt_data.issue.project.name) + '</a></li>' + ((opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a></li>' : '') + '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.key) + '" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.issue.key) + '" id="key-val" rel="' + soy.$$escapeHtml(opt_data.issue.id) + '">' + soy.$$escapeHtml(opt_data.issue.key) + '</a></li></ol><h1 id="summary-val">' + soy.$$escapeHtml(opt_data.issue.summary) + '</h1>'}, param72);
  }
  var param127 = new soy.StringBuilder('<div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, param127);
  }
  param127.append('</div>');
  aui.page.pageHeaderActions({content: param127.toString()}, param72);
  aui.page.pageHeader({content: param72.toString()}, output);
  output.append('<div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.linkGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.group.header && opt_data.group.header.label) {
    if (opt_data.group.links.length > 0 || opt_data.group.groups.length > 0) {
      JIRA.Components.IssueViewer.Templates.Header.dropdownLink(opt_data.group, output);
    }
  } else {
    output.append('<ul ', (opt_data.group.id) ? 'id="opsbar-' + soy.$$escapeHtml(opt_data.group.id) + '" ' : '', 'class="toolbar-group pluggable-ops">');
    var linkList155 = opt_data.group.links;
    var linkListLen155 = linkList155.length;
    for (var linkIndex155 = 0; linkIndex155 < linkListLen155; linkIndex155++) {
      var linkData155 = linkList155[linkIndex155];
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: linkData155}, output);
    }
    if (opt_data.group.groups.length == 1 && opt_data.group.groups[0].links.length == 0 && opt_data.group.groups[0].groups.length == 1 && opt_data.group.groups[0].groups[0].links.length == 1) {
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: opt_data.group.groups[0].groups[0].links[0]}, output);
    } else {
      var subGroupList164 = opt_data.group.groups;
      var subGroupListLen164 = subGroupList164.length;
      for (var subGroupIndex164 = 0; subGroupIndex164 < subGroupListLen164; subGroupIndex164++) {
        var subGroupData164 = subGroupList164[subGroupIndex164];
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData164}, output);
      }
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item toolbar-dropdown"><div><a href="#" ', (opt_data.header.id) ? ' id="' + soy.$$escapeHtml(opt_data.header.id) + '"' : '');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.header.title, label: opt_data.header.label}, output);
  output.append(' data-hide-on-scroll=".split-view .issue-container" data-contain-to-window="true" class="toolbar-trigger ', (opt_data.links.length > 0 || opt_data.groups.length > 0) ? ' js-default-dropdown' : '', (opt_data.header.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.header.styleClass) : '', '" >', (opt_data.header.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.header.iconClass) + '"></span> ' : '', '<span class="dropdown-text">', soy.$$truncate(soy.$$escapeHtml(opt_data.header.label), 25, true), '</span><span class="icon drop-menu"></span></a><div class="aui-list hidden">');
  if (opt_data.links.length > 0) {
    output.append('<ul class="aui-list-section aui-first', (opt_data.groups.length == 0) ? ' aui-last' : '', '">');
    var linkList204 = opt_data.links;
    var linkListLen204 = linkList204.length;
    for (var linkIndex204 = 0; linkIndex204 < linkListLen204; linkIndex204++) {
      var linkData204 = linkList204[linkIndex204];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData204, output);
    }
    output.append('</ul>');
  }
  var groupList208 = opt_data.groups;
  var groupListLen208 = groupList208.length;
  for (var groupIndex208 = 0; groupIndex208 < groupListLen208; groupIndex208++) {
    var groupData208 = groupList208[groupIndex208];
    output.append('<ul class="aui-list-section', (opt_data.links.length == 0 && groupIndex208 == 0) ? ' aui-first' : '', (groupIndex208 == groupListLen208 - 1) ? ' aui-last' : '', '">');
    var linkList217 = groupData208.links;
    var linkListLen217 = linkList217.length;
    for (var linkIndex217 = 0; linkIndex217 < linkListLen217; linkIndex217++) {
      var linkData217 = linkList217[linkIndex217];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData217, output);
    }
    output.append('</ul>');
  }
  output.append('</div></div></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item"><a  href="', (opt_data.href) ? soy.$$escapeHtml(opt_data.href) : '#', '" class="aui-list-item-link', (opt_data.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.styleClass) : '', '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr(opt_data, output);
  output.append((opt_data.id) ? 'id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '><span class="trigger-label">', soy.$$truncate(soy.$$escapeHtml(opt_data.label), 25, true), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.toolbarItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item"><a id="', soy.$$escapeHtml(opt_data.link.id), '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.link.title, label: opt_data.link.label}, output);
  output.append('class="toolbar-trigger', (opt_data.link.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.link.styleClass) : '', '" href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '">', (opt_data.link.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.link.iconClass) + '"></span> <span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>' : '<span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>', '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.titleAttr = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : (opt_data.label && opt_data.label.length && opt_data.label.length > 25) ? 'title="' + soy.$$escapeHtml(opt_data.label) + '"' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueBody.soy' */
// This file was automatically generated from IssueBody.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Body == 'undefined') { JIRA.Components.IssueViewer.Templates.Body = {}; }


JIRA.Components.IssueViewer.Templates.Body.issueBody = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column"></div><div id="viewissuesidebar" class="aui-item issue-side-column"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issueBodyWithPanels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList10 = opt_data.panels.leftPanels;
    var panelListLen10 = panelList10.length;
    for (var panelIndex10 = 0; panelIndex10 < panelListLen10; panelIndex10++) {
      var panelData10 = panelList10[panelIndex10];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData10, output);
    }
  }
  output.append('</div><div id="viewissuesidebar" class="aui-item issue-side-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList16 = opt_data.panels.rightPanels;
    var panelListLen16 = panelList16.length;
    for (var panelIndex16 = 0; panelIndex16 < panelListLen16; panelIndex16++) {
      var panelData16 = panelList16[panelIndex16];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData16, output);
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issuePanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.renderHeader) {
    output.append('<div id=', soy.$$escapeHtml(opt_data.id), ' class="module toggle-wrap"><div id="', soy.$$escapeHtml(opt_data.id), '_heading" class="mod-header"><ul class="ops">');
    var linkList28 = opt_data.headerLinks.links;
    var linkListLen28 = linkList28.length;
    for (var linkIndex28 = 0; linkIndex28 < linkListLen28; linkIndex28++) {
      var linkData28 = linkList28[linkIndex28];
      output.append('<li>');
      JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData28}, output);
      output.append('</li>');
    }
    if (opt_data.headerLinks.groups.length > 0) {
      output.append('<li class="drop"><div class="aui-dd-parent"><a href="#" class="icon drop-menu js-default-dropdown" title="', soy.$$escapeHtml("Options"), '"><span>', soy.$$escapeHtml("Options"), '</span></a><div class="aui-dropdown-content aui-list">');
      var groupList41 = opt_data.headerLinks.groups;
      var groupListLen41 = groupList41.length;
      for (var groupIndex41 = 0; groupIndex41 < groupListLen41; groupIndex41++) {
        var groupData41 = groupList41[groupIndex41];
        output.append((groupData41.header && groupData41.header.label) ? '<h5>' + soy.$$escapeHtml(groupData41.header.label) + '</h5>' : '', '<ul ', (groupData41.header && groupData41.header.id) ? 'id="' + soy.$$escapeHtml(groupData41.header.id) + '"' : '', 'class="aui-list-section', (groupData41.header && groupData41.header.styleClass) ? ' ' + soy.$$escapeHtml(groupData41.header.styleClass) : '', (groupIndex41 == 0) ? ' aui-first' : '', (groupIndex41 == groupListLen41 - 1) ? ' aui-last' : '', '">');
        var linkList65 = groupData41.links;
        var linkListLen65 = linkList65.length;
        for (var linkIndex65 = 0; linkIndex65 < linkListLen65; linkIndex65++) {
          var linkData65 = linkList65[linkIndex65];
          output.append('<li class="aui-list-item">');
          JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData65, additionalStyleClass: 'aui-list-item-link'}, output);
          output.append('</li>');
        }
        output.append('</ul>');
      }
      output.append('</div></div></li>');
    }
    output.append('</ul>');
    if (opt_data.subpanelHtmls.length > 0) {
      output.append('<div class="mod-header-panels">');
      var subPanelList79 = opt_data.subpanelHtmls;
      var subPanelListLen79 = subPanelList79.length;
      for (var subPanelIndex79 = 0; subPanelIndex79 < subPanelListLen79; subPanelIndex79++) {
        var subPanelData79 = subPanelList79[subPanelIndex79];
        output.append('<div class="mod-header-panel">', subPanelData79, '</div>');
      }
      output.append('</div>');
    }
    output.append('<h2 class="toggle-title">', soy.$$escapeHtml(opt_data.label), '</h2></div><div class="mod-content">', opt_data.html, '</div></div>');
  } else {
    output.append(opt_data.html);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data.errorMessages) {
    output.append('<ul>');
    var msgList104 = opt_data.errorMessages;
    var msgListLen104 = msgList104.length;
    for (var msgIndex104 = 0; msgIndex104 < msgListLen104; msgIndex104++) {
      var msgData104 = msgList104[msgIndex104];
      output.append('<li>', soy.$$escapeHtml(msgData104), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.focusShifter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message closeable" id="focus-shifter"><label><span>', soy.$$escapeHtml("viewissue.focusshifter"), '</span><div id="focus-shifter-content"></div></label><span class="aui-icon icon-close"></span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueError.soy' */
// This file was automatically generated from IssueError.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Error == 'undefined') { JIRA.Components.IssueViewer.Templates.Error = {}; }


JIRA.Components.IssueViewer.Templates.Error.NoPermission = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Permission Violation", body: "It seems that you have tried to perform an operation which you are not permitted to perform.", error: 'warning', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.DoesNotExist = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Issue Does Not Exist", body: "The issue you are trying to view does not exist.", error: 'error', returnToSearch: ! opt_data.hideReturnToSearch}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.Generic = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Unexpected Error", body: "There was an unexpected error while loading the issue.", error: 'error', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.viewIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="form-body"><header class="issue-header"><div class="issue-header-content"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1>', soy.$$escapeHtml(opt_data.title), '</h1></div><div class="aui-page-header-actions"><div id="issue-header-pager"></div></div></div></header></div></header><div class="issue-body-content"><div class="aui-message ', soy.$$escapeHtml(opt_data.error), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.error), '"></span><p>', soy.$$escapeHtml(opt_data.body), '</p><p>', soy.$$escapeHtml("If you think this message is wrong, please contact your"), '<a href="', soy.$$escapeHtml("/jira"), '/secure/ContactAdministrators!default.jspa"> ', soy.$$escapeHtml("JIRA administrators"), '</a>.</p>', (opt_data.returnToSearch) ? '<p><a id="return-to-search" class="push-state" href="' + soy.$$escapeHtml("/jira") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></p>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Panel");JIRA.Components.IssueViewer.Models.Panel=JIRA.Issues.Brace.Model.extend({namedAttributes:["entity","updateLocked"],initialize:function(){JIRA.bind(JIRA.Events.LOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",true)}},this));JIRA.bind(JIRA.Events.UNLOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",false)}},this))},update:function(c,a,b){if(!this.getUpdateLocked()){this.set("entity",c);this.trigger("updated",a,b)}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsCollection.js' */
AJS.namespace("JIRA.Components.IssueViewer.Collections.Panels");JIRA.Components.IssueViewer.Collections.Panels=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueViewer.Models.Panel,update:function(c,b){var a=this;this.each(function(d){var e=d.id;var f=_.any(c,function(g){return g.id===e});if(!f){this.remove(d)}},this);_.each(c,function(e,f){var d=this.get(e.id);if(d){d.update(e,b.fieldsInProgress,b.fieldsSaved)}else{this.add({id:e.id,entity:e},{at:f})}},this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsGroupModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.PanelsGroup");JIRA.Components.IssueViewer.Models.PanelsGroup=JIRA.Issues.Brace.Model.extend({namedAttributes:["leftPanels","rightPanels","infoPanels"],defaults:function(){return{leftPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),rightPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),infoPanels:new JIRA.Components.IssueViewer.Collections.Panels([])}},update:function(b,a){this.get("leftPanels").update(b.leftPanels,a);this.get("rightPanels").update(b.rightPanels,a);this.get("infoPanels").update(b.infoPanels,a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/IssueModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Issue");JIRA.Components.IssueViewer.Models.Issue=JIRA.Issues.Brace.Model.extend({namedEvents:["updated"],namedAttributes:["entity","id","key","panels"],defaults:function(){return{entity:{},panels:new JIRA.Components.IssueViewer.Models.PanelsGroup()}},update:function(c,b){var a=false;if(c.issue){this.updateFromEntity(c.issue);a=true}if(c.panels){this.getPanels().update(c.panels,b);a=true}if(a){this.trigger("updated",b)}},resetToDefault:function(){this.clear();this.set(this.defaults())},updateFromEntity:function(a){this.set({id:a.id,key:a.key,entity:a})},isCurrentIssue:function(a){return this.get("id")==a},hasIssue:function(){return this.has("id")},updateIssueQuery:function(a){if(!this.hasIssue()){return}this.getEntity().viewIssueQuery=a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanel");JIRA.Components.IssueViewer.Views.IssuePanel=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Body.issuePanel,modelEvents:{updated:"update"},update:function(a,i){var b=this.renderTemplate();var d=this.$el;var h=this;if(b.text()===d.text()){return}function f(){return _.any(a,function(j){return d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(j)).length===1})}function c(){var j=d.find(document.activeElement).length>0;var m=!!jQuery.browser.msie&&jQuery.browser.version<=8;if(!m){d.replaceWith(b)}else{var l=d[0].nextSibling;var k=d[0].parentNode;d.remove();if(l){jQuery(l).before(b)}else{jQuery(k).append(b)}}if(j){h.trigger("replacedFocusedPanel")}h.setElement(b)}function e(k){var l=h.model.id;var j=h.$el;h.trigger("panelRendered",l,j);JIRA.trigger(JIRA.Events.PANEL_REFRESHED,[l,j,d]);_.each(k,function(m){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[m,JIRA.CONTENT_ADDED_REASON.panelRefreshed])})}if(!f()){c();e([h.$el])}else{var g=[];_.each(i,function(l){var k=d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(k.length===1){var j=b.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(j.length===1){k.replaceWith(j);g.push(j)}else{k.closest("li, dl").remove()}}});e(g)}this.bindUIElements()},onRender:function(){this.setElement(this.$el.children());var a=this.model.getEntity().styleClass;if(a){this.$el.addClass(a)}JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},serializeData:function(){return this.model.getEntity()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelsView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanels");JIRA.Components.IssueViewer.Views.IssuePanels=JIRA.Marionette.CollectionView.extend({itemView:JIRA.Components.IssueViewer.Views.IssuePanel,_updatingFromDom:false,appendHtml:function(a,d,b){var c=a.$el.children();var e=c.length;if(b<=0){a.$el.prepend(d.$el)}else{if(!e||b>=e){a.$el.append(d.$el)}else{d.$el.insertBefore(c.eq(b))}}},applyToDom:function(){var a=this;this._updatingFromDom=true;this.$el.children().filter(".module").each(function(){var b=this.id;if(b==="addcomment"){b="addcommentmodule"}a.collection.add(new JIRA.Components.IssueViewer.Models.Panel({id:b,entity:{id:b}}))});this._updatingFromDom=false},renderItemView:function(){if(!this._updatingFromDom){JIRA.Marionette.CollectionView.prototype.renderItemView.apply(this,arguments)}},buildItemView:function(b){var a=JIRA.Marionette.CollectionView.prototype.buildItemView.apply(this,arguments);if(this._updatingFromDom){a.setElement(this.$el.find("#"+b.id))}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueBodyView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueBody");JIRA.Components.IssueViewer.Views.IssueBody=JIRA.Marionette.Layout.extend({tagName:"div",className:"issue-body-content",regions:{leftPanels:{selector:".issue-main-column",regionType:JIRA.Marionette.LinkRegion},rightPanels:{selector:".issue-side-column",regionType:JIRA.Marionette.LinkRegion},infoPanels:{selector:".issue-body",regionType:JIRA.Marionette.LinkRegion}},template:JIRA.Components.IssueViewer.Templates.Body.issueBody});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueOpsbarView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueOpsbar");JIRA.Components.IssueViewer.Views.IssueOpsbar=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Header.opsbar,ui:{shareButton:".viewissue-share",exportButton:"#viewissue-export",loginButton:"#ops-login-lnk",commentButton:"#comment-issue"},serializeData:function(){return{issue:this.model.getEntity()}},onApplyToDom:function(){this.onRender()},onRender:function(){this.ui.loginButton.hide();this.ui.commentButton.addClass("inline-comment");new JIRA.Issues.Tipsy({el:this.ui.shareButton,showCondition:":not(.active)"});new JIRA.Issues.Tipsy({el:this.ui.exportButton,showCondition:":not(.active)",tipsy:{gravity:"ne"}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueHeaderView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueHeader");JIRA.Components.IssueViewer.Views.IssueHeader=JIRA.Marionette.Layout.extend({className:"issue-header js-stalker",id:"stalker",tagName:"header",template:JIRA.Components.IssueViewer.Templates.Header.issueHeader,modelEvents:{updated:"update"},regions:{opsbar:".command-bar",pager:"#issue-header-pager"},serializeData:function(){return{issue:this.model.getEntity(),hasProjectShortcut:JIRA.Components.IssueViewer.Services.DarkFeatures.PROJECT_SHORTCUTS.enabled()}},update:function(a){if(a.initialize){this._updateWindowTitle()}else{var b=_.include(a.fieldsInProgress,"summary");if(b){this.renderOpsBar()}else{this.render()}}},onApplyToDom:function(){var a=new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model});a.setElement(this.opsbar.el);this.opsbar.attachView(a);this.opsbar.currentView.applyToDom()},onRender:function(){this.renderOpsBar();this._updateWindowTitle();this.trigger("panelRendered","header",this.$el)},renderOpsBar:function(){this.opsbar.show(new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model}));JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},_updateWindowTitle:function(){var a=this.model.getEntity();var c=a.key;var b=a.summary;var d=AJS.Meta.get("app-title");if(d&&b&&c){document.title="["+c+"] "+b+" - "+d}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Issue");JIRA.Components.IssueViewer.Views.Issue=JIRA.Marionette.Layout.extend({template:JIRA.Components.IssueViewer.Templates.layout,className:"issue-container",regions:{header:{selector:".issue-header-container",regionType:JIRA.Marionette.ReplaceRegion},body:{selector:".issue-body-container",regionType:JIRA.Marionette.ReplaceRegion}},modelEvents:{updated:"update"},showLoading:function(){this.$el.addClass("loading")},hideLoading:function(){this.$el.removeClass("loading")},focusComment:function(a){this.$("#activitymodule .focused").removeClass("focused");this.$("#comment-"+a).addClass("focused");this.$(".js-stalker").trigger("refresh")},update:function(a){if(a.initialize){this.render()}if(a.reason&&a.reason.action===JIRA.Issues.Actions.EDIT_COMMENT){this.focusComment(a.reason.meta.commentId)}this._bringViewIssueElementIntoView()},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1");this._bringViewIssueElementIntoView();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.pageLoad]);if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS,[this.model.getId()])}},onApplyToDom:function(){this._bringViewIssueElementIntoView()},_bringViewIssueElementIntoView:function(){var a=this.model.get("entity").viewIssueQuery;if(a){var b;if(a.focusedCommentId){b="#comment-"+a.focusedCommentId}else{if(a.attachmentSortBy||a.attachmentOrder){b="#attachmentmodule"}}if(b){AJS.$(b).scrollIntoView({marginBottom:200,marginTop:200})}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Error");JIRA.Components.IssueViewer.Views.Error=JIRA.Marionette.Layout.extend({className:"issue-container",regions:{pager:"#issue-header-pager"},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorGenericView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorGeneric");JIRA.Components.IssueViewer.Views.ErrorGeneric=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.Generic});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNotFoundView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNotFound=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.DoesNotExist,initialize:function(a){a=a||{};this.showReturnToSearchOnError=a.showReturnToSearchOnError},triggers:{"click #return-to-search":"returnToSearch"},serializeData:function(){var a=this.showReturnToSearchOnError;if(_.isFunction(a)){a=a()}return{hideReturnToSearch:!a}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNoPermissionView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNoPermission=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.NoPermission});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/IssueController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Issue");JIRA.Components.IssueViewer.Controllers.Issue=JIRA.Marionette.Controller.extend({initialize:function(a){this.model=a.model},_createViews:function(){this.view=this._createMainView();this.bodyView=this._createBodyView();this.headerView=this._createHeaderView();this.leftPanelsView=this._createPanelsView(this.model.getPanels().getLeftPanels());this.rightPanelsView=this._createPanelsView(this.model.getPanels().getRightPanels());this.infoPanelsView=this._createPanelsView(this.model.getPanels().getInfoPanels())},_createMainView:function(){return new JIRA.Components.IssueViewer.Views.Issue({model:this.model,el:this.$el})},_createBodyView:function(){return new JIRA.Components.IssueViewer.Views.IssueBody({model:this.model})},_createHeaderView:function(){var a=new JIRA.Components.IssueViewer.Views.IssueHeader({model:this.model});this.listenAndRethrow(a,"panelRendered");this.listenTo(a,"render",function(){this.trigger("headerRender",{pager:a.pager})});this.listenTo(a,"applyToDom",function(){this.trigger("headerRender",{pager:a.pager})});return a},_createPanelsView:function(b){var a=new JIRA.Components.IssueViewer.Views.IssuePanels({collection:b});this.listenTo(a,"itemview:replacedFocusedPanel",function(){this.trigger("replacedFocusedPanel")});this.listenTo(a,"itemview:panelRendered",function(c,e,d){this.trigger("panelRendered",e,d)});return a},createView:function(){this._createViews();this.listenTo(this.view,"render",function(){this.view.header.show(this.headerView);this.view.body.show(this.bodyView);this.bodyView.leftPanels.show(this.leftPanelsView);this.bodyView.rightPanels.show(this.rightPanelsView);this.bodyView.infoPanels.show(this.infoPanelsView);this.trigger("render",{pager:this.headerView.pager},{loadedFromDom:false,issueId:this.model.getId()})})},createViewFromDom:function(){this._createViews();this.listenTo(this.view,"applyToDom",function(){function a(d,b,c){b.setElement(c);b.applyToDom();d.attachView(b)}a(this.view.body,this.bodyView,this.view.$el.find(".issue-body-content"));a(this.view.body,this.headerView,this.view.$el.find("#stalker"));a(this.bodyView.leftPanels,this.leftPanelsView,this.bodyView.$el.find(this.bodyView.leftPanels.el));a(this.bodyView.rightPanels,this.rightPanelsView,this.bodyView.$el.find(this.bodyView.rightPanels.el));a(this.bodyView.infoPanels,this.infoPanelsView,this.bodyView.$el.find(this.bodyView.infoPanels.el));this.trigger("render",{pager:this.headerView.pager},{loadedFromDom:true,issueId:this.model.getId()})})},setElement:function(a){this.$el=a;if(this.view){this.view.setElement(a)}},applyToDom:function(a){a.id=+a.id;this.model.updateFromEntity(a);this.createViewFromDom();this.view.applyToDom()},show:function(){if(!this.view){this.createView();this.view.render()}else{this.trigger("render",{pager:this.headerView.pager},{loadedFromDom:false,issueId:this.model.getId()})}this.view.hideLoading()},close:function(){if(this.view){this.view.close()}this.hideLoading();delete this.view},hideLoading:function(){this.view&&this.view.hideLoading()},showLoading:function(){this.view&&this.view.showLoading()},canDismissComment:function(){var b;var a=JIRA.Issue.CommentForm;if(!a.getForm().data("dismissed")){b=a.handleBrowseAway();if(b){if(!confirm(b)){a.focus();return false}else{a.getForm().data("dismissed",true)}}}return true}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/ErrorController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Error");JIRA.Components.IssueViewer.Controllers.Error=JIRA.Marionette.Controller.extend({initialize:function(a){this.contextPath=a.contextPath;this.showReturnToSearchOnError=a.showReturnToSearchOnError},render:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},applyToDom:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},close:function(){if(this.view){this.view.close();delete this.view}},setElement:function(a){this._$el=a;if(this.view){this.view.setElement(a)}},_renderErrorAuth:function(b){var a=this.contextPath+"/login.jsp?os_destination="+encodeURIComponent("/browse/"+b);window.location.replace(a)},_renderErrorView:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.render();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.pager},{loadedFromDom:false,issueId:null});this.trigger("headerRender",{pager:this.view.pager})},_renderErrorViewFromDom:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.applyToDom();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.pager},{loadedFromDom:true,issueId:null});this.trigger("headerRender",{pager:this.view.pager})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/IssueLoaderService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.IssueLoader");JIRA.Components.IssueViewer.Services.IssueLoader=JIRA.Marionette.Controller.extend({initialize:function(){this._promiseManager=jQuery.RecurringPromise();this._updatingPromise=this._promiseManager.sub();this._updatingPromise.done(_.bind(this._onUpdatingDone,this)).fail(_.bind(this._onUpdatingError,this));this._loadingPromise=this._promiseManager.sub();this._loadingPromise.done(_.bind(this._onLoadingDone,this)).fail(_.bind(this._onLoadingError,this))},cancel:function(){this._promiseManager.reset()},update:function(f){var d=f.issueEntity,c=f.mergeIntoCurrent,g=f.viewIssueData;var e=jQuery.Deferred(),b;function a(h){return function(){return{taskKey:h,data:arguments,startIssueLoad:new Date()}}}b=this._updatingPromise.add(g.get(d.key,true,{issueEntity:d,loadingDeferred:e,mergeIntoCurrent:c,startIssueLoad:new Date()}).pipe(a("issue"),a("issue")));b.fail(function(){e.reject.apply(e,arguments)});return e.promise()},load:function(c){var a=c.issueEntity;var d=c.viewIssueData;this._currentlyLoading=true;var b=jQuery.Deferred();this._loadingPromise.add(d.get(a.key,false,{issueEntity:a,loadFields:false,loadingDeferred:b,startIssueLoad:new Date()}));return b.promise()},isLoading:function(){return this._currentlyLoading},_onLoadingDone:function(c,d,b){var a=b.issueEntity;var e=a.id=c.issue.id;a.key=c.issue.key;if(!c.pager){c.pager=a.pager}JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this._currentlyLoading=false;d.loadDuration=new Date()-b.startIssueLoad;this.trigger("issueLoaded",c,d,b);b.loadingDeferred.resolve(c,d,b)},_onUpdatingDone:function(a){var b=a.data[1];if(b){b.isUpdate=true}this._onLoadingDone.apply(this,a.data)},_onLoadingError:function(d,f,b){var a=b.issueEntity;var g=a.id;var c={issueId:a.id,issueKey:a.key,response:d};this._currentlyLoading=false;var e;switch(d.status){case 401:e="auth";break;case 403:e="forbidden";break;case 404:e="notfound";break;default:e="generic";break}this.trigger("error",e,c);b.loadingDeferred.reject()},_onUpdatingError:function(a){this._onLoadingError.apply(this,a.data)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/MetadataService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.Metadata");JIRA.Components.IssueViewer.Services.Metadata={removeIssueMetadata:function(b){var a=b.getEntity();if(a.metadata){_.each(a.metadata,function(d,c){AJS.Meta.set(c,null)})}else{if(AJS.Meta.get("issue-key")){AJS.Meta.set("issue-key",null)}}},addIssueMetadata:function(b){var a=b.getEntity();_.each(a.metadata,function(d,c){AJS.Meta.set(c,d)})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/DarkFeatures.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.DarkFeatures");JIRA.Components.IssueViewer.Services.DarkFeatures=(function(){var a=Class.extend({init:function(c){this.featureKey=c},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});var b=a.extend({enabled:function(){return this._super()&&(!this._ieGhetto.enabled()||history.pushState)},_ieGhetto:new a("ka.ghetto")});return{NO_PREFETCH:new b("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new a("rotp.project.shortcuts")}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/Utils.js' */
JIRA.Components.IssueViewer.Utils={hideLightbox:function(){AJS.$.fancybox.close()},hideDropdown:function(){if(AJS.InlineDialog.current&&(!JIRA.Issues.IntroDialog||_.contains(JIRA.Issues.IntroDialog.dialogs,AJS.InlineDialog.current))&&AJS.InlineDialog.current.id!=="column-picker-dialog"){AJS.InlineDialog.current.hide()}if(AJS.InlineLayer.current){var a=AJS.InlineLayer.current.options.offsetTarget();if(a instanceof jQuery){if(!a.is(":visible")){AJS.InlineLayer.current.hide()}}}}};JIRA.Events.ISSUE_REFRESHED="issueRefreshed";JIRA.Events.PANEL_REFRESHED="panelRefreshed";JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.EDIT_COMMENT="editComment";
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueEventBus.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueEventBus");JIRA.Components.IssueViewer.Legacy.IssueEventBus=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId"],namedEvents:["save","saveSuccess","savingStarted","saveError","panelRendered","replacedFocusedPanel","fieldSubmitted","dismiss","refreshIssue","issueRefreshed","updateFromDom","updateStatusColor","quickEditKeyPressed","openFocusShifter"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/AsyncData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.AsyncData");JIRA.Components.IssueViewer.Legacy.AsyncData=JIRA.Issues.Brace.Evented.extend({namedEvents:["change"],initialize:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.disableCache=a.disableCache;this.maxCacheSize=a.maxCacheSize}},get:function(b,a,i){var g=jQuery.Deferred();var d=this.disableCache?{}:this.data;var f=_.bind(function(m,l){var k=this._set(d,b,_.defaults(m,{accessIndex:this.accessIndex++}),true,i);var j=_.defaults({changed:k},l,d[b]);if(i&&i.mergeIntoCurrent){j.mergeIntoCurrent=true}if(d[b]&&!d[b].error){g.resolve(d[b].value,j,i)}else{g.reject(d[b]&&d[b].value,j,i)}},this);var c=_.bind(function(j){var k=this.fetch(b,i);this.setPending(b,k,function(l){f({value:l,error:false,updated:new Date()},{initialLoad:j})},function(l){var m={error:true,updated:new Date()};if(l!==undefined){m.value=l}f(m,{initialLoad:j,error:true})})},this);var e=function(){f({},{fromCache:true})};var h=_.bind(function(){this.pendings[b].always(_.bind(f,this,{},{initialLoad:true}))},this);if(a||this.disableCache){c(false)}else{if(this.hasCached(b)){e()}else{if(this.hasPending(b)){h()}else{c(true)}}}return g.promise()},setPending:function(d,b,a,c){if(this.hasPending(d)){this.pendings[d].update(b)}else{this.pendings[d]=jQuery.ConcurrentDeferred(b)}return this.pendings[d].done(function(e){a(e)}).fail(function(e){c(e)})},getIdByValue:function(a){var b;for(b in this.data){if(this.data[b].value===a){return b}}return null},getMeta:function(a){return this.data[a]||{}},getAllCached:function(){var a={};_.each(this.data,function(b,c){a[c]=b.value});return a},hasCached:function(b){var a=this.getMeta(b);return a.value!==undefined||a.error===true},hasError:function(b){var a=this.getMeta(b);return a.error===true},hasPending:function(b){var a=this.pendings[b];return a?a.isPending():false},set:function(b,a){return this._set(this.data,b,{value:a,updated:new Date()},true)},remove:function(a){if(this.data[a]){delete this.data[a];this.triggerChange();return true}return false},setError:function(c,a){var b={error:true,updated:new Date()};if(a!==undefined){b.value=a}return this._set(this.data,c,b,true)},setMultiple:function(b){var a=new Date();var c=false;_.each(b,_.bind(function(d,e){d=_.pick(d,"value","error");d.updated=a;if(this._set(this.data,e,d,false)){c=true}},this));if(c){this.triggerChange()}return c},reset:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.setMultiple(a)}else{this.triggerChange()}},_set:function(e,g,f,c,b){if(this.disableCache&&e===this.data){e={}}var d=e[g]?_.clone(e[g]):{};var a=this.mergeFetchedAndCached(d,f,b?b:{},e[g]);if(c&&(!e[g]||a||e[g].error!==d.error)&&e===this.data){this.triggerChange()}if(!e[g]&&this.maxCacheSize&&_.keys(e).length===this.maxCacheSize){if(f.accessIndex){this._dropItem(e);e[g]=d}}else{e[g]=d}return a},_dropItem:function(c){var a=null;for(var b in c){if(!c[b].accessIndex){a=b;break}else{if(a===null||c[b].accessIndex<c[a].accessIndex){a=b}}}if(a!==null){delete c[a]}},fetch:function(d,b){var c=this.getMeta(d);var a=jQuery.Deferred();if(!this.hasCached(d)||c.error){a.reject(c.value)}else{a.resolve(c.value)}return a.promise()},mergeFetchedAndCached:function(b,d,a,c){_.extend(b,d);return !c||c.value!==b.value||c.error!==b.error}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/ViewIssueData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.ViewIssueData");JIRA.Components.IssueViewer.Legacy.ViewIssueData=JIRA.Components.IssueViewer.Legacy.AsyncData.extend({initialize:function(a){JIRA.Components.IssueViewer.Legacy.AsyncData.prototype.initialize.call(this,_.defaults(a||{},{disableCache:JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled(),maxCacheSize:+AJS.Meta.get("viewissue-max-cache-size")}))},fetch:function(e,d){var h={issueKey:e,decorator:"none",prefetch:!!d.prefetch};if(d.mergeIntoCurrent){if(this.data&&this.data[e]&&this.data[e].value&&this.data[e].value.issue){h.lastReadTime=this.data[e].value.readTime;h.fields=[];_.each(this.data[e].value.fields,function(i){h.fields.push(i.id+":"+i.contentId)});h.issue=["summary:"+this.data[e].value.issue.summaryContentId];h.links=[];var g=function(i){_.each(i.links,function(j){h.links.push(j.id+":"+j.contentId)});_.each(i.groups,function(j){g(j)})};_.each(this.data[e].value.issue.operations.linkGroups,function(i){g(i)});h.panels=[];var a=this;var b=function(i){_.each(a.data[e].value.panels[i],function(j){h.panels.push(j.completeKey+":"+j.contentId)})};b("leftPanels");b("rightPanels");b("infoPanels")}}if("loadFields" in d){h.loadFields=d.loadFields}if(d.issueEntity){_.defaults(h,d.issueEntity.viewIssueQuery)}var f=jQuery.ajax({url:contextPath+"/secure/AjaxIssueAction!default.jspa",headers:{"X-SITEMESH-OFF":true},data:h,type:d.mergeIntoCurrent?"POST":"GET"});var c=f.pipe(function(i){return i},function(i){return _.pick(i,"status","responseText","statusText")});c.abort=function(){f.abort.apply(f,arguments)};return c},mergeFetchedAndCached:function(l,m,d){if(this._skipMerging(l,m,d)){_.extend(l,m);return null}_.each(_.pairs(m),function(s){if(s[0]!=="value"){l[s[0]]=s[1]}});var q=m.value;var k=[];var b=[];var h=[];_.each(q.removedContentIds,function(u,t){var s;if(t==="fields"){s=k}else{if(t==="panels"){s=b}else{if(t==="links"){s=h}}}if(s){_.each(u,function(v){s.push(v)})}});var g=q.fields;var e=q.issue.operations.linkGroups;var o=q.panels;var j=q.issue.summary;if(this._nothingChanged(k,b,h,g,o,e,j)){return null}var p={updated:{},added:{},deleted:{}};var i=l.value;var f=this._comparator;var c=false;var n=false;var a=false;var r=false;if(k.length>0||g.length>0){this._mergeFields(g,i,p,k);c=true}if(b.length>0||o.leftPanels.length>0||o.rightPanels.length>0||o.infoPanels.length>0){this._mergePanels(o,i,p,b,f);n=true}if(h.length>0||e.length>0){this._mergeLinks(e,i,p,h,f);a=true}if(j){this._mergeSummary(q,i,p);r=true}return p},_skipMerging:function(c,b,a){return _.isEmpty(c)||!a.mergeIntoCurrent||!c.value||!c.value.issue||b.error===true},_nothingChanged:function(e,a,g,b,d,c,f){return e.length==0&&a.length==0&&g.length==0&&b.length==0&&c.length==0&&d.leftPanels.length==0&&d.rightPanels.length==0&&d.infoPanels.length==0&&!f},_mergeFields:function(c,e,d,a){d.added.fields=[];d.updated.fields=[];d.deleted.fields=[];_.each(c,function(f){var g=_.find(e.fields,function(h){return h.id==f.id});if(g){d.updated.fields.push(f.id)}else{d.added.fields.push(f.id)}});var b=c;_.each(e.fields,function(f){if(_.contains(a,f.id)){d.deleted.fields.push(f.id)}else{if(!_.contains(d.updated.fields,f.id)){b.push(f)}}});e.fields=b},_mergeSummary:function(c,b,a){a.updated.issue=["summary"];b.issue.summary=c.issue.summary;b.issue.summaryContentId=c.issue.summaryContentId},_mergePanels:function(e,d,c,a,b){c.added.panels={};c.updated.panels={};c.deleted.panels={};var f=function(g){c.added.panels[g]=[];c.updated.panels[g]=[];c.deleted.panels[g]=[];_.each(e[g],function(i){var j=_.find(d.panels[g],function(k){return k.id==i.id});if(j){c.updated.panels[g].push(i.id)}else{c.added.panels[g].push(i.id)}});var h=e[g];_.each(d.panels[g],function(i){if(_.contains(a,i.completeKey)){c.deleted.panels[g].push(i.id)}else{if(!_.contains(c.updated.panels[g],i.id)){h.push(i)}}});h.sort(b);d.panels[g]=h};f("leftPanels");f("rightPanels");f("infoPanels")},_mergeLinks:function(e,d,c,a,b){c.added.groups={};c.updated.groups={};c.deleted.groups={};var f=[];this._mergeOperationsLinks(e,d,f,c,a,b);this._mergeToolsLinks(e,d,f,c,a,b);d.issue.operations.linkGroups=f},_mergeOperationsLinks:function(j,d,c,a,k,b){a.added.groups["view.issue.opsbar"]=[];a.updated.groups["view.issue.opsbar"]=[];a.deleted.groups["view.issue.opsbar"]=[];var i=_.find(d.issue.operations.linkGroups,function(l){return"view.issue.opsbar"===l.id});var h=_.find(j,function(l){return"view.issue.opsbar"===l.id});var g={};var e={};if(h){_.each(h.groups,function(l){var m=_.find(i.groups,function(o){return l.id===o.id});if(m){a.updated.groups["view.issue.opsbar"].push(l.id)}else{a.added.groups["view.issue.opsbar"].push(l.id)}_.each(l.links,function(o){g[o.id]=o;e[o.id]=l.id});if(l.groups&&l.groups.length>0){var n=l.groups[0];_.each(n.groups,function(o){_.each(o.links,function(p){g[p.id]=p;e[p.id]=o.id})})}})}if(i){var f=[];if(h){_.each(h.groups,function(l){if(_.contains(a.added.groups["view.issue.opsbar"],l.id)){f.push(l)}})}_.each(i.groups,function(q){var p=[];var m=null;if(h){m=_.find(h.groups,function(t){return q.id===t.id});if(m){_.each(m.links,function(t){var u=_.find(q.links,function(v){return t.id===v.id});if(!u){p.push(t)}})}}var n=false;var l=function(u,t){_.each(u.links,function(v){var w=e[v.id];if(w&&w!==u.id){n=true}else{if(g[v.id]){t.push(g[v.id])}else{if(!_.contains(k,v.id)){t.push(v)}else{n=true}}}})};l(q,p);p.sort(b);q.links=p;var o=null;if(m&&m.groups&&m.groups.length>0){o=m.groups[0]}var s=null;if(q.groups&&q.groups.length>0){s=q.groups[0];var r=[];if(o){_.each(o.groups,function(t){var u=_.find(s.groups,function(v){return t.id===v.id});if(!u){r.push(t)}})}_.each(s.groups,function(v){var u=[];if(o){var t=_.find(o.groups,function(w){return w.id===v.id});if(t){_.each(t.links,function(w){var x=_.find(v.links,function(y){return w.id===y.id});if(!x){u.push(w)}})}}l(v,u);if(u.length>0){u.sort(b);v.links=u;r.push(v)}});if(r.length>0){r.sort(b);s.groups=r}else{s=null;n=true}}else{if(o){s=m.groups[0]}}q.groups=[];if(s){q.groups[0]=s}if(p.length>0||s){f.push(q);if(n&&!_.contains(a.updated.groups["view.issue.opsbar"],q.id)){a.updated.groups["view.issue.opsbar"].push(q.id)}}else{a.deleted.groups["view.issue.opsbar"].push(q.id)}});if(f.length>0){f.sort(b);i.groups=f;c.push(i)}}else{if(h){c.push(h)}}a.added.groups["view.issue.opsbar"].sort();a.deleted.groups["view.issue.opsbar"].sort();a.updated.groups["view.issue.opsbar"].sort()},_mergeToolsLinks:function(j,g,f,a,k,b){a.updated.groups["jira.issue.tools"]=false;var m=_.find(g.issue.operations.linkGroups,function(n){return"jira.issue.tools"===n.id});var l=_.find(j,function(n){return"jira.issue.tools"===n.id});var h={};if(l){a.updated.groups["jira.issue.tools"]=true;_.each(l.links,function(n){h[n.id]=n});if(l.groups&&l.groups.length>0){_.each(l.groups[0].links,function(n){h[n.id]=n})}}if(m){var c=[];if(l){_.each(l.links,function(n){var o=_.find(m.links,function(p){return n.id===p.id});if(!o){c.push(n)}})}_.each(m.links,function(n){if(h[n.id]){c.push(h[n.id])}else{if(!_.contains(k,n.id)){c.push(n)}}});c.sort(b);m.links=c;var i=null;if(l&&l.groups&&l.groups.length>0){i=l.groups[0]}if(m.groups&&m.groups.length>0){var e=m.groups[0];var d=[];if(i){_.each(i.links,function(n){var o=_.find(e.links,function(p){return n.id===p.id});if(!o){d.push(n)}})}_.each(e.links,function(n){if(h[n.id]){d.push(h[n.id])}else{if(!_.contains(k,n.id)){d.push(n)}}});m.groups=[];if(d.length>0){d.sort(b);e.links=d;m.groups[0]=e}}else{if(i){m.groups=[i]}}f.push(m)}else{if(l){f.push(l)}}},_comparator:function(b,a){if(b.weight&&a.weight){if(b.weight>a.weight){return 1}if(b.weight<a.weight){return -1}return 0}if(b.weight&&!a.weight){return 1}if(!b.weight&&a.weight){return -1}return 0},updateIssue:function(a,c){var b=this.getMeta(a);if(b&&b.value){b.value.fields=c.fields||{}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueFieldUtil.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueFieldUtil");JIRA.Components.IssueViewer.Legacy.IssueFieldUtil={getFieldSelector:function(a){if(a==="issuetype"){return"#type-val"}else{if(a==="fixVersions"){return"#fixfor-val"}else{if(a==="summary"){return"#summary-val"}else{if(a==="labels"){return"#wrap-labels .value"}else{if(a==="duedate"){return"#due-date"}else{return"#"+a+"-val"}}}}}},matchesFieldSelector:function(a){return jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(a)).length===1},transformFieldHtml:function(a){a.fields=_.map(a.fields,function(c){var b=AJS.$("<div />").htmlCatchExceptions(c.editHtml);b.find("legend,label").eq(0).remove();return{id:c.id,label:c.label,editHtml:b.html(),required:c.required,contentId:c.contentId}});return a},getAccessKeyModifier:function(){var b=AJS.$("#home_link_drop").attr("title"),a=/\(([\w\+]+)\+\w\)/i;if(a.test(b)){return a.exec(b)[1]}else{return"Alt"}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditor.js' */
AJS.namespace("JIRA.Components.IssueEditor");JIRA.Components.IssueEditor=JIRA.Components.IssueViewer.extend({namedEvents:["loadComplete","loadError","returnToSearch","saveSuccess","saveError","editField","fieldSubmitted","replacedFocusedPanel"],initialize:function(a){JIRA.Components.IssueViewer.prototype.initialize.call(this,a);this._buildFieldsLoader();this._buildIssueSaver();this._buildEditIssueController();this._buildFieldsController();this._buildDeferredErrorController();this._handleUnload();this.listenAndRethrow(this.eventBus,"fieldSubmitted")},_buildFieldsLoader:function(){this.fieldsLoader=new JIRA.Components.IssueEditor.Services.FieldsLoader({contextPath:contextPath});this.listenTo(this.fieldsLoader,"fieldsLoaded",function(a){this.viewIssueData.updateIssue(a.issueKey,a);a.issueId=Number(a.issueId);var b=a.fields&&a.fields.length;if(b){this.editIssueController.update(a);this.deferredErrorController.fixPreviousIssueError(a.issueId)}else{this.editIssueController.reset()}JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})});this.listenTo(this.fieldsLoader,"fieldsError",function(a){this.fieldsController.showError(a.errorCollection,a.isTimeout);JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})})},_buildIssueSaver:function(){this.saveInProgressManager=new JIRA.Components.IssueEditor.Services.SaveInProgressManager();this.issueSaver=new JIRA.Components.IssueEditor.Services.IssueSaver({saveInProgressManager:this.saveInProgressManager,model:this.model});this.listenTo(this.issueSaver,"deferredError",function(d){var f=d.issueId;var a=d.issueKey;var c=d.attemptedSavedIds;var b=d.response;var e=d.duration;this.deferredErrorController.show({issueEntity:{id:f,key:a},attemptedSavedIds:c,response:b});if(this.model.isCurrentIssue(f)){this.editIssueController.cancelEdit()}this.trigger("saveError",{issueId:f,duration:e,deferred:true})});this.listenTo(this.issueSaver,"error",function(d){var f=d.issueId;var c=d.attemptedSavedIds;var b=d.response;var e=d.duration;this.eventBus.triggerSaveError(f,c,b);var a=b&&b.fields&&b.fields.length;if(!a&&b){this.editIssueController.reset();this.model.update(b,{fieldsSaved:[],fieldsInProgress:[]})}this.trigger("saveError",{issueId:f,duration:e,deferred:false});JIRA.trace("jira.issue.refreshed",{id:f})});this.listenTo(this.issueSaver,"saveStarted",function(a,b){this.eventBus.triggerSavingStarted(b)});this.listenTo(this.issueSaver,"save",function(i){var g=i.issueId;var c=i.issueKey;var f=i.savedFieldIds;var e=i.response;var h=i.shouldSkipSaveIssueSuccessHandler;var d=i.duration;if(this.model.isCurrentIssue(g)&&!h){this.eventBus.triggerSaveSuccess(g,c,f,e);this.viewIssueData.set(c,e);var a=this.editIssueController.getEditsInProgress();this.model.update(e,{fieldsSaved:f,fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.trace("jira.psycho.issue.refreshed",{id:g});var b=e.fields&&e.fields.length;if(b){this.editIssueController.update({fields:e.fields,issueId:g,issueKey:c},{editable:true,editIssueController:this.editIssueController,issueModel:this.model,issueId:g,fieldsSaved:f,initialize:false,fieldsInProgress:this.editIssueController.getEditsInProgress()})}JIRA.trace("jira.issue.refreshed",{id:g})}this.trigger("saveSuccess",{issueId:g,savedFieldIds:f,duration:d})})},_buildEditIssueController:function(){this.editIssueController=new JIRA.Components.IssueEditor.Controllers.EditIssue({issueEventBus:this.eventBus});this.listenTo(this.editIssueController,"save",function(e,a,c,d,b){this.issueSaver.setSkipSaveIssueSuccessHandler(false);this.issueSaver.save(e,a,c,d,b)});this.listenAndRethrow(this.editIssueController,"editField")},_buildFieldsController:function(){this.fieldsController=new JIRA.Components.IssueEditor.Controllers.Fields()},_buildDeferredErrorController:function(){this.deferredErrorController=new JIRA.Components.IssueEditor.Controllers.DeferredError({model:this.model});this.listenTo(this.deferredErrorController,"replaySaveError",function(b,e,d){if(this.model.isCurrentIssue(b.id)){var a=this.editIssueController.getFields();if(e&&e.length===1){var g=a.get(e[0]);if(!g.matchesFieldSelector()){new JIRA.Components.IssueEditor.Views.ModalFieldView({issueEventBus:this.eventBus,model:g}).show()}}this.eventBus.triggerSaveError(b.id,e,d);var c=d&&d.fields&&d.fields.length;if(!c){this.editIssueController.reset();this.model.update(d)}var f=a.filter(function(h){return h.getEditing()});if(f.length===1){f[0].triggerFocusRequested()}}else{this.loadIssue(b)}})},_onIssueLoaded:function(c,d,a){if(c.issue.isEditable){var b=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();if(b&&!d.error&&!d.fromCache){this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:a.issueEntity})}}JIRA.Components.IssueViewer.prototype._onIssueLoaded.call(this,c,d,a);if(c.fields){this.editIssueController.update({fields:c.fields,issueId:c.issue.id,issueKey:c.issue.key});JIRA.trace("jira.issue.fields.loaded",{id:c.issue.id})}},_handleUnload:function(){var a=_.bind(function(){var b;if(this.editIssueController.getDirtyEditsInProgress().length>0){b="You are still editing this page. Are you sure you want to leave?"}return b},this);this.unloadInterceptor=new JIRA.Components.IssueEditor.Services.UnloadInterceptor();this.unloadInterceptor.addAfterEvent(a);this.on("destroy",function(){this.unloadInterceptor.removeAfterEvent(a)})},_updateModel:function(c,a){var b=c.fields&&c.fields.length;if(b){this.editIssueController.update(c.fields,{fieldsInProgress:this.editIssueController.getEditsInProgress(),changed:a.changed})}a=_.extend({},a,{fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.Components.IssueViewer.prototype._updateModel.call(this,c,a)},_loadIssueFromDom:function(a){if(AJS.Meta.get("server-view-issue-is-editable")){this.editIssueController.setIssueId(a.id);this.editIssueController.setIssueKey(a.key);this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:a});AJS.Meta.set("server-view-issue-is-editable",null)}JIRA.Components.IssueViewer.prototype._loadIssueFromDom.call(this,a)},editField:function(c){if(!c.isEditable()){return}var a=this.model.getEntity();var b=_.bind(function(){if(c.matchesFieldSelector()){c.edit()}else{new JIRA.Components.IssueEditor.Views.ModalFieldView({issueEventBus:this.eventBus,model:c,issue:a}).show()}},this);if(!c.getSaving()){b()}else{JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){b()})}},abortPending:function(){this.fieldsLoader.cancel();JIRA.Components.IssueViewer.prototype.abortPending.call(this)},beforeHide:function(){this.issueSaver.setSkipSaveIssueSuccessHandler(true);JIRA.Components.IssueViewer.prototype.beforeHide.call(this)},setContainer:function(a){this.editIssueController.setIssueViewContext(a);JIRA.Components.IssueViewer.prototype.setContainer.call(this,a)},dismiss:function(){this.editIssueController.reset();JIRA.Components.IssueViewer.prototype.dismiss.call(this)},getFields:function(){return this.editIssueController.getFields()},hasSavesInProgress:function(){return this.saveInProgressManager.hasSavesInProgress()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditorAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.AppModule");JIRA.Components.IssueEditor.AppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueEditor({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.commands.call(this,a);return _.extend(b,{editField:true})},requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return a.getFields()},hasSavesInProgress:true})},events:function(b){var a=JIRA.Components.IssueViewer.AppModule.prototype.events.call(this,b);return a.concat(["saveSuccess","saveError","editField","fieldSubmitted"])}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/NoInlineAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.AppModule");JIRA.Components.IssueEditor.NoInlineAppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return[]},hasSavesInProgress:function(){return false}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/templates/Fields.soy' */
// This file was automatically generated from Fields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueEditor == 'undefined') { JIRA.Templates.IssueEditor = {}; }
if (typeof JIRA.Templates.IssueEditor.Fields == 'undefined') { JIRA.Templates.IssueEditor.Fields = {}; }


JIRA.Templates.IssueEditor.Fields.saveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var issueLink__soy3 = new soy.StringBuilder();
  if (opt_data.isAccessible) {
    JIRA.Templates.IssueEditor.Fields.issueAnchor(opt_data, issueLink__soy3);
  } else {
    issueLink__soy3.append(soy.$$escapeHtml(opt_data.issueKey));
  }
  issueLink__soy3 = issueLink__soy3.toString();
  output.append(AJS.format("Saving of \x3cstrong\x3e{0}\x3c/strong\x3e failed!",issueLink__soy3), '<ul>');
  var messageList12 = opt_data.errors;
  var messageListLen12 = messageList12.length;
  for (var messageIndex12 = 0; messageIndex12 < messageListLen12; messageIndex12++) {
    var messageData12 = messageList12[messageIndex12];
    output.append('<li>', soy.$$escapeHtml(messageData12), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="', soy.$$escapeHtml(opt_data.issue.id), '-form" class="ajs-dirty-warning-exempt aui" action= "#"><div class="inline-edit-fields">', opt_data.issue.editHtml, '</div><span class="overlay-icon throbber" /><div class="save-options"><button type="submit" class="aui-button submit" accessKey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-success">', soy.$$escapeHtml("Save"), '</span></button><button type="cancel" class="aui-button cancel" accessKey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Cancel"), '</span></button></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("Edit {0} for {1}",opt_data.field.label,opt_data.issue.key)), '</h2><form action="" class="aui" method="post"><div class="form-body">', opt_data.field.editHtml, '</div><div class="buttons-container form-footer"><div class="buttons"><input class="button" type="submit" value="', soy.$$escapeHtml("Submit"), '"/><a class="cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error">');
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else if (opt_data.messages.length > 0) {
    output.append('<ul>');
    var messageList63 = opt_data.messages;
    var messageListLen63 = messageList63.length;
    for (var messageIndex63 = 0; messageIndex63 < messageListLen63; messageIndex63++) {
      var messageData63 = messageList63[messageIndex63];
      output.append('<li>', soy.$$escapeHtml(messageData63), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.resumableSaveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueEditor.Fields.saveErrorMessage(opt_data, output);
  output.append('<p><a href="#" id="fix" class="fix" data-key="', soy.$$escapeHtml(opt_data.issueKey), '">', (opt_data.isCurrentIssue) ? soy.$$escapeHtml("Fix errors") : soy.$$escapeHtml("Return to Issue"), '</a></p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data.errorMessages) {
    output.append('<ul>');
    var msgList90 = opt_data.errorMessages;
    var msgListLen90 = msgList90.length;
    for (var msgIndex90 = 0; msgIndex90 < msgListLen90; msgIndex90++) {
      var msgData90 = msgList90[msgIndex90];
      output.append('<li>', soy.$$escapeHtml(msgData90), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldModel.js' */
AJS.namespace("JIRA.Components.IssueEditor.Models.Field");JIRA.Components.IssueEditor.Models.Field=JIRA.Issues.Brace.Model.extend({namedEvents:["editingStarted","focusRequested","editingCancelled","save","saveError","savingStarted","saveComplete","saveSuccess","updateRequired","validationError","modelDestroyed"],namedAttributes:["id","initParams","params","editHtml","viewHtml","required","fieldType","editing","saving","error","label","contentId"],initialize:function(){if(this.collection){var a=this;this.collection.on("reset",function(){a.triggerModelDestroyed()})}this.on("change:viewHtml",function(){var b=this.previous("viewHtml");if(b){jQuery.cleanData(b)}});this.onModelDestroyed(function(){var b=this.getViewHtml();if(b){jQuery.cleanData(b)}})},blurEdit:function(){if(this.getEditing()){if(this.isDirty()||this.hasValidationError()){this.save()}else{this.cancelEdit()}}},setValidationError:function(c,b,a){this.setSaving(false);this.setError(b);this.edit({ignoreBlur:true});this.triggerSaveError();this.triggerValidationError(c,a)},handleSaveError:function(){this.setSaving(false);this.triggerSaveError()},cancelEdit:function(b){if(!this.cancelLocked){var a=new AJS.$.Event(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL);JIRA.trigger(a,[this.getId(),this.getFieldType(),b]);if(!a.isDefaultPrevented()){this.cancelLocked=true;if(this.getEditing()||this.getSaving()){this.setEditing(false);this.setSaving(false);this.unset("params");this.unset("initParams");this.triggerEditingCancelled();this.unset("viewHtml")}delete this.cancelLocked}}},edit:function(a){if(!this.getEditing()){this.setEditing(true);this.triggerEditingStarted(this,a)}else{if(!a||!a.ignoreBlur){this.triggerFocusRequested(this,a)}}},getCurrentParams:function(){this.triggerUpdateRequired();var c={};if(this.getParams()){c=this.getParams()}else{if(this.getInitParams()){c=this.getInitParams()}else{var b=AJS.$("<div />").html(this.getEditHtml());this.setInitParams(b.serializeObject());c=this.getInitParams()}}var a={};_.each(c,function(e,d){a[d]=e});return a},isEditable:function(){if(this.getEditHtml()){return AJS.$(this.getEditHtml()).find("textarea, :text,:radio,:checkbox, select").length!==0}return false},hasValidationError:function(){return !!this.getError()},switchElToEdit:function(a){if(!this.getViewHtml()){this.setViewHtml(a.contents())}a.contents().detach();a.html(JIRA.Templates.IssueEditor.Fields.field({issue:this.toJSON(),accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));if(!this.getInitParams()){this.setInitParams(a.serializeObject())}this.setEditing(true)},update:function(a){if(this.getEditing()){this.setParams(a.serializeObject())}},handleSaveSuccess:function(){this.setSaving(false);this.setEditing(false);this.unset("viewHtml");this.unset("initParams");this.setError(null);this.triggerSaveSuccess()},handleSaveStarted:function(){this.setSaving(true);this.triggerSavingStarted()},save:function(){if(!this.getSaving()){this.triggerUpdateRequired();this.triggerSave(this)}},isDirty:function(){this.triggerUpdateRequired();return this._isDirty(this.getCurrentParams())},_isDirty:function(a){return JSON.stringify(a)!==JSON.stringify(this.getInitParams())},matchesFieldSelector:function(){return JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.matchesFieldSelector(this.id)}},{IS_EDITABLE:function(a){return a.isEditable()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldCollection.js' */
AJS.namespace("JIRA.Components.IssueEditor.Collections.Fields");JIRA.Components.IssueEditor.Collections.Fields=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueEditor.Models.Field,initialize:function(){this.on("editingStarted",this._handleEditingStarted,this)},_handleEditingStarted:function(b,a){a=a||{};if(a.ignoreBlur){return}this.each(function(c){if(b!==c&&c.getEditing()){c.blurEdit()}})},update:function(e,c){var a=this;if(c&&c.changed){var b=c.changed;var f=b.updated?b.updated.fields:[];var d=b.added?b.added.fields:[];_.each(e,function(h){if(_.contains(f,h.id)){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}}else{if(_.contains(d,h.id)){a.add(h)}}})}else{_.each(e,function(h){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}})}},cancelEdit:function(){this.each(function(a){a.cancelEdit()})},isDirty:function(){return this.any(function(a){return a.isDirty()})},getDirtyFields:function(){return this.filter(function(a){return a.isDirty()})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/DeferredErrorView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.DeferredError");JIRA.Components.IssueEditor.Views.DeferredError=JIRA.Marionette.ItemView.extend({events:{"click .fix":"_onFix","click .issue-key":"_onFix"},initialize:function(a){this.isCurrentIssue=a.isCurrentIssue;this.issueEntity=a.issueEntity;this.attemptedSavedIds=a.attemptedSavedIds;this.response=a.response;this.template=_.bind(this.template,this)},template:function(b){var c=_.any(this.response.fields,function(d){return d.id===this.attemptedSavedIds[0]&&d.editHtml},this);var a=c?"resumableSaveErrorMessage":"saveErrorMessage";return JIRA.Templates.IssueEditor.Fields[a](b)},serializeData:function(){var a=this.response.errorCollection;var b;if(a){b=a.errorMessages.concat(_.values(a.errors))}else{b=[]}return{errors:b,issueKey:this.issueEntity.key,isAccessible:!!(this.response.fields&&this.response.fields.length),isCurrentIssue:this.isCurrentIssue}},_onFix:function(a){this.trigger("fixError")},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/FieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.FieldView");JIRA.Components.IssueEditor.Views.FieldView=JIRA.Marionette.ItemView.extend({events:{"click .cancel":"onClickCancel",keyup:"onKeyCancel","click .submit":"onSubmit",click:"onEdit",mousedown:"saveSelectedText","submit form":"onSubmit",'keydown select[multiple="multiple"]':"_enterToSubmitMultiSelect","keypress select":"_enterToSubmitSelect","beforeBlurInput *":"_preventBlurByEsc"},initialize:function(b){this.model.on("validationError",this.handleValidationError,this);this.model.on("editingStarted",this.switchToEdit,this);this.model.on("focusRequested",this.focus,this);this.model.on("editingCancelled",this.switchToRead,this);this.model.on("saveError",this.handleSaveError,this);this.model.on("updateRequired",this.updateModel,this);this.model.on("savingStarted",this.handleSavingStarted,this);this.model.on("modelDestroyed",this.destroy,this);this.decorate();this.issueEventBus=b.issueEventBus;this.issueEventBus.on("panelRendered",this.handlePanelRendered,this);this.model.setFieldType(this.$el.data("fieldtypecompletekey"));this._editDelay=0;var a=this;JIRA.bind(JIRA.Events.INLINE_EDIT_BLURRED,function(d,c){if(c===a.model.getId()){a._onPossibleBlur()}});JIRA.bind(JIRA.Events.INLINE_EDIT_REQUESTED,function(d,c){if(c!==a.model.getId()&&a._editDelay!==0){clearTimeout(a._editDelay);a._editDelay=0}})},destroy:function(){this.issueEventBus.off("panelRendered",this.handlePanelRendered)},decorate:function(){if(this.model.isEditable()&&!this.model.getEditing()){this.$el.addClass("editable-field inactive");this.$el.append('<span class="overlay-icon aui-icon aui-icon-small aui-iconfont-edit" />');this._addToolTip()}},getEditElements:function(){return this.$el.find(".inline-edit-fields")},_addToolTip:function(){this.$el.attr("title","Click to edit");jQuery("a:not([title])",this.$el).attr("title","Follow link")},_removeToolTip:function(){this.$el.removeAttr("title")},_stealAccessKeys:function(){jQuery("[accessKey='"+"s"+"']").attr("accessKey","_s");jQuery("[accessKey='"+"`"+"']").attr("accessKey","_x")},_returnAccessKeys:function(){jQuery("[accessKey=_s]").attr("accessKey","s");jQuery("[accessKey=_x]").attr("accessKey","`")},_handleEditingStarted:function(a){var b=this.$el.find(".field-tools");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.inlineEditStarted]);JIRA.trigger(JIRA.Events.INLINE_EDIT_STARTED,[this.model.getId(),this.model.getFieldType(),this.getEditElements(),this.$el]);this.$el.find(".textarea").css("height",Math.max(this._originalHeight,60)).expandOnInput(jQuery(window).height()-jQuery("#stalker").height()-100);if(a){this.$el.find(":input:visible:first").focus()}if(!this.$el.find(".error").size()){this.$el.find("select.aui-ss-select").each(function(){var c=jQuery(this);if(c.data("static-suggestions")){c.trigger("showSuggestions")}})}this.$el.find(".save-options").attr("tabindex",1).prepend(b)},handleValidationError:function(b,a){this.$el.html(JIRA.Templates.IssueEditor.Fields.field({issue:{id:this.model.id,editHtml:b},accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));this.$el.find(".error").addClass("inline-edit-error").attr("data-field",this.model.id);this._handleEditingStarted(a)},handlePanelRendered:function(a,b){var c=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(this.model.id),b);if(c.length===1){this.$el=c;this.el=this.$el[0];this.decorate();this.delegateEvents()}},handleSaveError:function(){this.$el.find(":input").removeAttr("disabled").trigger("enable");this.$el.removeClass("saving saving-"+this.model.id)},handleSavingStarted:function(){this.$el.find(":input").attr("disabled","disabled").trigger("disable");this.$el.addClass("saving saving-"+this.model.id)},updateModel:function(){this.model.update(this.$el)},reveal:function(){var a=40;this.$el.scrollIntoView({direction:"y",marginBottom:a,marginTop:AJS.$("#stalker").outerHeight(true)+a});this.$el.trigger("reveal")},focus:function(){this.reveal();this.$el.find(":input").removeAttr("disabled");if(jQuery(".aui-blanket").length===0){var a=this.$el.find(":input:visible:first");a.focus();if(!this.$el.hasClass("field-ignore-highlight")){a.select()}}},switchToEdit:function(){this.trigger("editField",{fieldId:this.model.getId()});this._stealAccessKeys();this._removeToolTip();this.$el.removeClass("inactive saving").addClass("active");this._originalHeight=this.$el.height();this.model.switchElToEdit(this.$el);this._handleEditingStarted();this.focus()},switchToRead:function(){this._addToolTip();this.$el.addClass("inactive").removeClass("active");this.$el.html(this.model.getViewHtml());this.$el.closest("form").unbind("submit",this.onSubmit);this._returnAccessKeys()},onKeyCancel:function(a){if(a.keyCode===27){this.model.cancelEdit(JIRA.Issues.CANCEL_REASON.escPressed);a.preventDefault()}},onClickCancel:function(a){this.model.cancelEdit();a.preventDefault()},onSubmit:function(b){var a=new jQuery.Event("before-submit");this.$el.find("form").trigger(a);if(!a.isDefaultPrevented()){this.$el.find(":focus").blur();this.issueEventBus.triggerFieldSubmitted();this.model.save();this._returnAccessKeys()}b.preventDefault()},onEdit:function(f){var e=AJS.$(f.target).is(".overlay-icon.aui-iconfont-edit");var c=AJS.$(f.target).closest("a, .uneditable").length===0&&this.$el.hasClass("inactive");var d=this._getCurrentlySelectedText()===""&&!this._previouslySelectedText;var b=c&&(e||d);if(this._editDelay!==0){clearTimeout(this._editDelay);this._editDelay=0}else{if(b){JIRA.trigger(JIRA.Events.INLINE_EDIT_REQUESTED,[this.model.getId()]);var a=this;if(e){jQuery(document).one("click",function(g){if(!g.isDefaultPrevented()){a.model.edit()}})}else{this._editDelay=setTimeout(function(){if(!f.isDefaultPrevented()&&a.$el.hasClass("inactive")&&a._getCurrentlySelectedText()===""){a.model.edit()}a._editDelay=0},250)}}}},_onPossibleBlur:function(){if(this.model.getSaving()){return}if(jQuery(".aui-blanket").length>0){return}this.model.blurEdit()},_preventBlurByEsc:function(a){a.preventDefault()},_getCurrentlySelectedText:function(){if(jQuery(document.activeElement).is(":input")){return""}if(document.selection&&document.selection.createRange){return document.selection.createRange().text||""}if(window.getSelection){return window.getSelection().toString()}return""},_enterToSubmitSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){a.preventDefault();jQuery(a.target).closest("form").submit()}}},_enterToSubmitMultiSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){jQuery(a.target).blur()}}},saveSelectedText:function(){this._previouslySelectedText=this._getCurrentlySelectedText()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/ModalFieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.ModalFieldView");JIRA.Components.IssueEditor.Views.ModalFieldView=JIRA.Marionette.ItemView.extend({errorsTemplate:JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors,template:JIRA.Templates.IssueEditor.Fields.modalField,initialize:function(a){_.bindAll(this,"_onHide","_onSubmit","_remove","_showGeneralError","_showValidationError","_updateModel");JIRA.bind("Dialog.hide",this._onHide);this.issueEventBus=a.issueEventBus;this.issueEventBus.on("saveError",this._showGeneralError);this.model.onSaveSuccess(this._remove);this.model.onUpdateRequired(this._updateModel);this.model.onValidationError(this._showValidationError)},_enable:function(){var b=this._getDialog();b.hideFooterLoadingIndicator();var a=b.$popup;a.find(":input").removeAttr("disabled").trigger("enable");a.find(":input:first").focus().select();a.find(":submit").removeAttr("disabled")},_getDialog:function(){if(!this._dialog){this._dialog=new JIRA.FormDialog({id:"modal-field-view",submitHandler:this._onSubmit,content:_.bind(function(a){a(this.template({field:this.model.toJSON(),issue:this.options.issue}))},this)});this._dialog.get$popup().data("field-id",this.model.getId())}return this._dialog},_onHide:function(a,b){if(b===this._getDialog().get$popup()){this._remove()}},_onSubmit:function(c,b){c.preventDefault();this.model.save();b();var a=this._getDialog();a.showFooterLoadingIndicator();a.$popup.find(":input").attr("disabled","disabled").trigger("disable")},close:function(){this._remove()},_remove:function(b){var a=this._getDialog();if(a.get$popup().is(":visible")){a.hide()}a.destroy();this.model.cancelEdit();JIRA.unbind("Dialog.hide",this._onHide);this.issueEventBus.off("saveError",this._showGeneralError);this.model.off("saveSuccess",this._remove);this.model.off("updateRequired",this._updateModel);this.model.off("validationError",this._showValidationError)},show:function(){this.model.edit();this._getDialog().show()},_showGeneralError:function(f,b,a){this._enable();var d=this._getDialog().$popup;var g=a&&a.errorCollection;if(g){var c=!_.isEmpty(g.errors),e=!_.isEmpty(g.errorMessages);if(!c&&e){d.find(".form-body").append(this.errorsTemplate({messages:g.errorMessages}))}}},_showValidationError:function(a){this._enable();this._getDialog().$popup.find(".form-body").html(a)},_updateModel:function(){this.model.update(this._getDialog().$popup)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/LoadingError.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.LoadingError");JIRA.Components.IssueEditor.Views.LoadingError=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueEditor.Fields.errorsLoading,initialize:function(b,a){this.errorMessages=b;this.isTimeout=a},serializeData:function(){return{errorMessages:this.errorMessages,isTimeout:this.isTimeout}},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/DeferredErrorController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.DeferredError");JIRA.Components.IssueEditor.Controllers.DeferredError=JIRA.Marionette.Controller.extend({initialize:function(a){this.model=a.model},close:function(){if(this.view){this.view.close();this.stopListening(this.view);delete this.view}},fixPreviousIssueError:function(a){if(this.view&&this.issueEntity.id===a){this.fixError();this.close()}},fixError:function(){this.trigger("replaySaveError",this.issueEntity,this.attemptedSavedIds,this.response)},show:function(a){this.issueEntity=a.issueEntity;this.attemptedSavedIds=a.attemptedSavedIds;this.response=a.response;this.close();this.triggerMethod("before:render");this.view=new JIRA.Components.IssueEditor.Views.DeferredError({issueEntity:this.issueEntity,attemptedSavedIds:this.attemptedSavedIds,response:this.response,isCurrentIssue:this.model.isCurrentIssue(this.issueEntity.id)});this.view.render();this.listenTo(this.view,"close",this.close);this.listenTo(this.view,"fixError",this.fixError);this.triggerMethod("render")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/EditIssueController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.EditIssue");JIRA.Components.IssueEditor.Controllers.EditIssue=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId","issueKey","issueViewContext","fields","issueEventBus"],namedEvents:["save","editField"],initialize:function(){_.bindAll(this,"_handleSaveError","_handleSaveSuccess","_handleSavingStarted","cancelUneditedFields","createFieldView","handleFieldUpdate","save");this.set({fields:new JIRA.Components.IssueEditor.Collections.Fields()},{silent:true});this.getFields().bind("add",this.createFieldView).bind("updated",this.handleFieldUpdate).bind("save",this.save);this.getIssueEventBus().onSavingStarted(this._handleSavingStarted);this.getIssueEventBus().onSaveSuccess(this._handleSaveSuccess);this.getIssueEventBus().onSaveError(this._handleSaveError);this.getIssueEventBus().onSave(this.save);this.getIssueEventBus().onSave(this.cancelUneditedFields)},_saveById:function(b){var a=this.getFields().get(b);if(a){a.blurEdit()}},_handleSaveError:function(d,c,b){var a=this;if(b){this.applyErrors(b)}else{_.each(c,function(f){var e=a.getFields().get(f);if(e){e.handleSaveError()}})}},_handleSavingStarted:function(a){this.getFields().each(function(b){if(_.include(a,b.id)){b.handleSaveStarted()}})},handleFieldUpdate:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id));if(!a.hasClass("editable-field")){this.createFieldView(b)}},applyErrors:function(d,c){var a=d.errorCollection;if(a&&a.errors){this.getFields().each(function(e){if(a.errors[e.id]){var f=_.find(d.fields,function(g){return g.id==e.id});if(f){e.setValidationError(f.editHtml,a.errors[e.id],c);c=false}}})}if(a.errorMessages&&a.errorMessages.length){var b=JIRA.Templates.IssueEditor.Fields.saveErrorMessage({errors:a.errorMessages,issueKey:this.getIssueKey()});JIRA.Messages.showErrorMsg(b,{closeable:true})}},reset:function(){this.getFields().reset()},cancelEdit:function(){this.getFields().each(function(a){a.cancelEdit()})},_handleSaveSuccess:function(c,a,d){var b=this.getFields().filter(function(e){return _.indexOf(d,e.id)>=0});_.each(b,function(e){e.handleSaveSuccess()})},getDirtyEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()&&a.isDirty()}),"id")},getEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()}),"id")},save:function(b,a){var e={},d=[];var c=[b];if(!b){c=this.getFields().filter(function(f){return !f.getSaving()&&f.getEditing()&&f.isDirty()})}else{if(!b.getEditing()||b.getSaving()){return}}_.each(c,function(f){d.push(f.getId());_.extend(e,f.getCurrentParams())});if(d.length>0){this.triggerSave(this.getIssueId(),this.getIssueKey(),d,e,a)}},cancelUneditedFields:function(){this.getFields().each(function(a){if(a.getEditing()&&!a.isDirty()&&!a.hasValidationError()){a.cancelEdit()}})},update:function(b,a){if(b.fields){if(a&&a.fieldsInProgress){_.each(b.fields,function(c){if(_.contains(a.fieldsInProgress,c.id)){c.editing=true}})}this.getFields().update(b.fields,a)}if(b.issueId){this.setIssueId(b.issueId)}if(b.issueKey){this.setIssueKey(b.issueKey)}},createFieldView:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id),this.getIssueViewContext());if(a.length===1){var c=new JIRA.Components.IssueEditor.Views.FieldView({model:b,el:a,issueEventBus:this.getIssueEventBus()});c.on("editField",_.bind(function(d){this.trigger("editField",d)},this))}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/FieldsController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.Fields");JIRA.Components.IssueEditor.Controllers.Fields=JIRA.Marionette.Controller.extend({showError:function(b,a){if(b||a){var c=b.errorMessages||[];this.close();this.triggerMethod("before:render");this.view=new JIRA.Components.IssueEditor.Views.LoadingError(b,a);this.view.render();this.listenTo(this.view,"close",this.close);this.triggerMethod("render")}},close:function(){if(this.view){this.view.close();this.stopListening(this.view);delete this.view}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/FieldsLoaderService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.FieldsLoader");JIRA.Components.IssueEditor.Services.FieldsLoader=JIRA.Marionette.Controller.extend({initialize:function(a){this.recurringPromise=jQuery.RecurringPromise().sub();this.recurringPromise.done(_.bind(function(b){this.trigger("fieldsLoaded",b)},this)).fail(_.bind(function(b){this.trigger("fieldsError",b)},this));this.contextPath=a.contextPath},load:function(b){var a=this._buildUpdateTask(b);this.recurringPromise.add(a)},cancel:function(){this.recurringPromise.reset()},_getFieldsData:function(d,a){var c=jQuery.ajax({url:this.contextPath+"/secure/AjaxIssueEditAction!default.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},data:{issueId:d}});var b=c.pipe(function(e){var f=JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);return{issueId:d,issueKey:a,fields:f.fields}},function(j){var g={};var h;switch(j.status){case 400:h=false;try{var f=JSON.parse(j.responseText)||{};g=f.errorCollection}catch(i){}break;case 401:h=false;g=null;break;default:h=true;g={};break}return{issueId:d,fields:null,errorCollection:g,isTimeout:"timeout"===j.statusText,fatalError:h}});b.abort=function(){c.abort.apply(c,arguments)};return b},_buildUpdateTask:function(c){var e=c.viewIssueData;var a=c.issueEntity;var d=c.lastEditData;var b=jQuery.Deferred();e.setPending(a.id,this._getFieldsData(a.id,a.key),function(f){b.resolve(f)},function(f){if(f.fatalError){b.reject(f)}else{b.resolve(f)}});return b.promise()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/IssueSaverService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.IssueSaver");JIRA.Components.IssueEditor.Services.IssueSaver=JIRA.Marionette.Controller.extend({initialize:function(a){this.saveInProgressManager=a.saveInProgressManager;this.model=a.model;this._saveStarted=[];this.saveInProgressManager.onSavingStarted(_.bind(function(b,c){this._saveStarted.push((new Date()).getTime());this.trigger("saveStarted",b,c)},this));this.saveInProgressManager.onSaveSuccess(_.bind(function(d,b,e,c){if(c&&c.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c)}this.trigger("save",{issueId:d,issueKey:b,savedFieldIds:e,response:c,shouldSkipSaveIssueSuccessHandler:this._shouldSkipSaveIssueSuccessHandler,duration:(new Date()).getTime()-this._saveStarted.shift()})},this));this.saveInProgressManager.onSaveError(_.bind(function(g,b,f,d){if(d&&d.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(d)}var e={issueId:g,issueKey:b,attemptedSavedIds:f,response:d,duration:(new Date()).getTime()-this._saveStarted.shift()};var c=this._shouldShowDeferredError(g,f);if(c){this.trigger("deferredError",e)}else{this.trigger("error",e)}},this))},setSkipSaveIssueSuccessHandler:function(a){this._shouldSkipSaveIssueSuccessHandler=a},save:function(e,a,c,d,b){this.saveInProgressManager.saveIssue(e,a,c,d,b)},_shouldShowDeferredError:function(f,e){var c=AJS.$(".aui-blanket:visible").length>0;if(!this.model.isCurrentIssue(f)){return true}if(e.length>1){return c}var b=JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.matchesFieldSelector(e[0]);var a=AJS.$("#modal-field-view").data("field-id");var d=e[0]===a;return !d&&(!b||c)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/SaveInProgressManager.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.SaveInProgressManager");JIRA.Components.IssueEditor.Services.SaveInProgressManager=JIRA.Issues.Brace.Model.extend({namedAttributes:["savesInProgress"],namedEvents:["beforeSaving","savingStarted","saveSuccess","saveError"],initialize:function(){this.setSavesInProgress([])},saveIssue:function(g,b,d,c,h){this.triggerBeforeSaving();var i=this,a,e;e=_.extend(c,{issueId:g,atl_token:atl_token(),singleFieldEdit:true,fieldsToForcePresent:d});var f=_.extend({type:"POST",url:contextPath+"/secure/AjaxIssueAction.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},error:function(j){i._handleSaveError(g,b,d,j)},success:function(n,l,m,j){var k=j.data;if(typeof k=="string"){i._handleHtmlResponse(g,b,d,k)}else{JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(k);i.triggerSaveSuccess(g,b,d,k)}},complete:function(){i.removeSaveInProgress(a);JIRA.trigger(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE)},data:e},h);a=JIRA.SmartAjax.makeRequest(f);this.addSaveInProgress(a);this.triggerSavingStarted(g,d,c)},hasSavesInProgress:function(){return this.getSavesInProgress().length>0},removeSaveInProgress:function(a){this.setSavesInProgress(_.without(this.getSavesInProgress(),a))},addSaveInProgress:function(a){var b=this.getSavesInProgress();b.push(a);this.setSavesInProgress(b)},_handleHtmlResponse:function(h,b,c,e){var a=this;var g=AJS.$(AJS.extractBodyFromResponse(e));var f=g.find("#atl_token").val();if(f){AJS.$("#atlassian-token").attr("content",f)}var d=new JIRA.FormDialog({offsetTarget:"body",content:g});this.triggerSaveError(h,b,c);d._handleServerSuccess=function(i){d.hide();var j=a._parseResponse(i);if(j){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);a.triggerSaveSuccess(h,b,c,j)}};d._handleServerError=function(j){d.hide();var i=a._parseResponse(j.responseText);if(i){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(i);a.triggerSaveError(h,b,c,i)}};d.show()},_handleSaveError:function(e,a,b,d){var c=this._parseResponse(d.responseText);if(c){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this.triggerSaveError(e,a,b,c)}},_parseResponse:function(a){try{return JSON.parse(a)}catch(b){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var a="<p>"+"Communications Breakdown"+"</p><p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(a,{closeable:true})}});JIRA.Events.INLINE_EDIT_SAVE_COMPLETE="inlineEditSaveComplete";
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/UnloadInterceptor.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.UnloadInterceptor");JIRA.Components.IssueEditor.Services.UnloadInterceptor=JIRA.Marionette.Controller.extend({initialize:function(){this._afterEventHandlers=[];this.originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=_.bind(this.onBeforeUnload,this)},addAfterEvent:function(a){this._afterEventHandlers.push(a)},removeAfterEvent:function(a){this._afterEventHandlers=_.without(this._afterEventHandlers,a)},onBeforeUnload:function(){var a,b=arguments;if(_.isFunction(this.originalBeforeUnload)){a=this.originalBeforeUnload.apply(window,b)}if(!a){a=_.reduce(this._afterEventHandlers,function(c,f,d,e){if(c){return c}return f.apply(window,b)},a)}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/InlineEditUtils.js' */
JIRA.Events.INLINE_EDIT_STARTED="inlineEditStarted";JIRA.Events.BEFORE_INLINE_EDIT_CANCEL="inlineEditCancelled";JIRA.Events.INLINE_EDIT_BLURRED="inlineEditBlurred";JIRA.Events.INLINE_EDIT_FOCUSED="inlineEditFocused";JIRA.Events.INLINE_EDIT_REQUESTED="inlineEditRequested";JIRA.Events.LOCK_PANEL_REFRESHING="lockPanelRefreshing";JIRA.Events.UNLOCK_PANEL_REFRESHING="unlockPanelRefreshing";JIRA.Events.REFRESH_ISSUE_PAGE="refreshIssuePage";JIRA.Issues.CANCEL_REASON={escPressed:"escPressed"};AJS.$(function(){AJS.namespace("JIRA.Components.IssueEditor.InlineEditUtils");JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT=50;var a=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggers={Default:function(e,i){i=i.nextAll(".save-options").andSelf();var h=":input, a[href], [tabindex]";var g;var f=b(i);var d={focus:function(){if(!f){f=true;JIRA.trigger(JIRA.Events.INLINE_EDIT_FOCUSED,[e])}},blur:function(){if(g){clearTimeout(g)}g=setTimeout(c,JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT)}};i.attr("tabindex",1).bind(d).delegate(h,d);function c(){if(!b(i)){f=false;JIRA.trigger(JIRA.Events.INLINE_EDIT_BLURRED,[e])}}}};function b(d){var c=document.activeElement;return d.find(c).length>0||d.filter(c).length>0}JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping={system:{summary:a.Default,priority:a.Default,issuetype:a.Default,components:a.Default,versions:a.Default,fixVersions:a.Default,assignee:a.Default,reporter:a.Default,environment:a.Default,description:a.Default,labels:a.Default,duedate:a.Default},custom:{"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datetime":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:float":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:grouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:labels":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:project":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:select":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:url":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:version":a.Default}};JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(h,d,c,i){var g;if(c){g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[c];if(!g){var f=c.replace(/.+:(.+)/,"$1");g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[f]}}else{g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.system[d]}if(g){g(d,i)}})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/legacy/SerializeToObject.js' */
jQuery.fn.serializeObject=function(){var b={};var a=this.find(":input").serializeArray();jQuery.each(a,function(){if(b[this.name]){if(!b[this.name].push){b[this.name]=[b[this.name]]}b[this.name].push(this.value||"")}else{b[this.name]=this.value||""}});return b};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerTemplate.soy' */
// This file was automatically generated from PagerTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Header == 'undefined') { JIRA.Templates.ViewIssue.Header = {}; }


JIRA.Templates.ViewIssue.Header.pager = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="ajax ops page-navigation"><li class="previous">', (opt_data.previousIssue && opt_data.position != 1) ? '<a data-id="' + soy.$$escapeHtml(opt_data.previousIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" id="previous-issue" rel="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" title="' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'"><span class="icon icon-page-prev"><span>' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-prev-deactivated" title="' + soy.$$escapeHtml("Not available - this is the first issue") + '"></span>' : '', '</li><li class="showing">', (opt_data.position && opt_data.resultCount) ? soy.$$escapeHtml(AJS.format("{0} of {1}",opt_data.position,opt_data.resultCount)) : '', '</li><li class="next">', (opt_data.nextIssue && opt_data.position != opt_data.resultCount) ? '<a data-id="' + soy.$$escapeHtml(opt_data.nextIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" href="' + soy.$$escapeHtml("/jira") + '/browse/' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" id="next-issue" rel="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" title="' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'"><span class="icon icon-page-next"><span>' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-next-deactivated" title="' + soy.$$escapeHtml("Not available - this is the last issue") + '"></span>' : '', '</li>', (opt_data.hasSearchLink) ? '<li class="return"><a id="return-to-search" href="' + soy.$$escapeHtml("/jira") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/Pager.js' */
(function(b,a){b.namespace("JIRA.Components.Pager");a.Components.Pager=function(e){var d,c;this.initialize=function(){d=new a.Components.Pager.Model()};this.update=function(f){if(f){d.update(f)}else{d.clear()}};this.show=function(f,g){if(!c){c=new a.Components.Pager.Controller({model:d});c.on("goBack",e.goBack);c.on("nextItem",e.nextItem);c.on("previousItem",e.previousItem)}c.show(f,g)};this.close=function(){if(c){c.close()}c=null;d.clear()}}})(AJS,JIRA);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerModel.js' */
(function(a,b){b.define("JIRA.Components.Pager.Model",a.Issues.BaseModel.extend({properties:["nextIssue","previousIssue","position","resultCount","hasSearchLink"],update:function(c){c.hasSearchLink=!c.isSplitView;delete c.isSplitView;this.set(c)}}))})(JIRA,Backbone);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerView.js' */
(function(a,b,c){AJS.namespace("JIRA.Components.Pager.View");a.Components.Pager.View=a.Marionette.ItemView.extend({template:function(d){return _.isEmpty(d)?"":a.Templates.ViewIssue.Header.pager(d)},events:{"simpleClick #return-to-search":"_onReturnToSearchClick"},triggers:{"simpleClick #next-issue":"nextItem","simpleClick #previous-issue":"previousItem"},ui:{nextIssue:"#next-issue",previousIssue:"#previous-issue",returnToSearch:"#return-to-search"},modelEvents:{change:"render"},onRender:function(){if(AJS.activeShortcuts){AJS.activeShortcuts.j&&AJS.activeShortcuts.j._addShortcutTitle(this.$el.find(this.ui.nextIssue));AJS.activeShortcuts.k&&AJS.activeShortcuts.k._addShortcutTitle(this.$el.find(this.ui.previousIssue));AJS.activeShortcuts.u&&AJS.activeShortcuts.u._addShortcutTitle(this.$el.find(this.ui.returnToSearch))}},_onReturnToSearchClick:function(d){d.preventDefault();this.trigger("goBack");b("body").focus()}})})(JIRA,AJS.$,Backbone);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerController.js' */
(function(a,c,b){c.define("JIRA.Components.Pager.Controller",a.Marionette.Controller.extend({initialize:function(d){this.model=d.model},getView:function(d){if(!this.pagerView){this.pagerView=new a.Components.Pager.View({model:this.model,el:d});this.listenTo(this.pagerView,"close",this.destroyView);this.listenAndRethrow(this.pagerView,["goBack","nextItem","previousItem"])}else{if(d){this.pagerView.setElement(d)}}return this.pagerView},show:function(d){if(d instanceof b.Region){d.show(this.getView())}else{this.getView(d).render()}},onClose:function(){this.pagerView.close()},destroyView:function(){delete this.pagerView}}))})(JIRA,Backbone,JIRA.Libs.Marionette);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerAppModule.js' */
(function(b,a){b.namespace("JIRA.Components.Pager.AppModule");a.Components.Pager.AppModule=function(c,e){var d=new a.Components.Pager({nextItem:function(){a.Issues.Api.nextIssue()},previousItem:function(){a.Issues.Api.prevIssue()},goBack:function(){e.execute("returnToSearch")}});e.addInitializer(function(){d.initialize();e.commands.setHandlers({"pager:update":d.update,"pager:render":d.show,"pager:close":d.close})})}})(AJS,JIRA);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/Application.js' */
AJS.namespace("JIRA.Issues.Application");JIRA.Issues.Application=new JIRA.Marionette.Application();JIRA.Issues.Application.addInitializer(function(){this.module("JIRA.Components.Pager",JIRA.Components.Pager.AppModule);if(AJS.Meta.get("is-inline-edit-enabled")!==false){this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.AppModule().definition)}else{this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.NoInlineAppModule().definition)}this.module("JIRA.Components.Analytics",new JIRA.Components.Analytics.AppModule().definition)});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/FocusShifterService.js' */
AJS.namespace("JIRA.Issues.FocusShifter");JIRA.Issues.FocusShifter.init=function(){return JIRA.Shifter.register(function(){var b;if(JIRA.Issues.Api.issueIsVisible&&!JIRA.Issues.Api.issueIsVisible()){b=[]}else{var a=JIRA.Issues.Api.getFieldsOnSelectedIssue();b=a?JIRA.Issues.FocusShifter.getSuggestions(a):[]}return{id:"edit-fields",name:"Edit Fields",context:JIRA.Issue.getIssueKey(),weight:100,getSuggestions:function(){return jQuery.Deferred().resolve(b)},onSelection:function(c){JIRA.Issues.Api.editFieldOnSelectedIssue(c)}}})};JIRA.Issues.FocusShifter.show=function(){JIRA.Shifter.show()};JIRA.Issues.FocusShifter.getSuggestions=function(a){return _.chain(a.models).filter(JIRA.Components.IssueEditor.Models.Field.IS_EDITABLE).filter(function(b){return b.id!=="comment"}).map(function(b){return{label:b.getLabel(),value:b.id}}).value()};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/Overrides.js' */
JIRA.Messages.showMsgOnReload=function(b,a){JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){a.type=JIRA.Messages.Types[a.type];JIRA.Messages.showMsg(b,a)})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.Util == 'undefined') { JIRA.Templates.Issues.Util = {}; }


JIRA.Templates.Issues.Util.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml("/jira"), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml("/jira"), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/templates/issuenav.soy' */
// This file was automatically generated from issuenav.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.issueTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<thead><tr></tr></thead><tbody></tbody>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-type issue-icon-result persist-result"><div>', soy.$$escapeHtml("T"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-type issue-icon-result persist-result"><img src="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.name), '" title="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.description), '" align="absmiddle" border="0" height="16" width="16"></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-key persist-result"><div>', soy.$$escapeHtml("Key"), '</div></th><th class="issue-summary issue-text-result persist-result"><div>', soy.$$escapeHtml("Summary"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-key-summary issue-text-result persist-result" colspan="2"><div><a href="', soy.$$escapeHtml(opt_data.contextPath), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" class="issue"><span class="secondary-text">', soy.$$escapeHtml(opt_data.issue.key), '</span>', soy.$$escapeHtml(opt_data.issue.fields.summary), '</a></div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-status"><div>', soy.$$escapeHtml("Status"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-status"><div class="status-lozenge">', soy.$$escapeHtml(opt_data.issue.fields.status.name), '</div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-user"><div>', soy.$$escapeHtml("Assignee"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-user">', (opt_data.issue.fields.assignee) ? '<img src="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.avatarUrls['16x16']) + '" alt="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" height="16" width="16" /><a class="user-hover" rel="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" href="#">' + soy.$$escapeHtml(opt_data.issue.fields.assignee.displayName) + '</a>' : soy.$$escapeHtml("Unassigned"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-datetime"><div>', soy.$$escapeHtml("Updated"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-datetime"><time datetime="', soy.$$escapeHtml(opt_data.issue.fields.updated), '">', soy.$$escapeHtml(opt_data.TMP_FORMATTED_DATE), '</time></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-resolution"><div>', soy.$$escapeHtml("Resolution"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-resolution">', (opt_data.issue.fields.resolution) ? soy.$$escapeHtml(opt_data.issue.fields.resolution.name) : soy.$$escapeHtml("Unresolved"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.issueResultsError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="error"><td colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml(opt_data.errorText), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/Notifications.js' */
JIRA.Issues.showNotification=function(){var a={thanks_issue_updated:"{0} has been updated.",thanks_issue_transitioned:"{0} has been updated.",thanks_issue_assigned:"{0} has been assigned.",thanks_issue_commented:"{0} has been updated with your comment.",thanks_issue_worklogged:"Work has been logged on {0}.",thanks_issue_voted:"Your vote on {0} has been updated.",thanks_issue_watched:"Your watcher status on {0} has been updated.",thanks_issue_moved:"{0} has been moved.",thanks_issue_linked:"The links on {0} have been updated.",thanks_issue_cloned:"{0} has been cloned.",thanks_issue_labelled:"The labels on {0} have been updated.",thanks_issue_deleted:"{0} has been deleted.",thanks_issue_attached:"The file(s) have been attached to {0}."};return function(c,b){var d;if(!c){c="thanks_issue_updated"}d=a[c];if(d&&b){d=AJS.format(d,b)}JIRA.Messages.showSuccessMsg(d||c,{closeable:true})}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavRouter.js' */
Backbone.define("JIRA.Issues.IssueNavRouter",JIRA.Issues.BaseRouter.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_restoreSessionSearch","_route");this.route(/^(.*?)([\?]{1}.*)?$/,this._route);this.route(/^(issues\/)?$/,this._restoreSessionSearch);delete Backbone.Router.arrayValueSplit},navigate:function(){this.searchPageModule.removeOpenTipsies();this.trigger("navigate");JIRA.Issues.BaseRouter.prototype.navigate.apply(this,arguments)},pushState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false})},replaceState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false,replace:true})},_restoreSessionSearch:function(){var b=this.initialSessionSearchState,a=JIRA.Issues.URLSerializer.getURLFromState(b||this.searchPageModule.getState());this.navigate(a,{replace:true,trigger:true})},_route:function(d,c){var a=this.toFragment(d,c);if(JIRA.Issues.ignorePopState){return}var b=JIRA.Issues.URLSerializer.getStateFromURL(a);if(!this._navigateToLoginIfNeeded(b)){this._navigateUsingState(b)}},_navigateToLoginIfNeeded:function(c,d){if(!JIRA.Issues.IssueNavRouter.usePushState(d)&&c.selectedIssueKey&&!JIRA.Issues.LoginUtils.isLoggedIn()){var a=this;var b={};if(c.filter!=null){b.filterId=c.filter}jQuery.ajax({url:AJS.contextPath()+"/rest/issueNav/1/issueNav/anonymousAccess/"+c.selectedIssueKey,headers:{"X-SITEMESH-OFF":true},data:b,success:function(){a._navigateUsingState(c)},error:function(e){if(e.status===401){a._redirectToLogin(c)}else{a._navigateUsingState(c)}}});return true}return false},_navigateUsingState:function(a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{replace:true,trigger:false});this.searchPageModule.updateFromRouter(a)}},_redirectToLogin:function(b){var a=AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(JIRA.Issues.URLSerializer.getURLFromState(b));window.location.replace(a)},_setStatePermalink:function(d){var b=_.pick(d,"selectedIssueKey");var c=AJS.Meta.get("jira-base-url");if(!_.isEmpty(b)){AJS.Meta.set("viewissue-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(b))}var a=_.omit(d,"selectedIssueKey");if(!_.isEmpty(a)){AJS.Meta.set("issuenav-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(a))}}},{getBackboneRoot:function(a){return AJS.contextPath()+(this.usePushState(a)?"/":"/i")},usePushState:function(c){var a=(c=c||window.history)&&c.pushState,b=AJS.DarkFeatures.isEnabled("ka.I_ROOT");return a&&!b}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/HandlePushStateInIE.js' */
JIRA.Issues.hashTheUrl=function(b){var d=parseUri(b);var a={changed:false,uri:d};if(d.anchor===""&&d.query!==""){var c=d.protocol+"://"+d.authority+d.path;a.uri=c+"#?"+d.query;a.changed=true}return a};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/DialogCleanup.js' */
JIRA.Issues.dialogCleaner=function(a){a.on("navigate",function(){if(JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(AJS.HelpTip&&AJS.HelpTip.Manager){AJS.HelpTip.Manager.hideSequences();AJS.HelpTip.Manager.clearSequences()}})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavCreator.js' */
JIRA.Issues.IssueNavCreator=function(){};JIRA.Issues.IssueNavCreator.prototype={create:function(p,q){JIRA.Events.LAYOUT_RENDERED="layoutRendered";JIRA.Issues.IssueNavCreated=new Date();var d=this.searchPageModule=new JIRA.Issues.SearchPageModule({},{initialIssueTableState:q.initialIssueTableState});d.registerViewContainers({issueContainer:jQuery(".issue-container"),searchContainer:jQuery(".navigator-container")});var h=this.searchHeaderModule=new JIRA.Issues.SearchHeaderModule({searchPageModule:d});var n=h.createView({searchHeaderEl:p.find("#search-header-view")});var e=new JIRA.Issues.FilterModule({searchPageModule:d,systemFilters:d.addOwnerToSystemFilters(q.systemFilters)});e.createView({$filterPanelEl:p.find(".navigator-sidebar")});var j=JIRA.Components.Query.create({el:p.find("form.navigator-search"),searchers:q.initialSearcherCollectionState,preferredSearchMode:AJS.Meta.get("user.search.mode"),layoutSwitcher:true,autocompleteEnabled:AJS.params.autocompleteEnabled,basicAutoUpdate:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.bind(JIRA.Events.ISSUE_TABLE_REORDER,function(r){if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){r.preventDefault()}});if(!JIRA.Issues.DarkFeatures.KILL_SWITCH.enabled()){this.layoutSwitcherView=new JIRA.Issues.LayoutSwitcherView({searchPageModule:d});this.layoutSwitcherView.setElement(p.find("#layout-switcher-toggle")).render()}var i=JIRA.Issues.Application.request("issueEditor");JIRA.Issues.Application.on("issueEditor:headerRender",function(r){JIRA.Issues.Application.execute("pager:render",r.pager)});JIRA.Issues.Application.commands.setHandler("returnToSearch",function(){JIRA.Issues.Application.execute("issueEditor:close")});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(r){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])});JIRA.Issues.Application.on("issueEditor:saveError",function(r){if(!r.deferred){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])}});JIRA.Issues.FocusShifter.init();var m=i.viewIssueData;var l=new JIRA.Issues.IssueSearchManager({initialIssueTableState:q.initialIssueTableState,initialIssueIds:q.initialIssueIds});var f=new JIRA.Issues.SearchModule({searchPageModule:d,queryModule:j,issueSearchManager:l,initialHighlightedIssueId:q.initialHighlightedIssueId,initialSelectedIssue:q.initialSelectedIssue});var a=new JIRA.Issues.Cache.IssueCacheManager({searchResults:f.getResults(),viewIssueData:m});var b=p.find(".saved-search-selector");var g=new JIRA.Issues.FullScreenIssue({issueContainer:d.issueContainer,searchContainer:d.searchContainer,issueCacheManager:a});d.registerSearch(f);d.registerSearchHeaderModule(h);d.registerFilterModule(e);d.registerQueryModule(j);d.registerFullScreenIssue(g);d.registerIssueSearchManager(l);d.registerIssueCacheManager(a);d.registerLayoutSwitcher(this.layoutSwitcherView);n.render();h.registerSearch(f);h.createToolsView(b);var k=this.issueNavRouter=new JIRA.Issues.IssueNavRouter({searchPageModule:d,initialSessionSearchState:q.initialSessionSearchState});d.registerIssueNavRouter(k);JIRA.Issues.enhanceLinks.toIssueNav({searchPageModule:d});JIRA.Issues.enhanceLinks.withPushState({router:k});JIRA.Issues.enhanceLinks.toIssue({searchPageModule:d});JIRA.Issues.enhanceLinks.transformToAjax();JIRA.Issues.dialogCleaner(k);JIRA.Issues.overrideIssueDialogs({getIssueId:_.bind(d.getEffectiveIssueId,d),isNavigator:true,updateIssue:function(r){var s=JIRA.Issues.Utils.getUpdateCommandForDialog(r);return d.updateIssue(s)}});var c=AJS.$("#quicksearch-message");if(c.length){var o=JIRA.Messages.showWarningMsg(c.find("p").html(),{closeable:true});AJS.$("a",o).click(function(){o.remove()})}jQuery(document).keydown(function(t){var v=jQuery("div.aui-blanket").length>0,r=(t.which===AJS.$.ui.keyCode.ENTER||t.which===AJS.$.ui.keyCode.LEFT||t.which===AJS.$.ui.keyCode.UP||t.which===AJS.$.ui.keyCode.RIGHT||t.which===AJS.$.ui.keyCode.DOWN);if(!v&&r){var s=AJS.$(t.target),u=s.is(":not(:input)");if(s==undefined||u){if(t.which===AJS.$.ui.keyCode.ENTER){if(s==undefined||s.is(":not(a)")){JIRA.Issues.Api.viewSelectedIssue()}}else{if(t.which===AJS.$.ui.keyCode.LEFT){d.handleLeft()}else{if(t.which===AJS.$.ui.keyCode.RIGHT){d.handleRight()}else{if(t.which===AJS.$.ui.keyCode.UP){if(d.handleUp()){t.preventDefault()}}else{if(t.which===AJS.$.ui.keyCode.DOWN){if(d.handleDown()){t.preventDefault()}}}}}}}}});this._autoUpdateLoginLinks(f.getResults());return this},_autoUpdateLoginLinks:function(a){this.searchResults=a;this.searchPageModule.on("change",this._changeLoginUrl,this);a.on("change",this._changeLoginUrl,this);a.getSelectedIssue().on("change",this._changeLoginUrl,this)},_changeLoginUrl:function(){var a=JIRA.Issues.LoginUtils.redirectUrlToCurrent();jQuery(".login-link").attr("href",a);if(!JIRA.Issues.LoginUtils.isLoggedIn()){jQuery("#header-details-user > a.lnk").attr("href",a)}}};
/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/popupuserprefstore.js' */
/**
 * @fileoverview Implements the gadgets.UserPrefStore interface storing data in a javascript store.
 */
jQuery.namespace("jira.plugin.chartingstore", true);

jira.plugin.chartingstore = function() {
    var userPrefMap = {};
    return {
        get: function (gadgetId) {
            var userPrefs = userPrefMap[gadgetId];
            if(!userPrefs) {
                return {};
            }
            return userPrefs;
        },
        set: function (gadgetId, name, value) {
            var prefs = this.get(gadgetId);
            prefs[name] = value;
            userPrefMap[gadgetId] = prefs;
        },
        clear: function() {
            userPrefMap = {};
        }
    };
}();

gadgets.IfrGadgetService.prototype.setUserPref = function(editToken, name, value) {
    var gadgetId = this.f;
    if(gadgetId) {
        gadgetId = gadgetId.substr("gadget-".length);
    }
    jira.plugin.chartingstore.set(gadgetId, name, value);
};

/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/chartdialog.js' */
/**
 * @module jira.plugin.charting
 * @author Scott Harwood
 * @since 4.0
 * @requires jQuery > v1.6, jQuery.aop
 */

 /*JSLINT options*/
 /*jslint white: true, browser: true, onevar: true, plusplus: true, regexp: true, eqeqeq: true */
 /*global window, document, jQuery, dhtmlHistory, jira*/

jQuery.namespace("jira.plugin.charting");

// singleton
jira.plugin.charting = function () {
    var dialog, /* {Object} jquery object */
    DIALOG_ID = "charts-dialog",
    CHARTS_CATEGORY = "Charts",
    CHART_HEIGHT = 522,
    saveFormLoaded = false,
    idToUriMap = {},
    dialogThrobber = AJS.$('<span class="icon throbber"></span>'),

    getPostData = function(formData) {
        var postData = {};
        jQuery.each(formData, function(i, field) {
            postData[field.name] = field.value;
        });
        var filterId = getFilterId();
        if(filterId) {
            postData.filterId = filterId;
        } else {
            postData.jql = getFilterJql() || "";
        }
        var chartPanelId = dialog.getPage(0).curtab;
        postData.gadgetUri = idToUriMap[chartPanelId];
        var userPrefs = jira.plugin.chartingstore.get(chartPanelId);
        if(userPrefs) {
            var prefsMap = {};
            for (var key in userPrefs) {
                prefsMap[key] = userPrefs[key];
            }
            postData.userPrefs = prefsMap;
        }

        return postData;
    },

    loadSaveToDashboardForm = function() {
        if(!saveFormLoaded) {
            var saveFormUrl = contextPath + "/rest/gadget/1.0/chart/add";
            var filterId = getFilterId();
            if(filterId) {
                saveFormUrl = saveFormUrl + "?filterId=" + encodeURIComponent(filterId);
            } else {
                saveFormUrl = saveFormUrl + "?jql=" + encodeURIComponent(getFilterJql());
            }

            var saveFormPanel = jQuery("#saveToDashboardPanel");
            saveFormPanel.empty();
            jQuery.ajax({
                url: saveFormUrl,
                success: function(data) {
                    saveFormPanel.html(data);
                    saveFormLoaded = true;
                    var chartForm = saveFormPanel.find("form#savetodashboardform");
                    var saveButton = saveFormPanel.find("#save-btn1");
                    chartForm.submit(function(e) {
                        e.preventDefault();
                        chartForm.find(".error").remove();
                        chartForm.find(".form-errors p").remove();
                        chartForm.find(".form-errors").hide();
                        saveButton.attr("disabled", "true");

                        var postData = getPostData(chartForm.serializeArray());
                        jQuery.ajax({
                            url: chartForm.attr("action"),
                            contentType:'application/json',
                            dataType: "text",
                            data: JSON.stringify(postData),
                            type:'POST',
                            success: function (data) {
                                chartForm.trigger("fakesubmit");
                                saveButton.removeAttr("disabled", "false");
                                window.location = data;
                            },
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                                saveButton.removeAttr("disabled", "false");
                                if(XMLHttpRequest.status === 400) {
                                    var errorCollection = eval("(" + XMLHttpRequest.responseText + ")");
                                    if(errorCollection.generic.length > 0) {
                                        jQuery(errorCollection.generic).each(function(i, item) {
                                        chartForm.find(".form-errors").append("<p>" + item + "</p>");
                                        });
                                        chartForm.find(".form-errors").show();
                                    }
                                    if(errorCollection.fields.length > 0) {
                                        jQuery(errorCollection.fields).each(function(i, item) {
                                            chartForm.find("#" + item.field).after("<div class=\"error\">" + item.error + "</div>");
                                        });
                                    }
                                }
                            }
                        });

                    });
                    saveFormPanel.find("#cancel-btn1").click(function(e) {
                        dialog.prevPage();
                        saveButton.removeAttr("disabled", "false");
                        chartForm.find(".form-errors").hide();
                        chartForm.find(".error").remove();
                        e.preventDefault();
                    });
                }
            });
        }
    },

    /**
     * Appends loading indicator (throbber) to all ajax requests. Indicator, controlled via css, appears in the top
     * right corner of the dialog.
     *
     * @method addThrobber
     * @private
     */
    addThrobber = function () {
        dialog.popup.element.find(".dialog-button-panel").prepend(dialogThrobber);
        jQuery().ajaxSend(function(a,xhr) {
            if (dialog.popup.element.is(":visible")) {
                jQuery(xhr).throbber({target: dialogThrobber});
            }
        });
    },

    /**
     * Handles failed ajax requests. Will subsitute the page body with the 500 error that occured.
     *
     * @method addErrorHandler
     * @private
     */
    addErrorHandler = function () {
        jQuery().ajaxError(function(e,XMLHttpRequest,ajaxOptions){
            if (XMLHttpRequest.status == 500) {
                dialog.hide();
                jQuery("body").html(XMLHttpRequest.responseText);
            }
        });
    },

    /**
     * ESC hides the dialog
     */
    keypressListener = function(e) {       
        if (e.keyCode === 27) {
            dialog.hide();
        }
    },

    /**
     * Creates dialog box. Adds global functionality including error handling and ajax throbber indicator.
     *
     * @method createDialog
     * @private
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     */
    createDialog = function (width, height, data) {
        dialog = new AJS.Dialog(width, height, DIALOG_ID);
        dialog.addHeader("Gadgets");
        resetPanels(data);
        dialog.addButton("Save to Dashboard",
                function(dialog) {
                    loadSaveToDashboardForm();
                    dialog.nextPage();
                },
                "save-to-dashboard");
        dialog.addCancel("Cancel", function(dialog) {
            dialog.hide();
        });
        dialog.addPage();
        dialog.page[1].addPanel("saveToDashBoard", "<div id=\"saveToDashboardPanel\"</div>");
        dialog.page[1].addHeader("Save gadget to a Dashboard");
        addThrobber();
        addErrorHandler();
        AJS.$(document).keydown(keypressListener);
    },

    /**
     * Resets the dialog to the original state when it pops up.
     *
     * @method resetDialog
     * @param {Number} initialPanel - the panel index to go to after resetting the dialog
     * @private
     */
    resetDialog = function(initialPanel) {
        if(dialog) {
            saveFormLoaded = false;
            jQuery("form[name=chartpopup]").show();
            jQuery("input[name=filterName]").val("");
            dialog.gotoPage(0);
            for(var i = 0; dialog.getPanel(i); i++) {
                var panel = dialog.getPanel(i);
                panel.loaded = false;
            }
            dialog.gotoPanel(initialPanel);
        }
    },

    /**
     * Given a directory JSON object this method figures out all the chart gadgets to display in the popup.
     *
     * @method createDialog
     * @private
     * @param {json} data -
     */
    loadChartGadgets = function(data) {
        // Fill items on the right
        var chartGadgets = [], filterResultsGadget, uri = parseUri(window.location);
        var baseUrl = uri.protocol + "://" + uri.authority;
        jQuery(data.gadgets).each(function(i, gadget) {
            //JRADEV-4419: Only add gadgets that are hosted locally to the dialog!
            if(gadget.gadgetSpecUri.indexOf("http") !== 0 || gadget.gadgetSpecUri.indexOf(baseUrl) === 0) {
                jQuery([gadget.categories]).each(function(i, catKey) {
                    var g = {title:gadget.title, specUri:gadget.gadgetSpecUri};
                    // we want to stick the Filter Results gadget at the front of the list of gadgets, so keep a reference to it
                    if (g.specUri.indexOf("filter-results") > -1) {
                        filterResultsGadget = g;
                    }
                    if(catKey.constructor==Array) { // if there are multiple categories for this gadget, loop through all of them
                        for(var j=0; j<catKey.length; ++j) {
                            // don't add the Filter Results gadget to the array - we'll do it later
                            if(catKey[j] === CHARTS_CATEGORY && filterResultsGadget != g) {
                                chartGadgets.push(g);
                            }
                        }
                    }
                    else {
                        // don't add the Filter Results gadget to the array - we'll do it later
                        if(catKey === CHARTS_CATEGORY && filterResultsGadget != g) {
                            chartGadgets.push(g);
                        }
                    }
                });
            }
        });

        chartGadgets.sort(function(one, two) { return (one.title > two.title ? 1 : -1); });
        // add the Filter Results gadget to the start
        if (filterResultsGadget) {
            chartGadgets.unshift(filterResultsGadget);
        }
        return chartGadgets;
    },

    /**
     * Renders the contents of a particular panel for a particular chart.
     *
     * @method renderPanelContents
     * @private
     * @param {Object} panel - the panel to render
     * @param {Object} data - json object with the directory contents
     */
    renderPanelContents = function(panel, data) {
        panel.body.html(data);
        panel.loaded = true;
    },

    /**
     * Sets up all the panels when the dialog loads
     *
     * @method resetPanels
     * @private
     * @param {Object} data - json object of the directory contents
     */
    resetPanels = function(data) {
        var chartGadgets = loadChartGadgets(data);
        dialog.gotoPage(0);
        jQuery(chartGadgets).each(function(i, gadget) {
            dialog.page[0].addPanel(gadget.title, "<div class=\"loadingPanel\">&nbsp;</div>");
            var panel = dialog.getPanel(i);
            if(panel) {
                panel.loaded = false;
                idToUriMap[i] = gadget.specUri;
                panel.body.show = function (panel, show) {
                    return function() {
                        if(!panel.loaded) {
                            var rendererUrl = contextPath + "/rest/gadget/1.0/chart/render?id=" + i + "&gadgetUri=" + encodeURIComponent(gadget.specUri);
                            var filterId = getFilterId();
                            if(filterId) {
                                rendererUrl = rendererUrl + "&filterId=" + encodeURIComponent(filterId);
                            } else {
                                rendererUrl = rendererUrl + "&jql=" + encodeURIComponent(getFilterJql());
                            }

                            jQuery.ajax({
                                url: rendererUrl,
                                success: function(data) {
                                    renderPanelContents(panel, data);
                                }
                            });
                        }
                        show.call(panel.body);
                    };
                }(panel, panel.body.show);
            }
        });
    },

    /**
     * Creates a new dialog (if necessary and displays it)
     *
     * @method launchDialog
     * @private
     * @param {String} url - the url to get the direcotry JSON object from
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     * @param {String, Number} initialPanel - the first panel to load
     */
    launchDialog = function (url, width, height, initialPanel) {
        if(dialog) {
            //this ensures that all the panels will get loaded from the server again.
            resetDialog(initialPanel);
            dialog.show();
        } else {
            jQuery(jQuery.ajax({
                url: url,
                dataType: 'json',
                success: function (data) {
                    if (!dialog) {
                        createDialog(width, height, data);
                    }
                    dialog.show();
                    dialog.gotoPage(0);
                    dialog.gotoPanel(initialPanel);
                }
            })).throbber({target: jQuery("#throbber-space")});
        }
    },

    getFilterId = function()
    {
        var filterId = AJS.Meta.get('filter-id');

        if (filterId && filterId >= 0) {
            return filterId;
        }

        return null;
    },

    getFilterJql = function()
    {
        return AJS.Meta.get('filter-jql');
    };

    return function () {
        // if they clicked on Charts we default to the first chart i.e. Panel 1
        jQuery("body").delegate("#charts", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 1);
            e.preventDefault();
        });
        // if they clicked on On Dashboard we default to the Filter Results gadget i.e. Panel 0
        jQuery("body").delegate("#onDashboard", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 0);
            e.preventDefault();
        });
    };
}();

// wait for page to fully load to make sure we have all the elements we need
jQuery(document).ready(jira.plugin.charting);


/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavInit.js' */
(function(){if(history&&history.pushState===undefined){var a=JIRA.Issues.hashTheUrl(window.location);if(a.changed){window.location=a.uri}}jQuery("html").addClass("hide-until-domready");jQuery(function(){jQuery("html").removeClass("hide-until-domready")});jQuery(document).on("keydown",function(b){if(b.which===27){b.preventDefault()}})})();AJS.$(function(){var g=AJS.$(".navigator-content");var j=g.data("issue-table-model-state");if(j&&!j.table){var a=AJS.$("<div></div>").append(g.children().clone());j.issueTable.table=a.html()}var e=g.data("highlighted-issue-id");var f=AJS.$("#stableSearchIds").data("ids");var i=g.data("selected-issue");var c=jQuery.parseJSON(jQuery("#criteriaJson").text());var d=g.data("session-search-state");var h=jQuery.parseJSON(jQuery("#systemFiltersJson").text());JIRA.Issues.Application.start({showReturnToSearchOnError:function(){return JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()!=="split-view"},useLog:AJS.Meta.get("dev-mode")===true});JIRA.Issues.AnalyticsLoader();var b=new JIRA.Issues.IssueNavCreator().create(AJS.$(document),{initialIssueTableState:j,initialSearcherCollectionState:c,initialSessionSearchState:d,initialSelectedIssue:i,initialHighlightedIssueId:e,initialIssueIds:f,systemFilters:h});Backbone.history.start({pushState:!AJS.DarkFeatures.isEnabled("ka.I_ROOT"),root:JIRA.Issues.IssueNavRouter.getBackboneRoot()});if(jQuery.browser.webkit){JIRA.Issues.ignorePopState=true;window.addEventListener("load",function(){setTimeout(function(){JIRA.Issues.ignorePopState=false},0)})}JIRA.Issues.Api.initialize({searchPageModule:b.searchPageModule});JIRA.Issues.IssueAPI.override({searchPageModule:b.searchPageModule});JIRA.Issues.IssueNavigatorAPI.override({searchPageModule:b.searchPageModule});JIRA.Dialogs.BeforeShowIssueDialogHandler.add(JIRA.Issues.Api.waitForSavesToComplete);AJS.KeyboardShortcut.addIgnoreCondition(function(n,m,l){return l==="issueaction"&&JIRA.Issues.Api.isCurrentlyLoadingIssue()});var k=parseInt(jQuery("body").css("minWidth"),10);jQuery(document).bind("resultsWidthChanged",function(){var l=jQuery(".contained-content");var p=l.parent();if(l.length>0){var o=l.offset().left;var n=jQuery(window).width();var q=Math.max(n,k)-o;var m=q/p.width()*100;if(m<100){l.css("width",m+"%")}else{l.css("width","")}jQuery(document).trigger("issueNavWidthChanged")}});AJS.$(document).trigger("resultsWidthChanged");JIRA.Issues.onVerticalResize(function(){jQuery.event.trigger("updateOffsets.popout")});JIRA.bind(JIRA.Events.LAYOUT_RENDERED,function(){_.defer(function(){jQuery.event.trigger("updateOffsets.popout")})})});JIRA.Issues.displayFailSearchMessage=function(a){if(a&&a.statusText!=="abort"){return JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(a),{closeable:true})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/util/OverrideSparklerPadding.js' */
JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/util/OverrideIssueDialogs.js' */
(function(){var e,f,b;JIRA.Dialogs.getDefaultAjaxOptions=function(){var g=this.options.url||this.getRequestUrlFromTrigger();this.issueId=JIRA.Issues.Api.getSelectedIssueId();this.issueKey=JIRA.Issues.Api.getSelectedIssueKey();if(/id=\{0\}/.test(g)){if(!this.issueId){return false}else{g=g.replace(/(id=\{0\})/,"id="+this.issueId)}}return{data:{decorator:"dialog",inline:"true"},url:g}};JIRA.Issues.overrideIssueDialogs=function(g){g=_.defaults({},g,{isNavigator:false});e=g.getIssueId;f=!!g.isNavigator;b=g.updateIssue;if(f){JIRA.LabelsDialog.prototype._handleSubmitResponse=JIRA.FormDialog.prototype._handleSubmitResponse}JIRA.unbind("QuickEdit.sessionComplete");JIRA.bind("QuickEdit.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.unbind("QuickCreateSubtask.sessionComplete");JIRA.bind("QuickCreateSubtask.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.bind("Dialog.show",function(j,i,h){if(h){h.issueId=e(JIRA.Dialog.current)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,h){h.find(".issueaction-workflow-transition").each(function(){var k=AJS.$(this);var j=k.attr("href");j=j.replace(/atl_token=[^&]*/,"atl_token="+atl_token());k.attr("href",j)})});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(l,j){var k=AJS.$("#ops-login-lnk");if(k.length==0){return}var h=window.location;var i=parseUri(k.attr("href"));i.queryKey.os_destination=h.pathname.slice(contextPath.length)+h.search;k.attr("href",i.path+"?"+AJS.$.param(i.queryKey))})};var d=JIRA.FormDialog.prototype._getDefaultOptions;JIRA.FormDialog.prototype._getDefaultOptions=function(){var g=d.call(this),h=g.onDialogFinished;g.onDialogFinished=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{h.apply(this,arguments)}};return g};var a=JIRA.FormDialog.prototype._performRedirect;JIRA.FormDialog.prototype._performRedirect=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{a.apply(this,arguments)}};function c(){if(this.options.id==="clone-issue-dialog"){a.apply(this,arguments)}else{if(this.options.id==="delete-issue-dialog"){if(f){this.hide();b(this)}else{var h=this._getTargetUrlValue();if(h&&h!==""){AJS.reloadViaWindowLocation(h)}else{if(AJS.$(".page-navigation #next-issue").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #next-issue").attr("href"))}else{if(AJS.$(".page-navigation #return-to-search").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #return-to-search").attr("href"))}else{AJS.reloadViaWindowLocation(AJS.$("#find_link").attr("href"))}}}}}else{var g=this;this.showFooterLoadingIndicator();b(this).always(function(){JIRA.trace("jira.issue.update");g.hideFooterLoadingIndicator();g.hide()})}}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavigatorAPI.js' */
JIRA.Issues.IssueNavigatorAPI=(function(){var a;var b={isNavigator:function(){return a.isIssueVisible()}};var c={focusSearch:JIRA.Issues.Api.focusSearch,isNavigator:b.isNavigator,selectNextIssue:JIRA.Issues.Api.nextIssue,selectPreviousIssue:JIRA.Issues.Api.prevIssue,viewSelectedIssue:JIRA.Issues.Api.viewSelectedIssue};return{override:function(d){a=d.searchPageModule;JIRA.IssueNavigator=_.extend(JIRA.IssueNavigator,b);JIRA.IssueNavigator.Shortcuts=_.extend(JIRA.IssueNavigator.Shortcuts,c)}}})();
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    output.append('<div class="aui-nav-heading sidebar-section-header">', soy.$$escapeHtml(opt_data.title), '</div><ul class="aui-nav nav-links">');
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      navlinks.templates.appswitcher.applicationsItem(linkData8, output);
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">', soy.$$escapeHtml("Application Links"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">', soy.$$escapeHtml("Shortcuts"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div></nav></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-title">');
  aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}, output);
  output.append('<div class="sidebar-project-name">', soy.$$escapeHtml(opt_data.name), '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var dropdownList__soy74 = new soy.StringBuilder();
  navlinks.templates.appswitcher.dropdownList({list: opt_data.links}, dropdownList__soy74);
  dropdownList__soy74 = dropdownList__soy74.toString();
  aui.dropdown2.dropdown2({menu: {'id': opt_data.id, 'content': dropdownList__soy74, 'extraClasses': 'aui-style-default sidebar-customize-section'}, trigger: {'showIcon': false, 'content': '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', 'container': '#app-switcher'}}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="sidebar-admin-links">');
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(linkData82.href), '" title="', soy.$$escapeHtml(linkData82.title), '"><span class="nav-link-label">', soy.$$escapeHtml(linkData82.label), '</span></a></li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = new soy.StringBuilder();
      navlinks.templates.appswitcher.sidebarContents(null, sidebarContents__soy97);
      sidebarContents__soy97 = sidebarContents__soy97.toString();
      var triggerContent__soy99 = new soy.StringBuilder();
      navlinks.templates.appswitcher.trigger(null, triggerContent__soy99);
      triggerContent__soy99 = triggerContent__soy99.toString();
      navlinks.templates.appswitcher.sidebar({sidebar: {'id': 'app-switcher', 'content': sidebarContents__soy97}, trigger: {'showIcon': false, 'content': triggerContent__soy99}}, output);
      output.append('<script>\n                (function (NL) {\n                    var initialise = function () {\n                        new NL.SideBar({\n                            sidebarContents: \'#app-switcher\'\n                        });\n                    };\n                    if (NL.SideBar) {\n                        initialise();\n                    } else {\n                        NL.onInit = initialise;\n                    }\n                }(window.NL = (window.NL || {})));\n                window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
    } else {
      navlinks.templates.appswitcher_old.switcher(null, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="sidebar-trigger app-switcher-trigger" aria-owns="', soy.$$escapeHtml(opt_data.sidebar.id), '" aria-haspopup="true">', opt_data.trigger.content, '</a><div id=', soy.$$escapeHtml(opt_data.sidebar.id), ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">', opt_data.sidebar.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(c,a){a.SideBar=function(d){var e=this;this.$sidebar=null;d=c.extend({sidebarContents:null},d);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(g,f){e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:f,name:g}))};this.getProjectData=function(){var f=c(".project-shortcut-dialog-trigger"),g=f.data("key"),h=f.data("entity-type");if(f.size()==0||!g||!h){c(".app-switcher-shortcuts").remove();return}var j,i;i=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+g,cache:false,data:{entityType:h},dataType:"json"});j=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+g,cache:false,data:{entityType:h},dataType:"json"});c.when(i,j).then(function(l,k){e.updateProjectShortcuts(l,k,{key:g,entityType:h,name:f.data("name"),avatarUrl:f.find("img").prop("src")})},e.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=c(d.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){c(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(f,h){var g=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+f,label:"Customize shortcuts",title:""}];if(e.entityMappings[h]){g.push({href:e.generateEntityLinksUrl(f,e.entityMappings[h]),label:"Manage product links",title:""})}e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:g}))};this.updateAppLinks=function(f){c(function(){e.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:f}));if(a.isUserAdmin){e.addApplicationsCog()}e.bindAnalyticsHandlers(e.getSidebar(),f)})};this.updateProjectShortcuts=function(i,g,h){var j=i[0].shortcuts,f=g[0].shortcuts;e.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:j.concat(f)}));if(a.isUserAdmin){e.addProjectShortcutsCog(h.key,h.entityType)}e.populateProjectHeader(h.name,h.avatarUrl);e.bindAnalyticsHandlers(e.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(f,g){if(g===e.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+g+"&key="+f}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+g+"/"+f}};this.showAppSwitcherError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.showProjectShortcutsError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();f&&f.stopPropagation()};this.trackEvent=function(h,f,g){try{a.trackEvent("appswitcher-new",h,f,g)}catch(i){AJS.log("failed to track analytics event, category: appswitcher, action: "+h+", label: "+f+", value: "+g)}};this.bindAnalyticsHandlers=function(f,g){};this.getLinks();c(this.getProjectData);this.toggleSidebar=function(h){var i=e.getSidebar(),g=c("body"),f=c(window.document);if(!g.hasClass("app-switcher-open")){var k=c("#header");i.css("left",-i.width());i.parent("body").length||i.appendTo("body");b({data:i});i.animate({left:0},300);function j(l){var n=l.target&&c(l.target),m=l.keyCode;if(l.originalEvent===h.originalEvent){return}if(n&&!m&&!(n.closest(i).length||n.closest(k).length)&&h.which==1&&!(l.shiftKey||l.ctrlKey||l.metaKey)){e.toggleSidebar()}else{if(m===27){e.toggleSidebar()}}}f.on("click.appSwitcher",j);f.on("keydown.appSwitcher",j);f.on("scroll.appSwitcher",i,b)}else{f.off(".appSwitcher")}g.toggleClass("app-switcher-open")};c("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(f){var d=c(document).scrollTop(),g=c("#header"),e=(g.height()+g.offset().top)-d;if(e>=0){f.data.css({top:e,position:"fixed"})}else{f.data.css({top:0,left:0,position:"fixed"})}}if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
(function(b,a){a.AppSwitcher=function(c){var d=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var e=this;this.$dropdown=null;c=b.extend({dropdownContents:null},c);this.getLinks=function(){return b.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=b(c.dropdownContents)}return this.$dropdown};this.updateDropdown=function(f){b(function(){e.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:f,showAdminLink:a.isUserAdmin,adminLink:d}));e.bindAnalyticsHandlers(e.getDropdown(),f)})};this.showError=function(){b(function(){e.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",b.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();f&&f.stopPropagation()};this.trackEvent=function(h,f,g){try{a.trackEvent("appswitcher-new",h,f,g)}catch(i){AJS.log("failed to track analytics event, category: appswitcher, action: "+h+", label: "+f+", value: "+g)}};this.bindAnalyticsHandlers=function(i,h){function g(){var l=0;for(var j in h){var k=h[j];if(k.custom){l+=1}}return l}var f=g();i.on({"aui-dropdown2-show":function(j){e.trackEvent("show",a.getCurrentApplication(),h.length)},"aui-dropdown2-hide":function(j){e.trackEvent("hide",a.getCurrentApplication(),h.length)}});i.off(".analytics").on("click.analytics","a",function(j){e.trackEvent("appSelected",b(this).attr("href"),h.length)})};this.getLinks()};if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}, output);
  if (opt_data.custom) {
    navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}, output);
  }
  if (opt_data.showAdminLink) {
    navlinks.templates.appswitcher_old.adminSection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    var param19 = new soy.StringBuilder('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentData(linkData27, {showDescription: opt_data.showDescription}), param19);
    }
    param19.append('</ul>');
    aui.dropdown2.section({content: param19.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link', (opt_data.self) ? ' nav-link-local' : '', '"><a href="', soy.$$escapeHtml(opt_data.link), '" class="aui-dropdown2-radio interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + "Configure\x26hellip;" + '</span></a></li></ul>'}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-loading">', "Loading\x26hellip;", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    var loadingContent__soy81 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.loading(null, loadingContent__soy81);
    loadingContent__soy81 = loadingContent__soy81.toString();
    var triggerContent__soy83 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.trigger(null, triggerContent__soy83);
    triggerContent__soy83 = triggerContent__soy83.toString();
    aui.dropdown2.dropdown2({menu: {'id': 'app-switcher', 'content': loadingContent__soy81, 'extraClasses': 'aui-style-default'}, trigger: {'showIcon': false, 'content': triggerContent__soy83, 'extraClasses': 'app-switcher-trigger'}}, output);
    output.append('<script>\n            (function (NL) {\n                var initialise = function () {\n                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.\n                    window.atlassian = window.atlassian || window.aui;\n                    new NL.AppSwitcher({\n                        dropdownContents: \'#app-switcher\'\n                    });\n                };\n                if (NL.AppSwitcher) {\n                    initialise();\n                } else {\n                    NL.onInit = initialise;\n                }\n            }(window.NL = (window.NL || {})));\n            window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'soy/headerDropdown.soy' */
// This file was automatically generated from headerDropdown.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Menu == 'undefined') { JIRA.Templates.Menu = {}; }
if (typeof JIRA.Templates.Menu.Dropdowns == 'undefined') { JIRA.Templates.Menu.Dropdowns = {}; }


JIRA.Templates.Menu.Dropdowns.dropdown2Fragment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var sectionList3 = opt_data.sections;
  var sectionListLen3 = sectionList3.length;
  for (var sectionIndex3 = 0; sectionIndex3 < sectionListLen3; sectionIndex3++) {
    var sectionData3 = sectionList3[sectionIndex3];
    var hasItems__soy4 = sectionData3.items && sectionData3.items.length > 0;
    output.append('<div class="aui-dropdown2-section">', (hasItems__soy4 && sectionData3.label) ? '<strong>' + soy.$$escapeHtml(sectionData3.label) + '</strong>' : '', '<ul class=\'aui-list-truncate\'', (sectionData3.id) ? ' id="' + soy.$$escapeHtml(sectionData3.id) + '"' : '', (sectionData3.style) ? ' class="' + soy.$$escapeHtml(sectionData3.style) + '"' : '', '>');
    if (hasItems__soy4) {
      var itemList25 = sectionData3.items;
      var itemListLen25 = itemList25.length;
      for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
        var itemData25 = itemList25[itemIndex25];
        JIRA.Templates.Menu.Dropdowns.dropdown2Item(itemData25, output);
      }
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Menu.Dropdowns.dropdown2Item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.style) ? ' class="' + soy.$$escapeHtml(opt_data.style) + '"' : '', '><a href="', soy.$$escapeHtml(opt_data.url), '"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '_lnk"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', ' class="', (opt_data.iconUrl) ? 'aui-icon-container' : '', (opt_data.parameters && opt_data.parameters['class']) ? ' ' + soy.$$escapeHtml(opt_data.parameters['class']) : '', '"');
  if (opt_data.parameters) {
    var keyList66 = soy.$$getMapKeys(opt_data.parameters);
    var keyListLen66 = keyList66.length;
    for (var keyIndex66 = 0; keyIndex66 < keyListLen66; keyIndex66++) {
      var keyData66 = keyList66[keyIndex66];
      output.append((keyData66 != 'class') ? ' ' + soy.$$escapeHtml(keyData66) + '="' + soy.$$escapeHtml(opt_data.parameters[keyData66]) + '"' : '');
    }
  }
  output.append('>', (opt_data.iconUrl) ? '<img class="icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '" />' : '', soy.$$escapeHtml(opt_data.label), '</a></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'js/init-dropdown2.js' */
/**
 * Binds all the header implementations of Dropdown2. Including global nav and user profile.
 */
JIRA.Dropdowns.bindHeaderDropdown2 = function () {
    AJS.$(".jira-ajax-menu").each(function() {
        var $ddtrigger = AJS.$(this);
        var $dd = AJS.$("#" + $ddtrigger.attr("aria-owns"));
        var $ajaxkey = $dd.data("aui-dropdown2-ajax-key");

        if ($ajaxkey) {
            $dd.bind("aui-dropdown2-show", function(event, options) {
                $dd.empty();
                $dd.addClass("aui-dropdown2-loading");
                JIRA.SmartAjax.makeRequest({
                    url: contextPath + "/rest/api/1.0/menus/" + $ajaxkey,
                    data: {
                        inAdminMode: AJS.Meta.getBoolean("in-admin-mode")
                    },
                    dataType: "json",
                    cache: false,
                    success: function (data) {
                        $dd.removeClass("aui-dropdown2-loading");
                        $dd.html(JIRA.Templates.Menu.Dropdowns.dropdown2Fragment(data));

                        if (options && options.selectFirst) {
                            $dd.find("a:not(.disabled)").filter(":first").addClass("active")
                        }
                    }
                });
            });
        }
    });
};

AJS.$(function(){
    JIRA.Dropdowns.bindHeaderDropdown2();
});

